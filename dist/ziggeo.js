/*!
ziggeo-client-sdk - v2.32.7 - 2018-08-11
Copyright (c) 
Proprietary Software License.
*/
//  json2.js
//  2016-10-28
//  Public Domain.
//  NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
//  See http://www.JSON.org/js.html
//  This code should be minified before deployment.
//  See http://javascript.crockford.com/jsmin.html

//  USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO
//  NOT CONTROL.

//  This file creates a global JSON object containing two methods: stringify
//  and parse. This file provides the ES5 JSON capability to ES3 systems.
//  If a project might run on IE8 or earlier, then this file should be included.
//  This file does nothing on ES5 systems.

//      JSON.stringify(value, replacer, space)
//          value       any JavaScript value, usually an object or array.
//          replacer    an optional parameter that determines how object
//                      values are stringified for objects. It can be a
//                      function or an array of strings.
//          space       an optional parameter that specifies the indentation
//                      of nested structures. If it is omitted, the text will
//                      be packed without extra whitespace. If it is a number,
//                      it will specify the number of spaces to indent at each
//                      level. If it is a string (such as "\t" or "&nbsp;"),
//                      it contains the characters used to indent at each level.
//          This method produces a JSON text from a JavaScript value.
//          When an object value is found, if the object contains a toJSON
//          method, its toJSON method will be called and the result will be
//          stringified. A toJSON method does not serialize: it returns the
//          value represented by the name/value pair that should be serialized,
//          or undefined if nothing should be serialized. The toJSON method
//          will be passed the key associated with the value, and this will be
//          bound to the value.

//          For example, this would serialize Dates as ISO strings.

//              Date.prototype.toJSON = function (key) {
//                  function f(n) {
//                      // Format integers to have at least two digits.
//                      return (n < 10)
//                          ? "0" + n
//                          : n;
//                  }
//                  return this.getUTCFullYear()   + "-" +
//                       f(this.getUTCMonth() + 1) + "-" +
//                       f(this.getUTCDate())      + "T" +
//                       f(this.getUTCHours())     + ":" +
//                       f(this.getUTCMinutes())   + ":" +
//                       f(this.getUTCSeconds())   + "Z";
//              };

//          You can provide an optional replacer method. It will be passed the
//          key and value of each member, with this bound to the containing
//          object. The value that is returned from your method will be
//          serialized. If your method returns undefined, then the member will
//          be excluded from the serialization.

//          If the replacer parameter is an array of strings, then it will be
//          used to select the members to be serialized. It filters the results
//          such that only members with keys listed in the replacer array are
//          stringified.

//          Values that do not have JSON representations, such as undefined or
//          functions, will not be serialized. Such values in objects will be
//          dropped; in arrays they will be replaced with null. You can use
//          a replacer function to replace those with JSON values.

//          JSON.stringify(undefined) returns undefined.

//          The optional space parameter produces a stringification of the
//          value that is filled with line breaks and indentation to make it
//          easier to read.

//          If the space parameter is a non-empty string, then that string will
//          be used for indentation. If the space parameter is a number, then
//          the indentation will be that many spaces.

//          Example:

//          text = JSON.stringify(["e", {pluribus: "unum"}]);
//          // text is '["e",{"pluribus":"unum"}]'

//          text = JSON.stringify(["e", {pluribus: "unum"}], null, "\t");
//          // text is '[\n\t"e",\n\t{\n\t\t"pluribus": "unum"\n\t}\n]'

//          text = JSON.stringify([new Date()], function (key, value) {
//              return this[key] instanceof Date
//                  ? "Date(" + this[key] + ")"
//                  : value;
//          });
//          // text is '["Date(---current time---)"]'

//      JSON.parse(text, reviver)
//          This method parses a JSON text to produce an object or array.
//          It can throw a SyntaxError exception.

//          The optional reviver parameter is a function that can filter and
//          transform the results. It receives each of the keys and values,
//          and its return value is used instead of the original value.
//          If it returns what it received, then the structure is not modified.
//          If it returns undefined then the member is deleted.

//          Example:

//          // Parse the text. Values that look like ISO date strings will
//          // be converted to Date objects.

//          myData = JSON.parse(text, function (key, value) {
//              var a;
//              if (typeof value === "string") {
//                  a =
//   /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
//                  if (a) {
//                      return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],
//                          +a[5], +a[6]));
//                  }
//              }
//              return value;
//          });

//          myData = JSON.parse('["Date(09/09/2001)"]', function (key, value) {
//              var d;
//              if (typeof value === "string" &&
//                      value.slice(0, 5) === "Date(" &&
//                      value.slice(-1) === ")") {
//                  d = new Date(value.slice(5, -1));
//                  if (d) {
//                      return d;
//                  }
//              }
//              return value;
//          });

//  This is a reference implementation. You are free to copy, modify, or
//  redistribute.

/*jslint
    eval, for, this
*/

/*property
    JSON, apply, call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,
    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,
    lastIndex, length, parse, prototype, push, replace, slice, stringify,
    test, toJSON, toString, valueOf
*/


// Create a JSON object only if one does not already exist. We create the
// methods in a closure to avoid creating global variables.

if (typeof JSON !== "object") {
    JSON = {};
}

(function () {
    "use strict";

    var rx_one = /^[\],:{}\s]*$/;
    var rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;
    var rx_three = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;
    var rx_four = /(?:^|:|,)(?:\s*\[)+/g;
    var rx_escapable = /[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
    var rx_dangerous = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;

    function f(n) {
        // Format integers to have at least two digits.
        return n < 10
            ? "0" + n
            : n;
    }

    function this_value() {
        return this.valueOf();
    }

    if (typeof Date.prototype.toJSON !== "function") {

        Date.prototype.toJSON = function () {

            return isFinite(this.valueOf())
                ? this.getUTCFullYear() + "-" +
                        f(this.getUTCMonth() + 1) + "-" +
                        f(this.getUTCDate()) + "T" +
                        f(this.getUTCHours()) + ":" +
                        f(this.getUTCMinutes()) + ":" +
                        f(this.getUTCSeconds()) + "Z"
                : null;
        };

        Boolean.prototype.toJSON = this_value;
        Number.prototype.toJSON = this_value;
        String.prototype.toJSON = this_value;
    }

    var gap;
    var indent;
    var meta;
    var rep;


    function quote(string) {

// If the string contains no control characters, no quote characters, and no
// backslash characters, then we can safely slap some quotes around it.
// Otherwise we must also replace the offending characters with safe escape
// sequences.

        rx_escapable.lastIndex = 0;
        return rx_escapable.test(string)
            ? "\"" + string.replace(rx_escapable, function (a) {
                var c = meta[a];
                return typeof c === "string"
                    ? c
                    : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
            }) + "\""
            : "\"" + string + "\"";
    }


    function str(key, holder) {

// Produce a string from holder[key].

        var i;          // The loop counter.
        var k;          // The member key.
        var v;          // The member value.
        var length;
        var mind = gap;
        var partial;
        var value = holder[key];

// If the value has a toJSON method, call it to obtain a replacement value.

        if (value && typeof value === "object" &&
                typeof value.toJSON === "function") {
            value = value.toJSON(key);
        }

// If we were called with a replacer function, then call the replacer to
// obtain a replacement value.

        if (typeof rep === "function") {
            value = rep.call(holder, key, value);
        }

// What happens next depends on the value's type.

        switch (typeof value) {
        case "string":
            return quote(value);

        case "number":

// JSON numbers must be finite. Encode non-finite numbers as null.

            return isFinite(value)
                ? String(value)
                : "null";

        case "boolean":
        case "null":

// If the value is a boolean or null, convert it to a string. Note:
// typeof null does not produce "null". The case is included here in
// the remote chance that this gets fixed someday.

            return String(value);

// If the type is "object", we might be dealing with an object or an array or
// null.

        case "object":

// Due to a specification blunder in ECMAScript, typeof null is "object",
// so watch out for that case.

            if (!value) {
                return "null";
            }

// Make an array to hold the partial results of stringifying this object value.

            gap += indent;
            partial = [];

// Is the value an array?

            if (Object.prototype.toString.apply(value) === "[object Array]") {

// The value is an array. Stringify every element. Use null as a placeholder
// for non-JSON values.

                length = value.length;
                for (i = 0; i < length; i += 1) {
                    partial[i] = str(i, value) || "null";
                }

// Join all of the elements together, separated with commas, and wrap them in
// brackets.

                v = partial.length === 0
                    ? "[]"
                    : gap
                        ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]"
                        : "[" + partial.join(",") + "]";
                gap = mind;
                return v;
            }

// If the replacer is an array, use it to select the members to be stringified.

            if (rep && typeof rep === "object") {
                length = rep.length;
                for (i = 0; i < length; i += 1) {
                    if (typeof rep[i] === "string") {
                        k = rep[i];
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (
                                gap
                                    ? ": "
                                    : ":"
                            ) + v);
                        }
                    }
                }
            } else {

// Otherwise, iterate through all of the keys in the object.

                for (k in value) {
                    if (Object.prototype.hasOwnProperty.call(value, k)) {
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (
                                gap
                                    ? ": "
                                    : ":"
                            ) + v);
                        }
                    }
                }
            }

// Join all of the member texts together, separated with commas,
// and wrap them in braces.

            v = partial.length === 0
                ? "{}"
                : gap
                    ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}"
                    : "{" + partial.join(",") + "}";
            gap = mind;
            return v;
        }
    }

// If the JSON object does not yet have a stringify method, give it one.

    if (typeof JSON.stringify !== "function") {
        meta = {    // table of character substitutions
            "\b": "\\b",
            "\t": "\\t",
            "\n": "\\n",
            "\f": "\\f",
            "\r": "\\r",
            "\"": "\\\"",
            "\\": "\\\\"
        };
        JSON.stringify = function (value, replacer, space) {

// The stringify method takes a value and an optional replacer, and an optional
// space parameter, and returns a JSON text. The replacer can be a function
// that can replace values, or an array of strings that will select the keys.
// A default replacer method can be provided. Use of the space parameter can
// produce text that is more easily readable.

            var i;
            gap = "";
            indent = "";

// If the space parameter is a number, make an indent string containing that
// many spaces.

            if (typeof space === "number") {
                for (i = 0; i < space; i += 1) {
                    indent += " ";
                }

// If the space parameter is a string, it will be used as the indent string.

            } else if (typeof space === "string") {
                indent = space;
            }

// If there is a replacer, it must be a function or an array.
// Otherwise, throw an error.

            rep = replacer;
            if (replacer && typeof replacer !== "function" &&
                    (typeof replacer !== "object" ||
                    typeof replacer.length !== "number")) {
                throw new Error("JSON.stringify");
            }

// Make a fake root object containing our value under the key of "".
// Return the result of stringifying the value.

            return str("", {"": value});
        };
    }


// If the JSON object does not yet have a parse method, give it one.

    if (typeof JSON.parse !== "function") {
        JSON.parse = function (text, reviver) {

// The parse method takes a text and an optional reviver function, and returns
// a JavaScript value if the text is a valid JSON text.

            var j;

            function walk(holder, key) {

// The walk method is used to recursively walk the resulting structure so
// that modifications can be made.

                var k;
                var v;
                var value = holder[key];
                if (value && typeof value === "object") {
                    for (k in value) {
                        if (Object.prototype.hasOwnProperty.call(value, k)) {
                            v = walk(value, k);
                            if (v !== undefined) {
                                value[k] = v;
                            } else {
                                delete value[k];
                            }
                        }
                    }
                }
                return reviver.call(holder, key, value);
            }


// Parsing happens in four stages. In the first stage, we replace certain
// Unicode characters with escape sequences. JavaScript handles many characters
// incorrectly, either silently deleting them, or treating them as line endings.

            text = String(text);
            rx_dangerous.lastIndex = 0;
            if (rx_dangerous.test(text)) {
                text = text.replace(rx_dangerous, function (a) {
                    return "\\u" +
                            ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
                });
            }

// In the second stage, we run the text against regular expressions that look
// for non-JSON patterns. We are especially concerned with "()" and "new"
// because they can cause invocation, and "=" because it can cause mutation.
// But just to be safe, we want to reject all unexpected forms.

// We split the second stage into 4 regexp operations in order to work around
// crippling inefficiencies in IE's and Safari's regexp engines. First we
// replace the JSON backslash pairs with "@" (a non-JSON character). Second, we
// replace all simple value tokens with "]" characters. Third, we delete all
// open brackets that follow a colon or comma or that begin the text. Finally,
// we look to see that the remaining characters are only whitespace or "]" or
// "," or ":" or "{" or "}". If that is so, then the text is safe for eval.

            if (
                rx_one.test(
                    text
                        .replace(rx_two, "@")
                        .replace(rx_three, "]")
                        .replace(rx_four, "")
                )
            ) {

// In the third stage we use the eval function to compile the text into a
// JavaScript structure. The "{" operator is subject to a syntactic ambiguity
// in JavaScript: it can begin a block or an object literal. We wrap the text
// in parens to eliminate the ambiguity.

                j = eval("(" + text + ")");

// In the optional fourth stage, we recursively walk the new structure, passing
// each name/value pair to a reviver function for possible transformation.

                return (typeof reviver === "function")
                    ? walk({"": j}, "")
                    : j;
            }

// If the text is not JSON parseable, then a SyntaxError is thrown.

            throw new SyntaxError("JSON.parse");
        };
    }
}());

/*!
betajs-shims - v0.0.14 - 2017-12-09
Copyright (c) Oliver Friedmann
Apache-2.0 Software License.
*/
(function() {
    if (!this)
        return;

    // Production steps of ECMA-262, Edition 5, 15.4.4.18
    // Reference: http://es5.github.io/#x15.4.4.18
    if (!this.forEach) {
        this.forEach = function (callback/*, thisArg*/) {

            var T, k;

            if (this === null) {
                throw new TypeError('this is null or not defined');
            }

            // 1. Let O be the result of calling toObject() passing the
            // |this| value as the argument.
            var O = Object(this);

            // 2. Let lenValue be the result of calling the Get() internal
            // method of O with the argument "length".
            // 3. Let len be toUint32(lenValue).
            var len = O.length >>> 0;

            // 4. If isCallable(callback) is false, throw a TypeError exception.
            // See: http://es5.github.com/#x9.11
            if (typeof callback !== 'function') {
                throw new TypeError(callback + ' is not a function');
            }

            // 5. If thisArg was supplied, let T be thisArg; else let
            // T be undefined.
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // 6. Let k be 0.
            k = 0;

            // 7. Repeat while k < len.
            while (k < len) {

                var kValue;

                // a. Let Pk be ToString(k).
                //    This is implicit for LHS operands of the in operator.
                // b. Let kPresent be the result of calling the HasProperty
                //    internal method of O with argument Pk.
                //    This step can be combined with c.
                // c. If kPresent is true, then
                if (k in O) {

                    // i. Let kValue be the result of calling the Get internal
                    // method of O with argument Pk.
                    kValue = O[k];

                    // ii. Call the Call internal method of callback with T as
                    // the this value and argument list containing kValue, k, and O.
                    callback.call(T, kValue, k, O);
                }
                // d. Increase k by 1.
                k++;
            }
            // 8. return undefined.
        };
    }

    if (!this.filter) {
        this.filter = function (func, thisArg) {
            if (!(((typeof func).toLowerCase() === 'function') && this))
                throw new TypeError();

            var len = this.length >>> 0,
                res = new Array(len), // preallocate array
                t = this, c = 0, i = -1;
            if (thisArg === undefined) {
                while (++i !== len)
                    // checks to see if the key was set
                    if (i in this)
                        if (func(t[i], i, t))
                            res[c++] = t[i];
            } else {
                while (++i !== len)
                    // checks to see if the key was set
                    if (i in this)
                        if (func.call(thisArg, t[i], i, t))
                            res[c++] = t[i];
            }
            res.length = c; // shrink down array to proper size
            return res;
        };
    }

    // Production steps of ECMA-262, Edition 5, 15.4.4.19
    // Reference: http://es5.github.io/#x15.4.4.19
    if (!this.map) {
        this.map = function(callback/*, thisArg*/) {

            var T, A, k;

            if (this === null) {
                throw new TypeError('this is null or not defined');
            }

            // 1. Let O be the result of calling ToObject passing the |this|
            //    value as the argument.
            var O = Object(this);

            // 2. Let lenValue be the result of calling the Get internal
            //    method of O with the argument "length".
            // 3. Let len be ToUint32(lenValue).
            var len = O.length >>> 0;

            // 4. If IsCallable(callback) is false, throw a TypeError exception.
            // See: http://es5.github.com/#x9.11
            if (typeof callback !== 'function') {
                throw new TypeError(callback + ' is not a function');
            }

            // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
            if (arguments.length > 1) {
                T = arguments[1];
            }

            // 6. Let A be a new array created as if by the expression new Array(len)
            //    where Array is the standard built-in constructor with that name and
            //    len is the value of len.
            A = new Array(len);

            // 7. Let k be 0
            k = 0;

            // 8. Repeat, while k < len
            while (k < len) {

                var kValue, mappedValue;

                // a. Let Pk be ToString(k).
                //   This is implicit for LHS operands of the in operator
                // b. Let kPresent be the result of calling the HasProperty internal
                //    method of O with argument Pk.
                //   This step can be combined with c
                // c. If kPresent is true, then
                if (k in O) {

                    // i. Let kValue be the result of calling the Get internal
                    //    method of O with argument Pk.
                    kValue = O[k];

                    // ii. Let mappedValue be the result of calling the Call internal
                    //     method of callback with T as the this value and argument
                    //     list containing kValue, k, and O.
                    mappedValue = callback.call(T, kValue, k, O);

                    // iii. Call the DefineOwnProperty internal method of A with arguments
                    // Pk, Property Descriptor
                    // { Value: mappedValue,
                    //   Writable: true,
                    //   Enumerable: true,
                    //   Configurable: true },
                    // and false.

                    // In browsers that support Object.defineProperty, use the following:
                    // Object.defineProperty(A, k, {
                    //   value: mappedValue,
                    //   writable: true,
                    //   enumerable: true,
                    //   configurable: true
                    // });

                    // For best browser support, use the following:
                    A[k] = mappedValue;
                }
                // d. Increase k by 1.
                k++;
            }

            // 9. return A
            return A;
        };
    }

    // Production steps of ECMA-262, Edition 5, 15.4.4.21
    // Reference: http://es5.github.io/#x15.4.4.21
    // https://tc39.github.io/ecma262/#sec-array.prototype.reduce
    if (!this.reduce) {
        this.reduce =function(callback /*, initialValue*/) {
            if (this === null) {
                throw new TypeError( 'Array.prototype.reduce ' +
                    'called on null or undefined' );
            }
            if (typeof callback !== 'function') {
                throw new TypeError( callback +
                    ' is not a function');
            }

            // 1. Let O be ? ToObject(this value).
            var o = Object(this);

            // 2. Let len be ? ToLength(? Get(O, "length")).
            var len = o.length >>> 0;

            // Steps 3, 4, 5, 6, 7
            var k = 0;
            var value;

            if (arguments.length >= 2) {
                value = arguments[1];
            } else {
                while (k < len && !(k in o)) {
                    k++;
                }

                // 3. If len is 0 and initialValue is not present,
                //    throw a TypeError exception.
                if (k >= len) {
                    throw new TypeError( 'Reduce of empty array ' +
                        'with no initial value' );
                }
                value = o[k++];
            }

            // 8. Repeat, while k < len
            while (k < len) {
                // a. Let Pk be ! ToString(k).
                // b. Let kPresent be ? HasProperty(O, Pk).
                // c. If kPresent is true, then
                //    i.  Let kValue be ? Get(O, Pk).
                //    ii. Let accumulator be ? Call(
                //          callbackfn, undefined,
                //          « accumulator, kValue, k, O »).
                if (k in o) {
                    value = callback(value, o[k], k, o);
                }

                // d. Increase k by 1.
                k++;
            }

            // 9. Return accumulator.
            return value;
        };

    }

    // Production steps of ECMA-262, Edition 5, 15.4.4.17
    // Reference: http://es5.github.io/#x15.4.4.17
    if (!this.some) {
        this.some = function(fun/*, thisArg*/) {

            if (this === null) {
                throw new TypeError('Array.prototype.some called on null or undefined');
            }

            if (typeof fun !== 'function') {
                throw new TypeError();
            }

            var t = Object(this);
            var len = t.length >>> 0;

            var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
            for (var i = 0; i < len; i++) {
                if (i in t && fun.call(thisArg, t[i], i, t)) {
                    return true;
                }
            }

            return false;
        };
    }

    // Production steps of ECMA-262, Edition 5, 15.4.4.14
    // Reference: http://es5.github.io/#x15.4.4.14
    if (!this.indexOf) {
        this.indexOf = function(searchElement, fromIndex) {

            var k;

            // 1. Let o be the result of calling ToObject passing
            //    the this value as the argument.
            if (this === null) {
                throw new TypeError('"this" is null or not defined');
            }

            var o = Object(this);

            // 2. Let lenValue be the result of calling the Get
            //    internal method of o with the argument "length".
            // 3. Let len be ToUint32(lenValue).
            var len = o.length >>> 0;

            // 4. If len is 0, return -1.
            if (len === 0) {
                return -1;
            }

            // 5. If argument fromIndex was passed let n be
            //    ToInteger(fromIndex); else let n be 0.
            var n = fromIndex | 0;

            // 6. If n >= len, return -1.
            if (n >= len) {
                return -1;
            }

            // 7. If n >= 0, then Let k be n.
            // 8. Else, n<0, Let k be len - abs(n).
            //    If k is less than 0, then let k be 0.
            k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

            // 9. Repeat, while k < len
            while (k < len) {
                // a. Let Pk be ToString(k).
                //   This is implicit for LHS operands of the in operator
                // b. Let kPresent be the result of calling the
                //    HasProperty internal method of o with argument Pk.
                //   This step can be combined with c
                // c. If kPresent is true, then
                //    i.  Let elementK be the result of calling the Get
                //        internal method of o with the argument ToString(k).
                //   ii.  Let same be the result of applying the
                //        Strict Equality Comparison Algorithm to
                //        searchElement and elementK.
                //  iii.  If same is true, return k.
                if (k in o && o[k] === searchElement) {
                    return k;
                }
                k++;
            }
            return -1;
        };
    }

    // Production steps of ECMA-262, Edition 5, 15.4.4.15
    // Reference: http://es5.github.io/#x15.4.4.15
    if (!this.lastIndexOf) {
        this.lastIndexOf = function(searchElement /*, fromIndex*/) {
            if (this === void 0 || this === null) {
                throw new TypeError();
            }

            var n, k,
                t = Object(this),
                len = t.length >>> 0;
            if (len === 0) {
                return -1;
            }

            n = len - 1;
            if (arguments.length > 1) {
                n = Number(arguments[1]);
                if (n != n) {
                    n = 0;
                }
                else if (n !== 0 && n != (1 / 0) && n != -(1 / 0)) {
                    n = (n > 0 || -1) * Math.floor(Math.abs(n));
                }
            }

            for (k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n); k >= 0; k--) {
                if (k in t && t[k] === searchElement) {
                    return k;
                }
            }
            return -1;
        };
    }

    if (!this.every) {
        this.every = function(callbackfn, thisArg) {
            var T, k;

            if (this === null) {
                throw new TypeError('this is null or not defined');
            }

            // 1. Let O be the result of calling ToObject passing the this
            //    value as the argument.
            var O = Object(this);

            // 2. Let lenValue be the result of calling the Get internal method
            //    of O with the argument "length".
            // 3. Let len be ToUint32(lenValue).
            var len = O.length >>> 0;

            // 4. If IsCallable(callbackfn) is false, throw a TypeError exception.
            if (typeof callbackfn !== 'function') {
                throw new TypeError();
            }

            // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
            if (arguments.length > 1) {
                T = thisArg;
            }

            // 6. Let k be 0.
            k = 0;

            // 7. Repeat, while k < len
            while (k < len) {

                var kValue;

                // a. Let Pk be ToString(k).
                //   This is implicit for LHS operands of the in operator
                // b. Let kPresent be the result of calling the HasProperty internal
                //    method of O with argument Pk.
                //   This step can be combined with c
                // c. If kPresent is true, then
                if (k in O) {

                    // i. Let kValue be the result of calling the Get internal method
                    //    of O with argument Pk.
                    kValue = O[k];

                    // ii. Let testResult be the result of calling the Call internal method
                    //     of callbackfn with T as the this value and argument list
                    //     containing kValue, k, and O.
                    var testResult = callbackfn.call(T, kValue, k, O);

                    // iii. If ToBoolean(testResult) is false, return false.
                    if (!testResult) {
                        return false;
                    }
                }
                k++;
            }
            return true;
        };
    }

    // Production steps of ECMA-262, Edition 5, 15.4.4.22
    // Reference: http://es5.github.io/#x15.4.4.22
    if (!this.reduceRight) {
        this.reduceRight = function(callback /*, initialValue*/) {
            if (null === this || 'undefined' === typeof this) {
                throw new TypeError('Array.prototype.reduce called on null or undefined');
            }
            if ('function' !== typeof callback) {
                throw new TypeError(callback + ' is not a function');
            }
            var t = Object(this), len = t.length >>> 0, k = len - 1, value;
            if (arguments.length >= 2) {
                value = arguments[1];
            } else {
                while (k >= 0 && !(k in t)) {
                    k--;
                }
                if (k < 0) {
                    throw new TypeError('Reduce of empty array with no initial value');
                }
                value = t[k--];
            }
            for (; k >= 0; k--) {
                if (k in t) {
                    value = callback(value, t[k], k, t);
                }
            }
            return value;
        };
    }

    // https://tc39.github.io/ecma262/#sec-array.prototype.find
    if (!this.find) {
        this.find = function(predicate) {
            // 1. Let O be ? ToObject(this value).
            if (this === null) {
                throw new TypeError('"this" is null or not defined');
            }

            var o = Object(this);

            // 2. Let len be ? ToLength(? Get(O, "length")).
            var len = o.length >>> 0;

            // 3. If IsCallable(predicate) is false, throw a TypeError exception.
            if (typeof predicate !== 'function') {
                throw new TypeError('predicate must be a function');
            }

            // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.
            var thisArg = arguments[1];

            // 5. Let k be 0.
            var k = 0;

            // 6. Repeat, while k < len
            while (k < len) {
                // a. Let Pk be ! ToString(k).
                // b. Let kValue be ? Get(O, Pk).
                // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).
                // d. If testResult is true, return kValue.
                var kValue = o[k];
                if (predicate.call(thisArg, kValue, k, o)) {
                    return kValue;
                }
                // e. Increase k by 1.
                k++;
            }

            // 7. Return undefined.
            return undefined;
        };
    }

    if (!Array.isArray) {
        Array.isArray = function(arg) {
            return Object.prototype.toString.call(arg) === '[object Array]';
        };
    }

}).call((function () {
    try {
        return Array.prototype;
    } catch (e) {
        return null;
    }
}).call(this));

(function() {
	if (this.Map !== undefined)
		return;

	this.Map = function() {
		this.clear();
	};

	this.Map.prototype.set = function(key, value) {
		if (key in this.__data)
			this.__data[key].value = value;
		else {
			var obj = {
				key : key,
				value : value,
				prev : this.__last,
				next : null
			};
			this.__data[key] = obj;
			if (this.__last)
				this.__last.next = obj;
			else
				this.__first = obj;
			this.__last = obj;
			this.size++;
		}
		return this;
	};

	this.Map.prototype.get = function(key) {
		return key in this.__data ? this.__data[key].value : undefined;
	};

	this.Map.prototype.has = function(key) {
		return key in this.__data;
	};

	this.Map.prototype['delete'] = function(key) {
		var obj = this.__data[key];
		if (obj) {
			delete this.__data[key];
			this.size--;
			if (obj.prev)
				obj.prev.next = obj.next;
			else
				this.__first = obj.next;
			if (obj.next)
				obj.next.prev = obj.prev;
			else
				this.__last = obj.prev;
		}
		return this;
	};

	this.Map.prototype.clear = function() {
		this.__data = {};
		this.__first = null;
		this.__last = null;
		this.size = 0;
		return this;
	};

	this.Map.prototype.keys = function() {
		return {
			current : this.__first,
			next : function() {
				var current = this.current;
				if (!current)
					return {
						done : true
					};
				this.current = current.next;
				return {
					done : false,
					value : current.key
				};
			}
		};
	};

	this.Map.prototype.values = function() {
		return {
			current : this.__first,
			next : function() {
				var current = this.current;
				if (!current)
					return {
						done : true
					};
				this.current = current.next;
				return {
					done : false,
					value : current.value
				};
			}
		};
	};

	this.Map.prototype.entries = function() {
		return {
			current : this.__first,
			next : function() {
				var current = this.current;
				if (!current)
					return {
						done : true
					};
				this.current = current.next;
				return {
					done : false,
					value : [ current.key, current.value ]
				};
			}
		};
	};

	this.Map.prototype.forEach = function(callback, context) {
		var current = this.__first;
		while (current) {
			callback.call(context, current.value, current.key, this);
			current = current.next;
		}
		return this;
	};

}).call((function () {
	try {
		return window;
	} catch (e) {
		try {
			return global;
		} catch (e) {
			return self;
		}
	}
}).call(this));

(function() {
	if (!this)
		return;
	this.preventDefault = this.preventDefault || function () {
		this.returnValue = false;
	};
	this.stopPropagation = this.stopPropagation || function () {
		this.cancelBubble=true;
	};	
}).call((function () {
	try {
		return Event.prototype;
	} catch (e) {
		return null;
	}
}).call(this));

(function() {
	if (!this)
		return;
	var eventMap = {
		"DOMContentLoaded": {
			"event": "onreadystatechange",
			"wrapper": function (wrapper) {
				return function (e) {
					if (document.readyState=="complete")
						wrapper(e);
				};
			}
		}
	};
	this.addEventListener = this.addEventListener || function (type, listener, useCapture) {
		var self = this;
		var wrapper = function (e) {
			e.target = e.srcElement || self;
	        e.currentTarget = self;
	        if (typeof listener.handleEvent != 'undefined')
	            listener.handleEvent(e);
	        else
	            listener.call(self,e);
        };
        if (eventMap[type])
        	wrapper = eventMap[type].wrapper(wrapper);
        this.attachEvent("on" + (eventMap[type] ? eventMap[type].event : type), wrapper);
        try {
	        this.__eventlisteners = this.__eventlisteners || {};
	        this.__eventlisteners[type] = this.__eventlisteners[type] || [];
	        this.__eventlisteners[type].push({listener:listener, wrapper:wrapper});
        } catch (e) {
        	listener.__eventwrapper = wrapper;
        }
	};
	this.removeEventListener = this.removeEventListener || function (type, listener, useCapture) {
		try {
			if (this.__eventlisteners && this.__eventlisteners[type]) {
				for (var i = 0; i < this.__eventlisteners[type].length; ++i) {
					if (this.__eventlisteners[type][i].listener === listener) {
			            this.detachEvent("on" + (eventMap[type] ? eventMap[type].event : type), this.__eventlisteners[type][i].wrapper);
			            this.__eventlisteners[type].splice(i, 1);
			            return;
					}
				}
			}
		} catch (e) {}
		try {
			if (listener.__eventwrapper)
				this.detachEvent("on" + (eventMap[type] ? eventMap[type].event : type), listener.__eventwrapper);
		} catch (e) {}
	};
	this.dispatchEvent = this.dispatchEvent || function (eventObject) {
		var type = eventObject.type;
		var onEvent = "on" + type;
		try {
			return this.fireEvent(onEvent, eventObject);
		} catch (e) {
			var E = Element;
			try {
				E = HTMLElement;
			} catch (e) {}
			if (onEvent in E.prototype)
				throw e;
			if (this.__eventlisteners && this.__eventlisteners[type]) {
				for (var i = 0; i < this.__eventlisteners[type].length; ++i) {
					this.__eventlisteners[type][i].wrapper.call(this, eventObject);
				}
			}
		}
	};
}).call((function () {
	try {
		return Element.prototype;
	} catch (e) {
		return null;
	}
}).call(this));
	
(function() {
	if (!this)
		return;
	this.addEventListener = this.addEventListener || Element.prototype.addEventListener;
	this.removeEventListener = this.removeEventListener || Element.prototype.removeEventListener;
	this.dispatchEvent = this.dispatchEvent || Element.prototype.dispatchEvent;
}).call((function () {
	try {
		return HTMLDocument.prototype;
	} catch (e) {
		return null;
	}
}).call(this));

(function() {
	if (!this)
		return;
	this.addEventListener = this.addEventListener || Element.prototype.addEventListener;
	this.removeEventListener = this.removeEventListener || Element.prototype.removeEventListener;
	this.dispatchEvent = this.dispatchEvent || Element.prototype.dispatchEvent;
}).call((function () {
	try {
		return Window.prototype;
	} catch (e) {
		return null;
	}
}).call(this));

(function() {
	if (!this || !Object.defineProperty || !Object.getOwnPropertyDescriptor || Object.getOwnPropertyDescriptor(this, "outerHTML"))
		return;
    Object.defineProperty(this, "outerHTML", {
       get: function() {
    	   var temp = document.createElement("div");
    	   temp.appendChild(this.cloneNode(true));
    	   var result = temp.innerHTML;
    	   if (temp.remove)
    		   temp.remove();
    	   return result;
       }
   });
}).call((function () {
	try {
		return Element.prototype;
	} catch (e) {
		return null;
	}
}).call(this));
(function() {
    if (!this)
        return;

    if (!this.trim) {
        this.trim = function () {
            return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, '');
        };
    }

}).call((function () {
    try {
        return String.prototype;
    } catch (e) {
        return null;
    }
}).call(this));

(function () {

var oldScoped = null;

try {
	if ("Scoped" in window)
		oldScoped = window.Scoped.detach(true);
} catch (e) {} 
/** @flow **//*!
betajs-scoped - v0.0.19 - 2018-04-07
Copyright (c) Oliver Friedmann
Apache-2.0 Software License.
*/
var Scoped = (function () {
var Globals = (function () {  
/** 
 * This helper module provides functions for reading and writing globally accessible namespaces, both in the browser and in NodeJS.
 * 
 * @module Globals
 * @access private
 */
return {
		
	/**
	 * Returns the value of a global variable.
	 * 
	 * @param {string} key identifier of a global variable
	 * @return value of global variable or undefined if not existing
	 */
	get : function(key/* : string */) {
		if (typeof window !== "undefined")
			return key ? window[key] : window;
		if (typeof global !== "undefined")
			return key ? global[key] : global;
		if (typeof self !== "undefined")
			return key ? self[key] : self;
		return undefined;
	},

	
	/**
	 * Sets a global variable.
	 * 
	 * @param {string} key identifier of a global variable
	 * @param value value to be set
	 * @return value that has been set
	 */
	set : function(key/* : string */, value) {
		if (typeof window !== "undefined")
			window[key] = value;
		if (typeof global !== "undefined")
			global[key] = value;
		if (typeof self !== "undefined")
			self[key] = value;
		return value;
	},
	
	
	/**
	 * Returns the value of a global variable under a namespaced path.
	 * 
	 * @param {string} path namespaced path identifier of variable
	 * @return value of global variable or undefined if not existing
	 * 
	 * @example
	 * // returns window.foo.bar / global.foo.bar 
	 * Globals.getPath("foo.bar")
	 */
	getPath: function (path/* : string */) {
		if (!path)
			return this.get();
		var args = path.split(".");
		if (args.length == 1)
			return this.get(path);		
		var current = this.get(args[0]);
		for (var i = 1; i < args.length; ++i) {
			if (!current)
				return current;
			current = current[args[i]];
		}
		return current;
	},


	/**
	 * Sets a global variable under a namespaced path.
	 * 
	 * @param {string} path namespaced path identifier of variable
	 * @param value value to be set
	 * @return value that has been set
	 * 
	 * @example
	 * // sets window.foo.bar / global.foo.bar 
	 * Globals.setPath("foo.bar", 42);
	 */
	setPath: function (path/* : string */, value) {
		var args = path.split(".");
		if (args.length == 1)
			return this.set(path, value);		
		var current = this.get(args[0]) || this.set(args[0], {});
		for (var i = 1; i < args.length - 1; ++i) {
			if (!(args[i] in current))
				current[args[i]] = {};
			current = current[args[i]];
		}
		current[args[args.length - 1]] = value;
		return value;
	}
	
};}).call(this);
/*::
declare module Helper {
	declare function extend<A, B>(a: A, b: B): A & B;
}
*/

var Helper = (function () {  
/** 
 * This helper module provides auxiliary functions for the Scoped system.
 * 
 * @module Helper
 * @access private
 */
return { 
		
	/**
	 * Attached a context to a function.
	 * 
	 * @param {object} obj context for the function
	 * @param {function} func function
	 * 
	 * @return function with attached context
	 */
	method: function (obj, func) {
		return function () {
			return func.apply(obj, arguments);
		};
	},

	
	/**
	 * Extend a base object with all attributes of a second object.
	 * 
	 * @param {object} base base object
	 * @param {object} overwrite second object
	 * 
	 * @return {object} extended base object
	 */
	extend: function (base, overwrite) {
		base = base || {};
		overwrite = overwrite || {};
		for (var key in overwrite)
			base[key] = overwrite[key];
		return base;
	},
	
	
	/**
	 * Returns the type of an object, particulary returning 'array' for arrays.
	 * 
	 * @param obj object in question
	 * 
	 * @return {string} type of object
	 */
	typeOf: function (obj) {
		return Object.prototype.toString.call(obj) === '[object Array]' ? "array" : typeof obj;
	},
	
	
	/**
	 * Returns whether an object is null, undefined, an empty array or an empty object.
	 * 
	 * @param obj object in question
	 * 
	 * @return true if object is empty
	 */
	isEmpty: function (obj) {
		if (obj === null || typeof obj === "undefined")
			return true;
		if (this.typeOf(obj) == "array")
			return obj.length === 0;
		if (typeof obj !== "object")
			return false;
		for (var key in obj)
			return false;
		return true;
	},
	
	
    /**
     * Matches function arguments against some pattern.
     * 
     * @param {array} args function arguments
     * @param {object} pattern typed pattern
     * 
     * @return {object} matched arguments as associative array 
     */	
	matchArgs: function (args, pattern) {
		var i = 0;
		var result = {};
		for (var key in pattern) {
			if (pattern[key] === true || this.typeOf(args[i]) == pattern[key]) {
				result[key] = args[i];
				i++;
			} else if (this.typeOf(args[i]) == "undefined")
				i++;
		}
		return result;
	},
	
	
	/**
	 * Stringifies a value as JSON and functions to string representations.
	 * 
	 * @param value value to be stringified
	 * 
	 * @return stringified value
	 */
	stringify: function (value) {
		if (this.typeOf(value) == "function")
			return "" + value;
		return JSON.stringify(value);
	}	

	
};}).call(this);
var Attach = (function () {  
/** 
 * This module provides functionality to attach the Scoped system to the environment.
 * 
 * @module Attach
 * @access private
 */
return { 
		
	__namespace: "Scoped",
	__revert: null,
	
	
	/**
	 * Upgrades a pre-existing Scoped system to the newest version present. 
	 * 
	 * @param {string} namespace Optional namespace (default is 'Scoped')
	 * @return {object} the attached Scoped system
	 */
	upgrade: function (namespace/* : ?string */) {
		var current = Globals.get(namespace || Attach.__namespace);
		if (current && Helper.typeOf(current) == "object" && current.guid == this.guid && Helper.typeOf(current.version) == "string") {
			var my_version = this.version.split(".");
			var current_version = current.version.split(".");
			var newer = false;
			for (var i = 0; i < Math.min(my_version.length, current_version.length); ++i) {
				newer = parseInt(my_version[i], 10) > parseInt(current_version[i], 10);
				if (my_version[i] != current_version[i]) 
					break;
			}
			return newer ? this.attach(namespace) : current;				
		} else
			return this.attach(namespace);		
	},


	/**
	 * Attaches the Scoped system to the environment. 
	 * 
	 * @param {string} namespace Optional namespace (default is 'Scoped')
	 * @return {object} the attached Scoped system
	 */
	attach : function(namespace/* : ?string */) {
		if (namespace)
			Attach.__namespace = namespace;
		var current = Globals.get(Attach.__namespace);
		if (current == this)
			return this;
		Attach.__revert = current;
		if (current) {
			try {
				var exported = current.__exportScoped();
				this.__exportBackup = this.__exportScoped();
				this.__importScoped(exported);
			} catch (e) {
				// We cannot upgrade the old version.
			}
		}
		Globals.set(Attach.__namespace, this);
		return this;
	},
	

	/**
	 * Detaches the Scoped system from the environment. 
	 * 
	 * @param {boolean} forceDetach Overwrite any attached scoped system by null.
	 * @return {object} the detached Scoped system
	 */
	detach: function (forceDetach/* : ?boolean */) {
		if (forceDetach)
			Globals.set(Attach.__namespace, null);
		if (typeof Attach.__revert != "undefined")
			Globals.set(Attach.__namespace, Attach.__revert);
		delete Attach.__revert;
		if (Attach.__exportBackup)
			this.__importScoped(Attach.__exportBackup);
		return this;
	},
	

	/**
	 * Exports an object as a module if possible. 
	 * 
	 * @param {object} mod a module object (optional, default is 'module')
	 * @param {object} object the object to be exported
	 * @param {boolean} forceExport overwrite potentially pre-existing exports
	 * @return {object} the Scoped system
	 */
	exports: function (mod, object, forceExport) {
		mod = mod || (typeof module != "undefined" ? module : null);
		if (typeof mod == "object" && mod && "exports" in mod && (forceExport || mod.exports == this || !mod.exports || Helper.isEmpty(mod.exports)))
			mod.exports = object || this;
		return this;
	}	

};}).call(this);

function newNamespace (opts/* : {tree ?: boolean, global ?: boolean, root ?: Object} */) {

	var options/* : {
		tree: boolean,
	    global: boolean,
	    root: Object
	} */ = {
		tree: typeof opts.tree === "boolean" ? opts.tree : false,
		global: typeof opts.global === "boolean" ? opts.global : false,
		root: typeof opts.root === "object" ? opts.root : {}
	};

	/*::
	type Node = {
		route: ?string,
		parent: ?Node,
		children: any,
		watchers: any,
		data: any,
		ready: boolean,
		lazy: any
	};
	*/

	function initNode(options)/* : Node */ {
		return {
			route: typeof options.route === "string" ? options.route : null,
			parent: typeof options.parent === "object" ? options.parent : null,
			ready: typeof options.ready === "boolean" ? options.ready : false,
			children: {},
			watchers: [],
			data: {},
			lazy: []
		};
	}
	
	var nsRoot = initNode({ready: true});
	
	if (options.tree) {
		if (options.global) {
			try {
				if (window)
					nsRoot.data = window;
			} catch (e) { }
			try {
				if (global)
					nsRoot.data = global;
			} catch (e) { }
			try {
				if (self)
					nsRoot.data = self;
			} catch (e) { }
		} else
			nsRoot.data = options.root;
	}
	
	function nodeDigest(node/* : Node */) {
		if (node.ready)
			return;
		if (node.parent && !node.parent.ready) {
			nodeDigest(node.parent);
			return;
		}
		if (node.route && node.parent && (node.route in node.parent.data)) {
			node.data = node.parent.data[node.route];
			node.ready = true;
			for (var i = 0; i < node.watchers.length; ++i)
				node.watchers[i].callback.call(node.watchers[i].context || this, node.data);
			node.watchers = [];
			for (var key in node.children)
				nodeDigest(node.children[key]);
		}
	}
	
	function nodeEnforce(node/* : Node */) {
		if (node.ready)
			return;
		if (node.parent && !node.parent.ready)
			nodeEnforce(node.parent);
		node.ready = true;
		if (node.parent) {
			if (options.tree && typeof node.parent.data == "object")
				node.parent.data[node.route] = node.data;
		}
		for (var i = 0; i < node.watchers.length; ++i)
			node.watchers[i].callback.call(node.watchers[i].context || this, node.data);
		node.watchers = [];
	}
	
	function nodeSetData(node/* : Node */, value) {
		if (typeof value == "object" && node.ready) {
			for (var key in value)
				node.data[key] = value[key];
		} else
			node.data = value;
		if (typeof value == "object") {
			for (var ckey in value) {
				if (node.children[ckey])
					node.children[ckey].data = value[ckey];
			}
		}
		nodeEnforce(node);
		for (var k in node.children)
			nodeDigest(node.children[k]);
	}
	
	function nodeClearData(node/* : Node */) {
		if (node.ready && node.data) {
			for (var key in node.data)
				delete node.data[key];
		}
	}
	
	function nodeNavigate(path/* : ?String */) {
		if (!path)
			return nsRoot;
		var routes = path.split(".");
		var current = nsRoot;
		for (var i = 0; i < routes.length; ++i) {
			if (routes[i] in current.children)
				current = current.children[routes[i]];
			else {
				current.children[routes[i]] = initNode({
					parent: current,
					route: routes[i]
				});
				current = current.children[routes[i]];
				nodeDigest(current);
			}
		}
		return current;
	}
	
	function nodeAddWatcher(node/* : Node */, callback, context) {
		if (node.ready)
			callback.call(context || this, node.data);
		else {
			node.watchers.push({
				callback: callback,
				context: context
			});
			if (node.lazy.length > 0) {
				var f = function (node) {
					if (node.lazy.length > 0) {
						var lazy = node.lazy.shift();
						lazy.callback.call(lazy.context || this, node.data);
						f(node);
					}
				};
				f(node);
			}
		}
	}
	
	function nodeUnresolvedWatchers(node/* : Node */, base, result) {
		node = node || nsRoot;
		result = result || [];
		if (!node.ready && node.lazy.length === 0 && node.watchers.length > 0)
			result.push(base);
		for (var k in node.children) {
			var c = node.children[k];
			var r = (base ? base + "." : "") + c.route;
			result = nodeUnresolvedWatchers(c, r, result);
		}
		return result;
	}

	/** 
	 * The namespace module manages a namespace in the Scoped system.
	 * 
	 * @module Namespace
	 * @access public
	 */
	return {
		
		/**
		 * Extend a node in the namespace by an object.
		 * 
		 * @param {string} path path to the node in the namespace
		 * @param {object} value object that should be used for extend the namespace node
		 */
		extend: function (path, value) {
			nodeSetData(nodeNavigate(path), value);
		},
		
		/**
		 * Set the object value of a node in the namespace.
		 * 
		 * @param {string} path path to the node in the namespace
		 * @param {object} value object that should be used as value for the namespace node
		 */
		set: function (path, value) {
			var node = nodeNavigate(path);
			if (node.data)
				nodeClearData(node);
			nodeSetData(node, value);
		},
		
		/**
		 * Read the object value of a node in the namespace.
		 * 
		 * @param {string} path path to the node in the namespace
		 * @return {object} object value of the node or null if undefined
		 */
		get: function (path) {
			var node = nodeNavigate(path);
			return node.ready ? node.data : null;
		},
		
		/**
		 * Lazily navigate to a node in the namespace.
		 * Will asynchronously call the callback as soon as the node is being touched.
		 *
		 * @param {string} path path to the node in the namespace
		 * @param {function} callback callback function accepting the node's object value
		 * @param {context} context optional callback context
		 */
		lazy: function (path, callback, context) {
			var node = nodeNavigate(path);
			if (node.ready)
				callback(context || this, node.data);
			else {
				node.lazy.push({
					callback: callback,
					context: context
				});
			}
		},
		
		/**
		 * Digest a node path, checking whether it has been defined by an external system.
		 * 
		 * @param {string} path path to the node in the namespace
		 */
		digest: function (path) {
			nodeDigest(nodeNavigate(path));
		},
		
		/**
		 * Asynchronously access a node in the namespace.
		 * Will asynchronously call the callback as soon as the node is being defined.
		 *
		 * @param {string} path path to the node in the namespace
		 * @param {function} callback callback function accepting the node's object value
		 * @param {context} context optional callback context
		 */
		obtain: function (path, callback, context) {
			nodeAddWatcher(nodeNavigate(path), callback, context);
		},
		
		/**
		 * Returns all unresolved watchers under a certain path.
		 * 
		 * @param {string} path path to the node in the namespace
		 * @return {array} list of all unresolved watchers 
		 */
		unresolvedWatchers: function (path) {
			return nodeUnresolvedWatchers(nodeNavigate(path), path);
		},
		
		__export: function () {
			return {
				options: options,
				nsRoot: nsRoot
			};
		},
		
		__import: function (data) {
			options = data.options;
			nsRoot = data.nsRoot;
		}
		
	};
	
}
function newScope (parent, parentNS, rootNS, globalNS) {
	
	var self = this;
	var nextScope = null;
	var childScopes = [];
	var parentNamespace = parentNS;
	var rootNamespace = rootNS;
	var globalNamespace = globalNS;
	var localNamespace = newNamespace({tree: true});
	var privateNamespace = newNamespace({tree: false});
	
	var bindings = {
		"global": {
			namespace: globalNamespace
		}, "root": {
			namespace: rootNamespace
		}, "local": {
			namespace: localNamespace
		}, "default": {
			namespace: privateNamespace
		}, "parent": {
			namespace: parentNamespace
		}, "scope": {
			namespace: localNamespace,
			readonly: false
		}
	};
	
	var custom = function (argmts, name, callback) {
		var args = Helper.matchArgs(argmts, {
			options: "object",
			namespaceLocator: true,
			dependencies: "array",
			hiddenDependencies: "array",
			callback: true,
			context: "object"
		});
		
		var options = Helper.extend({
			lazy: this.options.lazy
		}, args.options || {});
		
		var ns = this.resolve(args.namespaceLocator);
		
		var execute = function () {
			this.require(args.dependencies, args.hiddenDependencies, function () {
                var _arguments = [];
                for (var a = 0; a < arguments.length; ++a)
                    _arguments.push(arguments[a]);
                _arguments[_arguments.length - 1].ns = ns;
				if (this.options.compile) {
					var params = [];
					for (var i = 0; i < argmts.length; ++i)
						params.push(Helper.stringify(argmts[i]));
					this.compiled += this.options.ident + "." + name + "(" + params.join(", ") + ");\n\n";
				}
				if (this.options.dependencies) {
					this.dependencies[ns.path] = this.dependencies[ns.path] || {};
					if (args.dependencies) {
						args.dependencies.forEach(function (dep) {
							this.dependencies[ns.path][this.resolve(dep).path] = true;
						}, this);
					}
					if (args.hiddenDependencies) {
						args.hiddenDependencies.forEach(function (dep) {
							this.dependencies[ns.path][this.resolve(dep).path] = true;
						}, this);
					}
				}
				var result = this.options.compile ? {} : args.callback.apply(args.context || this, _arguments);
				callback.call(this, ns, result);
			}, this);
		};
		
		if (options.lazy)
			ns.namespace.lazy(ns.path, execute, this);
		else
			execute.apply(this);

		return this;
	};
	
	/** 
	 * This module provides all functionality in a scope.
	 * 
	 * @module Scoped
	 * @access public
	 */
	return {
		
		getGlobal: Helper.method(Globals, Globals.getPath),
		setGlobal: Helper.method(Globals, Globals.setPath),
		
		options: {
			lazy: false,
			ident: "Scoped",
			compile: false,
			dependencies: false
		},
		
		compiled: "",
		
		dependencies: {},
		
		
		/**
		 * Returns a reference to the next scope that will be obtained by a subScope call.
		 * 
		 * @return {object} next scope
		 */
		nextScope: function () {
			if (!nextScope)
				nextScope = newScope(this, localNamespace, rootNamespace, globalNamespace);
			return nextScope;
		},
		
		/**
		 * Creates a sub scope of the current scope and returns it.
		 * 
		 * @return {object} sub scope
		 */
		subScope: function () {
			var sub = this.nextScope();
			childScopes.push(sub);
			nextScope = null;
			return sub;
		},
		
		/**
		 * Creates a binding within in the scope. 
		 * 
		 * @param {string} alias identifier of the new binding
		 * @param {string} namespaceLocator identifier of an existing namespace path
		 * @param {object} options options for the binding
		 * 
		 */
		binding: function (alias, namespaceLocator, options) {
			if (!bindings[alias] || !bindings[alias].readonly) {
				var ns;
				if (Helper.typeOf(namespaceLocator) != "string") {
					ns = {
						namespace: newNamespace({
							tree: true,
							root: namespaceLocator
						}),
						path: null	
					};
				} else
					ns = this.resolve(namespaceLocator);
				bindings[alias] = Helper.extend(options, ns);
			}
			return this;
		},
		
		
		/**
		 * Resolves a name space locator to a name space.
		 * 
		 * @param {string} namespaceLocator name space locator
		 * @return {object} resolved name space
		 * 
		 */
		resolve: function (namespaceLocator) {
			var parts = namespaceLocator.split(":");
			if (parts.length == 1) {
                throw ("The locator '" + parts[0] + "' requires a namespace.");
			} else {
				var binding = bindings[parts[0]];
				if (!binding)
					throw ("The namespace '" + parts[0] + "' has not been defined (yet).");
				return {
					namespace: binding.namespace,
					path : binding.path && parts[1] ? binding.path + "." + parts[1] : (binding.path || parts[1])
				};
			}
		},

		
		/**
		 * Defines a new name space once a list of name space locators is available.
		 * 
		 * @param {string} namespaceLocator the name space that is to be defined
		 * @param {array} dependencies a list of name space locator dependencies (optional)
		 * @param {array} hiddenDependencies a list of hidden name space locators (optional)
		 * @param {function} callback a callback function accepting all dependencies as arguments and returning the new definition
		 * @param {object} context a callback context (optional)
		 * 
		 */
		define: function () {
			return custom.call(this, arguments, "define", function (ns, result) {
				if (ns.namespace.get(ns.path))
					throw ("Scoped namespace " + ns.path + " has already been defined. Use extend to extend an existing namespace instead");
				ns.namespace.set(ns.path, result);
			});
		},
		
		
		/**
		 * Assume a specific version of a module and fail if it is not met.
		 * 
		 * @param {string} assumption name space locator
		 * @param {string} version assumed version
		 * 
		 */
		assumeVersion: function () {
			var args = Helper.matchArgs(arguments, {
				assumption: true,
				dependencies: "array",
				callback: true,
				context: "object",
				error: "string"
			});
			var dependencies = args.dependencies || [];
			dependencies.unshift(args.assumption);
			this.require(dependencies, function () {
				var argv = arguments;
				var assumptionValue = argv[0].replace(/[^\d\.]/g, "");
				argv[0] = assumptionValue.split(".");
				for (var i = 0; i < argv[0].length; ++i)
					argv[0][i] = parseInt(argv[0][i], 10);
				if (Helper.typeOf(args.callback) === "function") {
					if (!args.callback.apply(args.context || this, args))
						throw ("Scoped Assumption '" + args.assumption + "' failed, value is " + assumptionValue + (args.error ? ", but assuming " + args.error : ""));
				} else {
					var version = (args.callback + "").replace(/[^\d\.]/g, "").split(".");
					for (var j = 0; j < Math.min(argv[0].length, version.length); ++j)
						if (parseInt(version[j], 10) > argv[0][j])
							throw ("Scoped Version Assumption '" + args.assumption + "' failed, value is " + assumptionValue + ", but assuming at least " + args.callback);
				}
			});
		},
		
		
		/**
		 * Extends a potentiall existing name space once a list of name space locators is available.
		 * 
		 * @param {string} namespaceLocator the name space that is to be defined
		 * @param {array} dependencies a list of name space locator dependencies (optional)
		 * @param {array} hiddenDependencies a list of hidden name space locators (optional)
		 * @param {function} callback a callback function accepting all dependencies as arguments and returning the new additional definitions.
		 * @param {object} context a callback context (optional)
		 * 
		 */
		extend: function () {
			return custom.call(this, arguments, "extend", function (ns, result) {
				ns.namespace.extend(ns.path, result);
			});
		},
				
		
		/**
		 * Requires a list of name space locators and calls a function once they are present.
		 * 
		 * @param {array} dependencies a list of name space locator dependencies (optional)
		 * @param {array} hiddenDependencies a list of hidden name space locators (optional)
		 * @param {function} callback a callback function accepting all dependencies as arguments
		 * @param {object} context a callback context (optional)
		 * 
		 */
		require: function () {
			var args = Helper.matchArgs(arguments, {
				dependencies: "array",
				hiddenDependencies: "array",
				callback: "function",
				context: "object"
			});
			args.callback = args.callback || function () {};
			var dependencies = args.dependencies || [];
			var allDependencies = dependencies.concat(args.hiddenDependencies || []);
			var count = allDependencies.length;
			var deps = [];
			var environment = {};
			if (count) {
				var f = function (value) {
					if (this.i < deps.length)
						deps[this.i] = value;
					count--;
					if (count === 0) {
						deps.push(environment);
						args.callback.apply(args.context || this.ctx, deps);
					}
				};
				for (var i = 0; i < allDependencies.length; ++i) {
					var ns = this.resolve(allDependencies[i]);
					if (i < dependencies.length)
						deps.push(null);
					ns.namespace.obtain(ns.path, f, {
						ctx: this,
						i: i
					});
				}
			} else {
				deps.push(environment);
				args.callback.apply(args.context || this, deps);
			}
			return this;
		},

		
		/**
		 * Digest a name space locator, checking whether it has been defined by an external system.
		 * 
		 * @param {string} namespaceLocator name space locator
		 */
		digest: function (namespaceLocator) {
			var ns = this.resolve(namespaceLocator);
			ns.namespace.digest(ns.path);
			return this;
		},
		
		
		/**
		 * Returns all unresolved definitions under a namespace locator
		 * 
		 * @param {string} namespaceLocator name space locator, e.g. "global:"
		 * @return {array} list of all unresolved definitions 
		 */
		unresolved: function (namespaceLocator) {
			var ns = this.resolve(namespaceLocator);
			return ns.namespace.unresolvedWatchers(ns.path);
		},
		
		/**
		 * Exports the scope.
		 * 
		 * @return {object} exported scope
		 */
		__export: function () {
			return {
				parentNamespace: parentNamespace.__export(),
				rootNamespace: rootNamespace.__export(),
				globalNamespace: globalNamespace.__export(),
				localNamespace: localNamespace.__export(),
				privateNamespace: privateNamespace.__export()
			};
		},
		
		/**
		 * Imports a scope from an exported scope.
		 * 
		 * @param {object} data exported scope to be imported
		 * 
		 */
		__import: function (data) {
			parentNamespace.__import(data.parentNamespace);
			rootNamespace.__import(data.rootNamespace);
			globalNamespace.__import(data.globalNamespace);
			localNamespace.__import(data.localNamespace);
			privateNamespace.__import(data.privateNamespace);
		}
		
	};
	
}
var globalNamespace = newNamespace({tree: true, global: true});
var rootNamespace = newNamespace({tree: true});
var rootScope = newScope(null, rootNamespace, rootNamespace, globalNamespace);

var Public = Helper.extend(rootScope, (function () {  
/** 
 * This module includes all public functions of the Scoped system.
 * 
 * It includes all methods of the root scope and the Attach module.
 * 
 * @module Public
 * @access public
 */
return {
		
	guid: "4b6878ee-cb6a-46b3-94ac-27d91f58d666",
	version: '0.0.19',
		
	upgrade: Attach.upgrade,
	attach: Attach.attach,
	detach: Attach.detach,
	exports: Attach.exports,
	
	/**
	 * Exports all data contained in the Scoped system.
	 * 
	 * @return data of the Scoped system.
	 * @access private
	 */
	__exportScoped: function () {
		return {
			globalNamespace: globalNamespace.__export(),
			rootNamespace: rootNamespace.__export(),
			rootScope: rootScope.__export()
		};
	},
	
	/**
	 * Import data into the Scoped system.
	 * 
	 * @param data of the Scoped system.
	 * @access private
	 */
	__importScoped: function (data) {
		globalNamespace.__import(data.globalNamespace);
		rootNamespace.__import(data.rootNamespace);
		rootScope.__import(data.rootScope);
	}
	
};

}).call(this));

Public = Public.upgrade();
Public.exports();
	return Public;
}).call(this);
(function () {
var Scoped = this.subScope();
Scoped.binding('module', 'root:BetaJS');
Scoped.define("module:", function () {
	return {
    "guid": "71366f7a-7da3-4e55-9a0b-ea0e4e2a9e79",
    "version": "1.0.154"
};
});

Scoped.define("module:Types", function () {
    /**
     * Type-Testing and Type-Parsing
     * 
     * @module BetaJS.Types
     */
    return {
        /**
         * Returns whether argument is an object
         * 
         * @param x argument
         * @return true if x is an object
         */
        is_object: function(x) {
            return typeof x == "object";
        },

        /**
         * Returns whether argument is an array
         * 
         * @param x argument
         * @return true if x is an array
         */
        is_array: function(x) {
            return Array.isArray(x);
        },

        /**
         * Returns whether argument is undefined (which is different from being
         * null)
         * 
         * @param x argument
         * @return true if x is undefined
         */
        is_undefined: function(x) {
            return typeof x == "undefined";
        },

        /**
         * Returns whether argument is null (which is different from being
         * undefined)
         * 
         * @param x argument
         * @return true if x is null
         */
        is_null: function(x) {
            return x === null;
        },

        /**
         * Returns whether argument is undefined or null
         * 
         * @param x argument
         * @return true if x is undefined or null
         */
        is_none: function(x) {
            return this.is_undefined(x) || this.is_null(x);
        },

        /**
         * Returns whether argument is defined (could be null)
         * 
         * @param x argument
         * @return true if x is defined
         */
        is_defined: function(x) {
            return typeof x != "undefined";
        },

        /**
         * Returns whether argument is empty (undefined, null, an empty array or
         * an empty object)
         * 
         * @param x argument
         * @return true if x is empty
         */
        is_empty: function(x) {
            return this.is_none(x) || (this.is_array(x) && x.length === 0) || (this.is_object(x) && this.is_empty_object(x));
        },

        /**
         * Returns whether object argument is empty
         * 
         * @param x object argument
         * @return true if x is empty
         */
        is_empty_object: function(x) {
            for (var key in x)
                return false;
            return true;
        },

        /**
         * Returns whether argument is a string
         * 
         * @param x argument
         * @return true if x is a a string
         */
        is_string: function(x) {
            return typeof x == "string";
        },

        /**
         * Returns whether argument is a function
         * 
         * @param x argument
         * @return true if x is a function
         */
        is_function: function(x) {
            return typeof x == "function";
        },

        /**
         * Returns whether argument is boolean
         * 
         * @param x argument
         * @return true if x is boolean
         */
        is_boolean: function(x) {
            return typeof x == "boolean";
        },

        /**
         * Compares two values
         * 
         * If values are booleans, we compare them directly. If values are
         * arrays, we compare them recursively by their components. Otherwise,
         * we use localeCompare which compares strings.
         * 
         * @param x left value
         * @param y right value
         * @return 1 if x > y, -1 if x < y and 0 if x == y
         */
        compare: function(x, y) {
            if (this.is_boolean(x) && this.is_boolean(y))
                return x == y ? 0 : (x ? 1 : -1);
            if (this.is_array(x) && this.is_array(y)) {
                var len_x = x.length;
                var len_y = y.length;
                var len = Math.min(len_x, len_y);
                for (var i = 0; i < len; ++i) {
                    var c = this.compare(x[i], y[i]);
                    if (c !== 0)
                        return c;
                }
                return len_x == len_y ? 0 : (len_x > len_y ? 1 : -1);
            }
            return x.localeCompare(y);
        },

        /**
         * Parses a boolean string
         * 
         * @param x boolean as a string
         * @return boolean value
         */
        parseBool: function(x) {
            if (this.is_boolean(x))
                return x;
            if (x === "true" || x === "")
                return true;
            if (x === "false")
                return false;
            return null;
        },

        /**
         * Parses an array of type "foo,bar"
         * 
         * @param x array as a string
         * @return array
         */
        parseArray: function(x) {
            return x.split(",");
        },

        /**
         * Returns the type of a given expression
         * 
         * @param x expression
         * @return type string
         */
        type_of: function(x) {
            if (this.is_array(x))
                return "array";
            return typeof x;
        },

        /**
         * Parses a value given a specific type.
         * 
         * @param x value to be parsed
         * @param {string} type the specific type to be parsed (accepts: bool, boolean, int, integer, date, time, datetime, float, double)
         * @return parsed value
         */
        parseType: function(x, type) {
            if (!this.is_string(x))
                return x;
            type = type.toLowerCase();
            if (type == "bool" || type == "boolean")
                return this.parseBool(x);
            if (type == "int" || type == "integer")
                return parseInt(x, 10);
            if (type == "date" || type == "time" || type == "datetime")
                return parseInt(x, 10);
            if (type == "float" || type == "double")
                return parseFloat(x);
            if (type == "array")
                return this.parseArray(x);
            if (type == "object")
                return JSON.parse(x);
            return x;
        },

        /**
         * Parses an object with given types.
         * 
         * @param {object} data object with key value pairs
         * @param {object} types object mapping keys to types
         * 
         * @return {object} object with properly parsed types
         */
        parseTypes: function(data, types) {
            var result = {};
            for (var key in data)
                result[key] = key in types ? this.parseType(data[key], types[key]) : data[key];
            return result;
        },

        /**
         * Returns the specific type of a JavaScript object
         * 
         * @param {object} obj an object instance
         * @return {string} the object type
         */
        objectType: function(obj) {
            if (!this.is_object(obj))
                return null;
            var matcher = obj.toString().match(/\[object (.*)\]/);
            return matcher ? matcher[1] : null;
        },

        /**
         * Returns whether a given object is a pure object
         * 
         * @param {object} obj an object instance
         * @return {boolean} true if pure
         */
        is_pure_object: function(obj) {
            return this.is_object(obj) && (obj.toString().toLowerCase() === '[object]' || obj.toString().toLowerCase() === '[object object]');
        }

    };
});

Scoped.define("module:Functions", ["module:Types"], function (Types) {

    /**
     * Function and Function Argument Support
     * 
     * @module BetaJS.Functions
     */
    return {

        /**
         * Returns the current stack trace.
         * 
         * @param {int} index optional stack trace start index
         * 
         * @return {array} stack trace array
         */
        getStackTrace: function(index) {
            var stack = (new Error()).stack.split("\n");
            while (stack.length > 0 && stack[0].trim().toLowerCase() === "error")
                stack.shift();
            return index ? stack.slice(index) : stack;
        },

        /**
         * Takes a function and an instance and returns the method call as a function
         * 
         * @param {function} func function
         * @param {object} instance instance
         * @return method call 
         */
        as_method: function(func, instance) {
            return function() {
                return func.apply(instance, arguments);
            };
        },

        /**
         * Takes a function name and returns the method call on the global object as a function
         *
         * @param {function} func function
         * @return method call
         */
        global_method: function(func) {
            var f = Scoped.getGlobal(func);
            return f ? this.as_method(f, Scoped.getGlobal()) : f;
        },


        /**
         * Takes a function and returns a function that calls the original function on the first call and returns the return value on all subsequent call. In other words a lazy function cache.
         * 
         * @param {function} func function
         * @return cached function 
         */
        once: function(func) {
            var result = false;
            var executed = false;
            return function() {
                if (executed)
                    return result;
                executed = true;
                result = func.apply(this, arguments);
                func = null;
                return result;
            };
        },


        /**
         * Converts some other function's arguments to an array
         * 
         * @param args function arguments
         * @param {integer} slice number of arguments to be omitted (default: 0)
         * @return {array} arguments as array 
         */
        getArguments: function(args, slice) {
            return Array.prototype.slice.call(args, slice || 0);
        },


        /**
         * Matches functions arguments against some pattern
         * 
         * @param args function arguments
         * @param {integer} skip number of arguments to be omitted (default: 0) 
         * @param {object} pattern typed pattern
         * @return {object} matched arguments as associative array 
         */
        matchArgs: function(args, skip, pattern) {
            if (arguments.length < 3) {
                pattern = skip;
                skip = 0;
            }
            var i = skip;
            var result = {};
            for (var key in pattern) {
                var config = pattern[key];
                if (config === true)
                    config = {
                        required: true
                    };
                else if (typeof config == "string")
                    config = {
                        type: config
                    };
                if (config.required || (config.type && Types.type_of(args[i]) == config.type)) {
                    result[key] = args[i];
                    i++;
                } else if (config.def) {
                    result[key] = Types.is_function(config.def) ? config.def(result) : config.def;
                }
            }
            return result;
        },


        /**
         * Creates a function for creating new instances of a class.
         *  
         * @param {object} cls Class
         * @return {function} class instantiation function 
         * @suppress {checkTypes}
         */
        newClassFunc: function(cls) {
            return function() {
                var args = arguments;

                function F() {
                    return cls.apply(this, args);
                }
                F.prototype = cls.prototype;
                return new F();
            };
        },


        /**
         * Creates a new class instance with arguments.
         *  
         * @param {object} cls Class
         * @return {function} class instance 
         */
        newClass: function(cls) {
            return this.newClassFunc(cls).apply(this, this.getArguments(arguments, 1));
        },


        /**
         * Call an object method.
         *  
         * @param {object} context object instance
         * @param method function or string of method
         * @return result of function call 
         */
        callWithin: function(context, method) {
            if (Types.is_string(method))
                method = context[method];
            return method.apply(context, this.getArguments(arguments, 2));
        }

    };
});

Scoped.define("module:Objs", ["module:Types","module:Functions"], function (Types, Functions) {

    /**
     * Object and Array Manipulation Routines
     * 
     * @module BetaJS.Objs
     */
    return {

        /**
         * Return the i-th key of an object.
         * 
         * @param {object} obj the object
         * @param {int} i index of the i-th key (default: 0)
         * 
         * @return {string} i-th key
         */
        ithKey: function(obj, i) {
            i = i || 0;
            for (var key in obj) {
                if (i <= 0)
                    return key;
                else
                    --i;
            }
            return null;
        },

        /**
         * Return the i-th value of an object.
         * 
         * @param {object} obj the object
         * @param {int} i index of the i-th value (default: 0)
         * 
         * @return {string} i-th value
         */
        ithValue: function(obj, i) {
            i = i || 0;
            for (var key in obj) {
                if (i <= 0)
                    return obj[key];
                else
                    --i;
            }
            return null;
        },

        /**
         * Return the i-th value of an object or array.
         * 
         * @param obj the object or array
         * @param {int} idx index of the i-th value (default: 0)
         * 
         * @return {string} i-th value
         */
        valueByIndex: function(obj, idx) {
            return Types.is_array(obj) ? obj[idx || 0] : this.ithValue(obj, idx);
        },

        /**
         * Return the i-th key of an object or array.
         * 
         * @param obj the object or array
         * @param {int} idx index of the i-th key (default: 0)
         * 
         * @return i-th key
         */
        keyByIndex: function(obj, idx) {
            return Types.is_array(obj) ? idx || 0 : this.ithKey(obj, idx);
        },

        /**
         * Returns the number of elements of an object or array.
         * 
         * @param obj object or array
         * 
         * @return {int} number of elements
         */
        count: function(obj) {
            if (Types.is_array(obj))
                return obj.length;
            else {
                var c = 0;
                for (var key in obj)
                    c++;
                return c;
            }
        },

        /**
         * Clone an object or array up to a certain depth.
         * 
         * @param item object or array
         * @param {int} depth depth until to clone it (default 0)
         * 
         * @return cloned object or array
         */
        clone: function(item, depth) {
            if (!depth || depth === 0)
                return item;
            if (Types.is_array(item))
                return item.slice(0);
            else if (Types.is_object(item))
                return this.extend({}, item, depth - 1);
            else
                return item;
        },

        /**
         * Acyclicly clone an object.
         * 
         * @param {object} object source object
         * 
         * @return acyclic cloned object
         */
        acyclic_clone: function(object) {
            if (object === null || !Types.is_object(object))
                return object;
            var s = "__acyclic_cloned";
            if (object[s])
                return object[s];
            var result = {};
            object[s] = result;
            for (var key in object)
                if (key !== s)
                    result[key] = this.acyclic_clone(object[key]);
            delete object[s];
            return result;
        },

        /**
         * Extend target object by source object, modifying target object in-place.
         * 
         * @param {object} target target object
         * @param {object} source source object
         * @param {int} depth optional depth for cloning source values
         * 
         * @return {object} target object
         */
        extend: function(target, source, depth) {
            target = target || {};
            if (source) {
                for (var key in source)
                    target[key] = this.clone(source[key], depth);
            }
            return target;
        },

        /**
         * Extend target object by source objects, modifying target object in-place.
         *
         */
        multi_extend: function() {
            var args = Functions.getArguments(arguments);
            var depth;
            if (!Types.is_object(args[args.length - 1])) {
                depth = args[args.length - 1];
                args.pop();
            }
            while (args.length > 1) {
                args[1] = this.extend(args[0], args[1], depth);
                args.shift();
            }
            return args[0];
        },

        /**
         * Weakly extend target object by source object, modifying target object in-place.
         * If a key already exists within the target object, it is not overwritten by source.
         * 
         * @param {object} target target object
         * @param {object} source source object
         * @param {int} depth optional depth for cloning source values
         * 
         * @return {object} target object
         */
        weak_extend: function(target, source, depth) {
            target = target || {};
            if (source) {
                for (var key in source) {
                    if (!(key in target))
                        target[key] = this.clone(source[key], depth);
                }
            }
            return target;
        },

        /**
         * Extend target object by source object recursively, modifying target object in-place.
         * 
         * @param {object} target target object
         * @param {object} source source object
         * @param {int} depth optional depth for cloning source values
         * 
         * @return {object} target object
         */
        tree_extend: function(target, source, depth) {
            target = target || {};
            if (source) {
                for (var key in source) {
                    if (key in target && Types.is_object(target[key]) && Types.is_object(source[key]) && !Types.is_array(target[key]) && !Types.is_array(source[key]))
                        target[key] = this.tree_extend(target[key], source[key], depth);
                    else
                        target[key] = this.clone(source[key], depth);
                }
            }
            return target;
        },

        /**
         * Returns the keys of an object.
         * If mapped is given, an object is returned with all keys mapped to mapped. Otherwise, an array is returned.
         * 
         * @param {object} object source object
         * @param mapped optional value
         * 
         * @return keys as array or as an object
         */
        keys: function(obj, mapped) {
            var result = null;
            var key = null;
            if (Types.is_undefined(mapped)) {
                result = [];
                for (key in obj)
                    result.push(key);
                return result;
            } else {
                result = {};
                for (key in obj)
                    result[key] = mapped;
                return result;
            }
        },

        /**
         * Returns true if all key-value-pairs of the first object are contained in the second object.
         * 
         * @param a first object or array
         * @param b second object or array
         * 
         * @return {boolean} true if first contained in second
         */
        subset_of: function(a, b) {
            a = Types.is_array(a) ? this.objectify(a) : a;
            b = Types.is_array(b) ? this.objectify(b) : b;
            for (var key in a)
                if (a[key] != b[key])
                    return false;
            return true;
        },

        /**
         * Returns true if all key-value-pairs of the second object are contained in the first object.
         * 
         * @param a first object or array
         * @param b second object or array
         * 
         * @return {boolean} true if second contained in first
         */
        superset_of: function(a, b) {
            return this.subset_of(b, a);
        },

        /**
         * Converts an array into an object by pairing together odd and even items.
         * 
         * @param {array} arr array with pairs
         * 
         * @return {object} created object
         */
        pairArrayToObject: function(arr) {
            var result = {};
            for (var i = 0; i < arr.length / 2; i += 2)
                result[arr[i]] = arr[i + 1];
            return result;
        },

        /**
         * Converts a list of arguments into an object by pairing together odd and even arguments.
         * 
         * @return {object} created object
         */
        pairsToObject: function() {
            var result = {};
            for (var i = 0; i < arguments.length; ++i)
                result[arguments[i][0]] = arguments[i][1];
            return result;
        },

        /**
         * Inverses the key-value pairs in an object.
         * 
         * @param {object} obj object to be reversed
         * @return {object} object with reversed key-value-pairs
         */
        inverseKeyValue: function(obj) {
            var result = {};
            this.iter(obj, function(value, key) {
                result[value] = key;
            });
            return result;
        },

        /**
         * Returns true if an entry in an object or array exists.
         * 
         * @param obj object or array
         * @param {function} f function to check for an entry to exist
         * @param {object} context optional context for the function
         * 
         * @return {boolean} returns true if an entry exists
         * 
         */
        exists: function(obj, f, context) {
            var success = false;
            this.iter(obj, function() {
                success = success || f.apply(this, arguments);
                return !success;
            }, context);
            return success;
        },

        /**
         * Returns true if all entries in an object or array satisfy a condition
         * 
         * @param obj object or array
         * @param {function} f function to check for the condition
         * @param {object} context optional context for the function
         * 
         * @return {boolean} returns true if all entries satisfy the condition
         * 
         */
        all: function(obj, f, context) {
            var success = true;
            this.iter(obj, function() {
                success = success && f.apply(this, arguments);
                return success;
            }, context);
            return success;
        },

        /**
         * Returns the first entry of an object or array.
         * 
         * @param obj object or array
         * 
         * @return first entry
         */
        peek: function(obj) {
            if (Types.is_array(obj))
                return obj.length > 0 ? obj[0] : null;
            for (var key in obj)
                return obj[key];
            return null;
        },

        /**
         * Returns and removes the first entry of an object or array.
         * 
         * @param obj object or array
         * 
         * @return first entry
         */
        poll: function(obj) {
            if (Types.is_array(obj))
                return obj.shift();
            for (var key in obj) {
                var item = obj[key];
                delete obj[key];
                return item;
            }
            return null;
        },

        /**
         * Iterates over an object or array, calling a callback function for each item.
         * 
         * @param obj object or array
         * @param {function} f callback function
         * @param {object} context optional callback context
         * 
         */
        iter: function(obj, f, context) {
            var result = null;
            if (Types.is_array(obj)) {
                for (var i = 0; i < obj.length; ++i) {
                    result = context ? f.apply(context, [obj[i], i]) : f(obj[i], i);
                    if (Types.is_defined(result) && !result)
                        return false;
                }
            } else {
                for (var key in obj) {
                    result = context ? f.apply(context, [obj[key], key]) : f(obj[key], key);
                    if (Types.is_defined(result) && !result)
                        return false;
                }
            }
            return true;
        },

        /**
         * Creates the intersection object of two objects.
         * 
         * @param {object} a object one
         * @param {object} b object two
         * 
         * @return {object} intersection object
         */
        intersect: function(a, b) {
            var c = {};
            for (var key in a) {
                if (key in b)
                    c[key] = a[key];
            }
            return c;
        },

        /**
         * Determines whether two objects have the same set of keys.
         *
         * @param {object} a object one
         * @param {object} b object two
         *
         * @return {boolean} true if same keys
         */
        keyEquals: function(a, b) {
            for (var key in a)
                if (!(key in b))
                    return false;
            for (key in b)
                if (!(key in a))
                    return false;
            return true;
        },

        /**
         * Splits an object into two according to a callback function
         *
         * @param {object} obj object to split
         * @param {function} f function to determine how to split
         * @param {object} ctx optional context
         *
         * @return {array} two element array of two split objects
         */
        splitObject: function(obj, f, ctx) {
            var x = {};
            var y = {};
            Objs.iter(obj, function(value, key) {
                if (f.apply(this, arguments))
                    x[key] = value;
                else
                    y[key] = value;
            }, ctx);
            return [x, y];
        },

        /**
         * Creates the difference object of two objects.
         * 
         * @param {object} a object one
         * @param {object} b object two
         * 
         * @return {object} difference object
         */
        diff: function(a, b) {
            var c = {};
            for (var key in a)
                if (!(key in b) || a[key] !== b[key])
                    c[key] = a[key];
            return c;
        },

        /**
         * Determines whether a key exists in an array or object.
         * 
         * @param obj object or array
         * @param key search key
         * 
         * @return {boolean} true if key is contained in obj
         */
        contains_key: function(obj, key) {
            if (Types.is_array(obj))
                return Types.is_defined(obj[key]);
            else
                return key in obj;
        },

        /**
         * Determines whether a value exists in an array or object.
         * 
         * @param obj object or array
         * @param value search value
         * 
         * @return {boolean} true if value is contained in obj
         */
        contains_value: function(obj, value) {
            if (Types.is_array(obj)) {
                for (var i = 0; i < obj.length; ++i) {
                    if (obj[i] === value)
                        return true;
                }
            } else {
                for (var key in obj) {
                    if (obj[key] === value)
                        return true;
                }
            }
            return false;
        },

        /**
         * Maps an array of object, mapping values using a function.
         * 
         * @param obj object or array
         * @param {function} f function for mapping values
         * @param {object} context function context
         * 
         * @return object or array with mapped values
         * 
         */
        map: function(obj, f, context) {
            var result = null;
            context = context || this;
            if (Types.is_array(obj)) {
                result = [];
                for (var i = 0; i < obj.length; ++i)
                    result.push(f.call(context, obj[i], i));
                return result;
            } else {
                result = {};
                for (var key in obj)
                    result[key] = f.call(context, obj[key], key);
                return result;
            }
        },

        /**
         * Maps the keys of an object using a function.
         * 
         * @param {object} obj object
         * @param {function} f function for mapping keys
         * @param {object} context function context
         * 
         * @return {object} object with mapped keys
         */
        keyMap: function(obj, f, context) {
            result = {};
            context = context || this;
            for (var key in obj)
                result[f.call(context, obj[key], key)] = obj[key];
            return result;
        },

        /**
         * Returns all values of an object as an array.
         * 
         * @param {object} obj object
         * 
         * @return {array} values of object as array
         */
        values: function(obj) {
            var result = [];
            for (var key in obj)
                result.push(obj[key]);
            return result;
        },

        /**
         * Filters all values of an object or array.
         * 
         * @param obj object or array
         * @param {function} f filter function
         * @param {object} context filter function context
         * 
         * @return object or array with filtered items
         */
        filter: function(obj, f, context) {
            f = f || function(x) {
                return !!x;
            };
            if (Types.is_array(obj))
                return obj.filter(f, context);
            var ret = {};
            for (var key in obj) {
                if (context ? f.apply(context, [obj[key], key]) : f(obj[key], key))
                    ret[key] = obj[key];
            }
            return ret;
        },

        /**
         * Tests two objects for deep equality up to a certain depth.
         * 
         * @param {object} obj1 first object
         * @param {object} obj2 second object
         * @param {int} depth depth until deep comparison should be done
         * 
         * @return {boolean} true if both objects are equal 
         */
        equals: function(obj1, obj2, depth) {
            var key = null;
            if (depth && depth > 0) {
                for (key in obj1) {
                    if (!(key in obj2) || !this.equals(obj1[key], obj2[key], depth - 1))
                        return false;
                }
                for (key in obj2) {
                    if (!(key in obj1))
                        return false;
                }
                return true;
            } else
                return obj1 == obj2;
        },

        /**
         * Converts an array into object using the array values as keys.
         * 
         * @param {array} arr array to be converted
         * @param f a function mapping the value of an array to a value of the object, or a constant value, or undefined (then true is used)
         * @param {object} context optional function context
         * 
         * @return {object} converted object
         */
        objectify: function(arr, f, context) {
            var result = {};
            var is_function = Types.is_function(f);
            if (Types.is_undefined(f))
                f = true;
            for (var i = 0; i < arr.length; ++i)
                result[arr[i]] = is_function ? f.apply(context || this, [arr[i], i]) : f;
            return result;
        },

        /**
         * Converts an object into an array using a function to merge value and key.
         *
         * @param {object} obj obj to be converted
         * @param f a function mapping the value and key to an item instance of the array
         * @param {object} context optional function context
         *
         * @return {array} converted array
         */
        arrayify: function(obj, f, context) {
            var result = [];
            this.iter(obj, function(value, key) {
                result.push(f.call(this, value, key));
            }, context);
            return result;
        },

        /**
         * Creates an object by pairing up the arguments to key value pairs.
         * 
         * @return {object} created object
         */
        objectBy: function() {
            var obj = {};
            var count = arguments.length / 2;
            for (var i = 0; i < count; ++i)
                obj[arguments[2 * i]] = arguments[2 * i + 1];
            return obj;
        },

        /**
         * Extracts all key-value pairs from an object instance not matching default key-value pairs in another instance.
         * 
         * @param {object} ordinary object with default key-value pairs
         * @param {object} concrete object with a concrete list of key-value pairs
         * @param {boolean} keys if true, iterating over the ordinary keys, otherwise iterating over the conrete keys (default)
         * 
         * @return {object} specialized key-value pairs
         */
        specialize: function(ordinary, concrete, keys) {
            var result = {};
            var iterateOver = keys ? ordinary : concrete;
            for (var key in iterateOver)
                if (!(key in ordinary) || ordinary[key] != concrete[key])
                    result[key] = concrete[key];
            return result;
        },

        /**
         * Merges to objects.
         * 
         * @param {object} secondary Secondary object
         * @param {object} primary Primary object
         * @param {object} options Key-based options for merging
         * 
         * @return {object} Merged object
         */
        merge: function(secondary, primary, options) {
            secondary = secondary || {};
            primary = primary || {};
            var result = {};
            var keys = this.extend(this.keys(secondary, true), this.keys(primary, true));
            for (var key in keys) {
                var opt = key in options ? options[key] : "primary";
                if (opt == "primary" || opt == "secondary") {
                    if (key in primary || key in secondary) {
                        if (opt == "primary")
                            result[key] = key in primary ? primary[key] : secondary[key];
                        else
                            result[key] = key in secondary ? secondary[key] : primary[key];
                    }
                } else if (Types.is_function(opt))
                    result[key] = opt(secondary[key], primary[key]);
                else if (Types.is_object(opt))
                    result[key] = this.merge(secondary[key], primary[key], opt);
            }
            return result;
        },

        /**
         * Recursively merges one object into another without modifying the source objects.
         * 
         * @param {object} secondary Object to be merged into.
         * @param {object} primary Object to be merged in
         * 
         * @return {object} Recurisvely merged object
         */
        tree_merge: function(secondary, primary) {
            secondary = secondary || {};
            primary = primary || {};
            var result = {};
            var keys = this.extend(this.keys(secondary, true), this.keys(primary, true));
            for (var key in keys) {
                if (Types.is_object(primary[key]) && secondary[key])
                    result[key] = this.tree_merge(secondary[key], primary[key]);
                else
                    result[key] = key in primary ? primary[key] : secondary[key];
            }
            return result;
        },

        /**
         * Serializes an object in such a way that all subscopes appear in a flat notation.
         * 
         * @param {object} obj source object
         * @param {string} head prefix header, usually empty
         * 
         * @return {array} serialized object
         */
        serializeFlatJSON: function(obj, head) {
            var result = [];
            if (Types.is_array(obj) && obj) {
                obj.forEach(function(value) {
                    result = result.concat(this.serializeFlatJSON(value, head + "[]"));
                }, this);
            } else if (Types.is_object(obj) && obj) {
                this.iter(obj, function(value, key) {
                    result = result.concat(this.serializeFlatJSON(value, head ? head + "[" + key + "]" : key));
                }, this);
            } else {
                result = [{
                    key: head,
                    value: obj
                }];
            }
            return result;
        },

        /**
         * Converts an object into an array by calling a custom function for combining key and value.
         *
         * @param {object} obj source object
         * @param f a function for combining key and value
         * @param {object} context optional function context
         *
         * @return {array} resulint arrayarray
         */
        objectToArray: function(obj, f, ctx) {
            var a = [];
            this.iter(obj, function(value, key) {
                a.push(f.call(this, key, value));
            }, ctx);
            return a;
        }

    };
});

Scoped.define("module:Ids", ["module:Types","module:Objs"], function (Types, Objs) {

    /**
     * Id Generation
     * 
     * @module BetaJS.Ids
     */
    return {

        __uniqueId: 0,


        /**
         * Returns a unique identifier
         * 
         * @param {string} prefix a prefix string for the identifier (optional)
         * @return {string} unique identifier
         */
        uniqueId: function(prefix) {
            return (prefix || "") + (this.__uniqueId++);
        },


        /**
         * Returns the object's unique identifier or sets it
         * 
         * @param {object} object the object
         * @param {string} id (optional)
         * @return {string} object's unique identifier
         */
        objectId: function(object, id) {
            if (!object)
                return undefined;
            if (id !== undefined)
                object.__cid = id;
            else if (!object.__cid)
                object.__cid = this.uniqueId("cid_");
            return object.__cid;
        },

        /**
         * Returns a unique key for any given value of any type.
         * This is not a hash value.
         * 
         * @param value a value to generate a unique key
         * @param {int} depth optional depth for exploring by value instead of by reference
         * @return unique key
         */
        uniqueKey: function(value, depth) {
            if (depth && depth > 0 && (Types.is_object(value) || Types.is_array(value))) {
                return JSON.stringify(Objs.map(value, function(x) {
                    return this.uniqueKey(x, depth - 1);
                }, this));
            }
            if ((value !== null && Types.is_object(value)) || Types.is_array(value) || Types.is_function(value))
                return this.objectId(value);
            return value;
        }

    };
});

Scoped.define("module:Class", ["module:Types","module:Objs","module:Functions","module:Ids"], function (Types, Objs, Functions, Ids) {
    var Class = function() {};

    /** @suppress {checkTypes} */
    Class.extend = function(options, objects, statics, class_statics) {
        objects = objects || [];
        if (!Types.is_array(objects))
            objects = [objects];
        statics = statics || [];
        if (!Types.is_array(statics))
            statics = [statics];
        class_statics = class_statics || [];
        if (!Types.is_array(class_statics))
            class_statics = [class_statics];

        var parent = this;

        objects = Objs.map(objects, function(obj) {
            if (Types.is_function(obj))
                obj = obj(parent.prototype);
            return obj;
        });

        var result;

        // Setup JavaScript Constructor
        Objs.iter(objects, function(obj) {
            if (obj.hasOwnProperty("constructor"))
                result = obj.constructor;
        });
        var has_constructor = Types.is_defined(result);
        if (!has_constructor) {
            result = function() {
                parent.prototype.constructor.apply(this, arguments);
            };
        }

        // Add Parent Statics
        Objs.extend(result, parent);

        // Add External Statics
        Objs.iter(statics, function(stat) {
            stat = Types.is_function(stat) ? stat(parent) : stat;
            var extender = result._extender;
            Objs.extend(result, stat);
            if (stat._extender)
                result._extender = Objs.extend(Objs.clone(extender, 1), stat._extender);
        });


        // Add Class Statics
        var class_statics_keys = {};
        if (parent.__class_statics_keys) {
            for (var key in parent.__class_statics_keys)
                result[key] = Objs.clone(parent[key], 1);
        }
        Objs.iter(class_statics, function(stat) {
            Objs.extend(result, stat);
            Objs.extend(class_statics_keys, Objs.keys(stat, true));
        });
        if (parent.__class_statics_keys)
            Objs.extend(class_statics_keys, parent.__class_statics_keys);
        result.__class_statics_keys = class_statics_keys;

        // Parent & Children Hierarchy
        result.parent = parent;
        result.children = [];
        result.extend = this.extend;
        if (!parent.children)
            parent.children = [];
        parent.children.push(result);

        // Setup Prototype
        var ctor = function() {};
        ctor.prototype = parent.prototype;
        result.prototype = new ctor();

        result.prototype.cls = result;


        options = Objs.extend({}, Types.is_string(options) ? {
            classname: options,
            register: true
        } : options);

        var classname = options.classname;
        if (options.scoped)
            classname = options.scoped.ns.path;

        result.classname = classname;
        if (classname && options.register)
            Scoped.setGlobal(classname, result);

        // Setup Prototype
        result.__notifications = {};
        result.__implements = {};

        if (parent.__notifications)
            Objs.extend(result.__notifications, parent.__notifications, 1);
        if (parent.__implements)
            Objs.extend(result.__implements, parent.__implements, 1);

        Objs.iter(objects, function(object) {
            for (var objkey in object)
                result.prototype[objkey] = result._extender && objkey in result._extender ? result._extender[objkey](result.prototype[objkey], object[objkey]) : object[objkey];
            //Objs.extend(result.prototype, object);

            // Note: Required for Internet Explorer
            if ("constructor" in object)
                result.prototype.constructor = object.constructor;

            if (object._notifications) {
                for (var key in object._notifications) {
                    if (!result.__notifications[key])
                        result.__notifications[key] = [];
                    result.__notifications[key].push(object._notifications[key]);
                }
            }
            if (object._implements) {
                Objs.iter(Types.is_string(object._implements) ? [object._implements] : object._implements, function(impl) {
                    result.__implements[impl] = true;
                });
            }
        });
        delete result.prototype._notifications;
        delete result.prototype._implements;

        if (!has_constructor) {
            result.prototype.constructor = function() {
                parent.prototype.constructor.apply(this, arguments);
            };
        }

        return result;
    };


    /*
     * 
     * Extending the Class
     * 
     */

    Objs.extend(Class, {

        classname: "Class",

        __class_guid: "0f5499f9-f0d1-4c6c-a561-ef026a1eee05",

        __notifications: {},

        /**
         * Determines whether this cls is an ancestor of another class.
         * 
         * @param {object} cls in question
         * 
         * @return {boolean} true if ancestor
         */
        ancestor_of: function(cls) {
            return (this == cls) || (this != Class && this.parent.ancestor_of(cls));
        },

        /**
         * Determines whether something is of type class.
         * 
         * @param cls class in question
         * 
         * @return {boolean} true if class
         */
        is_class: function(cls) {
            return cls && Types.is_object(cls) && ("__class_guid" in cls) && cls.__class_guid == this.__class_guid;
        },

        /**
         * Determines whether something is of type class instance.
         * 
         * @param obj instance in question
         * 
         * @return {boolean} true if class instance
         */
        is_class_instance: function(obj) {
            return obj && Types.is_object(obj) && ("__class_instance_guid" in obj) && obj.__class_instance_guid == this.prototype.__class_instance_guid;
        },

        /**
         * Determines whether something is pure json and not a class instance.
         * 
         * @param obj json in question
         * 
         * @return {boolean} true if pure json
         */
        is_pure_json: function(obj) {
            return obj && Types.is_object(obj) && !this.is_class_instance(obj) && Types.is_pure_object(obj);
        },

        /**
         * Determines whether an object is an instance of this class.
         * 
         * @param {object} obj object in question
         * 
         * @return {boolean} true if instance of class
         */
        is_instance_of: function(obj) {
            return obj && this.is_class_instance(obj) && obj.instance_of(this);
        },

        /**
         * Adhoc defines a new class.
         * 
         * @param parent scoped string of parent class or parent class
         * @param current scoped string of new class
         */
        define: function(parent, current) {
            var args = Functions.getArguments(arguments, 2);
            if (Types.is_object(parent)) {
                return Scoped.define(current, [], function(scoped) {
                    args.unshift({
                        scoped: scoped
                    });
                    return parent.extend.apply(parent, args);
                });
            } else {
                return Scoped.define(current, [parent], function(parent, scoped) {
                    args.unshift({
                        scoped: scoped
                    });
                    return parent.extend.apply(parent, args);
                });
            }
        },

        /**
         * @deprecated
         */
        _inherited: function(cls, func) {
            return cls.parent[func].apply(this, Array.prototype.slice.apply(arguments, [2]));
        }

    });






    /*
     * 
     * Extending the Object
     * 
     */

    Class.prototype.__class_instance_guid = "e6b0ed30-80ee-4b28-af02-7d52430ba45f";

    //Class.prototype.supportsGc = false;

    /**
     * Creates a new instance.
     */
    Class.prototype.constructor = function() {
        this._notify("construct");
    };

    /**
     * Destroys this instance.
     */
    Class.prototype.destroy = function() {
        this._notify("destroy");
        if (this.__auto_destroy_list) {
            for (var i = 0; i < this.__auto_destroy_list.length; ++i) {
                if ("destroy" in this.__auto_destroy_list[i])
                    this.__auto_destroy_list[i].weakDestroy();
            }
        }
        var cid = this.cid();
        for (var key in this)
            delete this[key];
        Ids.objectId(this, cid);
        this.destroy = this.__destroyedDestroy;
    };

    /**
     * Determines whether this instance has already been destroyed.
     * 
     * @return {boolean} true if this instance has been destroyed
     */
    Class.prototype.destroyed = function() {
        return this.destroy === this.__destroyedDestroy;
    };

    /**
     * Weakly destroy this instance, only destroying it if it hasn't been destroyed already.
     */
    Class.prototype.weakDestroy = function() {
        if (!this.destroyed()) {
            if (this.__gc) {
                this.__gc.queue(this);
                return;
            }
            this.destroy();
        }
    };

    Class.prototype.__destroyedDestroy = function() {
        throw ("Trying to destroy destroyed object " + this.cid() + ": " + this.cls.classname + ".");
    };

    /**
     * Enable garbage collection for this instance.
     */
    Class.prototype.enableGc = function(gc) {
        if (this.supportsGc)
            this.__gc = gc;
        return this;
    };

    /**
     * Destroy another instance depending on this one.
     * 
     * @param {object} other other object that should be destroyed
     */
    Class.prototype.dependDestroy = function(other) {
        if (other.destroyed())
            return;
        if (this.__gc)
            other.enableGc();
        other.weakDestroy();
        return this;
    };

    /**
     * Returns the unique id of the object.
     * 
     * @return {string} unique id
     */
    Class.prototype.cid = function() {
        return Ids.objectId(this);
    };

    Class.prototype.cls = Class;

    /**
     * Generates a context-free function of a method.
     * 
     * @param {string} s name of method
     * 
     * @return {function} context-free function
     */
    Class.prototype.as_method = function(s) {
        return Functions.as_method(this[s], this);
    };

    /**
     * Automatically destroys an object when this object is being destroyed.
     * 
     * @param {object} obj
     * @param {boolean} returnSource return source object instead of obj
     */
    Class.prototype.auto_destroy = function(obj, returnSource) {
        if (obj) {
            if (!this.__auto_destroy_list)
                this.__auto_destroy_list = [];
            var target = obj;
            if (!Types.is_array(target))
                target = [target];
            for (var i = 0; i < target.length; ++i)
                this.__auto_destroy_list.push(target[i]);
        }
        return returnSource ? this : obj;
    };

    /**
     * Notify all notifications listeners of an internal notification event.
     * 
     * @param {string} name notification name
     * 
     * @protected
     */
    Class.prototype._notify = function(name) {
        if (!this.cls.__notifications)
            return;
        var rest = Array.prototype.slice.call(arguments, 1);
        Objs.iter(this.cls.__notifications[name], function(entry) {
            var method = Types.is_function(entry) ? entry : this[entry];
            if (!method)
                throw this.cls.classname + ": Could not find " + name + " notification handler " + entry;
            method.apply(this, rest);
        }, this);
    };

    /**
     * Checks whether this instance implements a certain mixin.
     *
     * @param identifier mixin identifier
     * 
     * @return {boolean} true if it implements the mixin
     */
    Class.prototype.impl = function(identifier) {
        return !!(this.cls.__implements && this.cls.__implements[Types.is_string(identifier) ? identifier : identifier._implements]);
    };

    /**
     * Determines whether this instance is an instance of a certain class.
     * 
     * @param {object} cls class in question
     * 
     * @return {boolean} true if instance is instance of class
     */
    Class.prototype.instance_of = function(cls) {
        return this.cls.ancestor_of(cls);
    };

    /**
     * Increases the reference counter of this instance.
     * 
     * @param {object} reference optional reference object
     */
    Class.prototype.increaseRef = function(reference) {
        this.__referenceCount = this.__referenceCount || 0;
        this.__referenceCount++;
        this.__referenceObjects = this.__referenceObjects || {};
        if (reference) {
            if (!this.__referenceObjects[reference.cid()])
                this.__referenceObjects[reference.cid()] = reference;
            else
                this.__referenceCount--;
        }
        return this;
    };

    /**
     * Decreases the reference counter of this instance.
     * 
     * @param {object} reference optional reference object
     */
    Class.prototype.decreaseRef = function(reference) {
        this.__referenceCount = this.__referenceCount || 0;
        this.__referenceCount--;
        this.__referenceObjects = this.__referenceObjects || {};
        if (reference) {
            if (this.__referenceObjects[reference.cid()])
                delete this.__referenceObjects[reference.cid()];
            else
                this.__referenceCount++;
        }
        if (this.__referenceCount <= 0 && Types.is_empty(this.__referenceObjects))
            this.weakDestroy();
        return this;
    };

    /**
     * Inspects the instance for debugging purposes.
     * 
     * @return {object} json object describing the instance
     */
    Class.prototype.inspect = function() {
        return {
            header: {
                cid: this.cid(),
                classname: this.cls.classname,
                destroyed: this.destroyed()
            },
            attributes: {
                attributes_public: Objs.filter(this, function(value, key) {
                    return !Types.is_function(value) && key.indexOf("_") !== 0;
                }, this),
                attributes_protected: Objs.filter(this, function(value, key) {
                    return !Types.is_function(value) && key.indexOf("_") === 0 && key.indexOf("__") !== 0;
                }, this),
                attributes_private: Objs.filter(this, function(value, key) {
                    return !Types.is_function(value) && key.indexOf("__") === 0;
                }, this)
            },
            methods: {
                methods_public: Objs.filter(this, function(value, key) {
                    return Types.is_function(value) && key.indexOf("_") !== 0;
                }, this),
                methods_protected: Objs.filter(this, function(value, key) {
                    return Types.is_function(value) && key.indexOf("_") === 0 && key.indexOf("__") !== 0;
                }, this),
                method_private: Objs.filter(this, function(value, key) {
                    return Types.is_function(value) && key.indexOf("__") === 0;
                }, this)
            }
        };
    };



    /**
     * @deprecated
     */
    Class.prototype._auto_destroy = function(obj) {
        return this.auto_destroy(obj);
    };

    /**
     * @deprecated
     */
    Class.prototype._inherited = function(cls, func) {
        return cls.parent.prototype[func].apply(this, Array.prototype.slice.apply(arguments, [2]));
    };

    return Class;

});

Scoped.define("module:Time", [], function () {
    /**
     * Time Helper Functions
     * 
     * All time routines are based on UTC time.
     * The optional timezone parameter should be used as follows:
     *    - undefined or false: UTC
     *    - true: user's local time zone
     *    - int value: actual time zone bias in minutes
     *    
     * @module BetaJS.Time
     */
    return {

        __components: {
            "year": {
                "set": function(date, value) {
                    date.setUTCFullYear(value);
                },
                "get": function(date) {
                    return date.getUTCFullYear();
                }
            },
            "month": {
                "set": function(date, value) {
                    date.setUTCMonth(value);
                },
                "get": function(date) {
                    return date.getUTCMonth();
                }
            },
            "day": {
                "dependencies": {
                    "weekday": true
                },
                "set": function(date, value) {
                    date.setUTCDate(value + 1);
                },
                "get": function(date) {
                    return date.getUTCDate() - 1;
                },
                "milliseconds": 24 * 60 * 60 * 1000
            },
            "weekday": {
                "dependencies": {
                    "day": true,
                    "month": true,
                    "year": true
                },
                "set": function(date, value) {
                    date.setUTCDate(date.getUTCDate() + value - date.getUTCDay());
                },
                "get": function(date) {
                    return date.getUTCDay();
                }
            },
            "hour": {
                "set": function(date, value) {
                    date.setUTCHours(value);
                },
                "get": function(date) {
                    return date.getUTCHours();
                },
                "max": 23,
                "milliseconds": 60 * 60 * 1000
            },
            "minute": {
                "set": function(date, value) {
                    date.setUTCMinutes(value);
                },
                "get": function(date) {
                    return date.getUTCMinutes();
                },
                "max": 59,
                "milliseconds": 60 * 1000
            },
            "second": {
                "set": function(date, value) {
                    date.setUTCSeconds(value);
                },
                "get": function(date) {
                    return date.getUTCSeconds();
                },
                "max": 59,
                "milliseconds": 1000
            },
            "millisecond": {
                "set": function(date, value) {
                    date.setUTCMilliseconds(value);
                },
                "get": function(date) {
                    return date.getUTCMilliseconds();
                },
                "max": 999,
                "milliseconds": 1
            }
        },

        /**
         * Reads the current timezone offset.
         *
         * @return {int} timezone offset in minutes
         */
        getTimezoneOffset: function() {
            return this.__timezoneOffset === undefined ? (new Date()).getTimezoneOffset() : this.__timezoneOffset;
        },

        /**
         * Overwrites the current timezone offset.
         *
         * @param {int} timezoneOffset timezone offset in minutes (undefined to disable overwrite)
         */
        setTimezoneOffset: function(timezoneOffset) {
            this.__timezoneOffset = timezoneOffset;
        },

        /**
         * Computes the timezone bias in milliseconds from UTC
         * 
         * @param {int} timezone bias in minutes; can be true to use current time zone; can be undefined to use UTC
         * 
         * @return {int} timezone bias in milliseconds
         */
        timezoneBias: function(timezone) {
            if (timezone === true)
                timezone = this.getTimezoneOffset();
            if (typeof timezone == "undefined" || timezone === null || timezone === false)
                timezone = 0;
            return timezone * 60 * 1000;
        },

        /**
         * Given a time in milliseconds, compute a Date object.
         * 
         * @param {int} t time in milliseconds
         * @param {int} timezone timezone (optional)
         * 
         * @return {object} Date object
         */
        timeToDate: function(t, timezone) {
            return new Date(t + this.timezoneBias(timezone));
        },

        /**
         * Given a time as a Date object, return UTC time in milliseconds.
         * 
         * @param {object} d time as Date object
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} UTC time in milliseconds
         */
        dateToTime: function(d, timezone) {
            return d.getTime() - this.timezoneBias(timezone);
        },

        /**
         * Given a time in milliseconds, compute a timezone-based Date object.
         * 
         * @param {int} t time in milliseconds
         * @param {int} timezone timezone (optional)
         * 
         * @return {object} timezone-based Date object
         */
        timeToTimezoneBasedDate: function(t, timezone) {
            return new Date(t - this.timezoneBias(timezone));
        },

        /**
         * Given a time as a timezone-based Date object, return UTC time in milliseconds.
         * 
         * @param {object} d time as a timezone-based Date object
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} UTC time in milliseconds
         */
        timezoneBasedDateToTime: function(d, timezone) {
            return d.getTime() + this.timezoneBias(timezone);
        },

        /**
         * Decode time into its time components
         *
         * @param {int} t time in milliseconds
         * @param {int} timezone timezone (optional)
         * 
         * @return {object} decoded time component
         */
        decodeTime: function(t, timezone) {
            var d = this.timeToTimezoneBasedDate(t || this.now(), timezone);
            var result = {};
            for (var key in this.__components)
                result[key] = this.__components[key].get(d);
            return result;
        },

        /**
         * Encode time from components to UTC time
         * 
         * @param {object} data component data
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} encoded UTC time
         */
        encodeTime: function(data, timezone) {
            return this.updateTime(this.now(), data, timezone);
        },

        /**
         * Encode time period data from components to milliseconds
         * 
         * @param {object} data component data
         * 
         * @return {int} encoded milliseconds
         */
        encodePeriod: function(data) {
            return this.incrementTime(0, data);
        },

        /**
         * Updates a given time with respect to provided component data
         * 
         * @param {int} t UTC time
         * @param {object} data component data
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} updated UTC time
         */
        updateTime: function(t, data, timezone) {
            var d = this.timeToTimezoneBasedDate(t, timezone);
            for (var key in data)
                this.__components[key].set(d, data[key]);
            return this.timezoneBasedDateToTime(d, timezone);
        },

        /**
         * Returns the current time in milliseconds
         * 
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} current time
         */
        now: function(timezone) {
            return this.dateToTime(new Date(), timezone);
        },

        /**
         * Returns the performance time in millseconds
         * 
         * @return {float} performance time
         */
        perfNow: function() {
            return typeof performance === "undefined" ? (new Date()).getTime() : performance.now();
        },

        /**
         * Increments a given time with respect to provided component data
         * 
         * @param {int} t UTC time
         * @param {object} data component data
         * 
         * @return {int} incremented UTC time
         */
        incrementTime: function(t, data) {
            var d = this.timeToDate(t);
            for (var key in data)
                this.__components[key].set(d, this.__components[key].get(d) + data[key]);
            return this.dateToTime(d);
        },

        /**
         * Floors a given time with respect to a component key and all smaller components.
         * 
         * @param {int} t time
         * @param {string} key component key
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} floored time
         */
        floorTime: function(t, key, timezone) {
            var d = this.timeToTimezoneBasedDate(t, timezone);
            var found = false;
            for (var comp in this.__components) {
                var c = this.__components[comp];
                found = found || comp == key;
                if (found && (!c.dependencies || !c.dependencies[key]))
                    c.set(d, 0);
            }
            return this.timezoneBasedDateToTime(d, timezone);
        },

        /**
         * Computes how long a specific time is ago from now.
         * 
         * @param {int} t time
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} milliseconds ago
         */
        ago: function(t, timezone) {
            return this.now(timezone) - t;
        },

        /**
         * Returns the multiplicity of a time component given a time.
         * 
         * @param {int} t time
         * @param {string} key component key
         * @param {function} rounding function (default is floor)
         * 
         * @return {int} multiplicity of time
         */
        timeComponent: function(t, key, round) {
            return Math[round || "floor"](t / this.__components[key].milliseconds);
        },

        /**
         * Returns the value of a time component given a time.
         * 
         * @param {int} t time
         * @param {string} key component key
         * @param {int} timezone timezone (optional)
         * 
         * @return {int} value of time
         */
        timeComponentGet: function(t, key, timezone) {
            return this.__components[key].get(this.timeToTimezoneBasedDate(t, timezone));
        },

        /**
         * Returns the remainder of a time component given a time.
         * 
         * @param {int} t time
         * @param {string} key component key
         * @param {function} rounding function (default is floor)
         * 
         * @return {int} remainder of time
         */
        timeModulo: function(t, key, round) {
            return this.timeComponent(t, key, round) % (this.__components[key].max + 1);
        }

    };

});

Scoped.define("module:Timers.Timer", ["module:Class","module:Objs","module:Time"], function (Class, Objs, Time, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Timer Class
         * 
         * @class BetaJS.Timers.Timer
         */
        return {

            /**
             * Create a new timer instance.
             * 
             * @param {object} options, including
             *   int delay (mandatory): number of milliseconds until it fires
             *   bool once (optional, default false): should it fire infinitely often
             *   func fire (optional): will be fired
             *   object context (optional): for fire
             *   bool start (optional, default true): should it start immediately
             *   bool real_time (default false)
             *   bool immediate (optional, default false): zero time until first fire
             *   int duration (optional, default null)
             *   int fire_max (optional, default null)
             * 
             */
            constructor: function(options) {
                inherited.constructor.call(this);
                options = Objs.extend({
                    once: false,
                    start: true,
                    fire: null,
                    context: this,
                    destroy_on_fire: false,
                    destroy_on_stop: false,
                    real_time: false,
                    duration: null,
                    fire_max: null,
                    immediate: false
                }, options);
                this.__immediate = options.immediate;
                this.__delay = options.delay;
                this.__destroy_on_fire = options.destroy_on_fire;
                this.__destroy_on_stop = options.destroy_on_stop;
                this.__once = options.once;
                this.__fire = options.fire;
                this.__context = options.context;
                this.__started = false;
                this.__real_time = options.real_time;
                this.__end_time = options.duration !== null ? Time.now() + options.duration : null;
                this.__fire_max = options.fire_max;
                if (options.start)
                    this.start();
            },

            /**
             * @override
             */
            destroy: function() {
                this.stop();
                inherited.destroy.call(this);
            },

            /**
             * Returns the number of times the timer has fired.
             * 
             * @return {int} fire count
             */
            fire_count: function() {
                return this.__fire_count;
            },

            /**
             * Returns the current duration of timer.
             * 
             * @return {int} duration in milliseconds
             */
            duration: function() {
                return Time.now() - this.__start_time;
            },

            /**
             * Fired when the timer fires.
             */
            fire: function() {
                if (this.__once)
                    this.__started = false;
                if (this.__fire) {
                    this.__fire.call(this.__context, this);
                    this.__fire_count++;
                    if (this.__real_time && !this.__destroy_on_fire && !this.__once) {
                        while ((this.__fire_count + 1) * this.__delay <= Time.now() - this.__start_time) {
                            this.__fire.call(this.__context, this);
                            this.__fire_count++;
                        }
                    }
                }
                if ((this.__end_time !== null && Time.now() + this.__delay > this.__end_time) ||
                    (this.__fire_max !== null && this.__fire_max <= this.__fire_count))
                    this.stop();
                if (this.__destroy_on_fire)
                    this.weakDestroy();
            },

            /**
             * Stops the timer.
             * 
             * @return {object}
             */
            stop: function() {
                if (!this.__started)
                    return this;
                if (this.__once)
                    clearTimeout(this.__timer);
                else
                    clearInterval(this.__timer);
                this.__started = false;
                if (this.__destroy_on_stop)
                    this.weakDestroy();
                return this;
            },

            /**
             * Starts the timer.
             * 
             * @return {object} this
             */
            start: function() {
                if (this.__started)
                    return this;
                var self = this;
                this.__start_time = Time.now();
                this.__fire_count = 0;
                if (this.__once)
                    this.__timer = setTimeout(function() {
                        self.fire();
                    }, this.__delay);
                else
                    this.__timer = setInterval(function() {
                        self.fire();
                    }, this.__delay);
                this.__started = true;
                if (this.__immediate)
                    this.fire();
                return this;
            },

            /**
             * Restarts the timer.
             * 
             * @return {object} this
             */
            restart: function() {
                this.stop();
                this.start();
                return this;
            }

        };
    });
});

Scoped.define("module:Async", ["module:Types","module:Functions"], function (Types, Functions) {

    var clearTimeoutGlobal = function(h) {
        return clearTimeout(h);
    };

    var clearImmediate =
        Functions.global_method("clearImmediate") ||
        Functions.global_method("cancelAnimationFrame") ||
        Functions.global_method("webkitCancelAnimationFrame") ||
        Functions.global_method("mozCancelAnimationFrame") ||
        clearTimeoutGlobal;

    var setImmediate =
        Functions.global_method("setImmediate") ||
        Functions.global_method("requestAnimationFrame") ||
        Functions.global_method("webkitRequestAnimationFrame") ||
        Functions.global_method("mozRequestAnimationFrame") ||
        function(cb) {
            return setTimeout(cb, 0);
        };


    var __eventuallyOnce = {};
    var __eventuallyOnceIdx = 1;


    /**
     * Auxilary functions for asynchronous operations.
     * 
     * @module BetaJS.Async
     */
    return {


        /**
         * Wait asynchronously for a condition to be met.
         * 
         * @param {function} condition condition function
         * @param {object} conditionCtx condition context (optional)
         * @param {function} callback callback function
         * @param {object} callbackCtx callback context (optional)
         * @param {int} interval interval time between checks (optional, default 1)
         * 
         */
        waitFor: function() {
            var args = Functions.matchArgs(arguments, {
                condition: true,
                conditionCtx: "object",
                callback: true,
                callbackCtx: "object",
                interval: "int"
            });
            var h = function() {
                try {
                    return !!args.condition.apply(args.conditionCtx || args.callbackCtx || this);
                } catch (e) {
                    return false;
                }
            };
            if (h())
                args.callback.apply(args.callbackCtx || this);
            else {
                var timer = setInterval(function() {
                    if (h()) {
                        clearInterval(timer);
                        args.callback.apply(args.callbackCtx || this);
                    }
                }, args.interval || 1);
                return timer;
            }
        },


        /**
         * Execute a function asynchronously eventually.
         * 
         * @param {function} function function to be executed asynchronously
         * @param {array} params optional list of parameters to be passed to the function
         * @param {object} context optional context for the function execution
         * @param {int} time time to wait until execution (default is 0)
         * 
         * @return handle to the eventual call
         */
        eventually: function() {
            var args = Functions.matchArgs(arguments, {
                func: true,
                params: "array",
                context: "object",
                time: "number"
            });
            args.time = args.time || 0;
            var result = {};
            var cb = function() {
                result.clear(result.handle);
                args.func.apply(args.context || this, args.params || []);
            };
            if (args.time > 0) {
                result.clear = clearTimeoutGlobal;
                result.handle = setTimeout(cb, args.time);
            } else {
                result.clear = clearImmediate;
                result.handle = setImmediate(cb);
            }
            return result;
        },


        /**
         * Clears a call scheduled for eventual execution.
         * 
         * @param ev event handle
         * 
         */
        clearEventually: function(ev) {
            if (ev && ev.clear && ev.handle)
                ev.clear(ev.handle);
        },


        /**
         * Executes a function asynchronously eventually, but only once.
         * 
         * @param {function} function function to be executed asynchronously
         * @param {array} params list of parameters to be passed to the function
         * @param {object} context optional context for the function execution
         * 
         */
        eventuallyOnce: function(func, params, context) {
            var data = {
                func: func,
                params: params,
                context: context
            };
            for (var key in __eventuallyOnce) {
                var record = __eventuallyOnce[key];
                if (record.func == func && record.params == params && record.context == context)
                    return;
            }
            __eventuallyOnceIdx++;
            var index = __eventuallyOnceIdx;
            __eventuallyOnce[index] = data;
            return this.eventually(function() {
                delete __eventuallyOnce[index];
                func.apply(context || this, params || []);
            }, this);
        }

    };

});

Scoped.define("module:Promise", ["module:Types","module:Functions","module:Async","module:Objs"], function (Types, Functions, Async, Objs) {

    /**
     * Promise Class
     * 
     * @class BetaJS.Promise
     */
    var Promise = {

        /**
         * Creates a new promise instance.
         * 
         * @param value optional promise value
         * @param error optional promise error
         * @param {boolean} finished does this promise have its final value / error
         */
        Promise: function(value, error, finished) {
            this.__value = error ? null : (value || null);
            this.__error = error ? error : null;
            this.__isFinished = finished;
            this.__hasError = !!error;
            this.__resultPromise = null;
            this.__callbacks = [];
        },

        /**
         * Create a new promise instance. (Simplified)
         * 
         * @param value optional promise value
         * @param error optional promise error
         * 
         * @return {object} promise instance
         */
        create: function(value, error) {
            return new this.Promise(value, error, arguments.length > 0);
        },

        /**
         * Returns a promise instance for a value. The value might be a promise itself already.
         * 
         * @param value promise value or promise
         * @return {object} promise instance
         */
        value: function(value) {
            return this.is(value) ? value : new this.Promise(value, null, true);
        },

        /**
         * Returns a promise instance for a value, setting the value asynchronously.
         * 
         * @param value promise value
         * @return {object} promise instance
         */
        eventualValue: function(value) {
            var promise = new this.Promise();
            Async.eventually(function() {
                promise.asyncSuccess(value);
            });
            return promise;
        },

        /**
         * Returns a promise instance for an error. The error might be a promise itself already.
         * 
         * @param error promise error or promise
         * @return {object} promise instance
         */
        error: function(error) {
            return this.is(error) ? error : new this.Promise(null, error, true);
        },

        /**
         * Turns a function call into a promise, mapping exceptions to errors.
         * 
         * @param {function} f function
         * @param {object} ctx optional function context
         * @param {array} params optional function parameters
         * 
         * @return {object} promise
         */
        box: function(f, ctx, params) {
            try {
                var result = f.apply(ctx || this, params || []);
                return this.is(result) ? result : this.value(result);
            } catch (e) {
                return this.error(e);
            }
        },

        /**
         * Try-Catch a function, wrapping it into a promise.
         * 
         * @param {function} f function
         * @param {object} ctx optional function context
         * 
         * @return {object} promise
         */
        tryCatch: function(f, ctx) {
            try {
                return this.value(f.apply(ctx || this));
            } catch (e) {
                return this.error(e);
            }
        },

        /**
         * Turns a function accepting a callback function as last parameter into a promise.
         * 
         * @param {object} optional function context
         * @param {function} func function
         * 
         * @return {object} promise
         */
        funcCallback: function(ctx, func) {
            var args = [];
            if (Types.is_function(ctx)) {
                args = Functions.getArguments(arguments, 1);
                func = ctx;
                ctx = this;
            } else
                args = Functions.getArguments(arguments, 2);
            var promise = this.create();
            args.push(promise.asyncCallbackFunc());
            func.apply(ctx, args);
            return promise;
        },

        /**
         * Takes a number of promises and creates a single new promise being successful if and only if all input promises are successful.
         * 
         * @param {array} promises promises array
         * 
         * @return {object} promise
         */
        and: function(promises) {
            var promise = this.create();
            promise.__promises = [];
            promise.__successCount = 0;
            promise.__values = [];
            promise.__errorPromise = null;
            promise.and = function(promises) {
                promises = promises || [];
                if (this.__ended)
                    return this;
                if (!Types.is_array(promises))
                    promises = [promises];
                var f = function(error, value) {
                    if (error)
                        this.promise.__errorPromise = this.promise.__promises[this.idx];
                    else {
                        this.promise.__successCount++;
                        this.promise.__values[this.idx] = value;
                    }
                    this.promise.results();
                };
                for (var i = 0; i < promises.length; ++i) {
                    var last = this.__promises.length;
                    this.__promises.push(promises[i]);
                    this.__values.push(null);
                    if (promises[i].isFinished()) {
                        if (promises[i].hasValue()) {
                            this.__successCount++;
                            this.__values[last] = promises[i].value();
                        } else
                            this.__errorPromise = promises[i];
                    } else {
                        promises[i].callback(f, {
                            promise: this,
                            idx: last
                        });
                    }
                }
                return this;
            };
            promise.end = function() {
                if (this.__ended)
                    return this;
                this.__ended = true;
                this.results();
                return this;
            };
            promise.results = function() {
                if (this.__ended && this.__errorPromise)
                    this.asyncError(this.__errorPromise.err(), this.__errorPromise);
                else if (this.__ended && this.__successCount == this.__promises.length)
                    this.asyncSuccess(this.__values);
                return this;
            };
            promise.successUnfold = function(f, context, options) {
                return this.success(function() {
                    return f.apply(context, arguments);
                }, context, options);
            };
            promise.and(promises);
            return promise;
        },

        /**
         * Takes a function and calls with a number of arguments, some of which might be promises and turns it into actual values.
         * 
         * @param {function} func function
         * 
         * @return {object} promise
         */
        func: function(func) {
            var args = Functions.getArguments(arguments, 1);
            var promises = [];
            for (var i = 0; i < args.length; ++i) {
                if (this.is(args[i]))
                    promises.push(args[i]);
            }
            var promise = this.create();
            this.and(promises).end().success(function(values) {
                var params = [];
                for (var i = 0; i < args.length; ++i)
                    params[i] = this.is(args[i]) ? args[i].value() : args[i];
                var result = func.apply(this, params);
                if (this.is(result))
                    result.forwardCallback(promise);
                else
                    promise.asyncSuccess(result);
            }, this).forwardError(promise);
            return promise;
        },

        /**
         * Takes a method and calls with a number of arguments, some of which might be promises and turns it into actual values.
         * 
         * @param {object} ctx function context
         * @param {function} func function
         * @param {array} params parameters
         * 
         * @return {object} promise
         */
        methodArgs: function(ctx, func, params) {
            params.unshift(function() {
                return func.apply(ctx, arguments);
            });
            return this.func.apply(this, params);
        },

        /**
         * Takes a method and calls with a number of arguments, some of which might be promises and turns it into actual values.
         * 
         * @param {object} ctx function context
         * @param {function} func function
         * 
         * @return {object} promise
         */
        method: function(ctx, func) {
            return this.methodArgs(ctx, func, Functions.getArguments(arguments, 2));
        },

        /**
         * Takes a constructor and calls with a number of arguments, some of which might be promises and turns it into actual values.
         * 
         * @param {object} cls constructor class
         * 
         * @return {object} promise
         */
        newClass: function(cls) {
            var params = Functions.getArguments(arguments, 1);
            params.unshift(Functions.newClassFunc(cls));
            return this.func.apply(this, params);
        },

        /**
         * Determines whether some value is a promise object.
         * 
         * @param obj value
         * 
         * @return {boolean} true if obj is a promise object
         */
        is: function(obj) {
            return obj && Types.is_object(obj) && obj.classGuid == this.Promise.prototype.classGuid;
        },

        /**
         * Applies a method multiple times until it succeeds.
         * 
         * @param {function} method method
         * @param {object} context method context
         * @param {int} resilience number of times to call
         * @param {array} args arguments for method
         * @param {int} delay optional delay in-between tries
         * 
         * @return {object} promise
         */
        resilience: function(method, context, resilience, args, delay) {
            if (delay)
                method = this.delayPromiseMethod(method, delay);
            return method.apply(context, args).mapError(function(error) {
                return resilience === 0 ? error : this.resilience(method, context, resilience - 1, args);
            }, this);
        },

        /**
         * Creates a new method returning a promise based on a method returning a promise by delaying the underlaying method.
         *
         * @param {function} method original method
         * @param {int} delay delay time
         * @returns {function} delayed method
         */
        delayPromiseMethod: function(method, delay) {
            var self = this;
            return function() {
                var promise = self.create();
                var args = Functions.getArguments(arguments);
                Async.eventually(function() {
                    method.apply(this, args).forwardCallback(promise);
                }, this, delay);
                return promise;
            };
        },

        /**
         * Wait asynchronously for a condition to be met.
         *
         * @param {function} condition condition function
         * @param {object} conditionCtx condition context (optional)
         * @param {int} interval interval time between checks (optional, default 1)
         * @param {int} timeout optional timeout
         *
         * @return {object} promise
         *
         */
        waitFor: function(condition, conditionCtx, interval, timeout) {
            var promise = this.create();
            var successTimer, errorTimer;
            if (timeout) {
                errorTimer = setTimeout(function() {
                    if (successTimer)
                        clearInterval(successTimer);
                    promise.asyncError(true);
                }, timeout);
            }
            successTimer = Async.waitFor(condition, conditionCtx, function() {
                if (errorTimer)
                    clearTimeout(errorTimer);
                promise.asyncSuccess(true);
            }, interval);
            return promise;
        }

    };

    Objs.extend(Promise.Promise.prototype, {
        classGuid: "7e3ed52f-22da-4e9c-95a4-e9bb877a3935",

        /**
         * Be notified when the promise is successful.
         * 
         * @param {function} f callback function
         * @param {object} context optional callback context
         * @param {object} options optional options
         */
        success: function(f, context, options) {
            return this.callback(f, context, options, "success");
        },

        /**
         * Be notified when the promise is unsuccessful.
         * 
         * @param {function} f callback function
         * @param {object} context optional callback context
         * @param {object} options optional options
         */
        error: function(f, context, options) {
            return this.callback(f, context, options, "error");
        },

        /**
         * Be notified when the promise is finished..
         * 
         * @param {function} f callback function
         * @param {object} context callback context
         * @param {object} options options
         * @param {string} type type of callback like "success"
         */
        callback: function(f, context, options, type) {
            if ("end" in this)
                this.end();
            var record = {
                type: type || "callback",
                func: f,
                options: options || {},
                context: context
            };
            if (this.__isFinished)
                this.triggerResult(record);
            else
                this.__callbacks.push(record);
            return this;
        },

        /**
         * Trigger the result.
         * 
         * @param {object} record optional specific callback record
         * 
         */
        triggerResult: function(record) {
            if (!this.__isFinished)
                return this;
            if (record) {
                if (record.type == "success" && !this.__hasError)
                    record.func.call(record.context || this, this.__value, this.__resultPromise || this);
                else if (record.type == "error" && this.__hasError)
                    record.func.call(record.context || this, this.__error, this.__resultPromise || this);
                else if (record.type == "callback")
                    record.func.call(record.context || this, this.__error, this.__value, this.__resultPromise || this);
            } else {
                var records = this.__callbacks;
                this.__callbacks = [];
                for (var i = 0; i < records.length; ++i)
                    this.triggerResult(records[i]);
            }
            return this;
        },

        /**
         * Returns the value of the promise.
         * 
         * @return value of promise
         */
        value: function() {
            return this.__value;
        },

        /**
         * Returns the error of the promise.
         * 
         * @return error of promise
         */
        err: function() {
            return this.__error;
        },

        /**
         * Determines whether the promise has a value or an error already.
         * 
         * @return {boolean} true if value or error present
         */
        isFinished: function() {
            return this.__isFinished;
        },

        /**
         * Determines whether the promise has a value.
         * 
         * @return {boolean} true if value present
         */
        hasValue: function() {
            return this.__isFinished && !this.__hasError;
        },

        /**
         * Determines whether the promise has an error.
         * 
         * @return {boolean} true if error present
         */
        hasError: function() {
            return this.__isFinished && this.__hasError;
        },

        /**
         * Informs the promise of a successful value.
         * 
         * @param value success value
         * @param {object} promise optional success promise
         */
        asyncSuccess: function(value, promise) {
            if (this.__isFinished)
                return this;
            this.__resultPromise = promise;
            this.__error = null;
            this.__isFinished = true;
            this.__hasError = false;
            this.__value = value;
            return this.triggerResult();
        },

        /**
         * Informs the promise of an error value.
         * 
         * @param error error value
         * @param {object} promise optional error promise
         */
        asyncError: function(error, promise) {
            if (this.__isFinished)
                return this;
            this.__resultPromise = promise;
            this.__isFinished = true;
            this.__hasError = true;
            this.__error = error;
            this.__value = null;
            return this.triggerResult();
        },

        /**
         * Informs the promise of an error or success value.
         * 
         * @param error optional error value
         * @param value optional success value
         * @param {object} promise optional callback promise
         */
        asyncCallback: function(error, value, promise) {
            if (error)
                return this.asyncError(error, promise);
            else
                return this.asyncSuccess(value, promise);
        },

        /**
         * Forwards the success of this promise to another promise.
         * 
         * @param {object} promise promise to which the success should be forwarded to
         */
        forwardSuccess: function(promise) {
            this.success(promise.asyncSuccess, promise);
            return this;
        },

        /**
         * Forwards the error of this promise to another promise.
         * 
         * @param {object} promise promise to which the error should be forwarded to
         */
        forwardError: function(promise) {
            this.error(promise.asyncError, promise);
            return this;
        },

        /**
         * Forwards the callback of this promise to another promise.
         * 
         * @param {object} promise promise to which the callback should be forwarded to
         */
        forwardCallback: function(promise) {
            this.callback(promise.asyncCallback, promise);
            return this;
        },

        /**
         * Generates a context-less function for the asynchronous callback.
         * 
         * @return {function} context-less function
         */
        asyncCallbackFunc: function() {
            return Functions.as_method(this.asyncCallback, this);
        },

        /**
         * Generates a context-less function for the asynchronous success.
         *
         * @return {function} context-less function
         */
        asyncSuccessFunc: function() {
            return Functions.as_method(this.asyncSuccess, this);
        },

        /**
         * Generates a context-less function for the asynchronous error.
         *
         * @return {function} context-less function
         */
        asyncErrorFunc: function() {
            return Functions.as_method(this.asyncError, this);
        },

        /**
         * Maps the success value of the promise to a function that might return another promise.
         * 
         * @param {function} func success callback
         * @param {object} ctx optional context
         * 
         * @return {object} promise
         */
        mapSuccess: function(func, ctx) {
            var promise = Promise.create();
            this.forwardError(promise).success(function(value, pr) {
                try {
                    var result = func.call(ctx || promise, value, pr);
                    if (Promise.is(result))
                        result.forwardCallback(promise);
                    else
                        promise.asyncSuccess(result);
                } catch (e) {
                    promise.asyncError(e);
                }
            });
            return promise;
        },

        /**
         * Maps the error value of the promise to a function that might return another promise.
         * 
         * @param {function} func error callback
         * @param {object} ctx optional context
         * 
         * @return {object} promise
         */
        mapError: function(func, ctx) {
            var promise = Promise.create();
            this.forwardSuccess(promise).error(function(err, pr) {
                var result = func.call(ctx || promise, err, pr);
                if (Promise.is(result))
                    result.forwardCallback(promise);
                else
                    promise.asyncError(result);
            });
            return promise;
        },

        /**
         * Maps the error or success value of the promise to a function that might return another promise.
         * 
         * @param {function} func callback function
         * @param {object} ctx optional context
         * 
         * @return {object} promise
         */
        mapCallback: function(func, ctx) {
            var promise = Promise.create();
            this.callback(function(err, value, pr) {
                var result = func.call(ctx || promise, err, value, pr);
                if (Promise.is(result))
                    result.forwardCallback(promise);
                else
                    promise.asyncCallback(err ? result : err, err ? value : result, pr);
            });
            return promise;
        },

        /**
         * Concatenates more promises to this promise
         * 
         * @param {array} promises other promises
         * 
         * @return {object} promise
         */
        and: function(promises) {
            var result = Promise.and(this);
            return result.and(promises);
        }
    });

    return Promise;
});

Scoped.define("module:Iterators.Iterator", ["module:Class","module:Functions","module:Async","module:Promise"], function (Class, Functions, Async, Promise, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Abstract Iterator Class
         * 
         * @class BetaJS.Iterators.Iterator
         */
        return {

            /**
             * Determines whether there are more elements in the iterator.
             * Should be overwritten by subclass.
             *
             * @return {boolean} true if more elements present
             */
            hasNext: function() {
                return false;
            },

            /**
             * Returns the next element in the iterator.
             * Should be overwritten by subclass.
             * 
             * @return next element in iterator
             */
            next: function() {
                return null;
            },

            /**
             * Returns the next element if present or null otherwise.
             * 
             * @return next element in iterator or null
             */
            nextOrNull: function() {
                return this.hasNext() ? this.next() : null;
            },

            /**
             * Materializes the iterator as an array.
             *
             * @param {boolean} keep do not destroy iterator
             * @return {array} array of elements in iterator
             */
            asArray: function(keep) {
                var arr = [];
                while (this.hasNext())
                    arr.push(this.next());
                if (!keep)
                    this.weakDestroy();
                return arr;
            },

            /**
             * Iterate over the iterator, calling a callback function for every element.
             * 
             * @param {function} cb callback function
             * @param {object} ctx optional callback context
             * @param {boolean} keep do not destroy iterator
             */
            iterate: function(cb, ctx, keep) {
                while (this.hasNext()) {
                    var result = cb.call(ctx || this, this.next());
                    if (result === false)
                        break;
                }
                if (!keep)
                    this.weakDestroy();
            },

            /**
             * Asynchronously iterate over the iterator, calling a callback function for every element.
             * 
             * @param {function} cb callback function
             * @param {object} ctx optional callback context
             * @param {int} time optional time between calls
             * 
             * @return {object} finish promise
             */
            asyncIterate: function(cb, ctx, time) {
                if (!this.hasNext()) {
                    this.destroy();
                    return Promise.value(true);
                }
                var result = cb.call(ctx || this, this.next());
                if (result === false)
                    return Promise.value(true);
                var promise = Promise.create();
                Async.eventually(function() {
                    this.asyncIterate(cb, ctx, time).forwardCallback(promise);
                }, this, time);
                return promise;
            }

        };
    });
});

Scoped.define("module:Iterators.ArrayIterator", ["module:Iterators.Iterator"], function (Iterator, scoped) {
    return Iterator.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * ArrayIterator Class
         * 
         * @class BetaJS.Iterators.ArrayIterator
         */
        return {

            /**
             * Creates an Array Iterator
             * 
             * @param {array} arr array
             */
            constructor: function(arr) {
                inherited.constructor.call(this);
                this.__array = arr;
                this.__i = 0;
            },

            /**
             * @override
             */
            hasNext: function() {
                return this.__i < this.__array.length;
            },

            /**
             * @override
             */
            next: function() {
                var ret = this.__array[this.__i];
                this.__i++;
                return ret;
            }

        };
    }, {

        /**
         * Creates an Array Iterator by an iteration function
         * 
         * @param {function} iterate_func Iteration function
         * @param {object} iterate_func_ctx Optional context
         * 
         * @return {object} Array Iterator instance
         */
        byIterate: function(iterate_func, iterate_func_ctx) {
            var result = [];
            iterate_func.call(iterate_func_ctx || this, function(item) {
                result.push(item);
            }, this);
            return new this(result);
        }
    });
});

Scoped.define("module:Lists.AbstractList", ["module:Class","module:Objs","module:Types","module:Iterators.ArrayIterator"], function (Class, Objs, Types, ArrayIterator, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Abstract List Class
         * 
         * @class BetaJS.Lists.AbstractList
         */
        return {

            /**
             * Add an object to the list.
             * 
             * @param {object} object Object to be added
             * @return {string} ident of object
             */
            _add: function(object) {},

            /**
             * Remove an object from the list.
             * 
             * @param {string} ident Ident of object to be removed.
             * @return {object} removed object
             */
            _remove: function(ident) {},

            /**
             * Get an object by ident.
             * 
             * @param {string} ident Ident of object
             * @return {object} object matching the ident
             */
            _get: function(ident) {},

            /**
             * Iterate over all objects in the list.
             * 
             * @param {function} callback callback function for iteration
             * @param {object} context optional context for callback function
             */
            _iterate: function(callback, context) {},

            /**
             * Given an object, return the ident of the object.
             * 
             * @param {object} object object in question
             * @return {string} ident of object
             */
            get_ident: function(object) {
                var ident = null;
                this._iterate(function(obj, id) {
                    if (obj == object) {
                        ident = id;
                        return false;
                    }
                    return true;
                });
                return ident;
            },

            /**
             * Determines whether an object exists in the list.
             * 
             * @param {object} object object in question
             * @return {boolean} true if object is contained in list
             */
            exists: function(object) {
                return object && this.get_ident(object) !== null;
            },

            /**
             * Notification when an object obtains a new ident.
             * 
             * @param {object} object object in question
             * @param {string} new_ident new identifier of object
             */
            _ident_changed: function(object, new_ident) {},

            /**
             * Creates a new instance.
             * 
             * @param {array} objects optional array of initial objects to be added to the list
             */
            constructor: function(objects) {
                inherited.constructor.call(this);
                this.__count = 0;
                if (objects) {
                    Objs.iter(objects, function(object) {
                        this.add(object);
                    }, this);
                }
            },

            /**
             * Add an object to the list.
             * 
             * @param {object} object Object to be added
             * @return {string} ident of object
             */
            add: function(object) {
                var ident = this._add(object);
                if (Types.is_defined(ident))
                    this.__count++;
                return ident;
            },

            /**
             * Returns the number of objects contained in the list.
             * 
             * @return {int} number of objects
             */
            count: function() {
                return this.__count;
            },

            /**
             * Removes all objects from the list.
             * 
             */
            clear: function() {
                this._iterate(function(object, ident) {
                    this.remove_by_ident(ident);
                    return true;
                }, this);
            },

            /**
             * Remove an object from the list by identifier.
             * 
             * @param {string} ident Ident of object to be removed.
             * @return {object} removed object
             */
            remove_by_ident: function(ident) {
                var ret = this._remove(ident);
                if (Types.is_defined(ret))
                    this.__count--;
                return ret;
            },

            /**
             * Remove an object from the list.
             * 
             * @param {object} object object in question
             * @return {object} removed object
             */
            remove: function(object) {
                return this.remove_by_ident(this.get_ident(object));
            },

            /**
             * Remove objects from the list that match a filter function.
             * 
             * @param {function} filter filter function for object
             */
            remove_by_filter: function(filter) {
                this._iterate(function(object, ident) {
                    if (filter(object))
                        this.remove_by_ident(ident);
                    return true;
                }, this);
            },

            /**
             * Get an object by ident.
             * 
             * @param {string} ident Ident of object
             * @return {object} object matching the ident
             */
            get: function(ident) {
                return this._get(ident);
            },

            /**
             * Iterate over all objects in the list.
             * 
             * @param {function} callback callback function for iteration
             * @param {object} context optional context for callback function
             */
            iterate: function(cb, context) {
                this._iterate(function(object, ident) {
                    var ret = cb.call(this, object, ident);
                    return Types.is_defined(ret) ? ret : true;
                }, context);
            },

            /**
             * Creates an iterator for the list.
             * 
             * @return {object} iterator for list
             */
            iterator: function() {
                return ArrayIterator.byIterate(this.iterate, this);
            }

        };
    });
});

Scoped.define("module:Lists.LinkedList", ["module:Lists.AbstractList"], function (AbstractList, scoped) {
    return AbstractList.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Linked List Implementation of List
         * 
         * @class BetaJS.Lists.LinkedList
         */
        return {

            __first: null,
            __last: null,

            /**
             * @override
             */
            _add: function(obj) {
                this.__last = {
                    obj: obj,
                    prev: this.__last,
                    next: null
                };
                if (this.__first)
                    this.__last.prev.next = this.__last;
                else
                    this.__first = this.__last;
                return this.__last;
            },

            /**
             * @override
             */
            _remove: function(container) {
                if (container.next)
                    container.next.prev = container.prev;
                else
                    this.__last = container.prev;
                if (container.prev)
                    container.prev.next = container.next;
                else
                    this.__first = container.next;
                return container.obj;
            },

            /**
             * @override
             */
            _get: function(container) {
                return container.obj;
            },

            /**
             * @override
             */
            _iterate: function(cb, context) {
                var current = this.__first;
                while (current) {
                    var prev = current;
                    current = current.next;
                    if (!cb.apply(context || this, [prev.obj, prev]))
                        return;
                }
            }

        };
    });
});

Scoped.define("module:Events.EventsMixin", ["module:Timers.Timer","module:Async","module:Lists.LinkedList","module:Functions","module:Types","module:Objs"], function (Timer, Async, LinkedList, Functions, Types, Objs) {

    /**
     * Events Mixin
     * 
     * @mixin BetaJS.Events.EventsMixin
     */
    return {

        _implements: "3d63b44f-c9f0-4aa7-b39e-7cbf195122b4",

        _notifications: {
            "construct": function() {
                this.__suspendedEvents = 0;
                this.__suspendedEventsQueue = [];
            },
            "destroy": function() {
                this.off(null, null, null);
            }
        },

        EVENT_SPLITTER: /\s+/,

        __create_event_object: function(callback, context, options) {
            options = options || {};
            var obj = {
                callback: callback,
                context: context
            };
            if (options.eventually)
                obj.eventually = options.eventually;
            if (options.off_on_destroyed)
                obj.off_on_destroyed = options.off_on_destroyed;
            if (options.min_delay)
                obj.min_delay = new Timer({
                    delay: options.min_delay,
                    once: true,
                    start: false,
                    context: this,
                    fire: function() {
                        if (obj.max_delay)
                            obj.max_delay.stop();
                        this.__invokeCallback(obj);
                    }
                });
            if (options.max_delay)
                obj.max_delay = new Timer({
                    delay: options.max_delay,
                    once: true,
                    start: false,
                    context: this,
                    fire: function() {
                        if (obj.min_delay)
                            obj.min_delay.stop();
                        this.__invokeCallback(obj);
                    }
                });
            return obj;
        },

        __destroy_event_object: function(object) {
            if (object.min_delay)
                object.min_delay.destroy();
            if (object.max_delay)
                object.max_delay.destroy();
        },

        __invokeCallback: function(obj, params) {
            if (obj.off_on_destroyed && obj.context && obj.context.destroyed())
                this.off(null, null, obj);
            else
                this._invokeCallback(obj.callback, obj.context || this, params || obj.params);
        },

        /**
         * @protected
         *
         * Invoke event callback
         *
         * @param {function} callback event callback function
         * @param {object} context callback context
         * @param {array} params parameters
         */
        _invokeCallback: function(callback, context, params) {
            callback.apply(context, params);
        },

        __call_event_object: function(object, params) {
            if (object.min_delay)
                object.min_delay.restart();
            if (object.max_delay)
                object.max_delay.start();
            if (!object.min_delay && !object.max_delay) {
                if (object.eventually) {
                    Async.eventually(function() {
                        this.__invokeCallback(object, params);
                    }, this, object.eventually === true ? 0 : object.eventually);
                } else
                    this.__invokeCallback(object, params);
            } else
                object.params = params;
        },

        /**
         * Listen to an event(s).
         * 
         * @param {string} events event(s) to listen to
         * @param {function} callback event callback function
         * @param {object} context optional callback context
         * @param {object} options optional options
         */
        on: function(events, callback, context, options) {
            this.__events_mixin_events = this.__events_mixin_events || {};
            events = events.split(this.EVENT_SPLITTER);
            var event;
            while (true) {
                event = events.shift();
                if (!event)
                    break;
                if (!this.__events_mixin_events[event])
                    this._notify("register_event", event);
                this.__events_mixin_events[event] = this.__events_mixin_events[event] || new LinkedList();
                var event_object = this.__create_event_object(callback, context, options);
                this.__events_mixin_events[event].add(event_object);
                if (this.__events_mixin_persistent_events && this.__events_mixin_persistent_events[event]) {
                    var argss = this.__events_mixin_persistent_events[event];
                    for (var i = 0; i < argss.length; ++i)
                        this.__call_event_object(event_object, argss[i]);
                }
                if (options && options.initcall)
                    this.__call_event_object(event_object, []);
            }
            return this;
        },

        /**
         * Stop listening to an event(s).
         * 
         * @param {string} events event(s) to listen to
         * @param {function} callback event callback function
         * @param {object} context optional callback context
         */
        off: function(events, callback, context) {
            this.__events_mixin_events = this.__events_mixin_events || {};
            if (events) {
                events = events.split(this.EVENT_SPLITTER);
                Objs.iter(events, function(event) {
                    if (this.__events_mixin_events[event]) {
                        this.__events_mixin_events[event].remove_by_filter(function(object) {
                            var result = (!callback || object.callback == callback) && (!context || object.context == context);
                            if (result && this.__destroy_event_object)
                                this.__destroy_event_object(object);
                            return result;
                        });
                        if (this.__events_mixin_events[event].count() === 0) {
                            this.__events_mixin_events[event].destroy();
                            delete this.__events_mixin_events[event];
                            this._notify("unregister_event", event);
                        }
                    }
                }, this);
            } else {
                Objs.iter(this.__events_mixin_events, function(evntobj, evnt) {
                    evntobj.remove_by_filter(function(object) {
                        var result = (!callback || object.callback == callback) && (!context || object.context == context);
                        if (result && this.__destroy_event_object)
                            this.__destroy_event_object(object);
                        return result;
                    });
                    if (evntobj.count() === 0) {
                        evntobj.destroy();
                        delete this.__events_mixin_events[evnt];
                        this._notify("unregister_event", evnt);
                    }
                }, this);
            }
            return this;
        },

        /**
         * Listen to an event(s) once.
         * 
         * @param {string} events event(s) to listen to
         * @param {function} callback event callback function
         * @param {object} context optional callback context
         * @param {object} options optional options
         */
        once: function(events, callback, context, options) {
            var self = this;
            var once = Functions.once(function() {
                self.off(events, once);
                callback.apply(this, arguments);
            });
            once._callback = callback;
            return this.on(events, once, context, options);
        },

        /**
         * Trigger an event(s) asynchronously.
         * 
         * @param {string} events events to be triggered
         */
        trigger: function(events) {
            if (this.__suspendedEvents > 0) {
                this.__suspendedEventsQueue.push(arguments);
                return this;
            }
            var self = this;
            events = events.split(this.EVENT_SPLITTER);
            var rest = Functions.getArguments(arguments, 1);
            var event;
            if (!this.__events_mixin_events)
                return this;
            Objs.iter(events, function(event) {
                if (this.__events_mixin_events[event])
                    this.__events_mixin_events[event].iterate(function(object) {
                        self.__call_event_object(object, rest);
                    });
                if (this.__events_mixin_events && "all" in this.__events_mixin_events)
                    this.__events_mixin_events.all.iterate(function(object) {
                        self.__call_event_object(object, [event].concat(rest));
                    });
            }, this);
            return this;
        },

        /**
         * Trigger an event(s) asynchronously.
         * 
         * @param {string} events events to be triggered
         */
        triggerAsync: function() {
            var self = this;
            var args = Functions.getArguments(arguments);
            var timeout = setTimeout(function() {
                clearTimeout(timeout);
                self.trigger.apply(self, args);
            }, 0);
            return this;
        },

        /**
         * Persistenly trigger an event(s).
         * 
         * @param {string} events events to be triggered
         */
        persistentTrigger: function(events) {
            var rest = Functions.getArguments(arguments, 1);
            this.__events_mixin_persistent_events = this.__events_mixin_persistent_events || [];
            Objs.iter(events.split(this.EVENT_SPLITTER), function(event) {
                this.__events_mixin_persistent_events[event] = this.__events_mixin_persistent_events[event] || [];
                this.__events_mixin_persistent_events[event].push(rest);
            }, this);
            this.trigger.apply(this, arguments);
            return this;
        },

        /**
         * Delegate certain events to this event object.
         * 
         * @param {string} events events to be delegated
         * @param {object} source source event object
         * @param {string} prefix optional event prefix for delegation
         * @param {array} params optional additional event params
         */
        delegateEvents: function(events, source, prefix, params) {
            params = params || [];
            prefix = prefix ? prefix + ":" : "";
            if (events === null) {
                source.on("all", function(event) {
                    var rest = Functions.getArguments(arguments, 1);
                    this.trigger.apply(this, [prefix + event].concat(params).concat(rest));
                }, this);
            } else {
                if (!Types.is_array(events))
                    events = [events];
                Objs.iter(events, function(event) {
                    source.on(event, function() {
                        var rest = Functions.getArguments(arguments);
                        this.trigger.apply(this, [prefix + event].concat(params).concat(rest));
                    }, this);
                }, this);
            }
            return this;
        },

        /**
         * Returns the parent event object in the chain.
         * 
         * @return {object} parent event object
         * 
         * @protected
         * @abstract
         */
        _eventChain: function() {},

        /**
         * Trigger an event locally and up the chain.
         * 
         * @param {string} eventName name of event
         * @param data event data
         */
        chainedTrigger: function(eventName, data) {
            data = Objs.extend({
                source: this,
                bubbles: true
            }, data);
            this.trigger(eventName, data);
            if (data.bubbles) {
                var chain = this._eventChain();
                if (chain && chain.chainedTrigger)
                    chain.chainedTrigger(eventName, data);
            }
            return this;
        },

        /**
         * Suspend all events until resumed.
         */
        suspendEvents: function() {
            this.__suspendedEvents++;
            return this;
        },

        /**
         * Resume all events.
         */
        resumeEvents: function() {
            this.__suspendedEvents--;
            if (this.__suspendedEvents !== 0)
                return this;
            Objs.iter(this.__suspendedEventsQueue, function(ev) {
                this.trigger.apply(this, ev);
            }, this);
            this.__suspendedEventsQueue = [];
            return this;
        }

    };
});

Scoped.define("module:Strings", ["module:Objs"], function (Objs) {
    /**
     * String Utilities
     *
     * @module BetaJS.Strings
     */
    return {

        /**
         * Escapes a string to be used as an exact match in a regular expression.
         *
         * @param {string} s string in question
         *
         * @return {string} escaped string
         *
         * @link http://stackoverflow.com/a/3561711
         */
        regexEscape: function(s) {
            return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
        },

        /**
         * Pads a string from the left with characters if necessary.
         *
         * @param {string} s string that should be padded
         * @param {string} padding padding string that should be used (e.g. whitespace)
         * @param {int} length minimum length of result string
         *
         * @return {string} padded string
         */
        padLeft: function(s, padding, length) {
            while (s.length < length)
                s = padding + s;
            return s;
        },

        /**
         * Pads a string from the left with zeros ('0') if necessary.
         *
         * @param {string} s string that should be padded
         * @param {int} length minimum length of result string
         *
         * @return {string} zero-padded string
         */
        padZeros: function(s, length) {
            return this.padLeft(s + "", "0", length);
        },

        /** Converts a string new lines to html <br /> tags
         *
         * @param s string
         * @return string with new lines replaced by <br />
         */
        nl2br: function(s) {
            return (s + "").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1<br />$2');
        },

        /** Converts special characters in a string to html entitiy symbols
         *
         * @param s string
         * @return converted string
         */
        htmlentities: function(s) {
            return (s + "").replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#x27;').replace(/\//g, '&#x2F;');
        },

        JS_ESCAPES: {
            "'": "'",
            '\\': '\\',
            '\r': 'r',
            '\n': 'n',
            '\t': 't',
            '\u2028': 'u2028',
            '\u2029': 'u2029'
        },

        JS_ESCAPER_REGEX: function() {
            if (!this.JS_ESCAPER_REGEX_CACHED)
                this.JS_ESCAPER_REGEX_CACHED = new RegExp(Objs.keys(this.JS_ESCAPES).join("|"), 'g');
            return this.JS_ESCAPER_REGEX_CACHED;
        },

        /** Converts string such that it can be used in javascript by escaping special symbols
         *
         * @param s string
         * @return escaped string
         */
        js_escape: function(s) {
            var self = this;
            return s.replace(this.JS_ESCAPER_REGEX(), function(match) {
                return '\\' + self.JS_ESCAPES[match];
            });
        },

        /** Determines whether a string starts with a sub string
         *
         * @param s string in question
         * @param needle sub string
         * @return true if string in question starts with sub string
         */
        starts_with: function(s, needle) {
            return s.substring(0, needle.length) == needle;
        },

        /** Determines whether a string ends with a sub string
         *
         * @param s string in question
         * @param needle sub string
         * @return true if string in question ends with sub string
         */
        ends_with: function(s, needle) {
            return s.indexOf(needle, s.length - needle.length) !== -1;
        },

        /** Removes sub string from a string if string starts with sub string
         *
         * @param s string in question
         * @param needle sub string
         * @return string without sub string if it starts with sub string otherwise it returns the original string
         */
        strip_start: function(s, needle) {
            return this.starts_with(s, needle) ? s.substring(needle.length) : s;
        },

        /** Removes sub string from a string if string ends with sub string
         *
         * @param s string in question
         * @param needle sub string
         * @return string without sub string if it ends with sub string otherwise it returns the original string
         */
        strip_end: function(s, needle) {
            return this.ends_with(s, needle) ? s.substring(0, s.length - needle.length) : s;
        },

        /**
         * Returns the complete remaining part of a string after the last occurrence of a sub string
         *
         * @param s string in question
         * @param needle sub string
         * @return remaining part of the string in question after the last occurrence of the sub string
         */
        last_after: function(s, needle) {
            return this.splitLast(s, needle).tail;
        },

        /**
         * Returns the complete remaining part of a string after the first occurrence of a sub string
         *
         * @param s string in question
         * @param needle sub string
         * @return remaining part of the string in question after the first occurrence of the sub string
         */
        first_after: function(s, needle) {
            return s.substring(s.indexOf(needle) + 1, s.length);
        },

        EMAIL_ADDRESS_REGEX: /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,

        /** Determines whether a string is a syntactically valid email address
         *
         * @param s string in question
         * @return true if string looks like an email address
         */
        is_email_address: function(s) {
            return this.EMAIL_ADDRESS_REGEX.test(s);
        },

        STRIP_HTML_TAGS: ["script", "style", "head"],
        STRIP_HTML_REGEX: /<\/?([a-z][a-z0-9]*)\b[^>]*>?/gi,
        STRIP_HTML_COMMENT_REGEX: /<![^>]*>/gi,

        /** Removes all html from data and returns plain text
         *
         * @param html string containing html
         * @return string containing the plain text part of it
         */
        strip_html: function(html) {
            var result = html;
            for (var i = 0; i < this.STRIP_HTML_TAGS.length; ++i)
                result = result.replace(new RegExp("<" + this.STRIP_HTML_TAGS[i] + ".*</" + this.STRIP_HTML_TAGS[i] + ">", "i"), '');
            result = result.replace(this.STRIP_HTML_REGEX, '').replace(this.STRIP_HTML_COMMENT_REGEX, '');
            return result;
        },

        /** Trims all trailing and leading whitespace and removes block indentations
         *
         * @param s string
         * @return string with trimmed whitespaces and removed block indentation
         */
        nltrim: function(s) {
            var a = s.replace(/\t/g, "  ").split("\n");
            var len = null;
            var i = 0;
            for (i = 0; i < a.length; ++i) {
                var j = 0;
                while (j < a[i].length) {
                    if (a[i].charAt(j) != ' ')
                        break;
                    ++j;
                }
                if (j < a[i].length)
                    len = len === null ? j : Math.min(j, len);
            }
            for (i = 0; i < a.length; ++i)
                a[i] = a[i].substring(len);
            return a.join("\n").trim();
        },

        /**
         * Replaces all occurrences of a substring with something else.
         *
         * @param {string} s input string
         * @param {string} sub search string
         * @param {string} wth replacement string
         *
         * @return {string} input with all occurrences of the search string replaced by the replacement string
         */
        replaceAll: function(s, sub, wth) {
            while (s.indexOf(sub) >= 0)
                s = s.replace(sub, wth);
            return s;
        },

        /**
         * Capitalizes all first characters of all words in a string.
         *
         * @param {string} input input string
         *
         * @return {string} input with all first characters capitalized
         */
        capitalize: function(input) {
            return input.replace(/\w\S*/g, function(txt) {
                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
            });
        },

        /**
         * Converts string to pascal case
         *
         * @param {string} s input string
         *
         * @return {string} input in pascal case
         */
        pascalCase: function(s) {
            return s.replace(/[A-Z][a-z0-9]/g, function(txt) {
                return " " + txt;
            }).replace(/[A-Za-z0-9]+/g, function(txt) {
                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
            }).replace(/[-_\s]/g, "");
        },

        /**
         * Converts string to camel case
         *
         * @param {string} s input string
         *
         * @return {string} input in camel case
         */
        camelCase: function(s) {
            var txt = this.pascalCase(s);
            return txt.charAt(0).toLowerCase() + txt.substr(1);
        },

        /**
         * Converts string to train case
         *
         * @param {string} s input string
         *
         * @return {string} input in train case
         */
        trainCase: function(s) {
            var txt = this.pascalCase(s);
            return txt.replace(/[A-Z]/g, function(txt) {
                return "-" + txt;
            }).substring(1);
        },

        /**
         * Converts string to snake case
         *
         * @param {string} s input string
         *
         * @return {string} input in snake case
         */
        snakeCase: function(s) {
            return this.trainCase(s).replace(/-/g, "_").toLowerCase();
        },

        /**
         * Converts string to kebab case
         *
         * @param {string} s input string
         *
         * @return {string} input in kebab case
         */
        kebabCase: function(s) {
            return this.trainCase(s).toLowerCase();
        },

        /**
         * Extracts the name from an email address name string (e.g. 'Foo Bar <foobar@domain.com>')
         *
         * @param {string} input email address name input string
         *
         * @return {string} name included in the string
         */
        email_get_name: function(input) {
            input = input || "";
            var temp = input.split("<");
            input = temp[0].trim();
            if (!input || temp.length < 2) {
                temp = temp[temp.length - 1].split("@");
                input = temp[0].trim();
            }
            input = input.replace(/['"]/g, "").replace(/[\\._@]/g, " ");
            return this.capitalize(input);
        },

        /**
         * Extracts the email from an email address name string (e.g. 'Foo Bar <foobar@domain.com>')
         *
         * @param {string} input email address name input string
         *
         * @return {string} email included in the string
         */
        email_get_email: function(input) {
            input = input || "";
            var temp = input.split("<");
            input = temp[0].trim();
            if (temp.length > 1) {
                temp = temp[1].split(">");
                input = temp[0].trim();
            }
            input = input.replace(/'/g, "").replace(/"/g, "").trim();
            return input;
        },

        /**
         * Extracts the salutatory name from an email address name string (normally the first name)
         *
         * @param {string} input email address name input string
         *
         * @return {string} salutatory name
         */
        email_get_salutatory_name: function(input) {
            return (this.email_get_name(input || "").split(" "))[0];
        },

        /**
         * Splits a string into two by the first occurrence of a delimiter
         *
         * @param {string} s input string
         * @param {string} delimiter delimiter string
         *
         * @return {object} a json object, mapping 'head' to the region left and 'tail' to region right to the delimiter
         */
        splitFirst: function(s, delimiter) {
            var i = s.indexOf(delimiter);
            return {
                head: i >= 0 ? s.substring(0, i) : s,
                tail: i >= 0 ? s.substring(i + delimiter.length) : ""
            };
        },

        /**
         * Splits a string into two by the last occurrence of a delimiter
         *
         * @param {string} s input string
         * @param {string} delimiter delimiter string
         *
         * @return {object} a json object, mapping 'head' to the region left and 'tail' to region right to the delimiter
         */
        splitLast: function(s, delimiter) {
            var i = s.lastIndexOf(delimiter);
            return {
                head: i >= 0 ? s.substring(0, i) : "",
                tail: i >= 0 ? s.substring(i + delimiter.length) : s
            };
        },

        /**
         * Replace all groups in a regular expression string by string parameters.
         *
         * @param {string} regex regular expression with groups as a string
         * @param {array} args array of string parameters
         *
         * @return {string} regular expression with groups being replaced by string parameters
         */
        regexReplaceGroups: function(regex, args) {
            var findGroup = /\(.*?\)/;
            var f = function(captured) {
                if (arg)
                    return arg;
                return captured.substring(1, captured.length - 1);
            };
            while (args.length > 0) {
                var arg = args.shift();
                regex = regex.replace(findGroup, f);
            }
            return regex;
        },

        /**
         * Given a regular expression with named capture groups (e.g. '(foobar:\d+)'), compute a normal regular expression with mappings to the named groups.
         *
         * @param {string} regex regular expression with named capture groups
         *
         * @return {object} mapping object
         */
        namedCaptureRegex: function(regex) {
            var groupMap = {};
            var groupIdx = 0;
            var newRegex = new RegExp(regex.replace(/\([^)]+\)/ig, function(group) {
                if (group.charAt(1) != "?" && group.indexOf(":") > 0) {
                    var delimiter = group.indexOf(":");
                    groupMap[group.substring(1, delimiter)] = groupIdx;
                    group = "(" + group.substring(delimiter + 1, group.length - 1) + ")";
                }
                groupIdx++;
                return group;
            }));
            var map = function(groups) {
                return Objs.map(groupMap, function(idx) {
                    return groups[idx + 1];
                });
            };
            var exec = function(test) {
                var result = newRegex.exec(test);
                return result ? map(result) : null;
            };
            var mapBack = function(args) {
                var result = [];
                for (var i = 0; i < groupIdx; ++i)
                    result.push(null);
                for (var key in args)
                    if (key in groupMap)
                        result[groupMap[key]] = args[key];
                return result;
            };
            return {
                regex: newRegex,
                map: map,
                exec: exec,
                mapBack: mapBack
            };
        },

        /**
         * Given an int, returns the short form of its ordinal value
         *
         * @param {int} i An integer
         *
         * @return {string} The ordinal value of the number
         */
        ordinalSuffix: function(i) {
            var j = i % 10,
                k = i % 100;
            if (j === 1 && k !== 11) {
                return i + "st";
            }
            if (j === 2 && k !== 12) {
                return i + "nd";
            }
            if (j === 3 && k !== 13) {
                return i + "rd";
            }
            return i + "th";
        }

    };

});

Scoped.define("module:Tokens", function () {
    /**
     * Unique Token Generation
     * 
     * @module BetaJS.Tokens
     */
    return {

        /**
         * Generates a random token
         * 
         * @param {integer} length optional length of token, default is 16
         * @return {string} generated token
         */
        generate_token: function(length) {
            length = length || 16;
            var s = "";
            while (s.length < length)
                s += Math.random().toString(36).substr(2);
            return s.substr(0, length);
        },

        /**
         * Generated a simple hash value from a string.
         * 
         * @param {string} input string
         * @return {integer} simple hash value
         * @see http://jsperf.com/string-hashing-methods 
         */
        simple_hash: function(s) {
            var nHash = 0;
            if (!s.length)
                return nHash;
            for (var i = 0, imax = s.length, n; i < imax; ++i) {
                n = s.charCodeAt(i);
                nHash = ((nHash << 5) - nHash) + n;
                nHash = nHash & nHash;
            }
            return Math.abs(nHash);
        }

    };
});

Scoped.define("module:Net.Uri", ["module:Objs","module:Types","module:Strings"], function (Objs, Types, Strings) {

    var parse_strict_regex = /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/;
    var parse_loose_regex = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;
    var parse_key = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"];
    var parse_key_parser = /(?:^|&)([^&=]*)=?([^&]*)/g;


    /**
     * Uri Auxilary Functions
     * 
     * @module BetaJS.Net.Uri
     */
    return {

        /**
         * Create a URI string from a set of parameters.
         * 
         * @param {object} obj parameters
         * 
         * @return {string} uri
         */
        build: function(obj) {
            var s = "";
            if (obj.protocol)
                s += obj.protocol + "://";
            if (obj.username)
                s += obj.username + ":";
            if (obj.password)
                s += obj.password + "@";
            s += obj.server;
            if (obj.port)
                s += ":" + obj.port;
            if (obj.path)
                s += "/" + obj.path;
            return s;
        },


        /**
         * Encode a set of uri query parameters.
         * 
         * @param {object} arr a key-value set of query parameters
         * @param {string} prefix an optional prefix to be used for generating the keys
         * @param {boolean} flatten flatten the components first
         * 
         * @return {string} encoded query parameters
         */
        encodeUriParams: function(arr, prefix, flatten) {
            prefix = prefix || "";
            var res = [];
            if (flatten) {
                Objs.iter(Objs.serializeFlatJSON(arr), function(kv) {
                    res.push(prefix + kv.key + "=" + encodeURIComponent(kv.value));
                }, this);
            } else {
                Objs.iter(arr, function(value, key) {
                    if (Types.is_object(value))
                        res = res.concat(this.encodeUriParams(value, prefix + key + "_"));
                    else
                        res.push(prefix + key + "=" + encodeURIComponent(value));
                }, this);
            }
            return res.join("&");
        },


        /**
         * Decode a uri query parameter string
         * 
         * @param {string} res encoded query parameters
         * 
         * @return {object} key-value set of query parameters
         */
        decodeUriParams: function(res) {
            var arr = {};
            res.split("&").forEach(function(kv) {
                var kvsplit = Strings.splitFirst(kv, "=");
                arr[kvsplit.head] = decodeURIComponent(kvsplit.tail);
            });
            return arr;
        },


        /**
         * Append a set of uri query parameters to a URI.
         * 
         * @param {string} uri a uri
         * @param {object} arr a key-value set of query parameters
         * @param {string} prefix an optional prefix to be used for generating the keys
         * 
         * @return {string} uri with the encoded query parameters attached
         */
        appendUriParams: function(uri, arr, prefix) {
            return Types.is_empty(arr) ? uri : (uri + (uri.indexOf("?") != -1 ? "&" : "?") + this.encodeUriParams(arr, prefix));
        },


        /**
         * Parses a given uri into decomposes it into its components.
         * 
         * @thanks parseUri 1.2.2, (c) Steven Levithan <stevenlevithan.com>, MIT License
         * 
         * @param {string} str uri to be parsed
         * @param {boolean} strict use strict parsing (default false)
         * 
         * @return {object} decomposed uri
         */
        parse: function(str, strict) {
            var parser = strict ? parse_strict_regex : parse_loose_regex;
            var m = parser.exec(str);
            var uri = {};
            for (var i = 0; i < parse_key.length; ++i)
                uri[parse_key[i]] = m[i] || "";
            uri.queryKey = {};
            uri[parse_key[12]].replace(parse_key_parser, function($0, $1, $2) {
                if ($1) uri.queryKey[$1] = $2;
            });
            return uri;
        },

        /**
         * Determines whether a target URI is considered cross-domain with respect to a source URI.
         * 
         * @param {string} source source URI
         * @param {string} target target URI
         * 
         * @return {boolean} true if target is cross-domain w.r.t. source
         */
        isCrossDomainUri: function(source, target) {
            // If target has no protocol delimiter, there is no domain given, hence source domain is used
            if (target.indexOf("//") < 0)
                return false;
            // If source has no protocol delimiter but target has, it is cross-domain.
            if (source.indexOf("//") < 0)
                return true;
            source = this.parse(source.toLowerCase());
            target = this.parse(target.toLowerCase());
            // Terminate if one of protocols is the file protocol.
            if (source.protocol === "file" || target.protocol === "file")
                return source.protocol === target.protocol;
            return source.host !== target.host || source.port !== target.port;
        }

    };
});

Scoped.define("module:Classes.OptimisticConditionalInstance", ["module:Class","module:Objs","module:Promise"], function (Class, Objs, Promise, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * OptimisticConditionalInstance for registering and optimistically creating particular flavors of a certain class under particular conditions
         * 
         * @class BetaJS.Classes.OptimisticConditionalInstance
         */
        return {

            /**
             * Instantiates a particular flavor of a OptimisticConditionalInstance
             * 
             * @param {object} options Options for the instance
             * @param {object} transitionals Particular transitional data that should be passed on from one instance to the next
             */
            constructor: function(options, transitionals) {
                inherited.constructor.call(this);
                this._transitionals = {};
            },

            /**
             * Returns an initialization promise.
             * 
             * @return {object} Initialization promise
             */
            _initializer: function() {
                // returns a promise
            },

            /**
             * Tries to initialize this instance.
             * 
             * @return {object} Success promise
             */
            _initialize: function() {
                return this._initializer().success(function() {
                    this._afterInitialize();
                }, this);
            },

            /**
             * Returns the current set of transitionals.
             * 
             * @return {object} Set of transitionals
             */
            transitionals: function() {
                return this._transitionals;
            },

            /**
             * Will be called after an instance has been initialized.
             * 
             */
            _afterInitialize: function() {
                // setup
            }

        };
    }, {}, {

        __registry: [],

        /**
         * Registers a particular flavor of an OptimisticConditionalInstance
         * 
         * @param {object} cls flavor class
         * @param {int} priority priority of this class; the higher the priority the more likely it is to be instantiated
         * 
         * @static
         */
        register: function(cls, priority) {
            this.__registry.push({
                cls: cls,
                priority: priority
            });
        },

        /**
         * Instantiates the best match.
         * 
         * @param {object} options Set of options
         * @return {object} Instance of best match as a promise
         * 
         * @static
         */
        create: function(options) {
            var promise = Promise.create();
            var reg = Objs.clone(this.__registry, 1);
            var transitionals = {};
            var next = function() {
                if (!reg.length) {
                    promise.asyncError(true);
                    return;
                }
                var p = -1;
                var j = -1;
                for (var i = 0; i < reg.length; ++i) {
                    if (reg[i].priority > p) {
                        p = reg[i].priority;
                        j = i;
                    }
                }
                var cls = reg[j].cls;
                reg.splice(j, 1);
                var instance = new cls(options, transitionals);
                instance._initialize().error(function() {
                    transitionals = instance.transitionals();
                    instance.destroy();
                    next.call(this);
                }, this).success(function() {
                    promise.asyncSuccess(instance);
                });
            };
            next.call(this);
            return promise;
        }

    });
});

Scoped.define("module:Classes.ConditionalInstance", ["module:Class","module:Objs"], function (Class, Objs, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Conditional Instance Class for registering and creating particular flavors of a certain class under particular conditions
         * 
         * @class BetaJS.Classes.ConditionalInstance
         */
        return {

            /**
             * Instantiates a particular flavor of a ConditionalInstance
             * 
             * @param {object} options Options for the instance
             */
            constructor: function(options) {
                inherited.constructor.call(this);
                this._options = this.cls._initializeOptions(options);
            }

        };
    }, {

        /**
         * Initialize given options with potentially additional parameters
         * 
         * @param {object} options Given options
         * @return {object} Initialized options
         * 
         * @static
         */
        _initializeOptions: function(options) {
            return options;
        },

        /**
         * Determines whether a set of options is supported by this flavor of a ConditionalInstance
         * 
         * @param {object} options set of options
         * @return {boolean} true if supported
         * 
         * @static
         */
        supported: function(options) {
            return false;
        }

    }, {

        __registry: [],

        /**
         * Registers a particular flavor of a ConditionalInstance
         * 
         * @param {object} cls flavor class
         * @param {int} priority priority of this class; the higher the priority the more likely it is to be instantiated
         * 
         * @static
         */
        register: function(cls, priority) {
            this.__registry.push({
                cls: cls,
                priority: priority
            });
        },

        /**
         * Determines the best match of all registered flavors, given a set of options.
         * 
         * @param {object} options Set of options
         * @return {object} flavor class being the best match
         * 
         * @static
         */
        match: function(options) {
            options = this._initializeOptions(options);
            var bestMatch = null;
            Objs.iter(this.__registry, function(entry) {
                if ((!bestMatch || bestMatch.priority < entry.priority) && entry.cls.supported(options))
                    bestMatch = entry;
            }, this);
            return bestMatch;
        },

        /**
         * Instantiates the best match.
         * 
         * @param {object} options Set of options
         * @return {object} Instance of best match
         * 
         * @static
         */
        create: function(options) {
            var match = this.match(options);
            return match ? new match.cls(options) : null;
        },

        /**
         * Determines whether there is any support for a given set of options.
         * 
         * @param {object} options Set of options
         * @return {boolean} True if there is at least one match.
         * 
         * @static
         */
        anySupport: function(options) {
            return this.match(options) !== null;
        }

    });
});

Scoped.define("module:Properties.ObservableMixin", [], function () {

    /**
     * Properties Observable Mixin
     *
     * @mixin BetaJS.Properties.ObservableMixin
     */
    return {

        __observable_guid: "48994ac3-7e0b-4ed5-8995-f146215dc795",

        /**
         * Returns the value associated with a key.
         *
         * @param {string} key key to read value for
         *
         * @return value for key
         */
        get: function(key) {},

        /**
         * Checks whether a key is set.
         *
         * @param {string} key key in question
         *
         * @return {boolean} true if key is set
         */
        hasKey: function(key) {}

    };
});

Scoped.define("module:Objs.Scopes", ["module:Types"], function (Types) {
    /**
     * Scoped access of keys within objects.
     * 
     * @module BetaJS.Objs.Scopes
     */
    return {

        /**
         * Determines whether a scoped key exists within a scope.
         * 
         * @param {string} key key within scope
         * @param {object} name scope context
         * 
         * @return {boolean} true if key exists within scope
         */
        has: function(key, scope) {
            var keys = key ? key.split(".") : [];
            for (var i = 0; i < keys.length; ++i) {
                if (!scope || !Types.is_object(scope))
                    return false;
                scope = scope[keys[i]];
            }
            return Types.is_defined(scope);
        },

        /**
         * Returns the value of a key within a scope.
         * 
         * @param {string} key key within scope
         * @param {object} name scope context
         * 
         * @return Value for key in scope
         */
        get: function(key, scope) {
            var keys = key ? key.split(".") : [];
            for (var i = 0; i < keys.length; ++i) {
                if (!scope || !Types.is_object(scope))
                    return null;
                scope = scope[keys[i]];
            }
            return scope;
        },

        /**
         * Sets the value of a key within a scope.
         * 
         * @param {string} key key within scope
         * @param name value to be set
         * @param {object} name scope context
         */
        set: function(key, value, scope) {
            if (!key)
                return;
            var keys = key.split(".");
            for (var i = 0; i < keys.length - 1; ++i) {
                if (!(keys[i] in scope) || !Types.is_object(scope[keys[i]]))
                    scope[keys[i]] = {};
                scope = scope[keys[i]];
            }
            scope[keys[keys.length - 1]] = value;
        },

        /**
         * Unsets a key within a scope.
         * 
         * @param {string} key key within scope
         * @param {object} name scope context
         */
        unset: function(key, scope) {
            if (!key)
                return;
            var keys = key.split(".");
            for (var i = 0; i < keys.length - 1; ++i) {
                if (!scope || !Types.is_object(scope))
                    return;
                scope = scope[keys[i]];
            }
            delete scope[keys[keys.length - 1]];
        },

        /**
         * Makes sure that a certain key is accessible within a scope.
         * 
         * @param {string} key key within scope
         * @param {object} name scope context
         * 
         * @return Touched value
         */
        touch: function(key, scope) {
            if (!key)
                return scope;
            var keys = key.split(".");
            for (var i = 0; i < keys.length; ++i) {
                if (!(keys[i] in scope) || !Types.is_object(scope))
                    scope[keys[i]] = {};
                scope = scope[keys[i]];
            }
            return scope[keys[keys.length - 1]];
        },

        /**
         * Initializes an array with pre-computed values using a callback function.
         *
         * @param {int} count number of elements to be generated
         * @param {function} callback function for computing the elements
         * @param {object} context optional context
         * @returns {array} generated array
         */
        initArray: function(count, callback, context) {
            var result = [];
            for (var i = 0; i < count; ++i)
                result.push(callback.call(context || this, i));
            return result;
        }

    };
});

Scoped.define("module:Properties.PropertiesMixin", ["module:Objs.Scopes","module:Objs","module:Strings","module:Types","module:Functions"], function (Scopes, Objs, Strings, Types, Functions) {

    /**
     * Properties Mixin
     * 
     * @mixin BetaJS.Properties.PropertiesMixin
     */
    return {

        __properties_guid: "ec816b66-7284-43b1-a945-0600c6abfde3",

        _notifications: {
            "construct": function() {
                this.__properties = {
                    // hierarchical organization
                    data: {},
                    // hierarchical organization
                    watchers: {
                        children: {},
                        eventCount: 0,
                        parent: null,
                        key: null
                    },
                    // flat organization
                    computed: {},
                    // flat organization
                    bindings: {}
                };
                Objs.iter(this.materializes, function(key) {
                    this.materializeAttr(key);
                }, this);
            },
            "destroy": function() {
                Objs.iter(this.__properties.bindings, function(value, key) {
                    this.unbind(key);
                }, this);
                Objs.iter(this.__properties.computed, function(value, key) {
                    this.uncompute(key);
                }, this);
                /**
                 * @event BetaJS.Properties.PropertiesMixin#destroy
                 */
                this.trigger("destroy");
            },
            "register_event": function(event) {
                Objs.iter(["change", "unset", "deepchange", "deepunset", "strongdeepchange", "strongchange"], function(eventType) {
                    if (Strings.starts_with(event, eventType + ":"))
                        this.__registerWatcher(Strings.strip_start(event, eventType + ":"), eventType);
                }, this);
            },
            "unregister_event": function(event) {
                Objs.iter(["change", "unset", "deepchange", "deepunset", "strongdeepchange", "strongchange"], function(eventType) {
                    if (Strings.starts_with(event, eventType + ":"))
                        this.__unregisterWatcher(Strings.strip_start(event, eventType + ":"), eventType);
                }, this);
            }
        },

        __registerWatcher: function(key, event) {
            var keys = key ? key.split(".") : [];
            var current = this.__properties.watchers;
            for (var i = 0; i < keys.length; ++i) {
                if (!(keys[i] in current.children)) {
                    current.children[keys[i]] = {
                        parent: current,
                        eventCount: 0,
                        children: {},
                        key: keys[i]
                    };
                }
                current = current.children[keys[i]];
            }
            current.eventCount++;
        },

        __unregisterWatcher: function(key, event) {
            var keys = key ? key.split(".") : [];
            var current = this.__properties.watchers;
            for (var i = 0; i < keys.length; ++i) {
                if (current)
                    current = current.children[keys[i]];
            }
            if (!current)
                return;
            current.eventCount--;
            while (current.eventCount <= 0 && Types.is_empty(current.children) && current.parent) {
                var parent = current.parent;
                delete parent.children[current.key];
                current = parent;
            }
        },

        __unsetChanged: function(key, oldValue) {
            /**
             * @event BetaJS.Properties.PropertiesMixin#unset
             */
            this.trigger("unset", key, oldValue);
            var keys = key ? key.split(".") : [];
            var current = this.__properties.watchers;
            var head = "";
            var tail = key;
            for (var i = 0; i < keys.length; ++i) {
                if (current.eventCount > 0) {
                    /**
                     * @event BetaJS.Properties.PropertiesMixin#deepunset
                     */
                    this.trigger("deepunset:" + head, oldValue, tail);
                }
                if (!(keys[i] in current.children))
                    return this;
                current = current.children[keys[i]];
                head = head ? (head + "." + keys[i]) : keys[i];
                tail = Strings.first_after(tail, ".");
            }

            function process_unset(current, key, oldValue) {
                if (Types.is_undefined(oldValue))
                    return;
                if (current.eventCount > 0) {
                    /**
                     * @event BetaJS.Properties.PropertiesMixin#unset
                     */
                    this.trigger("unset:" + key, oldValue);
                }
                Objs.iter(current.children, function(child, subkey) {
                    process_unset.call(this, child, key ? (key + "." + subkey) : subkey, oldValue[subkey]);
                }, this);
            }
            process_unset.call(this, current, key, oldValue);
            return this;
        },

        __setChanged: function(key, value, oldValue, notStrong) {
            /**
             * @event BetaJS.Properties.PropertiesMixin#change
             */
            this.trigger("change", key, value, oldValue);
            this._afterSet(key, value);
            if (this.destroyed())
                return;
            var keys = key ? key.split(".") : [];
            var current = this.__properties.watchers;
            var head = "";
            var tail = key;
            for (var i = 0; i < keys.length; ++i) {
                if (current.eventCount > 0) {
                    if (!notStrong) {
                        /**
                         * @event BetaJS.Properties.PropertiesMixin#strongdeepchange
                         */
                        this.trigger("strongdeepchange:" + head, value, oldValue, tail);
                    }
                    /**
                     * @event BetaJS.Properties.PropertiesMixin#deepchange
                     */
                    this.trigger("deepchange:" + head, value, oldValue, tail);
                }
                if (!(keys[i] in current.children))
                    return;
                current = current.children[keys[i]];
                head = head ? (head + "." + keys[i]) : keys[i];
                tail = Strings.first_after(tail, ".");
            }

            function process_set(current, key, value, oldValue) {
                if (value == oldValue)
                    return;
                if (current.eventCount > 0) {
                    if (!notStrong) {
                        /**
                         * @event BetaJS.Properties.PropertiesMixin#strongchange
                         */
                        this.trigger("strongchange:" + key, value, oldValue);
                    }
                    /**
                     * @event BetaJS.Properties.PropertiesMixin#change
                     */
                    this.trigger("change:" + key, value, oldValue);
                }
                Objs.iter(current.children, function(child, subkey) {
                    process_set.call(this, child, key ? (key + "." + subkey) : subkey, Types.is_object(value) && value ? value[subkey] : null, Types.is_object(oldValue) && oldValue ? oldValue[subkey] : null);
                }, this);
            }
            process_set.call(this, current, key, value, oldValue);
        },

        /**
         * Attributes that will be materialized upon initialization.
         */
        materializes: [],

        /**
         * Resolve the scope associated with a key.
         * 
         * @param {string} key key to resolve
         * @return associated scope
         * 
         * @protected
         */
        _resolveProps: function(key) {
            var result = {
                props: this,
                key: key
            };
            var scope = this.data();
            while (key) {
                if (!scope || !Types.is_object(scope))
                    return result;
                if (scope.__properties_guid === this.__properties_guid)
                    return scope._resolveProps(key);
                var spl = Strings.splitFirst(key, ".");
                if (!(spl.head in scope))
                    return result;
                key = spl.tail;
                scope = scope[spl.head];
            }
            return result;
        },

        /**
         * Check whether a key can be set to a value.
         * 
         * @param {string} key key in question
         * @param value value in question
         * 
         * @return {boolean} true if can be set
         * 
         * @protected
         */
        _canSet: function(key, value) {
            return true;
        },

        /**
         * Called before setting a value.
         * 
         * @param {string} key key in question
         * @param value value in question
         * 
         * @return value, possibly altered
         * 
         * @protected
         */
        _beforeSet: function(key, value) {
            return value;
        },

        /**
         * Called after setting a value.
         * 
         * @param {string} key key in question
         * @param value value in question
         * 
         * @protected
         */
        _afterSet: function(key, value) {},

        /**
         * Get value for key, resolving intermediate properties instances.
         * 
         * @param {string} key key to read
         * 
         * @return associated value
         */
        getProp: function(key) {
            var resolved = this._resolveProps(key);
            return resolved.props.get(resolved.key);
        },

        /**
         * Set value for key, resolving intermediate properties instances.
         * 
         * @param {string} key to read
         * @param value value to write
         */
        setProp: function(key, value) {
            var resolved = this._resolveProps(key);
            resolved.props.set(resolved.key, value);
            return this;
        },

        /**
         * Remove computation of a key.
         * 
         * @param {string} key key to remove computation for
         */
        uncomputeProp: function(key) {
            var resolved = this._resolveProps(key);
            return resolved.props.uncompute(resolved.key);
        },

        /**
         * Add computation of a key.
         * 
         * @param {string} key key to add computation for
         * @param {function} func function to compute the key
         */
        computeProp: function(key, func) {
            var resolved = this._resolveProps(key);
            var args = Functions.getArguments(arguments);
            args[0] = resolved.key;
            return resolved.props.compute.apply(resolved.props.compute, args);
        },

        /**
         * Returns the value associated with a key.
         * 
         * @param {string} key key to read value for
         * 
         * @return value for key
         */
        get: function(key) {
            return Scopes.get(key, this.__properties.data);
        },

        /**
         * Checks whether a key is set.
         * 
         * @param {string} key key in question
         * 
         * @return {boolean} true if key is set
         */
        has: function(key) {
            return Scopes.has(key, this.__properties.data);
        },

        /**
         * Checks whether a key is set.
         *
         * @param {string} key key in question
         *
         * @return {boolean} true if key is set
         */
        hasKey: function(key) {
            return this.has(key);
        },

        /**
         * Sets all attributes in a JSON object.
         * 
         * @param {object} obj JSON object data
         * 
         */
        setAll: function(obj) {
            for (var key in obj)
                this.set(key, obj[key]);
            return this;
        },

        /**
         * Returns all keys of the instance, possibly mapped.
         * 
         * @param {function} mapped optional key mapping
         * 
         * @return {array} all keys
         */
        keys: function(mapped) {
            return Objs.keys(this.__properties.data, mapped);
        },

        /**
         * Returns a data pointer to the raw data. Read only.
         * 
         * @return {object} data pointer
         */
        data: function() {
            return this.__properties.data;
        },

        /**
         * Returns a raw data copy.
         * 
         * @return {object} raw data copy
         */
        getAll: function() {
            return Objs.clone(this.__properties.data, 1);
        },

        /**
         * Iterates over all key-value pairs.
         *
         * @param {function} cb callback function
         * @param {object} ctx optional context
         *
         */
        iterate: function(cb, ctx) {
            Objs.iter(this.getAll(), cb, ctx);
            return this;
        },

        /**
         * Materializes an attribute as a function.
         * 
         * @param {string} attr attribute to be materialized
         * 
         */
        materializeAttr: function(attr) {
            this[attr] = function(value) {
                if (arguments.length === 0)
                    return this.get(attr);
                this.set(attr, value);
            };
            return this;
        },

        /**
         * Remove the computation of a key.
         * 
         * @param {string} key key for which the computation should be removed
         */
        uncompute: function(key) {
            if (key in this.__properties.computed) {
                Objs.iter(this.__properties.computed[key].dependencies, function(dependency) {
                    dependency.properties.off("change:" + dependency.key, null, dependency);
                    if (dependency.value && !dependency.value.destroyed())
                        dependency.value.off("change update", null, dependency);
                }, this);
                delete this.__properties.computed[key];
            }
            return this;
        },

        /**
         * Add a computation for a key.
         * 
         * @param {string} key key to add computation for
         * @param {function} func function to compute the key
         */
        compute: function(key, func) {
            var args = Functions.matchArgs(arguments, 2, {
                setter: "function",
                context: {
                    type: "object",
                    def: this
                },
                dependencies: true
            });
            this.uncompute(key);
            var deps = [];
            Objs.iter(args.dependencies, function(dep) {
                if (Types.is_string(dep))
                    deps.push({
                        properties: this,
                        key: dep
                    });
                else
                    deps.push({
                        properties: dep[0],
                        key: dep[1]
                    });
            }, this);
            var computed = {
                ignore: 0,
                func: func,
                context: args.context,
                setter: args.setter,
                dependencies: deps
            };
            this.__properties.computed[key] = computed;
            var self = this;

            function recompute() {
                if (computed.ignore > 0)
                    return;
                var values = Objs.map(deps, function(dep) {
                    return dep.properties.get(dep.key);
                });
                self.set(key, func.apply(args.context, values));
            }
            Objs.iter(deps, function(dep) {
                var value = dep.properties.get(dep.key);
                // Ugly way of checking whether an EventsMixin is present - please improve in the future on this
                if (value && typeof value == "object" && "on" in value && "off" in value && "trigger" in value) {
                    dep.value = value;
                    value.on("change update", function() {
                        recompute();
                    }, dep);
                }
                dep.properties.on("change:" + dep.key, function(value, oldValue) {
                    dep.value = null;
                    if (oldValue && typeof oldValue == "object" && "on" in oldValue && "off" in oldValue && "trigger" in oldValue) {
                        oldValue.off("change update", null, dep);
                    }
                    if (value && typeof value == "object" && "on" in value && "off" in value && "trigger" in value) {
                        dep.value = value;
                        value.on("change update", function() {
                            recompute();
                        }, dep);
                    }
                    recompute();
                }, dep);
            }, this);
            recompute();
            return this;
        },

        /**
         * Removes a binding for a key and another properties instance.
         * 
         * @param {string} key key for which the binding should be removed
         * @param {object} props other properties instance
         */
        unbind: function(key, props) {
            if (key in this.__properties.bindings) {
                for (var i = this.__properties.bindings[key].length - 1; i >= 0; --i) {
                    var binding = this.__properties.bindings[key][i];
                    if (!props || props == binding) {
                        if (binding.left)
                            binding.properties.off(null, null, binding);
                        if (binding.right)
                            this.off(null, null, binding);
                        this.__properties.bindings[key].splice(i, 1);
                        i--;
                    }
                }
                if (this.__properties.bindings[key].length === 0)
                    delete this.__properties.bindings[key];
            }
            return this;
        },

        /**
         * Adds a binding for a key and another properties instance.
         * 
         * @param {string} key key for which the binding should be added
         * @param {object} props other properties instance
         * @param {object} options optional options
         */
        bind: function(key, properties, options) {
            options = Objs.extend({
                secondKey: key,
                left: true,
                right: true,
                deep: false
            }, options);
            var binding = {
                key: options.secondKey,
                left: options.left,
                right: options.right,
                deep: options.deep,
                properties: properties
            };
            this.__properties.bindings[key] = this.__properties.bindings[key] || [];
            this.__properties.bindings[key].push(binding);
            var self = this;
            if (binding.left) {
                binding.properties.on("strongchange:" + binding.key, function(value) {
                    self.set(key, value);
                }, binding);
                binding.properties.on("unset:" + binding.key, function(value) {
                    self.unset(key);
                }, binding);
                if (binding.deep) {
                    binding.properties.on("strongdeepchange:" + binding.key, function(value, oldValue, subKey) {
                        if (self.get(key ? key + "." + subKey : subKey) === value)
                            self.__setChanged(key ? key + "." + subKey : subKey, value, oldValue, true);
                        else
                            self.set(key ? key + "." + subKey : subKey, value);
                    }, binding);
                    binding.properties.on("deepunset:" + binding.key, function(oldValue, subKey) {
                        if (!self.has(key ? key + "." + subKey : subKey))
                            self.__unsetChanged(key ? key + "." + subKey : subKey, oldValue);
                        else
                            self.unset(key ? key + "." + subKey : subKey);
                    }, binding);
                }
                if (!binding.right || !this.has(key))
                    this.set(key, binding.properties.get(binding.key));
                if (key === "") {
                    Objs.iter(binding.properties.data(), function(value, k) {
                        this.set(k, value);
                    }, this);
                }
            }
            if (binding.right) {
                this.on("strongchange:" + key, function(value) {
                    binding.properties.set(binding.key, value);
                }, binding);
                this.on("unset:" + key, function(value) {
                    binding.properties.unset(binding.key);
                }, binding);
                if (binding.deep) {
                    this.on("strongdeepchange:" + key, function(value, oldValue, subKey) {
                        if (binding.properties.get(binding.key ? binding.key + "." + subKey : subKey) === value)
                            binding.properties.__setChanged(binding.key ? binding.key + "." + subKey : subKey, value, oldValue, true);
                        else
                            binding.properties.set(binding.key ? binding.key + "." + subKey : subKey, value);
                    }, binding);
                    this.on("deepunset:" + key, function(oldValue, subKey) {
                        if (!binding.properties.has(binding.key ? binding.key + "." + subKey : subKey))
                            binding.properties.__unsetChanged(binding.key ? binding.key + "." + subKey : subKey, oldValue);
                        else
                            binding.properties.unset(binding.key ? binding.key + "." + subKey : subKey);
                    }, binding);
                }
                if (!binding.left || this.has(key))
                    binding.properties.set(binding.key, this.get(key));
                if (key === "") {
                    Objs.iter(this.data(), function(value, k) {
                        binding.properties.set(k, value);
                    }, this);
                }
            }
            binding.properties.on("destroy", function() {
                if (!self.destroyed())
                    self.unbind(key);
            }, binding);
            return this;
        },

        /**
         * Removes a key from the properties instance.
         * 
         * @param {string} key key to be removed
         */
        unset: function(key) {
            if (this.has(key)) {
                var oldValue = this.get(key);
                Scopes.unset(key, this.__properties.data);
                this.__unsetChanged(key, oldValue);
            }
            return this;
        },

        /**
         * Sets a key in the properties instance.
         * 
         * @param {string} key key to be set
         * @param value value to be set
         * @param {boolean} force optional force argument
         */
        set: function(key, value, force) {
            if (Types.is_object(value) && value && value.guid == this.__properties_guid) {
                if (value.properties)
                    this.bind(key, value.properties, {
                        secondKey: value.key
                    });
                if (value.func)
                    this.compute(key, value.func, value.dependencies);
                return this;
            }
            value = this._beforeSet(key, value);
            var oldValue = this.get(key);
            if (oldValue !== value) {
                Scopes.set(key, value, this.__properties.data);
                this.__setChanged(key, value, oldValue);
            } else if (force) {
                /**
                 * @event BetaJS.Properties.PropertiesMixin#change
                 */
                this.trigger("change", key, value, oldValue, true);
                /**
                 * @event BetaJS.Properties.PropertiesMixin#change
                 */
                this.trigger("change:" + key, value, oldValue, true);
            }
            return this;
        },

        /**
         * @deprecated
         */
        binding: function(key) {
            return {
                guid: this.__properties_guid,
                properties: this,
                key: key
            };
        },

        /**
         * @deprecated
         */
        computed: function(f, dependencies) {
            return {
                guid: this.__properties_guid,
                func: f,
                dependencies: dependencies
            };
        },

        /**
         * Returns the properties unique id.
         * 
         * @return {string} unique properties id
         */
        pid: function() {
            return this.cid();
        },

        /**
         * Checks whether this properties instance is a subset of another properties instance.
         *  
         * @param {object} props another properties instance or JSON object
         * 
         * @return {boolean} true if this instance is a subset of the other properties object
         */
        isSubsetOf: function(props) {
            return Objs.subset_of(this.data(), props.data ? props.data() : props);
        },

        /**
         * Checks whether this properties instance is a superset of another properties instance.
         *  
         * @param {object} props another properties instance or JSON object
         * 
         * @return {boolean} true if this instance is a superset of the other properties object
         */
        isSupersetOf: function(props) {
            return Objs.superset_of(this.data(), props.data ? props.data() : props);
        }

    };
});

Scoped.define("module:Properties.Properties", ["module:Class","module:Objs","module:Events.EventsMixin","module:Properties.ObservableMixin","module:Properties.PropertiesMixin"], function (Class, Objs, EventsMixin, ObservableMixin, PropertiesMixin, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, ObservableMixin, PropertiesMixin, function(inherited) {

        /**
         * Properties Class
         * 
         * @class BetaJS.Properties.Properties
         */
        return {

            /**
             * Creates a new instance.
             * 
             * @param {object} obj optional initial attributes
             * @param {array} materializes optional initial attributes that should be materialized
             */
            constructor: function(obj, materializes) {
                inherited.constructor.call(this);
                if (obj)
                    this.setAll(obj);
                if (materializes) {
                    Objs.iter(materializes, function(key) {
                        this.materializeAttr(key);
                    }, this);
                }
            }

        };
    }]);
});

Scoped.define("module:Comparators", ["module:Types","module:Properties.Properties"], function (Types, Properties) {

    /**
     * Comparator Functions
     * 
     * @module BetaJS.Comparators
     */
    return {


        /**
         * Creates a function that compares two json object w.r.t. a json object, mapping keys to a comparison order,
         * e.g. {'last_name': 1, 'first_name': -1, 'age': -1 }  
         * 
         * @param {json} object comparison object
         * @return {function} function for comparing two objects w.r.t. the comparison object
         */
        byObject: function(object) {
            var self = this;
            return function(left, right) {
                for (var key in object) {
                    var c = 0;
                    if (Properties.is_class_instance(left) && Properties.is_class_instance(right))
                        c = self.byValue(left.get(key) || null, right.get(key) || null);
                    else
                        c = self.byValue(left[key] || null, right[key] || null);
                    if (c !== 0)
                        return c * object[key];
                }
                return 0;
            };
        },


        /**
         * Compares to variables by the natural order in JS.
         * 
         * @param a value A
         * @param b value B
         * @return {int} 1 if a > b, -1 if a < b and 0 otherwise
         */
        byValue: function(a, b) {
            if (Types.is_string(a))
                return a.localeCompare(b);
            if (a < b)
                return -1;
            if (a > b)
                return 1;
            return 0;
        },


        /**
         * Compares two values a and b recursively.
         * 
         * @param a value A
         * @param b value B
         * @param {int} depth depth limit for the recursion, leave blank for infinite recursion
         * @return {bool} true if both values are equal
         */
        deepEqual: function(a, b, depth) {
            if (depth === 0)
                return true;
            if (depth === 1)
                return a === b;
            if (Types.is_array(a) && Types.is_array(b)) {
                if (a.length !== b.length)
                    return false;
                for (var i = 0; i < a.length; ++i)
                    if (!this.deepEqual(a[i], b[i], depth - 1))
                        return false;
                return true;
            } else if (Types.is_object(a) && Types.is_object(b)) {
                if (!a || !b)
                    return a === b;
                for (var key in a)
                    if (!this.deepEqual(a[key], b[key], depth - 1))
                        return false;
                for (key in b)
                    if (!(key in a))
                        return false;
                return true;
            } else
                return a === b;
        },


        /**
         * Determines whether two lists are equal. Two lists are considered equal if their elements are equal.
         * 
         * @param a list A
         * @param b list B
         * @return {bool} true if both lists are equal
         */
        listEqual: function(a, b) {
            return this.deepEqual(a, b, 2);
        }

    };
});

Scoped.define("module:Exceptions.Exception", ["module:Class","module:Comparators"], function (Class, Comparators, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Exception Class
         * 
         * @class BetaJS.Exceptions.Exception
         */
        return {

            /**
             * Instantiates a new exception.
             * 
             * @param {string} message Exception message
             */
            constructor: function(message) {
                inherited.constructor.call(this);
                this.__message = message;
                try {
                    throw new Error();
                } catch (e) {
                    this.__stack = e.stack;
                }
            },

            /**
             * Asserts to be a certain type of exception. Throws this as an exception of assertion fails.
             * 
             * @param {object} exception_class Exception class to be asserted
             * @return {object} this
             */
            assert: function(exception_class) {
                if (!this.instance_of(exception_class))
                    throw this;
                return this;
            },

            /**
             * Returns exception message string.
             * 
             * @return {string} Exception message string
             */
            message: function() {
                return this.__message;
            },

            /**
             * Returns exception stack.
             * 
             * @return Exception stack
             */
            stack: function() {
                return this.__stack;
            },

            /**
             * Format exception as string.
             * 
             * @return {string} Exception string
             */
            toString: function() {
                return this.message();
            },

            /**
             * Format exception as string including the classname.
             * 
             * @return {string} Exception string plus classname
             */
            format: function() {
                return this.cls.classname + ": " + this.toString();
            },

            /**
             * Returns exception data as JSON.
             * 
             * @return {object} exception data
             */
            json: function() {
                return {
                    classname: this.cls.classname,
                    message: this.message(),
                    stack: this.stack()
                };
            },

            /**
             * Determines whether this exception is equal to another.
             * 
             * @param {object} other Other exception
             * @return {boolean} True if equal
             */
            equals: function(other) {
                return other && this.cls === other.cls && Comparators.deepEqual(this.json(), other.json(), -1);
            }

        };
    }, {

        /**
         * Ensures that a given exception is an instance of an Exception class
         * 
         * @param e Exception
         * @return {object} Exception instance
         */
        ensure: function(e) {
            if (!this.is_instance_of(e))
                throw "Unasserted Exception " + e;
            return e;
        }

    });
});

Scoped.define("module:Ajax.AjaxException", ["module:Exceptions.Exception"], function (Exception, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Abstract Ajax Exception Class
         * 
         * @class BetaJS.Ajax.AjaxException
         */
        return {

            /**
             * Returns the status code associated with the exception
             * 
             * @return {int} status code
             */
            status_code: function() {
                return 500;
            }

        };
    });
});

Scoped.define("module:Ajax.NoCandidateAjaxException", ["module:Ajax.AjaxException"], function (Exception, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * No Candidate Ajax Exception Class
         * 
         * @class BetaJS.Ajax.NoCandidateAjaxException
         */
        return {

        };
    });
});

Scoped.define("module:Ajax.ReturnDataParseException", ["module:Ajax.AjaxException"], function (Exception, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Return Data Parse Exception Class
         * 
         * @class BetaJS.Ajax.ReturnDataParseException 
         */
        return {

            /**
             * Creates a new instance.
             * 
             * @param data return data
             * @param {string} decodeType decode type for return data 
             */
            constructor: function(data, decodeType) {
                inherited.constructor.call(this, "Could not decode data with type " + decodeType);
                this.__decodeType = decodeType;
                this.__data = data;
            }

        };
    });
});

Scoped.define("module:Ajax.RequestException", ["module:Ajax.AjaxException","module:Objs"], function (Exception, Objs, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Request Exception Class
         * 
         * @class BetaJS.Ajax.RequestException
         */
        return {

            /**
             * Instantiates a Ajax Request Exception
             * 
             * @param status_code Status Code
             * @param {string} status_text Status Text
             * @param data Custom Exception Data
             */
            constructor: function(status_code, status_text, data) {
                inherited.constructor.call(this, status_code + ": " + status_text);
                this.__status_code = status_code;
                this.__status_text = status_text;
                this.__data = data;
            },

            /**
             * Returns the status code associated with the exception
             * 
             * @return {int} status code
             */
            status_code: function() {
                return this.__status_code;
            },

            /**
             * Returns the status text associated with the exception
             * 
             * @return {string} status text
             */
            status_text: function() {
                return this.__status_text;
            },

            /**
             * Returns the custom data associated with the exception 
             * 
             * @return custom data
             */
            data: function() {
                return this.__data;
            },

            /**
             * Returns a JSON representation of the exception
             * 
             * @return {object} Exception JSON representation
             */
            json: function() {
                return Objs.extend({
                    data: this.data(),
                    status_code: this.status_code(),
                    status_text: this.status_text()
                }, inherited.json.call(this));
            }

        };
    });
});

Scoped.define("module:Net.HttpHeader", function () {
    /**
     * Http Header Codes and Functions
     * 
     * @module BetaJS.Net.HttpHeader
     */
    return {

        HTTP_STATUS_OK: 200,
        HTTP_STATUS_CREATED: 201,
        HTTP_STATUS_BAD_REQUEST: 400,
        HTTP_STATUS_UNAUTHORIZED: 401,
        HTTP_STATUS_PAYMENT_REQUIRED: 402,
        HTTP_STATUS_FORBIDDEN: 403,
        HTTP_STATUS_NOT_FOUND: 404,
        HTTP_STATUS_PRECONDITION_FAILED: 412,
        HTTP_STATUS_INTERNAL_SERVER_ERROR: 500,
        HTTP_STATUS_GATEWAY_TIMEOUT: 504,

        STRINGS: {
            0: "Unknown Error",
            200: "OK",
            201: "Created",
            400: "Bad Request",
            401: "Unauthorized",
            402: "Payment Required",
            403: "Forbidden",
            404: "Not found",
            412: "Precondition Failed",
            500: "Internal Server Error",
            504: "Gateway timeout"
        },


        /**
         * Formats a HTTP status code to a string.
         * 
         * @param {integer} code the http status code
         * @param {boolean} prepend_code should the integer status code be prepended (default false)
         * 
         * @return HTTP status code as a string.
         */
        format: function(code, prepend_code) {
            var ret = this.STRINGS[code in this.STRINGS ? code : 0];
            return prepend_code ? (code + " " + ret) : ret;
        },

        /**
         * Returns true if a status code is in the 200 region.
         * 
         * @param {int} code status code
         * 
         * @return {boolean} true if code in the 200 region
         */
        isSuccessStatus: function(code) {
            return code >= this.HTTP_STATUS_OK && code < 300;
        }

    };
});

Scoped.define("module:Ajax.Support", ["module:Ajax.NoCandidateAjaxException","module:Ajax.ReturnDataParseException","module:Ajax.RequestException","module:Promise","module:Objs","module:Types","module:Net.Uri","module:Net.HttpHeader","module:Async","module:Time"], function (NoCandidateAjaxException, ReturnDataParseException, RequestException, Promise, Objs, Types, Uri, HttpHeader, Async, Time) {

    /**
     * Ajax Support Module
     * 
     * @module BetaJS.Ajax.Support
     */
    return {

        __registry: [],

        /**
         * Registers an ajax execution system 
         * 
         * @param {object} descriptor Descriptor object containing a supports and an execute function
         * @param {int} priority Priority of this execution system to be used if applicable
         */
        register: function(descriptor, priority) {
            this.__registry.push({
                descriptor: descriptor,
                priority: priority
            });
        },

        /**
         * Unwrap the status from return data
         * 
         * @param {object} json Status-encoded return object
         * @param {string} errorDecodeType Decode type for data in case it is an error
         * 
         * @return Unwrapped data in case of a success status
         */
        unwrapStatus: function(json, errorDecodeType) {
            /*
             * Should be:
             * {
             * 	status: XXX,
             *  statusText: XXX, (or empty)
             *  responseText: XXX (or empty)
             * }
             */
            var status = json.status || HttpHeader.HTTP_STATUS_INTERNAL_SERVER_ERROR;
            if (!HttpHeader.isSuccessStatus(status)) {
                var status_text = json.statusText || HttpHeader.format(status);
                var resp = json.responseText;
                try {
                    resp = this.parseReturnData(json.responseText, errorDecodeType);
                } catch (e) {}
                throw new RequestException(status, status_text, resp);
            } else
                return json.responseText;
        },

        /**
         * Parse return data given a decode type.
         * 
         * @param data Return data to be parsed
         * @param {string} decodeType Decode type, e.g. "json"
         * 
         * @return Parsed return data
         */
        parseReturnData: function(data, decodeType) {
            if (decodeType === "json" && Types.is_string(data))
                return JSON.parse(data);
            return data;
        },

        /**
         * Process the return data and forward the result to a promise object.
         * 
         * @param {object} promise Promise object
         * @param {object} options Options for processing the return data
         * @param data Return data
         * @param {string} decodeType Decode type, e.g. "json"
         * 
         */
        promiseReturnData: function(promise, options, data, decodeType) {
            if (options.wrapStatus) {
                try {
                    data = this.parseReturnData(data, "json");
                } catch (e) {
                    promise.asyncError(new ReturnDataParseException(data, decodeType));
                    return;
                }
                try {
                    data = this.unwrapStatus(data, decodeType);
                } catch (e) {
                    promise.asyncError(e);
                    return;
                }
            }
            try {
                promise.asyncSuccess(this.parseReturnData(data, decodeType));
            } catch (e) {
                promise.asyncError(new ReturnDataParseException(data, decodeType));
            }
        },

        /**
         * Process the return data and forward the result as an error to a promise object.
         * 
         * @param {object} promise Promise object
         * @param {int} status Error status
         * @param {string} status_text Optional status text
         * @param data Return data
         * @param {string} decodeType Decode type, e.g. "json"
         * 
         */
        promiseRequestException: function(promise, status, status_text, data, decodeType) {
            status_text = status_text || HttpHeader.format(status);
            try {
                promise.asyncError(new RequestException(status, status_text, this.parseReturnData(data, decodeType)));
            } catch (e) {
                promise.asyncError(new RequestException(status, status_text, data));
            }
        },

        /**
         * Preprocess Ajax Options object.
         * 
         * @param {object} options Options object
         * 
         * @return {object} Preprocessed options object
         */
        preprocess: function(options) {
            options = Objs.extend({
                method: "GET",
                mapMethodsKey: "_method",
                wrapStatus: false,
                wrapStatusParam: null,
                context: this,
                query: {},
                jsonp: undefined,
                noCache: undefined,
                noCacheParam: null,
                postmessage: undefined,
                contentType: "urlencoded", // json
                resilience: 1,
                resilience_delay: 1000,
                cors: false,
                sendContentType: true,
                corscreds: false,
                forceJsonp: false,
                forcePostmessage: false
                /*,
                				decodeType: "json"*/
            }, options);
            if (options.params) {
                options.query = Objs.extend(options.query, options.params);
                delete options.params;
            }
            if (!Types.is_empty(options.query)) {
                options.query = Objs.filter(options.query, function(value) {
                    return value !== null && value !== undefined;
                });
            }
            options.method = options.method.toUpperCase();
            if (options.baseUri)
                options.uri = options.uri ? options.baseUri + options.uri : options.baseUri;
            delete options.baseUri;
            if (options.mapMethods && options.method in options.mapMethods) {
                options.uri = Uri.appendUriParams(options.uri, Objs.objectBy(options.mapMethodsKey, options.method));
                options.method = options.mapMethods[options.method];
            }
            if (options.wrapStatus && options.wrapStatusParam)
                options.uri = Uri.appendUriParams(options.uri, Objs.objectBy(options.wrapStatusParam, "true"));
            if (options.noCache && options.noCacheParam)
                options.uri = Uri.appendUriParams(options.uri, Objs.objectBy(options.noCacheParam, Time.now()));
            delete options.mapMethods;
            delete options.mapMethodsKey;
            if (options.contentType === "urlencoded" && !Types.is_empty(options.data)) {
                options.data = Objs.filter(options.data, function(value) {
                    return value !== null && value !== undefined;
                });
            }
            options.isCorsRequest = typeof document !== "undefined" && Uri.isCrossDomainUri(document.location.href, options.uri);
            return options;
        },

        /**
         * Execute an Ajax command.
         * 
         * @param {object} options Options for the Ajax command
         * @param {function} progress Optional progress function
         * @param {object} progressCtx Optional progress context
         * 
         * @return {object} Execution promise
         */
        execute: function(options, progress, progressCtx) {
            options = this.preprocess(options);
            var current = null;
            this.__registry.forEach(function(candidate) {
                if ((!current || current.priority < candidate.priority) && candidate.descriptor.supports.call(candidate.descriptor.context || candidate.descriptor, options))
                    current = candidate;
            }, this);
            if (!current)
                return Promise.error(new NoCandidateAjaxException(options));
            var helper = function(resilience) {
                var promise = current.descriptor.execute.call(current.descriptor.context || current.descriptor, options, progress, progressCtx);
                if (!resilience || resilience <= 1)
                    return promise;
                var returnPromise = Promise.create();
                promise.forwardSuccess(returnPromise).error(function() {
                    Async.eventually(function() {
                        helper(resilience - 1).forwardCallback(returnPromise);
                    }, options.resilience_delay);
                });
                return returnPromise;
            };
            return helper(options.resilience);
        }

    };
});

Scoped.define("module:Scheduling.Helper", [], function () {
    return {

        schedulable: function(callback, initialSteps, scheduler, context) {
            if (scheduler)
                scheduler.schedulable(context || this, callback, initialSteps);
            else
                callback.call(context || this, Infinity);
        }

    };
});

Scoped.define("module:Events.ListenMixin", ["module:Ids","module:Objs","module:Types"], function (Ids, Objs, Types) {
    /**
     * Listen Mixin, automatically de-registering all listeners on destruction.
     * 
     * @mixin BetaJS.Events.ListenMixin
     */
    return {

        _notifications: {
            "destroy": "listenOff"
        },

        /**
         * Listen to an event.
         * 
         * @param {object} targets target(s) event emitter
         * @param {string} events event(s) to listen to
         * @param {function} callback event callback function
         * @param {object} options optional listener options
         */
        listenOn: function(targets, events, callback, options) {
            if (!this.__listen_mixin_listen)
                this.__listen_mixin_listen = {};
            if (!Types.is_array(targets))
                targets = [targets];
            targets.forEach(function(target) {
                this.__listen_mixin_listen[Ids.objectId(target)] = target;
                target.on(events, callback, this, options);
            }, this);
            return this;
        },

        /**
         * Listen to an event once.
         *
         * @param {object} targets target(s) event emitter
         * @param {string} events event(s) to listen to
         * @param {function} callback event callback function
         * @param {object} options optional listener options
         */
        listenOnce: function(targets, events, callback, options) {
            if (!this.__listen_mixin_listen)
                this.__listen_mixin_listen = {};
            if (!Types.is_array(targets))
                targets = [targets];
            targets.forEach(function(target) {
                this.__listen_mixin_listen[Ids.objectId(target)] = target;
                target.once(events, callback, this, options);
            }, this);
            return this;
        },

        /**
         * Stop Listenning to an event.
         *
         * @param {object} targets target(s) event emitter
         * @param {string} events event(s) to listen to
         * @param {function} callback event callback function
         */
        listenOff: function(targets, events, callback) {
            if (!this.__listen_mixin_listen)
                return this;
            if (!Types.is_array(targets))
                targets = [targets];
            targets.forEach(function(target) {
                if (target && !target.destroyed()) {
                    target.off(events, callback, this);
                    if (!events && !callback)
                        delete this.__listen_mixin_listen[Ids.objectId(target)];
                } else {
                    Objs.iter(this.__listen_mixin_listen, function(obj) {
                        if (obj && "off" in obj && !obj.destroyed())
                            obj.off(events, callback, this);
                        if (!events && !callback)
                            delete this.__listen_mixin_listen[Ids.objectId(obj)];
                    }, this);
                }
            }, this);
            return this;
        }

    };
});

Scoped.define("module:Classes.Taggable", ["module:Objs"], function (Objs) {

    /**
     * Taggable Mixin for handling instance tags
     * 
     * @mixin BetaJS.Classes.Taggable
     */
    return {

        /**
         * Determines whether a specific tag is present. 
         * 
         * @param {string} tag tag in question
         * @return {boolean} true if tag present
         */
        hasTag: function(tag) {
            return this.__tags && (tag in this.__tags);
        },

        /**
         * Returns all tags being present.
         *  
         * @return {array} Array of tags
         */
        getTags: function() {
            return Object.keys(this.__tags || {});
        },

        /**
         * Removes a specific tag. 
         * 
         * @param {string} tag tag in question
         * @return {object} this
         */
        removeTag: function(tag) {
            if (this.__tags) {
                delete this.__tags[tag];
                this._notify("tags-changed");
            }
            return this;
        },

        /**
         * Remove a list of tags. 
         * 
         * @param {array} tags tags to be removed
         * @return {object} this
         */
        removeTags: function(tags) {
            Objs.iter(tags, this.removeTag, this);
            return this;
        },

        /**
         * Add a tag to the instance. 
         * 
         * @param {string} tag tag in question
         * @return {object} this
         */
        addTag: function(tag) {
            this.__tags = this.__tags || {};
            this.__tags[tag] = true;
            this._notify("tags-changed");
            return this;
        },

        /**
         * Add a number of tags to the instance. 
         * 
         * @param {array} tags tag to be added
         * @return {object} this
         */
        addTags: function(tags) {
            Objs.iter(tags, this.addTag, this);
            return this;
        },

        /**
         * Returns the subset of the given tags that are present in the instance. 
         * 
         * @param {array} tags Superset of tags to be checkd
         * @return {array} Subset of intersecting tags
         */
        tagIntersect: function(tags) {
            return Objs.filter(tags, this.hasTag, this);
        }

    };
});

Scoped.define("module:Classes.StringTable", ["module:Class","module:Classes.Taggable","module:Functions","module:Objs"], function (Class, Taggable, Functions, Objs, scoped) {
    return Class.extend({
        scoped: scoped
    }, [Taggable, function(inherited) {

        /**
         * Taggable StringTable Class 
         * 
         * @class BetaJS.Classes.StringTable
         */
        return {

            _notifications: {
                "tags-changed": function() {
                    this.__cache = {};
                }
            },

            /**
             * Instantiates a StringTable. 
             */
            constructor: function() {
                inherited.constructor.call(this);
                this.__cache = {};
                this.__strings = {};
            },

            __resolveKey: function(key, prefix) {
                if (prefix)
                    key = prefix + "." + key;
                key = key.replace(/[^\.]+\.</g, "");
                return key;
            },

            __betterMatch: function(candidate, reference) {
                var c = this.tagIntersect(candidate.tags).length - this.tagIntersect(reference.tags).length;
                if (c !== 0)
                    return c > 0;
                c = candidate.priority - reference.priority;
                if (c !== 0)
                    return c > 0;
                c = reference.tags.length - candidate.tags.length;
                return c > 0;
            },

            /**
             * Registers string resources. 
             * 
             * @param {object} strings key-value representation of strings
             * @param {string} prefix optional prefix for the keys
             * @param {array} tags optional tags
             * @param {int} priority optional priority
             * 
             * @return {object} this
             */
            register: function() {
                var args = Functions.matchArgs(arguments, {
                    strings: true,
                    prefix: "string",
                    tags: "array",
                    priority: "number"
                });
                Objs.iter(args.strings, function(value, key) {
                    key = this.__resolveKey(key, args.prefix);
                    this.__strings[key] = this.__strings[key] || [];
                    this.__strings[key].push({
                        value: value,
                        tags: args.tags || [],
                        priority: args.priority || 0
                    });
                    delete this.__cache[key];
                }, this);
                return this;
            },

            /**
             * Returns a string resource by key 
             * 
             * @param {string} key key to be retrieved
             * @param {string} prefix optional prefix for the key
             * 
             * @return {string} resource string
             */
            get: function(key, prefix) {
                key = this.__resolveKey(key, prefix);
                if (key in this.__cache)
                    return this.__cache[key];
                if (!(key in this.__strings))
                    return null;
                var current = null;
                Objs.iter(this.__strings[key], function(candidate) {
                    if (!current || this.__betterMatch(candidate, current))
                        current = candidate;
                }, this);
                this.__cache[key] = current.value;
                return current.value;
            },

            /**
             * Retruns all included string resources 
             * 
             * @return {object} key-value representation of the included string resources
             */
            all: function() {
                return Objs.map(this.__strings, function(value, key) {
                    return this.get(key);
                }, this);
            }

        };
    }]);
});

Scoped.define("module:Classes.LocaleMixin", function () {

    /**
     * Locale Mixin for adding Locale access to a Class
     * 
     * @mixin BetaJS.Classes.LocaleMixin
     */
    return {

        _clearLocale: function() {},
        _setLocale: function(locale) {},

        /**
         * Returns the current locale.
         * 
         * @return {object} current locale
         */
        getLocale: function() {
            return this.__locale;
        },

        /**
         * Clears the current locale.
         * 
         */
        clearLocale: function() {
            this._clearLocale();
            this.__locale = null;
        },

        /**
         * Sets the current locale
         * 
         * @param {object} locale New locale
         */
        setLocale: function(locale) {
            this.clearLocale();
            this.__locale = locale;
            this._setLocale(locale);
        },

        /**
         * Returns whether a locale is set.
         * 
         * @return {boolean} true if locale is set
         */
        isLocaleSet: function() {
            return !!this.__locale;
        },

        /**
         * Sets a locale if not locale is set.
         * 
         * @param {object} locale New weak locale
         */
        setWeakLocale: function(locale) {
            if (!this.isLocaleSet())
                this.setLocale(locale);
        }

    };
});

Scoped.define("module:Classes.LocaleTable", ["module:Classes.StringTable","module:Classes.LocaleMixin"], function (StringTable, LocaleMixin, scoped) {
    return StringTable.extend({
        scoped: scoped
    }, [LocaleMixin,

        /**
         * Locale Table Class
         * 
         * @class BetaJS.Classes.LocaleTable
         */
        {

            _localeTags: function(locale) {
                if (!locale)
                    return null;
                var result = [];
                result.push("language:" + locale);
                if (locale.indexOf("-") > 0)
                    result.push("language:" + locale.substring(0, locale.indexOf("-")));
                return result;
            },

            /**
             * @override 
             */
            _clearLocale: function() {
                this.removeTags(this._localeTags(this.getLocale()));
            },

            /**
             * @override 
             */
            _setLocale: function(locale) {
                this.addTags(this._localeTags(locale));
            }

        }
    ]);
});

Scoped.define("module:Classes.ObjectIdScopeMixin", function () {

    /**
     * Object Id Scope Mixin
     * 
     * @mixin BetaJS.Classes.ObjectIdScopeMixin
     */
    return {

        __objects: {},

        /**
         * Return object for specific id
         * 
         * @param {string} id id of object
         * 
         * @return {object} object in question
         */
        get: function(id) {
            return this.__objects[id];
        }

    };
});

Scoped.define("module:Classes.ObjectIdScope", ["module:Class","module:Classes.ObjectIdScopeMixin"], function (Class, Mixin, scoped) {
    return Class.extend({
        scoped: scoped
    }, Mixin, function(inherited) {

        /**
         * Object Id Scope Class
         * 
         * @class BetaJS.Classes.ObjectIdScope
         */
        return {

            /**
             * Create or return singleton instance of this class.
             * 
             * @return {object} singleton instance
             */
            singleton: function() {
                if (!this.__singleton)
                    this.__singleton = new this();
                return this.__singleton;
            }
        };
    });
});

Scoped.define("module:Classes.ObjectIdMixin", ["module:Classes.ObjectIdScope","module:Objs","module:Ids"], function (ObjectIdScope, Objs, Ids) {

    /**
     * Object Id Mixin
     * 
     * @mixin BetaJS.Classes.ObjectIdMixin
     */
    return {

        _notifications: {
            construct: "__register_object_id",
            destroy: "__unregister_object_id"
        },

        __object_id_scope: function() {
            if (!this.object_id_scope)
                this.object_id_scope = ObjectIdScope.singleton();
            return this.object_id_scope;
        },

        __register_object_id: function() {
            var scope = this.__object_id_scope();
            scope.__objects[this.cid()] = this;
        },

        __unregister_object_id: function() {
            var scope = this.__object_id_scope();
            delete scope.__objects[this.cid()];
        }

    };
});

Scoped.define("module:Lists.ArrayList", ["module:Lists.AbstractList","module:Ids","module:Objs"], function (AbstractList, Ids, Objs, scoped) {
    return AbstractList.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Array List Class
         * 
         * @class BetaJS.Lists.ArrayList
         */
        return {

            /**
             * Creates a new instance.
             * 
             * @param {array} objects optional initial set of objects
             * @param {options} options optional options parameter
             */
            constructor: function(objects, options) {
                this.__idToIndex = {};
                this.__items = [];
                options = options || {};
                if ("compare" in options)
                    this._compare = options.compare;
                if ("get_ident" in options)
                    this._get_ident = options.get_ident;
                inherited.constructor.call(this, objects);
            },

            /**
             * Set current compare function.
             * 
             * @param {function} compare compare function
             */
            set_compare: function(compare) {
                this._compare = compare;
                if (compare)
                    this.sort();
            },

            /**
             * Get current compare function.
             * 
             * @return {function} current compare function
             */
            get_compare: function() {
                return this._compare;
            },

            /**
             * Sort list using a compare function.
             * 
             * @param {function} compare compare function
             */
            sort: function(compare) {
                compare = compare || this._compare;
                if (!compare)
                    return;
                this.__items.sort(compare);
                for (var i = 0; i < this.__items.length; ++i)
                    this.__ident_changed(this.__items[i], i);
                this._sorted();
            },

            _sorted: function() {},

            /**
             * Reindex the index of an item.
             * 
             * @param {int} index index of the item
             * 
             * @return {int} new index of the item
             */
            re_index: function(index) {
                if (!this._compare)
                    return index;
                var last = this.__items.length - 1;
                var object = this.__items[index];
                var i = index;
                while (i < last && this._compare(this.__items[i], this.__items[i + 1]) > 0) {
                    this.__items[i] = this.__items[i + 1];
                    this.__ident_changed(this.__items[i], i);
                    this.__items[i + 1] = object;
                    ++i;
                }
                if (i == index) {
                    while (i > 0 && this._compare(this.__items[i], this.__items[i - 1]) < 0) {
                        this.__items[i] = this.__items[i - 1];
                        this.__ident_changed(this.__items[i], i);
                        this.__items[i - 1] = object;
                        --i;
                    }
                }
                if (i != index) {
                    this.__ident_changed(object, i);
                    this._re_indexed(object);
                }
                return i;
            },

            _re_indexed: function(object) {},

            __objectId: function(object) {
                return this._get_ident ? this._get_ident(object) : Ids.objectId(object);
            },

            /**
             * @override
             */
            _add: function(object) {
                var last = this.__items.length;
                this.__items.push(object);
                var i = this.re_index(last);
                this.__idToIndex[this.__objectId(object)] = i;
                return i;
            },

            /**
             * @override
             */
            _remove: function(ident) {
                var obj = this.__items[ident];
                for (var i = ident + 1; i < this.__items.length; ++i) {
                    this.__items[i - 1] = this.__items[i];
                    this.__ident_changed(this.__items[i - 1], i - 1);
                }
                this.__items.pop();
                delete this.__idToIndex[this.__objectId(obj)];
                return obj;
            },

            /**
             * @override
             */
            _get: function(ident) {
                return this.__items[ident];
            },

            /**
             * @override
             */
            _iterate: function(callback, context) {
                var items = Objs.clone(this.__items, 1);
                for (var i = 0; i < items.length; ++i)
                    callback.apply(context || this, [items[i], this.get_ident(items[i])]);
            },

            __ident_changed: function(object, index) {
                this.__idToIndex[this.__objectId(object)] = index;
                this._ident_changed(object, index);
            },

            /**
             * @override
             */
            get_ident: function(object) {
                var id = this.__objectId(object);
                return id in this.__idToIndex ? this.__idToIndex[id] : null;
            },

            /**
             * Returns the identifier given an id.
             * 
             * @param {string} id id
             * 
             * @return {string} identifier
             */
            ident_by_id: function(id) {
                return this.__idToIndex[id];
            }

        };
    });
});

Scoped.define("module:Iterators.FilteredIterator", ["module:Iterators.Iterator"], function (Iterator, scoped) {
    return Iterator.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * A delegated iterator class, filtering single objects by a function.
         * 
         * @class BetaJS.Iterators.FilteredIterator
         */
        return {

            /**
             * Create a new instance.
             * 
             * @param {object} iterator Source iterator
             * @param {function} filter Filter function
             * @param {object} context Context for the filter function
             */
            constructor: function(iterator, filter, context) {
                inherited.constructor.call(this);
                this.__iterator = iterator;
                this.__filter = filter;
                this.__context = context || this;
                this.__next = null;
            },

            /**
             * @override
             */
            hasNext: function() {
                this.__crawl();
                return this.__next !== null;
            },

            /**
             * @override
             */
            next: function() {
                this.__crawl();
                var item = this.__next;
                this.__next = null;
                return item;
            },

            __crawl: function() {
                while (!this.__next && this.__iterator.hasNext()) {
                    var item = this.__iterator.next();
                    if (this.__filter_func(item))
                        this.__next = item;
                }
            },

            __filter_func: function(item) {
                return this.__filter.apply(this.__context, [item]);
            }

        };
    });
});

Scoped.define("module:Iterators.ObjectValuesIterator", ["module:Iterators.ArrayIterator","module:Objs"], function (ArrayIterator, Objs, scoped) {
    return ArrayIterator.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * ObjectValuesIterator Class
         * 
         * @class BetaJS.Iterators.ObjectValuesIterator
         */
        return {

            /**
             * Creates an Object Values Iterator
             * 
             * @param {object} obj Object to create iterator from
             */
            constructor: function(obj) {
                inherited.constructor.call(this, Objs.values(obj));
            }

        };
    });
});

Scoped.define("module:Collections.Collection", ["module:Class","module:Events.EventsMixin","module:Objs","module:Functions","module:Lists.ArrayList","module:Ids","module:Properties.ObservableMixin","module:Properties.Properties","module:Iterators.ArrayIterator","module:Iterators.FilteredIterator","module:Iterators.ObjectValuesIterator","module:Types","module:Promise"], function (Class, EventsMixin, Objs, Functions, ArrayList, Ids, ObservableMixin, Properties, ArrayIterator, FilteredIterator, ObjectValuesIterator, Types, Promise, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, ObservableMixin, function(inherited) {

        /**
         * A collection class for managing a list of Properties-based objects.
         * 
         * @class BetaJS.Collections.Collection
         */
        return {

            /**
             * Creates an instance.
             * 
             * @param {object} options Options for the collection or an array of initial objects
             */
            constructor: function(options) {
                inherited.constructor.call(this);
                if (Types.is_array(options)) {
                    options = {
                        objects: options
                    };
                }
                options = options || {};
                this.bulk_operations = 0;
                this.__indices = {};
                if (options.release_references)
                    this.__release_references = true;
                var list_options = {};
                if ("compare" in options)
                    list_options.compare = options.compare;
                list_options.get_ident = Functions.as_method(this.get_ident, this);
                this.__data = new ArrayList([], list_options);
                var self = this;
                this.__data._ident_changed = function(object, index) {
                    self._index_changed(object, index);
                };
                this.__data._re_indexed = function(object) {
                    self._re_indexed(object);
                };
                this.__data._sorted = function() {
                    self._sorted();
                };
                if ("objects" in options)
                    this.add_objects(options.objects);
                if (options.indices)
                    Objs.iter(options.indices, this.add_secondary_index, this);
                if (options.uniqueness)
                    this.__uniqueness = options.uniqueness;
            },

            /**
             * Returns the value associated with an observable key.
             *
             * @param {string} key key to read value for
             *
             * @return value for key
             */
            get: function(key) {
                switch (key) {
                    case "observable_count":
                        return this.count();
                }
                return undefined;
            },

            /**
             * Checks whether an observable key is set.
             *
             * @param {string} key key in question
             *
             * @return {boolean} true if key is set
             */
            hasKey: function(key) {
                switch (key) {
                    case "observable_count":
                        return true;
                }
                return false;
            },

            /**
             * Add a secondary key index to the collection.
             * 
             * @param {string} key Name of key to be added
             */
            add_secondary_index: function(key) {
                this.__indices[key] = {};
                this.iterate(function(object) {
                    var value = object.get(key);
                    this.__indices[key][value] = this.__indices[key][value] || {};
                    this.__indices[key][value][this.get_ident(object)] = object;
                }, this);
                return this;
            },

            /**
             * Return entry by value from a secondary index.
             * 
             * @param {string} key Name of secondary index key
             * @param value Value to the secondary index
             * @param {boolean} returnFirst Only return single element
             * 
             * @return Returns entry associated with the key value pair
             */
            get_by_secondary_index: function(key, value, returnFirst) {
                return returnFirst ? Objs.ithValue(this.__indices[key][value]) : this.__indices[key][value];
            },

            /**
             * Get the identifier of an object.
             * 
             * @param {object} obj Source object
             * 
             * @return {string} identifier of source object
             */
            get_ident: function(obj) {
                return Ids.objectId(obj);
            },

            /**
             * Set the comparison function.
             * 
             * @param {function} compare Comparison function
             * @fires BetaJS.Collections.Collection#set_compare
             */
            set_compare: function(compare) {
                /**
                 * @event BetaJS.Collections.Collection#set_compare
                 */
                this.trigger("set_compare", compare);
                this.__data.set_compare(compare);
                return this;
            },

            /**
             * Return the current comparison function.
             * 
             * @return {function} current compare function
             */
            get_compare: function() {
                return this.__data.get_compare();
            },

            __load_item: function(object) {
                if ("on" in object) {
                    object.on("change", function(key, value, oldvalue) {
                        this._object_changed(object, key, value, oldvalue);
                    }, this);
                }
                if (this.__release_references)
                    object.increaseRef(this);
            },

            __unload_item: function(object) {
                if ("off" in object)
                    object.off(null, null, this);
                if (this.__release_references)
                    object.decreaseRef(this);
            },

            /**
             * @override
             * @fires BetaJS.Collections.Collection#destroy
             */
            destroy: function() {
                this.__data.iterate(this.__unload_item, this);
                this.__data.destroy();
                /**
                 * @event BetaJS.Collections.Collection#destroy
                 */
                this.trigger("destroy");
                inherited.destroy.call(this);
            },

            /**
             * Return the number of elements in the collection.
             * 
             * @return {int} number of elements
             */
            count: function() {
                return this.__data.count();
            },

            /**
             * Called when the index of an object has changed.
             * 
             * @param {object} object Object whose index has changed
             * @param {int} index New index
             * @fires BetaJS.Collections.Collection#index
             */
            _index_changed: function(object, index) {
                /**
                 * @event BetaJS.Collections.Collection#index
                 */
                this.trigger("index", object, index);
            },

            /**
             * Called when the index of an object has been successfully updated.
             * 
             * @param {object} object Object whose index has been updated
             * @fires BetaJS.Collections.Collection#reindexed
             */
            _re_indexed: function(object) {
                /**
                 * @event BetaJS.Collections.Collection#reindexed
                 */
                this.trigger("reindexed", object);
            },

            /**
             * Called when the collection has been sorted.
             * 
             * @fires BetaJS.Collections.Collection#sorted
             */
            _sorted: function() {
                /**
                 * @event BetaJS.Collections.Collection#sorted
                 */
                this.trigger("sorted");
            },

            /**
             * Called when an attribute of an object has changed.
             * 
             * @param {object} object Object whose attribute has changed
             * @param {string} key Key of changed attribute
             * @param value New value of the object
             * @param oldValue Old value of the object
             * @fires BetaJS.Collections.Collection#update
             * @fires BetaJS.Collections.Collection#change
             */
            _object_changed: function(object, key, value, oldValue) {
                /**
                 * @event BetaJS.Collections.Collection#update
                 */
                this.trigger("update");
                /**
                 * @event BetaJS.Collections.Collection#change
                 */
                this.trigger("change", object, key, value, oldValue);
                this.trigger("change:" + key, object, value, oldValue);
                this.__data.re_index(this.getIndex(object));
            },

            /**
             * Add an object to the collection.
             * 
             * @param {object} object Object to be added
             * @return {string} Identifier of added object
             * @fires BetaJS.Collections.Collection#add
             * @fires BetaJS.Collections.Collection#update
             */
            add: function(object) {
                if (!Class.is_class_instance(object))
                    object = new Properties(object);
                if (this.exists(object))
                    return null;
                var ident = this.__data.add(object);
                if (ident !== null) {
                    Objs.iter(this.__indices, function(entries, key) {
                        var value = object.get(key);
                        entries[value] = entries[value] || {};
                        entries[value][this.get_ident(object)] = object;
                    }, this);
                    /**
                     * @event BetaJS.Collections.Collection#add
                     */
                    this.trigger("add", object);
                    /**
                     * @event BetaJS.Collections.Collection#update
                     */
                    this.trigger("update");
                    this.trigger("change:observable_count", this.count());
                    this.__load_item(object);
                }
                return ident;
            },

            /**
             * Checks whether a bulk operation is in progress.
             *
             * @returns {boolean} true if in progress
             */
            bulkOperationInProgress: function() {
                return this.bulk_operations > 0;
            },

            /**
             * Replace objects by other objects with the same id.
             * 
             * @param {array} object New objects with ids
             * @param {boolean} keep_others True if objects with ids not included should be kept
             * 
             */
            replace_objects: function(objects, keep_others) {
                this.bulk_operations++;
                var addQueue = [];
                var ids = {};
                Objs.iter(objects, function(oriObject) {
                    var is_prop = Class.is_class_instance(oriObject);
                    var obj = is_prop ? oriObject : new Properties(oriObject);
                    var id = this.get_ident(obj);
                    ids[id] = true;
                    var old = this.getById(id);
                    if (!old)
                        addQueue.push(obj);
                    else if (is_prop) {
                        /*
                        this.remove(old);
                        this.add(obj);
                        */
                    } else {
                        obj.destroy();
                        old.setAll(oriObject);
                    }
                }, this);
                if (!keep_others) {
                    var iterator = this.iterator();
                    while (iterator.hasNext()) {
                        var object = iterator.next();
                        if (!ids[this.get_ident(object)]) {
                            this.remove(object);
                            if (addQueue.length > 0)
                                this.add(addQueue.shift());
                        }
                    }
                    iterator.destroy();
                }
                while (addQueue.length > 0)
                    this.add(addQueue.shift());
                this.bulk_operations--;
                this.trigger("replaced-objects");
                return this;
            },

            /**
             * Add objects in a bulk.
             * 
             * @param {array} objects Objects to be added
             * @param {boolean} return_collection Whether the return value should be the collection or its length
             * @return {int} Number of objects added
             */
            add_objects: function(objects, return_collection) {
                var count = 0;
                Objs.iter(objects, function(object) {
                    if (this.add(object))
                        count++;
                }, this);
                if (return_collection)
                    return this;
                else
                    return count;
            },

            /**
             * Determine whether an object is already included.
             * 
             * @param {object} object Object in question
             * @return {boolean} True if contained
             */
            exists: function(object) {
                if (this.__data.exists(object))
                    return true;
                if (!this.__uniqueness)
                    return false;
                if (this.__indices[this.__uniqueness])
                    return !!this.get_by_secondary_index(this.__uniqueness, object.get(this.__uniqueness), true);
                return !!this.queryOne(Objs.objectBy(this.__uniqueness, object.get(this.__uniqueness)));
            },

            /**
             * Remove an object from the collection.
             * 
             * @param {object} object Object to be removed
             * @return {object} Removed object
             * @fires BetaJS.Collections.Collection#remove
             * @fires BetaJS.Collections.Collection#update
             */
            remove: function(object) {
                if (!this.exists(object))
                    return null;
                Objs.iter(this.__indices, function(entry, key) {
                    var value = object.get(key);
                    if (entry[value]) {
                        delete entry[value][this.get_ident(object)];
                        if (Types.is_empty(entry[value]))
                            delete entry[value];
                    }
                }, this);
                var result = this.__data.remove(object);
                /**
                 * @event BetaJS.Collections.Collection#remove
                 */
                this.trigger("remove", object);
                this.trigger("change:observable_count", this.count());
                this.__unload_item(object);
                /**
                 * @event BetaJS.Collections.Collection#update
                 */
                this.trigger("update");
                return result;
            },

            /**
             * Get an object by index.
             * 
             * @param {int} index Index to be returned
             * @return {object} Object at that index
             */
            getByIndex: function(index) {
                return this.__data.get(index);
            },

            /**
             * Get an object by identifier.
             * 
             * @param {string} id Identifier of object
             * @return {object} Object with that identifier
             */
            getById: function(id) {
                return this.__data.get(this.__data.ident_by_id(id));
            },

            /**
             * Get the index of an object.
             * 
             * @param {object} object Object in question
             * @return {int} Index of object
             */
            getIndex: function(object) {
                return this.__data.get_ident(object);
            },

            /**
             * Iterate over the collection.
             * 
             * @param {function} cb Item callback
             * @param {object} context Context for callback
             * 
             */
            iterate: function(cb, context) {
                this.__data.iterate(cb, context);
                return this;
            },

            /**
             * Checks whether an item exists
             *
             * @param {function} cb Item callback
             * @param {object} context Context for callback
             * @returns {boolean} true if element exists
             *
             */
            has: function(cb, context) {
                var result = false;
                this.iterate(function(item) {
                    result = result || cb.call(this, item);
                }, context);
                return result;
            },

            /**
             * Checks whether something holds for all items
             *
             * @param {function} cb Item callback
             * @param {object} context Context for callback
             * @returns {boolean} true if holds for all items
             *
             */
            forall: function(cb, context) {
                var result = true;
                this.iterate(function(item) {
                    result = result && cb.call(this, item);
                }, context);
                return result;
            },

            /**
             * Creates an iterator instance for the collection.
             * 
             * @return {object} Iterator instance
             */
            iterator: function() {
                return ArrayIterator.byIterate(this.iterate, this);
            },

            /**
             * Creates an iterator instance via a secondary index for a specific value.
             * 
             * @param {string} key Key of secondary index
             * @param value Particular value
             * @return {object} Iterator instance
             */
            iterateSecondaryIndexValue: function(key, value) {
                return new ObjectValuesIterator(this.__indices[key][value]);
            },

            /**
             * Query the collection for items matching some query data.
             * 
             * @param {object} subset Query data to be matched.
             * @return {object} Iterator instance
             */
            query: function(subset) {
                var iterator = null;
                for (var index_key in this.__indices) {
                    if (index_key in subset) {
                        iterator = this.iterateSecondaryIndexValue(index_key, subset[index_key]);
                        break;
                    }
                }
                return new FilteredIterator(iterator || this.iterator(), function(prop) {
                    return prop.isSupersetOf(subset);
                });
            },

            /**
             * Query the collection for a single item matching some query data.
             *
             * @param {object} subset Query data to be matched.
             * @return {object} Item match
             */
            queryOne: function(subset) {
                return this.query(subset).next();
            },

            /**
             * Clears the whole collection.
             * 
             */
            clear: function() {
                this.iterate(function(obj) {
                    this.remove(obj);
                }, this);
                return this;
            },

            /**
             * Increase the view of the collection by a number of steps.
             * 
             * @param {int} steps Steps to increase
             */
            increase_forwards: function(steps) {
                return Promise.error(true);
            },

            /**
             * Increase the view of the collection by a number of steps backwards.
             *
             * @param {int} steps Steps to increase
             */
            increase_backwards: function(steps) {
                return Promise.error(true);
            },

            /**
             * Returns the first item in the collection.
             *
             * @returns {Object} first item
             */
            first: function() {
                return this.getByIndex(0);
            },

            /**
             * Returns the last item in the collection
             *
             * @returns {Object} last item
             */
            last: function() {
                return this.getByIndex(this.count() - 1);
            },

            /**
             * Sets a key value pair in all items
             *
             * @param {string} key key of pair
             * @param value value of pair
             *
             * @returns {BetaJS.Collections.Collection}
             */
            allSet: function(key, value) {
                this.iterate(function(obj) {
                    obj.set(key, value);
                });
                return this;
            },

            /**
             * Sets a set of key-value pairs in all items
             *
             * @param {object} data key-value pair to be set
             *
             * @returns {BetaJS.Collections.Collection}
             */
            allSetAll: function(data) {
                this.iterate(function(obj) {
                    obj.setAll(data);
                });
                return this;
            }

        };
    }]);
});

Scoped.define("module:Events.Events", ["module:Class","module:Events.EventsMixin"], function (Class, Mixin, scoped) {
    /**
     * Events Class
     * 
     * @class BetaJS.Events.Events
     * @implements BetaJS.Events.EventsMixin
     */
    return Class.extend({
        scoped: scoped
    }, Mixin);
});

Scoped.define("module:Trees.TreeNavigator", function () {

    /**
     * Abstract Tree Navigator Mixin
     * 
     * @mixin BetaJS.Trees.TreeNavigator
     */
    return {

        /**
         * Returns the root node of a tree.
         * 
         * @return {object} Root node
         */
        nodeRoot: function() {},

        /**
         * Retrusns the id of a node.
         * 
         * @param {object} node Node
         * @return {string} Id of node
         */
        nodeId: function(node) {},

        /**
         * Returns the parent of a node.
         * 
         * @param {object} node Node
         * @return {object} Parent node
         */
        nodeParent: function(node) {},

        /**
         * Returns the children of a node.
         * 
         * @param {object} node Node
         * @return {array} Children of the node
         */
        nodeChildren: function(node) {},

        /**
         * Watches a node for changes.
         * 
         * @param {object} node Node
         * @param {function} func Change callback function
         * @param {object} context Optional change callback context
         */
        nodeWatch: function(node, func, context) {},

        /**
         * Unwatches a node for changes.
         * 
         * @param {object} node Node
         * @param {function} func Change callback function
         * @param {object} context Optional change callback context
         */
        nodeUnwatch: function(node, func, context) {},

        /**
         * Returns the data associated with a node.
         * 
         * @param {object} node Node
         * @return {object} Node data
         */
        nodeData: function(node) {}

    };
});

Scoped.define("module:Parser.LexerException", ["module:Exceptions.Exception"], function (Exception, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {
        /**
         * Lexer Exception Class
         * 
         * @class BetaJS.Parser.LexerException
         */
        return {

            /**
             * Instantiates a Lexer Exception
             * 
             * @param {string} head head string that has been parsed
             * @param {string} tail tail string that is not parsed yet
             * 
             */
            constructor: function(head, tail) {
                inherited.constructor.call(this, "Lexer error: Unrecognized identifier at " + head.length + ".");
                this.__head = head;
                this.__tail = tail;
            }

        };
    });
});

Scoped.define("module:Parser.Lexer", ["module:Class","module:Types","module:Objs","module:Parser.LexerException"], function (Class, Types, Objs, LexerException, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Simple Lexer Class for Parsing Strings
         * 
         * @class BetaJS.Parser.Lexer
         */
        return {

            /**
             * Instantiates a Lexer
             * 
             * @param {object} patterns a mapping from regular expressions to token identifiers or value preservers
             */
            constructor: function(patterns) {
                inherited.constructor.call(this);
                this.__patterns = [];
                Objs.iter(patterns, function(value, key) {
                    this.__patterns.push({
                        regex: new RegExp("^" + key, "m"),
                        data: Types.is_string(value) ? {
                            token: value
                        } : value
                    });
                }, this);
            },

            /**
             * Lexes a string w.r.t. the initialised patterns.
             * 
             * @param {string} source source string
             * @return {array} array of parsed tokens
             */
            lex: function(source) {
                var result = [];
                var head = "";
                var tail = source;
                while (tail) {
                    var match = null;
                    var data = null;
                    for (var i = 0; i < this.__patterns.length; ++i) {
                        match = this.__patterns[i].regex.exec(tail);
                        if (match) {
                            data = Objs.clone(this.__patterns[i].data, 1);
                            break;
                        }
                    }
                    if (!match)
                        throw new LexerException(head, tail);
                    head += match[0];
                    tail = tail.substring(match[0].length);
                    if (!data)
                        continue;
                    for (var key in data) {
                        if (Types.is_string(data[key])) {
                            for (var j = 0; j < match.length; ++j)
                                data[key] = data[key].replace("$" + j, match[j]);
                        }
                    }
                    result.push(data);
                }
                return result;
            }

        };
    });
});

Scoped.define("module:Trees.TreeQueryObject", ["module:Class","module:Events.EventsMixin","module:Objs","module:Types"], function (Class, EventsMixin, Objs, Types, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {

        /**
         * Object representing a tree query on a node
         *
         * @class BetaJS.Trees.TreeQueryObject
         */
        return {

            /**
             * Create new instance.
             * 
             * @param {object} navigator Navigator object
             * @param {object} node Node of the query
             * @param {object} query Lexed query
             */
            constructor: function(navigator, node, query) {
                inherited.constructor.call(this);
                this.__navigator = navigator;
                this.__node = node;
                this.__query = query;
                this.__result = {};
                this.__partials = {};
                this.__ids = 0;
                this.__register(node, 0, {});
            },

            /**
             * @override
             */
            destroy: function() {
                Objs.iter(this.__partials, function(partials) {
                    Objs.iter(partials.partials, function(partial) {
                        this.__navigator.nodeUnwatch(partials.node, null, partial);
                    }, this);
                }, this);
                inherited.destroy.call(this);
            },

            /**
             * Returns the currently matching nodes.
             * 
             * @return {array} Matching nodes.
             */
            result: function() {
                var result = [];
                Objs.iter(this.__result, function(value) {
                    result.push(value.node);
                });
                return result;
            },

            __register: function(node, index) {
                var node_id = this.__navigator.nodeId(node);
                if (!this.__partials[node_id]) {
                    this.__partials[node_id] = {
                        node: node,
                        partials: {}
                    };
                }
                var partials = this.__partials[node_id];
                this.__ids++;
                var partial = {
                    owner: partials,
                    id: this.__ids,
                    query_index_start: index,
                    query_index_next: index,
                    query_index_last: index,
                    partial_match: false,
                    partial_final: index >= this.__query.length,
                    partial_data: false,
                    partial_children: false,
                    partial_parent: false,
                    partial_star: false,
                    parent: null,
                    deps: {}
                };
                partials.partials[partial.id] = partial;
                for (var i = partial.query_index_start; i < this.__query.length; ++i) {
                    if (this.__query[i].token == "Selector")
                        partial.partial_data = true;
                    else {
                        if (this.__query[i].token == "Up")
                            partial.partial_parent = true;
                        else if (this.__query[i].token == "Down")
                            partial.partial_children = true;
                        partial.partial_star = !this.__query[i].single;
                        if (!partial.partial_star)
                            partial.query_index_next = i + 1;
                        break;
                    }
                    partial.query_index_next = i + 1;
                    partial.partial_final = i + 1 == this.__query.length;
                }
                partial.query_index_last = partial.partial_star ? partial.query_index_next + 1 : partial.query_index_next;
                var self = this;
                this.__navigator.nodeWatch(node, function(action, node) {
                    if (action == "data" && partial.partial_data)
                        self.__update(partial);
                    if (action == "remove")
                        self.__unregisterPartial(partial);
                    if (action == "addChild" && partial.partial_children && partial.partial_match)
                        self.__addDependentPartial(partial, node);
                }, partial);
                this.__update(partial);
                return partial;
            },

            __unregisterPartial: function(partial) {
                var owner = partial.owner;
                var node = owner.node;
                var node_id = this.__navigator.nodeId(node);
                if (partial.partial_final && this.__result[node_id]) {
                    this.__result[node_id].count--;
                    if (this.__result[node_id].count <= 0) {
                        delete this.__result[node_id];
                        /**
                         * @event BetaJS.Trees.TreeQueryObject#remove
                         */
                        this.trigger("remove", node);
                        /**
                         * @event BetaJS.Trees.TreeQueryObject#change
                         */
                        this.trigger("change");
                    }
                }
                Objs.iter(partial.deps, this.__unregisterPartial, this);
                if (partial.parent)
                    delete partial.parent.deps[partial.id];
                this.__navigator.nodeUnwatch(node, null, partial);
                delete owner.partials[partial.id];
                if (Types.is_empty(owner.partials))
                    delete this.__partials[node_id];
            },

            __addDependentPartial: function(partial, node) {
                var partials = [];
                partials.push(this.__register(node, partial.query_index_next));
                if (partial.partial_star)
                    partials.push(this.__register(node, partial.query_index_next + 1));
                Objs.iter(partials, function(p) {
                    partial.deps[p.id] = p;
                    p.parent = partial;
                }, this);
            },

            __update: function(partial) {
                var matching = true;
                var node = partial.owner.node;
                var node_id = this.__navigator.nodeId(node);
                var node_data = this.__navigator.nodeData(node);
                for (var i = partial.query_index_start; i < partial.query_index_last; ++i) {
                    var q = this.__query[i];
                    if (q.token != "Selector")
                        break;
                    if (node_data[q.key] != q.value) {
                        matching = false;
                        break;
                    }
                }
                if (matching == partial.partial_match)
                    return;
                partial.partial_match = matching;
                if (matching) {
                    if (partial.partial_final) {
                        if (!this.__result[node_id]) {
                            this.__result[node_id] = {
                                node: node,
                                count: 1
                            };
                            /**
                             * @event BetaJS.Trees.TreeQueryObject#add
                             */
                            this.trigger("add", node);
                            /**
                             * @event BetaJS.Trees.TreeQueryObject#change
                             */
                            this.trigger("change");
                        } else
                            this.__result[node_id].count++;
                    } else if (partial.partial_parent) {
                        var parent = this.__navigator.nodeParent(node);
                        if (parent)
                            this.__addDependentPartial(partial, parent);
                    } else if (partial.partial_children) {
                        Objs.iter(this.__navigator.nodeChildren(node), function(child) {
                            this.__addDependentPartial(partial, child);
                        }, this);
                    }
                } else {
                    if (partial.partial_final) {
                        this.__result[node_id].count--;
                        if (this.__result[node_id].count <= 0) {
                            delete this.__result[node_id];
                            /**
                             * @event BetaJS.Trees.TreeQueryObject#remove
                             */
                            this.trigger("remove", node);
                            /**
                             * @event BetaJS.Trees.TreeQueryObject#change
                             */
                            this.trigger("change");
                        }
                    }
                    Objs.iter(partial.deps, this.__unregisterPartial, this);
                }
            }
        };
    }]);
});

Scoped.define("module:Trees.TreeQueryEngine", ["module:Class","module:Parser.Lexer","module:Trees.TreeQueryObject"], function (Class, Lexer, TreeQueryObject, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Tree Query Engine Class
         * 
         * @class BetaJS.Trees.TreeQueryEngine
         */
        return {

            /**
             * Create a new instance.
             * 
             * @param {object} navigator Navigator instance
             */
            constructor: function(navigator) {
                inherited.constructor.call(this);
                this.__navigator = navigator;
                this.__lexer = this._auto_destroy(new Lexer({
                    "<\\+": {
                        token: "Up"
                    },
                    "<": {
                        token: "Up",
                        single: true
                    },
                    ">\\+": {
                        token: "Down"
                    },
                    ">": {
                        token: "Down",
                        single: true
                    },
                    "\\[\s*([a-zA-Z]+)\s*=\s*\'([^']*)\'\s*\\]": {
                        token: "Selector",
                        key: "$1",
                        value: "$2"
                    },
                    "\\[\s*([a-zA-Z]+)\s*=\s*\"([^']*)\"\s*\\]": {
                        token: "Selector",
                        key: "$1",
                        value: "$2"
                    },
                    "\s": null
                }));
            },

            /**
             * Query the tree.
             * 
             * @param {object} node Node to start the query from
             * @param {string} query Query string
             * 
             * @return {object} Tree query object for the query
             */
            query: function(node, query) {
                return new TreeQueryObject(this.__navigator, node, this.__lexer.lex(query));
            }

        };
    });
});

Scoped.define("module:JavaScript", ["module:Objs"], function (Objs) {
    /**
     * JavaScript Simple Parse Functions
     * 
     * @module BetaJS.JavaScript
     */
    return {

        STRING_SINGLE_QUOTATION_REGEX: /'[^']*'/g,
        STRING_DOUBLE_QUOTATION_REGEX: /"[^"]*"/g,

        PROPER_IDENTIFIER_REGEX: /^[a-zA-Z_][a-zA-Z_0-9]*$/,
        IDENTIFIER_REGEX: /[a-zA-Z_][a-zA-Z_0-9]*/g,
        IDENTIFIER_SCOPE_REGEX: /[a-zA-Z_][a-zA-Z_0-9\.]*/g,

        RESERVED: Objs.objectify([
            "if", "then", "else", "return", "var"
        ], true),

        /**
         * Is string a JS-reserved keyword?
         * 
         * @param {string} key string in question
         * @return {boolean} true if reserved
         */
        isReserved: function(key) {
            return key in this.RESERVED;
        },

        /**
         * Is string a valid JS identifier?
         * 
         * @param {string} key string in question
         * @return {boolean} true if identifier
         */
        isIdentifier: function(key) {
            return !this.isReserved(key);
        },

        /**
         * Is string a valid proper JS identifier?
         * 
         * @param {string} key string in question
         * @return {boolean} true if identifier
         */
        isProperIdentifier: function(key) {
            return this.isIdentifier(key) && this.PROPER_IDENTIFIER_REGEX.test(key);
        },

        /**
         * Remove string definitions from JS code.
         * 
         * @param {string} code input code
         * @return {string} code without strings
         */
        removeStrings: function(code) {
            return code.replace(this.STRING_SINGLE_QUOTATION_REGEX, "").replace(this.STRING_DOUBLE_QUOTATION_REGEX, "");
        },

        /**
         * Return JS identifiers from a piece of code.
         * 
         * @param {string} code input code
         * @param {boolean} keepScopes keep scopes, e.g. `foo.bar` instead of `foo` and `bar` (default: false)
         * @return {array} array of extracted identifiers
         */
        extractIdentifiers: function(code, keepScopes) {
            var regex = keepScopes ? this.IDENTIFIER_SCOPE_REGEX : this.IDENTIFIER_REGEX;
            code = this.removeStrings(code);
            return Objs.filter(code.match(regex), this.isIdentifier, this);
        }

    };

});

Scoped.define("module:Classes.SharedObjectFactory", ["module:Class"], function (Class, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Shared Object Factory Class
         *
         * @class BetaJS.Classes.SharedObjectFactory
         */
        return {

            /**
             * Creates a new factory.
             *
             * @param {function} createCallback callback function for creating an instance
             * @param {object} createContext optional callback context
             */
            constructor: function(createCallback, createContext, createArgs) {
                inherited.constructor.call(this);
                this.__createCallback = createCallback;
                this.__createContext = createContext;
                this.__createArgs = createArgs || [];
                this.__object = null;
            },

            /**
             * @override
             */
            destroy: function() {
                if (this.__object && !this.__object.destroyed())
                    this.__object.destroy();
                inherited.destroy.call(this);
            },

            /**
             * Return object instance.
             *
             * @returns {object} shared object instance
             */
            value: function() {
                return this.__object && !this.__object.destroyed() ? this.__object : null;
            },

            /**
             * Return true if acquired.
             *
             * @returns {boolean} true if acquired
             */
            isAcquired: function() {
                return !!this.value();
            },

            /**
             * Acquire object instance.
             *
             * @param {object} reference optional reference
             *
             * @returns {object} shared object instance
             */
            acquire: function(reference) {
                if (!this.__object || this.__object.destroyed())
                    this.__object = this.__createCallback.apply(this.__createContext || this, this.__createArgs);
                this.__object.increaseRef(reference);
                return this.__object;
            },

            /**
             * Release object instance.
             *
             * @param {object} obj object instance
             * @param {object} reference optional reference
             */
            release: function(obj, reference) {
                if (obj && obj === this.__object && !obj.destroyed())
                    obj.decreaseRef(obj);
            }

        };
    });
});

Scoped.define("module:Classes.ClassRegistry", ["module:Class","module:Types","module:Functions","module:Objs"], function (Class, Types, Functions, Objs, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Class Registry Class
         * 
         * @class BetaJS.Classes.ClassRegistry
         */
        return {

            /**
             * Creates an instance.
             * 
             * @param {array} classes Class maps in an array
             * @param {boolean} lowercase Should all keys be lowercased
             */
            constructor: function(classes, lowercase) {
                inherited.constructor.call(this);
                this._classes = Types.is_array(classes) ? classes : [classes || {}];
                this._lowercase = lowercase;
            },

            /**
             * Sanitizes the key of a class.
             * 
             * @param {string} key Key to be sanitized
             * 
             * @return {string} Sanitized key
             */
            _sanitize: function(key) {
                return this._lowercase ? key.toLowerCase() : key;
            },

            /**
             * Register a class.
             * 
             * @param {string} key Key of class
             * @param {object} cls Class to be registered
             * 
             */
            register: function(key, cls) {
                this._classes[this._classes.length - 1][this._sanitize(key)] = cls;
                return this;
            },

            /**
             * Return a class by key.
             * 
             * @param {string} key Key of class
             * 
             * @return {object} Class referenced by key
             */
            get: function(key) {
                if (!Types.is_string(key))
                    return key;
                key = this._sanitize(key);
                for (var i = this._classes.length - 1; i >= 0; --i)
                    if (key in this._classes[i])
                        return this._classes[i][key];
                return null;
            },

            /**
             * Creates a new class based on its key.
             * 
             * @param {string} key Key of class
             * 
             * @return {object} Class instance
             */
            create: function(key) {
                var cons = Functions.newClassFunc(this.get(key));
                return cons.apply(this, Functions.getArguments(arguments, 1));
            },

            /**
             * Returns all classes as key-object map.
             * 
             * @return {object} Key-object map.
             */
            classes: function() {
                var result = {};
                Objs.iter(this._classes, function(classes) {
                    result = Objs.extend(result, classes);
                });
                return result;
            }

        };
    });
});

Scoped.define("module:Exceptions.ExceptionThrower", ["module:Class"], function (Class, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        /**
         * Abstract Exception Thrower Class
         * 
         * @class BetaJS.Exceptions.ExceptionThrower
         */
        return {

            /**
             * Throws an exception.
             * 
             * @param {exception} e exception to be thrown
             */
            throwException: function(e) {
                this._throwException(e);
                return this;
            },

            _throwException: function(e) {
                throw e;
            }

        };
    });
});

Scoped.define("module:Exceptions.AsyncExceptionThrower", ["module:Exceptions.ExceptionThrower","module:Async"], function (ExceptionThrower, Async, scoped) {
    return ExceptionThrower.extend({
        scoped: scoped
    }, function(inherited) {
        /**
         * Throws an exception asynchronously.
         * 
         * @class BetaJS.Exceptions.AsyncExceptionThrower
         */
        return {

            /**
             * @override
             */
            _throwException: function(e) {
                Async.eventually(function() {
                    throw e;
                });
            }

        };
    });
});

Scoped.define("module:Loggers.Logger", ["module:Class","module:Objs","module:Functions"], function (Class, Objs, Functions, scoped) {
    var Cls = Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Logger Class
         * 
         * @class BetaJS.Loggers.Logger
         */
        return {

            /**
             * Creates a new instance.
             * 
             * @param {object} options options for the logger
             */
            constructor: function(options) {
                inherited.constructor.call(this);
                options = options || {};
                this.__listeners = {};
                this.__augments = {};
                this.__tags = options.tags || [];
                Objs.iter(options.listeners, this.addListener, this);
            },

            /**
             * Adds a new augment to the logger.
             * 
             * @param {object} augment augment to be added
             */
            addAugment: function(augment) {
                this.__augments[augment.cid()] = augment;
                return this;
            },

            /**
             * Remove an existing augment from the logger.
             * 
             * @param {object} augment augment to be removed
             */
            removeAugment: function(augment) {
                delete this.__augments[augment.cid()];
                return this;
            },

            /**
             * Adds a new listener to the logger.
             * 
             * @param {object} listener listener to be added
             */
            addListener: function(listener) {
                this.__listeners[listener.cid()] = listener;
                return this;
            },

            /**
             * Remove an existing listener from the logger.
             * 
             * @param {object} listener listener to be removed
             */
            removeListener: function(listener) {
                delete this.__listeners[listener.cid()];
                return this;
            },

            /**
             * Create a new log message.
             */
            log: function() {
                return this.message(this, {
                    type: "log",
                    args: Functions.getArguments(arguments, 0)
                });
            },

            /**
             * Creates a log function calling the logger.
             */
            logf: function() {
                return Functions.as_method(this.log, this);
            },

            /**
             * Create a new warn message.
             */
            warn: function() {
                return this.message(this, {
                    type: "warn",
                    args: Functions.getArguments(arguments, 0)
                });
            },

            /**
             * Create a new error message.
             */
            error: function() {
                return this.message(this, {
                    type: "error",
                    args: Functions.getArguments(arguments, 0)
                });
            },

            /**
             * Create a new tagged log message.
             * 
             * @param {array} tags tags for the message
             */
            taggedlog: function(tags) {
                return this.message(this, {
                    type: "log",
                    tags: tags,
                    args: Functions.getArguments(arguments, 1)
                });
            },

            /**
             * Create a new tagged warn message.
             * 
             * @param {array} tags tags for the message
             */
            taggedwarn: function(tags) {
                return this.message(this, {
                    type: "warn",
                    tags: tags,
                    args: Functions.getArguments(arguments, 1)
                });
            },

            /**
             * Create a new tagged error message.
             * 
             * @param {array} tags tags for the message
             */
            taggederror: function(tags) {
                return this.message(this, {
                    type: "error",
                    tags: tags,
                    args: Functions.getArguments(arguments, 1)
                });
            },

            /**
             * Create a new log message.
             * 
             * @param {object} source logger source for message
             * @param {object} msg log message
             * @param {int} depth call depth (internal use)
             */
            message: function(source, msg, depth) {
                depth = depth || 0;
                msg.tags = this.__tags.concat(msg.tags || []);
                msg.augments = msg.augments || [];
                Objs.iter(this.__augments, function(augment) {
                    msg.augments.push(augment.augmentMessage(source, msg, depth));
                }, this);
                Objs.iter(this.__listeners, function(listener) {
                    listener.message(this, msg, depth + 1);
                }, this);
                return this;
            },

            /**
             * Create a new sub logger by tags.
             *
             * @return {object} sub logger
             */
            tag: function() {
                return new Cls({
                    tags: Functions.getArguments(arguments),
                    listeners: [this]
                });
            }

        };
    }, {

        /**
         * Return global singleton logger instance.
         * 
         * @return {object} singleton logger
         */
        global: function() {
            if (!this.__global)
                this.__global = new Cls();
            return this.__global;
        }

    });

    return Cls;
});

Scoped.define("module:Loggers.LoggableMixin", ["module:Loggers.Logger","module:Objs","module:Functions"], function (Logger) {

    /**
     * LoggableMixin Mixin
     *
     * @mixin BetaJS.Loggers.LoggableMixin
     */
    return {

        /**
         * Returns the base logger.
         *
         * @returns {object} base logger
         */
        baseLogger: function() {
            if (!this._baseLogger)
                this._baseLogger = Logger.global();
            return this._baseLogger;
        },

        /**
         * Returns the logger.
         *
         * @returns {object} logger
         */
        logger: function() {
            if (!this._logger)
                this._logger = this.baseLogger().tag(this.cls.classname, this.cid());
            return this._logger;
        }

    };
});

Scoped.define("module:TimeFormat", ["module:Time","module:Strings","module:Objs"], function (Time, Strings, Objs) {
    /**
     * Module for formatting Time / Date
     * 
     * @module BetaJS.TimeFormat
     */
    return {

        /*
        	HH	Hours; leading zero for single-digit hours (24-hour clock).
        	H	Hours; no leading zero for single-digit hours (24-hour clock).
        	h+  Hours; hours as absolute number
        	hh	Hours; leading zero for single-digit hours (12-hour clock).
        	h	Hours; no leading zero for single-digit hours (12-hour clock).
        	M+  Minutes; minutes as absolute number
        	MM	Minutes; leading zero for single-digit minutes.
        	M	Minutes; no leading zero for single-digit minutes.
        	s+	Seconds; seconds as absolute number
        	ss	Seconds; leading zero for single-digit seconds.
        	s	Seconds; no leading zero for single-digit seconds.
        	mmm	Month as a three-letter abbreviation.
        	mm	Month as digits; leading zero for single-digit months.
        	m	Month as digits; no leading zero for single-digit months.
        	d+	Days; days as absolute number
        	ddddDay of the week as string.
        	ddd	Day of the week as a three-letter abbreviation.
        	dd	Day of the month as digits; leading zero for single-digit days.
        	d	Day of the month as digits; no leading zero for single-digit days.
        	yy	Year as last two digits; leading zero for years less than 10.
        	yyyyYear represented by four digits.
        	l+  Milliseconds; absolute
        	l   Milliseconds 3 digits
        	L   Milliseconds 2 digits
        	t	Lowercase, single-character time marker string: a or p.
        	tt	Lowercase, two-character time marker string: am or pm.
        	T	Uppercase, single-character time marker string: A or P.
        	TT	Uppercase, two-character time marker string: AM or PM.
        	o	GMT/UTC timezone offset, e.g. -0500 or +0230.
        	
        */

        formatMappings: {
            "HH": function(t) {
                return Strings.padZeros(Time.timeModulo(t, "hour", "floor"), 2);
            },
            "H": function(t) {
                return Time.timeModulo(t, "hour", "floor");
            },
            "h+": function(t) {
                return Time.timeComponent(t, "hour", "floor");
            },
            "hh": function(t) {
                var h = Time.timeModulo(t, "hour", "floor");
                h = h === 0 ? 12 : (h > 12 ? h - 12 : h);
                return Strings.padZeros(h, " ", 2);
            },
            "h": function(t) {
                var h = Time.timeModulo(t, "hour", "floor");
                h = h === 0 ? 12 : (h > 12 ? h - 12 : h);
                return h;
            },
            "M+": function(t) {
                return Time.timeComponent(t, "minute", "floor");
            },
            "MM": function(t) {
                return Strings.padZeros(Time.timeModulo(t, "minute", "floor"), 2);
            },
            "M": function(t) {
                return Time.timeModulo(t, "minute", "floor");
            },
            "s+": function(t) {
                return Time.timeComponent(t, "second", "floor");
            },
            "ss": function(t) {
                return Strings.padZeros(Time.timeModulo(t, "second", "floor"), 2);
            },
            "s": function(t) {
                return Time.timeModulo(t, "second", "floor");
            },
            "mmm": function(t) {
                return ((new Date(t)).toUTCString().split(" "))[2];
            },
            "mm": function(t) {
                return Strings.padZeros(Time.timeComponentGet(t, "month") + 1, 2);
            },
            "m": function(t) {
                return Time.timeComponentGet(t, "month") + 1;
            },
            "d+": function(t) {
                return Time.timeComponent(t, "day", "floor");
            },
            "dddd": function(t) {
                var map = {
                    2: "s",
                    3: "nes",
                    4: "rs",
                    6: "ur"
                };
                return (new Date(t)).toUTCString().substring(0, 3) + (map[Time.timeComponentGet(t, "weekday")] || "") + "day";
            },
            "ddd": function(t) {
                return (new Date(t)).toUTCString().substring(0, 3);
            },
            "dd": function(t) {
                return Strings.padZeros(Time.timeComponentGet(t, "day") + 1, 2);
            },
            "d": function(t) {
                return Time.timeComponentGet(t, "day") + 1;
            },
            "yyyy": function(t) {
                return Time.timeComponentGet(t, "year");
            },
            "yy": function(t) {
                return Time.timeComponentGet(t, "year") % 100;
            },
            "l+": function(t) {
                return t.getTime();
            },
            "l": function(t) {
                return Time.timeComponentGet(t, "millisecond");
            },
            "L": function(t) {
                return Math.floor(Time.timeComponentGet(t, "millisecond") / 10);
            },
            "tt": function(t) {
                return Time.timeModulo(t, "hour", "floor") < 12 ? 'am' : 'pm';
            },
            "t": function(t) {
                return Time.timeModulo(t, "hour", "floor") < 12 ? 'a' : 'p';
            },
            "TT": function(t) {
                return Time.timeModulo(t, "hour", "floor") < 12 ? 'AM' : 'PM';
            },
            "T": function(t) {
                return Time.timeModulo(t, "hour", "floor") < 12 ? 'A' : 'P';
            },
            "o": function(t, bias) {
                bias = Math.floor(bias / 1000 / 60);
                return (bias > 0 ? "-" : "+") + Strings.padZeros(Math.floor(Math.abs(bias) / 60) * 100 + Math.abs(bias) % 60, 4);
            }

        },

        ELAPSED_HOURS_MINUTES_SECONDS: "h+:MM:ss",
        ELAPSED_MINUTES_SECONDS: "M+:ss",
        FULL_YEAR: "yyyy",
        LETTER_MONTH: "mmm",
        LETTER_MONTH_AND_DAY: "mmm d",
        WEEKDAY: "ddd",
        HOURS_MINUTES_TT: "hh:MM tt",


        /**
         * Format a given time w.r.t. a given time format
         * 
         * @param {string} timeFormat a time format string
         * @param {int} time time as integer to be formatted
         * @param {int} timezone timezone bias (optional)
         * @return {string} formatted time
         * 
         */
        format: function(timeFormat, time, timezone) {
            time = time || Time.now();
            var timezoneTime = Time.timeToTimezoneBasedDate(time, timezone);
            var bias = Time.timezoneBias(timezone);
            var result = timeFormat;
            var replacers = [];
            Objs.iter(this.formatMappings, function(formatter, key) {
                if (result.indexOf(key) >= 0) {
                    var i = replacers.length;
                    replacers.push(formatter(timezoneTime, bias));
                    result = result.replace(key, "$" + i + "$");
                }
            }, this);
            for (var i = 0; i < replacers.length; ++i)
                result = result.replace("$" + i + "$", replacers[i]);
            return result;
        },

        /**
         * Format the month as a three letter string
         * 
         * @param {int} month month as an int
         * @return {string} three letter month string
         */
        monthString: function(month) {
            return this.format("mmm", Time.encodePeriod({
                month: month
            }));
        },

        /**
         * Format the weekday as a three letter string
         * 
         * @param {int} weekday weekday as an int
         * @return {string} three letter weekday string
         */
        weekdayString: function(weekday) {
            return this.format("ddd", Time.encodePeriod({
                weekday: weekday
            }));
        },

        /**
         * Returns the week number
         *
         * @param {int} time time
         * @param {int} timezone timezone
         * @return {int} number of the week in a year
         */
        weekNumber: function(time, timezone) {
            var base = new Date(time + Time.timezoneBias(timezone));
            var d = new Date(Date.UTC(base.getFullYear(), base.getMonth(), base.getDate()));
            var dayNum = d.getUTCDay() || 7;
            d.setUTCDate(d.getUTCDate() + 4 - dayNum);
            var yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
            return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
        },

        /**
         * Format most significant part of date / time relative to current time
         * 
         * @param {int} time date/time to be formatted
         * @param {int} currentTime relative to current time (optional)
         * @param {int} timezone time zone bias (optional)
         * @return {string} formatted time
         */
        formatRelativeMostSignificant: function(time, currentTime, timezone) {
            currentTime = currentTime || Time.now();
            var t = Time.decodeTime(time, timezone);
            var c = Time.decodeTime(currentTime, timezone);
            // Same day. Return time.
            if (t.year === c.year && t.month === c.month && t.day === c.day)
                return this.format(this.HOURS_MINUTES_TT, time, timezone);
            // Less than 7 days. Return week day.
            if (currentTime - time < 7 * 24 * 60 * 60 * 1000 && t.weekday !== c.weekday)
                return this.format(this.WEEKDAY, time, timezone);
            // Last 2 months?
            if ((t.year === c.year && t.month + 1 >= c.month) || (t.year + 1 === c.year && t.month + 1 >= c.month + 12 - 1))
                return this.format(this.LETTER_MONTH_AND_DAY, time, timezone);
            // Last 11 month?
            if (t.year === c.year || (t.year + 1 === c.year && t.month > c.month))
                return this.format(this.LETTER_MONTH, time, timezone);
            // Return year
            return this.format(this.FULL_YEAR, time, timezone);
        }

    };
});

Scoped.define("module:States.State", ["module:Class","module:Types","module:Strings","module:Async","module:Objs"], function (Class, Types, Strings, Async, Objs, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Abstract State Class
         * 
         * @class BetaJS.States.State
         */
        return {

            _locals: [],
            _persistents: [],
            _defaults: {},
            _clonedDefaults: {},

            _white_list: null,

            _starting: false,
            _started: false,
            _stopped: false,
            _transitioning: false,
            __next_state: null,
            __suspended: 0,

            /**
             * Creates a new instance.
             * 
             * @param {object} host state host
             * @param {object} args arguments for creating the state
             * @param {object} transitionals transitionals variables
             */
            constructor: function(host, args, transitionals) {
                inherited.constructor.call(this);
                this.host = host;
                this.transitionals = transitionals;
                args = Objs.extend(Objs.extend(Objs.clone(this._clonedDefaults || {}, -1), Objs.clone(this._defaults || {}, 1)), args);
                this._locals = Types.is_function(this._locals) ? this._locals() : this._locals;
                var used = {};
                for (var i = 0; i < this._locals.length; ++i) {
                    this["_" + this._locals[i]] = args[this._locals[i]];
                    used[this._locals[i]] = true;
                }
                this._persistents = Types.is_function(this._persistents) ? this._persistents() : this._persistents;
                for (i = 0; i < this._persistents.length; ++i) {
                    this["_" + this._persistents[i]] = args[this._persistents[i]];
                    used[this._locals[i]] = true;
                }
                host.suspendEvents();
                this.__hostArgs = {};
                Objs.iter(args, function(value, key) {
                    if (!used[key]) {
                        this.__hostArgs[key] = true;
                        host.set(key, value);
                    }
                }, this);
                host.resumeEvents();
            },

            /**
             * Returns all attributes of the state.
             * 
             * @return {object} all attributes
             */
            allAttr: function() {
                var result = Objs.clone(this.host.data(), 1);
                Objs.iter(this._locals, function(key) {
                    result[key] = this["_" + key];
                }, this);
                Objs.iter(this._persistents, function(key) {
                    result[key] = this["_" + key];
                }, this);
                return result;
            },

            /**
             * Returns the name of state.
             * 
             * @return {string} name of state
             */
            state_name: function() {
                return Strings.last_after(this.cls.classname, ".");
            },

            /**
             * Returns the description of state.
             * 
             * @return {string} description of state
             */
            description: function() {
                return this.state_name();
            },

            /**
             * Starts the state.
             */
            start: function() {
                if (this._starting)
                    return this;
                this._starting = true;
                this.host._start(this);
                this._start();
                if (this.host) {
                    this.host._afterStart(this);
                    this._started = true;
                }
                return this;
            },

            /**
             * Ends the state.
             */
            end: function() {
                if (this._stopped)
                    return this;
                this._stopped = true;
                this._end();
                this.host._end(this);
                this.host._afterEnd(this);
                this.destroy();
                return this;
            },

            /**
             * Eventually transitions to the next state.
             * 
             * @param {string} state_name name of next state
             * @param {object} args arguments for creating the state
             * @param {object} transitionals transitionals variables
             * 
             * @return {object} next state
             */
            eventualNext: function(state_name, args, transitionals) {
                this.suspend();
                var state = this.next(state_name, args, transitionals);
                this.eventualResume();
                return state;
            },

            /**
             * Eventually transitions to the next state.
             * 
             * @param {string} state_name name of next state
             * @param {object} args arguments for creating the state
             * @param {object} transitionals transitionals variables
             * 
             * @return {object} next state
             */
            next: function(state_name, args, transitionals) {
                if (!this._starting || this._stopped || this.__next_state)
                    return null;
                args = args || {};
                for (var i = 0; i < this._persistents.length; ++i) {
                    if (!(this._persistents[i] in args))
                        args[this._persistents[i]] = this["_" + this._persistents[i]];
                }
                var obj = this.host._createState(state_name, args, transitionals);
                if (!this.can_transition_to(obj)) {
                    obj.destroy();
                    return null;
                }
                if (!this._started) {
                    this.host._afterStart(this);
                    this._started = true;
                }
                this.__next_state = obj;
                this._transitioning = true;
                this._transition();
                if (this.__suspended <= 0)
                    this.__next();
                return obj;
            },

            /**
             * Checks weakly whether a prospective new state is equal to this state.
             * 
             * @param {string} state_name name of next state
             * @param {object} args arguments for creating the state
             * @param {object} transitionals transitionals variables
             * 
             * @return {boolean} true if equal
             */
            weakSame: function(state_name, args, transitionals) {
                var same = true;
                if (state_name !== this.state_name())
                    same = false;
                var all = this.allAttr();
                Objs.iter(args, function(value, key) {
                    if (all[key] !== value)
                        same = false;
                }, this);
                return same;
            },

            /**
             * Weakly transitions to the next state.
             * 
             * @param {string} state_name name of next state
             * @param {object} args arguments for creating the state
             * @param {object} transitionals transitionals variables
             * 
             * @return {object} next state
             */
            weakNext: function(state_name, args, transitionals) {
                return this.weakSame.apply(this, arguments) ? this : this.next.apply(this, arguments);
            },

            __next: function() {
                var host = this.host;
                var obj = this.__next_state;
                host._next(obj);
                var hostArgs = this.__hostArgs;
                this.end();
                obj.start();
                host.suspendEvents();
                obj = host.state();
                if (!obj || obj.destroyed())
                    return;
                Objs.iter(hostArgs, function(dummy, key) {
                    if (!obj.__hostArgs[key])
                        host.unset(key);
                }, this);
                host.resumeEvents();
                host._afterNext(obj);
            },

            _transition: function() {},

            /**
             * Suspends the state.
             */
            suspend: function() {
                this.__suspended++;
                return this;
            },

            /**
             * Eventually resumes the state.
             */
            eventualResume: function() {
                Async.eventually(this.resume, this);
                return this;
            },

            /**
             * Resumes the state.
             */
            resume: function() {
                this.__suspended--;
                if (this.__suspended === 0 && !this._stopped && this.__next_state)
                    this.__next();
                return this;
            },

            /**
             * Determines whether the state can transition to another state.
             * 
             * @param {object} state another state
             * 
             * @return {boolean} true if it can transition
             */
            can_transition_to: function(state) {
                return this.host && this.host._can_transition_to(state) && this._can_transition_to(state);
            },

            _start: function() {},

            _end: function() {},

            _can_transition_to: function(state) {
                return !Types.is_array(this._white_list) || Objs.contains_value(this._white_list, state.state_name());
            }

        };
    }, {

        _extender: {
            _defaults: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            }
        }

    });
});

Scoped.define("module:States.Host", ["module:Properties.Properties","module:Events.EventsMixin","module:States.State","module:Types","module:Strings","module:Classes.ClassRegistry"], function (Class, EventsMixin, State, Types, Strings, ClassRegistry, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {

        /**
         * State Machine Host Class
         * 
         * @class BetaJS.States.Host
         */
        return {

            /**
             * Creates a new instance.
             * 
             * @param {object} options options for state host
             */
            constructor: function(options) {
                inherited.constructor.call(this);
                options = options || {};
                this._stateRegistry = options.stateRegistry;
                this._baseState = options.baseState;
                this._enabled = true;
            },

            /**
             * Initialize state machine.
             * 
             * @param initial_state initial state as string or class
             * @param {object} initial_args initial arguments for state
             * 
             */
            initialize: function(initial_state, initial_args) {
                if (!this._stateRegistry) {
                    var s = null;
                    if (Types.is_string(initial_state) && initial_state.indexOf(".") >= 0) {
                        var split = Strings.splitLast(initial_state, ".");
                        initial_state = split.tail;
                        s = split.head;
                    } else if (!Types.is_string(initial_state))
                        s = Strings.splitLast(initial_state.classname, ".").head;
                    else
                        s = Strings.splitLast(this.cls.classname, ".").head;
                    this._stateRegistry = this._auto_destroy(new ClassRegistry(Scoped.getGlobal(s)));
                }
                this._createState(initial_state, initial_args).start();
                this._baseState = this._baseState || this._state.cls;
                return this;
            },

            /**
             * Creates a new state.
             * 
             * @protected
             * 
             * @param state state as string or class
             * @param {object} args arguments for state
             * @param {object} transitionals transitional arguments for state
             * 
             * @return {object} created state
             */
            _createState: function(state, args, transitionals) {
                return this._stateRegistry.create(state, this, args || {}, transitionals || {});
            },

            /**
             * Finalize current state.
             */
            finalize: function() {
                if (this._state)
                    this._state.end();
                this._state = null;
                return this;
            },

            /**
             * @override
             */
            destroy: function() {
                this.finalize();
                inherited.destroy.call(this);
            },

            /**
             * Enable the state machine.
             */
            enable: function() {
                this._enabled = true;
                return this;
            },

            /**
             * Disable the state machine.
             */
            disable: function() {
                this._enabled = false;
                return this;
            },

            /**
             * Returns the current state.
             * 
             * @return {object} current state
             */
            state: function() {
                return this._state;
            },

            /**
             * Returns the current state name.
             * 
             * @return {string} state name
             */
            state_name: function() {
                return this.state().state_name();
            },

            /**
             * Transitions to the next state
             * 
             * @return {object} next state
             */
            next: function() {
                return this.state() ? this.state().next.apply(this.state(), arguments) : this.initialize.apply(this, arguments);
            },

            /**
             * Weakly transitions to the next state
             * 
             * @return {object} next state
             */
            weakNext: function() {
                return this.state() ? this.state().weakNext.apply(this.state(), arguments) : this.initialize.apply(this, arguments);
            },

            /**
             * Starts a new state.
             * 
             * @protected
             * 
             * @param {object} state state to start
             */
            _start: function(state) {
                this._stateEvent(state, "before_start");
                this._state = state;
                this.set("name", state.state_name());
            },

            /**
             * Called after an event was started.
             * 
             * @protected
             * 
             * @param {object} state state in question
             */
            _afterStart: function(state) {
                this._stateEvent(state, "start");
            },

            /**
             * End a state.
             * 
             * @protected
             * 
             * @param {object} state state in question
             */
            _end: function(state) {
                this._stateEvent(state, "end");
                this._state = null;
            },

            /**
             * Called after an event was ended.
             * 
             * @protected
             * 
             * @param {object} state state in question
             */
            _afterEnd: function(state) {
                this._stateEvent(state, "after_end");
            },

            /**
             * Called when a transition to a state is taking place.
             * 
             * @protected
             * 
             * @param {object} state state in question
             */
            _next: function(state) {
                this._stateEvent(state, "next");
            },

            /**
             * Called after transitioning to a state.
             * 
             * @protected
             * 
             * @param {object} state state in question
             */
            _afterNext: function(state) {
                this._stateEvent(state, "after_next");
            },

            /**
             * Determines whether we can transition to a state
             * 
             * @protected
             * 
             * @param {object} state state in question
             * @return {boolean} true if we can transition
             */
            _can_transition_to: function(state) {
                return this._enabled;
            },

            /**
             * Triggers a state event.
             * 
             * @protected
             * 
             * @param {object} state state in question
             * @param {string} s name of event
             * @fires BetaJS.States.Host#event
             */
            _stateEvent: function(state, s) {
                /**
                 * @event BetaJS.States.Host#event
                 */
                this.trigger("event", s, state.state_name(), state.description());
                this.trigger(s, state.state_name(), state.description());
                this.trigger(s + ":" + state.state_name(), state.description());
            },

            /**
             * Registers a new state.
             * 
             * @param {string} state_name name of new state
             * @param {object} parent_state class of parent state we should inherit from
             * @param {object} extend extension of state class
             * 
             * @return {object} new state class
             */
            register: function(state_name, parent_state, extend) {
                if (!Types.is_string(parent_state)) {
                    extend = parent_state;
                    parent_state = null;
                }
                if (!this._stateRegistry)
                    this._stateRegistry = this._auto_destroy(new ClassRegistry(Strings.splitLast(this.cls.classname).head));
                var base = this._baseState ? (Strings.splitLast(this._baseState.classname, ".").head + "." + state_name) : (state_name.indexOf(".") >= 0 ? state_name : null);
                var cls = (this._stateRegistry.get(parent_state) || this._baseState || State).extend(base, extend);
                if (!base)
                    cls.classname = state_name;
                this._stateRegistry.register(Strings.last_after(state_name, "."), cls);
                return this;
            }

        };
    }]);
});

Scoped.define("module:Collections.FilteredCollection", ["module:Collections.Collection"], function (Collection, scoped) {
    return Collection.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * The FilteredCollection Class allows you to create a dynamic sub collection based on another Collection instance and a filter function.
         * 
         * @class BetaJS.Collections.FilteredCollection
         */
        return {

            /**
             * Instantiates a FilteredCollection.
             * 
             * @param {object} parent Parent Collection
             * @param {object} options Standard Collection options, plus filter and context
             */
            constructor: function(parent, options) {
                this.__parent = parent;
                options = options || {};
                delete options.objects;
                options.compare = options.compare || parent.get_compare();
                inherited.constructor.call(this, options);
                this.__parent.on("add", this.add, this);
                this.__parent.on("remove", this.__selfRemove, this);
                this.__parent.on("change", this.add, this);
                this.setFilter(options.filter, options.context);
            },

            /**
             * Determines whether an item satisfies the filter of this collection.
             * 
             * @param {object} object Properties instance to be checked
             * 
             * @return {boolean} True if object satisfies current filter
             */
            filter: function(object) {
                return !this.__filter || this.__filter.call(this.__filterContext || this, object);
            },

            /**
             * Sets the current filter
             * 
             * @param {function} filterFunction Filter function to be used for checking items
             * @param {object} filterContext Optional filter function context
             */
            setFilter: function(filterFunction, filterContext) {
                this.__filterContext = filterContext;
                this.__filter = filterFunction;
                this.iterate(function(obj) {
                    if (!this.filter(obj))
                        this.__selfRemove(obj);
                }, this);
                this.__parent.iterate(function(object) {
                    if (!this.exists(object) && this.filter(object))
                        this.__selfAdd(object);
                    return true;
                }, this);
            },

            /**
             * @override
             */
            _object_changed: function(object, key, value) {
                inherited._object_changed.call(this, object, key, value);
                if (!this.filter(object))
                    this.__selfRemove(object);
            },

            /**
             * @override
             */
            destroy: function() {
                this.__parent.off(null, null, this);
                inherited.destroy.call(this);
            },

            __selfAdd: function(object) {
                return inherited.add.call(this, object);
            },

            /**
             * @override
             */
            add: function(object) {
                if (this.exists(object) || !this.filter(object))
                    return null;
                var id = this.__selfAdd(object);
                this.__parent.add(object);
                return id;
            },

            __selfRemove: function(object) {
                return inherited.remove.call(this, object);
            },

            /**
             * @override
             */
            remove: function(object) {
                if (!this.exists(object))
                    return null;
                var result = this.__selfRemove(object);
                if (!result)
                    return null;
                return this.__parent.remove(object);
            }

        };
    });
});

Scoped.define("module:Ajax.AjaxWrapper", ["module:Class","module:Objs","module:Ajax.Support"], function (Class, Objs, Support, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {

        /**
         * Ajax Wrapper Class
         * 
         * @class BetaJS.Ajax.AjaxWrapper
         */
        return {

            /**
             * Creates an instance.
             * 
             * @param {object} options common options for ajax calls
             */
            constructor: function(options) {
                inherited.constructor.call(this);
                this.options = options;
            },

            /**
             * Execute an ajax call.
             * 
             * @param {object} options options for ajax call
             * @param {function} progress Optional progress function
             * @param {object} progressCtx Optional progress context
             * @return {object} promise for the ajax call
             */
            execute: function(options, progress, progressCtx) {
                return Support.execute(Objs.extend(Objs.clone(this.options, 1), options), progress, progressCtx);
            }

        };
    });
});

Scoped.define("module:Net.Cookies", ["module:Objs","module:Types"], function (Objs, Types) {
    return {

        getCookielikeValue: function(cookies, key) {
            cookies = cookies || "";
            return decodeURIComponent(cookies.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(key).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
        },

        createCookielikeValue: function(key, value, end, path, domain, secure) {
            if (!key || /^(?:expires|max\-age|path|domain|secure)$/i.test(key))
                return null;
            var components = [];
            components.push([encodeURIComponent(key), encodeURIComponent(value)]);
            if (end) {
                if (end === Infinity)
                    components.push(["expires", "Fri, 31 Dec 9999 23:59:59 GMT"]);
                else if (typeof end === "number")
                    components.push(["max-age", end]);
                else if (typeof end === "object")
                    components.push(["expires", end.toUTCString()]);
                else
                    components.push(["expires", end]);
            }
            if (domain)
                components.push(["domain", domain]);
            if (path)
                components.push(["path", path]);
            if (secure)
                components.push("secure");
            return Objs.map(components, function(component) {
                return Types.is_array(component) ? component.join("=") : component;
            }).join("; ");
        },

        removeCookielikeValue: function(key, value, path, domain) {
            return this.createCookielikeValue(key, value, new Date(0), path, domain);
        },

        hasCookielikeValue: function(cookies, key) {
            return (new RegExp("(?:^|;\\s*)" + encodeURIComponent(key).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=")).test(cookies);
        },

        keysCookielike: function(cookies) {
            var base = cookies.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g, "").split(/\s*(?:\=[^;]*)?;\s*/);
            return Objs.map(base, decodeURIComponent);
        }

    };
});

Scoped.define("module:Sort", ["module:Comparators","module:Types","module:Objs"], function (Comparators, Types, Objs) {

    /**
     * Sort objects and arrays.
     * 
     * @module BetaJS.Sort
     */
    return {

        /**
         * Sort keys in an object according to a comparator. 
         * 
         * @param {object} object object to be sorted
         * @param {function} f comparator comparator for sorting, accepting keys first and then optionally values
         * 
         * @return {object} sorted object
         */
        sort_object: function(object, f) {
            var a = [];
            for (var key in object)
                a.push({
                    key: key,
                    value: object[key]
                });
            a.sort(function(x, y) {
                return f(x.key, y.key, x.value, y.value);
            });
            var o = {};
            for (var i = 0; i < a.length; ++i)
                o[a[i].key] = a[i].value;
            return o;
        },

        /**
         * Deep sorting an object according to a comparator. 
         * 
         * @param {object} object object to be sorted
         * @param {function} f comparator comparator for sorting, accepting keys first and then optionally values
         * 
         * @return {object} sorted object
         */
        deep_sort: function(object, f) {
            f = f || Comparators.byValue;
            if (Types.is_array(object)) {
                for (var i = 0; i < object.length; ++i)
                    object[i] = this.deep_sort(object[i], f);
                return object.sort(f);
            } else if (Types.is_object(object)) {
                for (var key in object)
                    object[key] = this.deep_sort(object[key], f);
                return this.sort_object(object, f);
            } else
                return object;
        },

        /**
         * Sort an array of items with inter-dependency specifiers s.t. every item in the resulting array has all its dependencies come before.
         * 
         * @param {array} items list of items with inter-dependency specifiers
         * @param {string|function} identifier function / key mapping an item to its unique identifier
         * @param {string|function} before function / key mapping an item to its array of dependencies
         * @param {string|function} after function / key mapping an item to its array of depending items
         * 
         * @return {array} sorted array
         */
        dependency_sort: function(items, identifier, before, after) {
            var identifierf = Types.is_string(identifier) ? function(obj) {
                return obj[identifier];
            } : identifier;
            var beforef = Types.is_string(before) ? function(obj) {
                return obj[before];
            } : before;
            var afterf = Types.is_string(after) ? function(obj) {
                return obj[after];
            } : after;
            var n = items.length;
            var data = [];
            var identifier_to_index = {};
            var todo = {};
            var i = 0;
            for (i = 0; i < n; ++i) {
                todo[i] = true;
                var ident = identifierf(items[i], i);
                identifier_to_index[ident] = i;
                data.push({
                    before: {},
                    after: {}
                });
            }
            var make_before_iter_func = function(i) {
                return function(before) {
                    var before_index = identifier_to_index[before];
                    if (Types.is_defined(before_index)) {
                        data[i].before[before_index] = true;
                        data[before_index].after[i] = true;
                    }
                };
            };
            var make_after_iter_func = function(i) {
                return function(after) {
                    var after_index = identifier_to_index[after];
                    if (Types.is_defined(after_index)) {
                        data[i].after[after_index] = true;
                        data[after_index].before[i] = true;
                    }
                };
            };
            for (i = 0; i < n; ++i) {
                Objs.iter(beforef(items[i], i) || [], make_before_iter_func(i));
                Objs.iter(afterf(items[i]) || [], make_after_iter_func(i));
            }
            var result = [];
            while (!Types.is_empty(todo)) {
                for (i in todo) {
                    if (Types.is_empty(data[i].after)) {
                        delete todo[i];
                        result.push(items[i]);
                        for (var bef in data[i].before)
                            delete data[bef].after[i];
                    }
                }
            }
            return result;
        }

    };
});

Scoped.define("module:Classes.LocaleAggregator", ["module:Class","module:Classes.LocaleMixin","module:Objs"], function (Class, LocaleMixin, Objs, scoped) {
    return Class.extend({
        scoped: scoped
    }, [LocaleMixin, function(inherited) {

        /**
         * Locale Aggregator Class for combining multiple locales into one.
         * 
         * @class BetaJS.Classes.LocaleAggregator
         */
        return {

            /**
             * Create a Locale Aggregator instance.
             * 
             */
            constructor: function() {
                inherited.constructor.call(this);
                this.__locales = [];
            },

            /**
             * Registers a new locale.
             * 
             * @return {object} Locale
             */
            register: function(obj) {
                this.__locales.push(obj);
            },

            /**
             * @override
             */
            _clearLocale: function() {
                Objs.iter(this.__locales, function(obj) {
                    obj.clearLocale();
                }, this);
            },

            /**
             * @override
             */
            _setLocale: function(locale) {
                Objs.iter(this.__locales, function(obj) {
                    obj.setLocale(locale);
                }, this);
            }

        };
    }]);
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('base', 'root:BetaJS');
Scoped.binding('module', 'root:BetaJS.Browser');
Scoped.define("module:FlashDetect", ["base:Class"], function (Class, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function() {
                inherited.constructor.call(this);
                this.__version = null;
                if (navigator.plugins && navigator.plugins.length > 0) {
                    var type = 'application/x-shockwave-flash';
                    var mimeTypes = navigator.mimeTypes;
                    if (mimeTypes && mimeTypes[type] && mimeTypes[type].enabledPlugin && mimeTypes[type].enabledPlugin.description)
                        this.__version = this.parseVersion(mimeTypes[type].enabledPlugin.description);
                } else if (navigator.appVersion.indexOf("Mac") == -1 && "execScript" in window) {
                    for (var i = 0; i < this.__activeXDetectRules.length; i++) {
                        try {
                            var obj = new ActiveXObject(this.__activeXDetectRules[i].name);
                            var version = this.__activeXDetectRules[i].version(obj);
                            if (version) {
                                this.__version = this.parseActiveXVersion(version);
                                break;
                            }
                        } catch (err) {}
                    }
                }
            },

            parseVersion: function(str) {
                var descParts = str.split(/ +/);
                var majorMinor = descParts[2].split(/\./);
                var revisionStr = descParts[3];
                return {
                    "raw": str,
                    "major": parseInt(majorMinor[0], 10),
                    "minor": parseInt(majorMinor[1], 10),
                    "revisionStr": revisionStr,
                    "revision": parseInt(revisionStr.replace(/[a-zA-Z]/g, ""), 10)
                };
            },

            parseActiveXVersion: function(str) {
                var versionArray = str.split(",");
                return {
                    "raw": str,
                    "major": parseInt(versionArray[0].split(" ")[1], 10),
                    "minor": parseInt(versionArray[1], 10),
                    "revision": parseInt(versionArray[2], 10),
                    "revisionStr": versionArray[2]
                };
            },

            version: function() {
                return this.__version;
            },

            installed: function() {
                return this.__version !== null;
            },

            supported: function() {
                var ua = navigator.userAgent;
                return this.installed() || !(ua.indexOf('iPhone') != -1 || ua.indexOf('iPod') != -1 || ua.indexOf('iPad') != -1);
            },

            majorAtLeast: function(version) {
                return this.installed() && this.version().major >= version;
            },

            minorAtLeast: function(version) {
                return this.installed() && this.version().minor >= version;
            },

            revisionAtLeast: function(version) {
                return this.installed() && this.version().revision >= version;
            },

            versionAtLeast: function(major) {
                if (!this.installed())
                    return false;
                var properties = [this.version().major, this.version().minor, this.version().revision];
                var len = Math.min(properties.length, arguments.length);
                for (var i = 0; i < len; i++) {
                    if (properties[i] != arguments[i])
                        return properties[i] > arguments[i];
                }
                return true;
            },

            __activeXDetectRules: [{
                name: "ShockwaveFlash.ShockwaveFlash.7",
                version: function(obj) {
                    try {
                        return obj.GetVariable("$version");
                    } catch (err) {
                        return null;
                    }
                }
            }, {
                name: "ShockwaveFlash.ShockwaveFlash.6",
                version: function(obj) {
                    try {
                        obj.AllowScriptAccess = "always";
                        try {
                            return obj.GetVariable("$version");
                        } catch (err) {
                            return null;
                        }
                    } catch (err) {
                        return "6,0,21";
                    }
                }
            }, {
                name: "ShockwaveFlash.ShockwaveFlash",
                version: function(obj) {
                    try {
                        return obj.GetVariable("$version");
                    } catch (err) {
                        return null;
                    }
                }
            }]

        };
    });
});

Scoped.define("module:Info", ["base:Objs","module:FlashDetect"], function (Objs, FlashDetect) {
    return {

        __navigator: null,

        getNavigator: function() {
            if (!this.__navigator) {
                this.__navigator = {
                    appCodeName: navigator.appCodeName,
                    appName: navigator.appName,
                    appVersion: navigator.appVersion,
                    cookieEnabled: navigator.cookieEnabled,
                    onLine: navigator.onLine,
                    platform: navigator.platform,
                    userAgent: navigator.userAgent,
                    window_chrome: "chrome" in window,
                    window_opera: "opera" in window,
                    language: navigator.language || navigator.userLanguage || ""
                };
            }
            return this.__navigator;
        },

        __cache: {},

        __cached: function(key, value_func, force) {
            if (!(key in this.__cache) || force) {
                var n = this.getNavigator();
                this.__cache[key] = value_func.call(this, n, n.userAgent, n.userAgent.toLowerCase());
            }
            return this.__cache[key];
        },

        setNavigator: function(obj) {
            this.__navigator = obj;
            this.__cache = {};
        },

        language: function() {
            return this.__cached("language", function(nav) {
                return nav.language;
            });
        },

        flash: function(force) {
            return this.__cached("flash", function() {
                return new FlashDetect();
            }, force);
        },

        isiOS: function() {
            return this.__cached("isiOS", function(nav, ua) {
                if (this.isInternetExplorer() || this.isIEMobile())
                    return false;
                return ua.indexOf('iPhone') != -1 || ua.indexOf('iPod') != -1 || ua.indexOf('iPad') != -1;
            });
        },

        isEdge: function() {
            return this.__cached("isEdge", function(nav, ua) {
                return ua.indexOf('Edge') != -1;
            });
        },

        isCordova: function() {
            return !!window.cordova || !!window._cordovaNative || document.location.href.indexOf("file:///android_asset/www") === 0 || document.location.href.indexOf("file:///var/mobile/Containers/Bundle/Application") === 0;
        },

        isLocalCordova: function() {
            return this.__cached("isLocalCordova", function() {
                return this.isCordova() && document.location.href.indexOf("http") !== 0;
            });
        },

        isChrome: function() {
            return this.__cached("isChrome", function(nav, ua) {
                return (nav.window_chrome || ua.indexOf('CriOS') != -1) && !this.isOpera() && !this.isEdge();
            });
        },

        isChromium: function() {
            return this.__cached("isChromium", function(nav, ua, ualc) {
                return !this.isChrome() && this.isAndroid() && ualc.indexOf("linux") >= 0;
            });
        },

        isChromiumBased: function() {
            return this.__cached("isChromiumBased", function() {
                return this.isChrome() || this.isChromium();
            });
        },

        isOpera: function() {
            return this.__cached("isOpera", function(nav, ua) {
                return nav.window_opera || ua.indexOf(' OPR/') >= 0 || ua.indexOf("OPiOS") >= 0 || ua.indexOf('Opera') >= 0;
            });
        },

        isAndroid: function() {
            return this.__cached("isAndroid", function(nav, ua, ualc) {
                return ualc.indexOf("android") != -1;
            });
        },

        isWebOS: function() {
            return this.__cached("isWebOS", function(nav, ua, ualc) {
                return ualc.indexOf("webos") != -1;
            });
        },

        isWindowsPhone: function() {
            return this.__cached("isWindowsPhone", function(nav, ua, ualc) {
                return ualc.indexOf("windows phone") != -1;
            });
        },

        isBlackberry: function() {
            return this.__cached("isBlackberry", function(nav, ua, ualc) {
                return ualc.indexOf("blackberry") != -1;
            });
        },

        iOSversion: function() {
            return this.__cached("iOSversion", function(nav) {
                if (!this.isiOS())
                    return false;
                var v = (nav.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);
                return {
                    major: parseInt(v[1], 10),
                    minor: parseInt(v[2], 10),
                    revision: parseInt(v[3] || 0, 10)
                };
            });
        },

        androidVersion: function() {
            return this.__cached("androidVersion", function(nav) {
                if (!this.isAndroid())
                    return false;
                var v = (nav.userAgent).match(/Android (\d+)\.(\d+)\.?(\d+)?/);
                return {
                    major: parseInt(v[1], 10),
                    minor: parseInt(v[2], 10),
                    revision: parseInt(v[3] || 0, 10)
                };
            });
        },

        isMobile: function() {
            return this.__cached("isMobile", function() {
                return this.isiOS() || this.isAndroid() || this.isWebOS() || this.isWindowsPhone() || this.isBlackberry();
            });
        },

        isDesktop: function() {
            return this.__cached("isDesktop", function() {
                return !this.isMobile();
            });
        },

        isInternetExplorer: function() {
            return this.__cached("isInternetExplorer", function() {
                //return navigator.appName == 'Microsoft Internet Explorer';
                return !this.isIEMobile() && this.internetExplorerVersion() !== null;
            });
        },

        isIEMobile: function() {
            return this.__cached("isIEMobile", function(nav, ua, ualc) {
                return ualc.indexOf("iemobile") >= 0;
            });
        },

        isFirefox: function() {
            return this.__cached("isFirefox", function(nav, ua, ualc) {
                return ualc.indexOf("firefox") != -1 || ualc.indexOf("fxios") != -1;
            });
        },

        isSafari: function() {
            return this.__cached("isSafari", function(nav, ua, ualc) {
                return !this.isChrome() && !this.isOpera() && !this.isEdge() && !this.isFirefox() && ualc.indexOf("safari") != -1 && !this.isAndroid();
            });
        },

        isWindows: function() {
            return this.__cached("isWindows", function(nav) {
                return nav.appVersion.toLowerCase().indexOf("win") != -1 && !this.isWindowsPhone();
            });
        },

        isMacOS: function() {
            return this.__cached("isMacOS", function(nav) {
                return !this.isiOS() && nav.appVersion.toLowerCase().indexOf("mac") != -1;
            });
        },

        isUnix: function() {
            return this.__cached("isUnix", function(nav) {
                return nav.appVersion.toLowerCase().indexOf("x11") != -1;
            });
        },

        isLinux: function() {
            return this.__cached("isLinux", function(nav) {
                return !this.isAndroid() && nav.appVersion.toLowerCase().indexOf("linux") != -1;
            });
        },

        internetExplorerVersion: function() {
            return this.__cached("internetExplorerVersion", function(nav, ua) {
                if (nav.appName == 'Microsoft Internet Explorer') {
                    var re = new RegExp("MSIE ([0-9]+)");
                    var ma = re.exec(ua);
                    if (ma)
                        return ma[1];
                } else if (nav.appName == 'Netscape') {
                    var re2 = new RegExp("Trident/.*rv:([0-9]+)");
                    var ma2 = re2.exec(nav.userAgent);
                    if (ma2)
                        return parseFloat(ma2[1]);
                }
                return null;
            });
        },

        chromeVersion: function() {
            return this.__cached("chromeVersion", function(nav, ua) {
                var re = /Chrome\/(\d+\.\d+)[^\d]/gi;
                var ma = re.exec(ua);
                if (ma)
                    return parseFloat(ma[1]);
                return null;
            });
        },

        operaVersion: function() {
            return this.__cached("operaVersion", function(nav, ua) {
                var re = /OPR\/(\d+\.\d+)[^\d]/gi;
                var ma = re.exec(ua);
                if (ma)
                    return parseFloat(ma[1]);
                return null;
            });
        },

        safariVersion: function() {
            return this.__cached("safariVersion", function(nav, ua) {
                var re = /Version\/(\d+\.\d+)[^\d]/gi;
                var ma = re.exec(ua);
                if (ma)
                    return parseFloat(ma[1]);
                return null;
            });
        },

        firefoxVersion: function() {
            return this.__cached("firefoxVersion", function(nav, ua) {
                var re = /Firefox\/(\d+\.\d+)/gi;
                var ma = re.exec(ua);
                if (ma)
                    return parseFloat(ma[1]);
                return null;
            });
        },

        inIframe: function() {
            try {
                return window.self !== window.top;
            } catch (e) {
                return true;
            }
        },

        __devicesMap: {
            mobile: {
                format: "Mobile",
                check: function() {
                    return this.isMobile();
                }
            },
            desktop: {
                format: "Desktop",
                check: function() {
                    return this.isDesktop();
                }
            }
        },

        __obtainMatch: function(map, def) {
            var result = null;
            Objs.iter(map, function(value, key) {
                if (value.check.apply(this)) {
                    if (result) {
                        result = null;
                        return false;
                    }
                    result = Objs.clone(value, 1);
                    delete result.check;
                    result.key = key;
                }
            }, this);
            return result || def;
        },

        getDevice: function() {
            return this.__cached("getDevice", function() {
                return this.__obtainMatch(this.__devicesMap, {
                    key: "unknown",
                    format: "Unknown Device"
                });
            });
        },

        formatDevice: function() {
            return this.getDevice().format;
        },

        __osMap: {
            macosx: {
                format: "Mac OS-X",
                check: function() {
                    return this.isMacOS();
                }
            },
            windows: {
                format: "Windows",
                check: function() {
                    return this.isWindows();
                }
            },
            unix: {
                format: "Unix",
                check: function() {
                    return this.isUnix();
                }
            },
            linux: {
                format: "Linux",
                check: function() {
                    return this.isLinux();
                }
            },
            ios: {
                format: "iOS",
                check: function() {
                    return this.isiOS();
                },
                version: function() {
                    return this.iOSversion().major + "." + this.iOSversion().minor + "." + this.iOSversion().revision;
                }
            },
            android: {
                format: "Android",
                check: function() {
                    return this.isAndroid();
                }
            },
            webos: {
                format: "WebOS",
                check: function() {
                    return this.isWebOS();
                }
            },
            windowsphone: {
                format: "Windows Phone",
                check: function() {
                    return this.isWindowsPhone();
                }
            },
            blackberry: {
                format: "Blackberry",
                check: function() {
                    return this.isBlackberry();
                }
            }
        },

        getOS: function() {
            return this.__cached("getOS", function() {
                return this.__obtainMatch(this.__osMap, {
                    key: "unknown",
                    format: "Unknown Operating System"
                });
            });
        },

        formatOS: function() {
            return this.getOS().format;
        },

        formatOSVersion: function() {
            return this.getOS().version ? this.getOS().version.apply(this) : "";
        },

        __browserMap: {
            chrome: {
                format: "Chrome",
                check: function() {
                    return this.isChrome();
                },
                version: function() {
                    return this.chromeVersion();
                }
            },
            chromium: {
                format: "Chromium",
                check: function() {
                    return this.isChromium();
                }
            },
            opera: {
                format: "Opera",
                check: function() {
                    return this.isOpera();
                },
                version: function() {
                    return this.operaVersion();
                }
            },
            internetexplorer: {
                format: "Internet Explorer",
                check: function() {
                    return this.isInternetExplorer();
                },
                version: function() {
                    return this.internetExplorerVersion();
                }
            },
            firefox: {
                format: "Firefox",
                check: function() {
                    return this.isFirefox();
                },
                version: function() {
                    return this.firefoxVersion();
                }
            },
            safari: {
                format: "Safari",
                check: function() {
                    return this.isSafari();
                },
                version: function() {
                    return this.safariVersion();
                }
            },
            webos: {
                format: "WebOS",
                check: function() {
                    return this.isWebOS();
                }
            },
            blackberry: {
                format: "Blackberry",
                check: function() {
                    return this.isBlackberry();
                }
            },
            edge: {
                format: "Edge",
                check: function() {
                    return this.isEdge();
                }
            },
            iemobile: {
                format: "IE Mobile",
                check: function() {
                    return this.isIEMobile();
                }
            }
        },

        getBrowser: function() {
            return this.__cached("getBrowser", function() {
                return this.__obtainMatch(this.__browserMap, {
                    key: "unknown",
                    format: "Unknown Browser"
                });
            });
        },

        formatBrowser: function() {
            return this.getBrowser().format;
        },

        formatBrowserVersion: function() {
            return this.getBrowser().version ? this.getBrowser().version.apply(this) : "";
        },

        formatFlash: function() {
            return this.flash().installed() ?
                ("Flash " + this.flash().version().raw) :
                (this.flash().supported() ?
                    "Flash not installed but supported" :
                    "Flash not supported");
        }

    };
});

Scoped.define("module:Dom", ["base:Types","base:Objs","module:Info","base:Async"], function (Types, Objs, Info, Async) {

    var TEMPLATE_TAG_MAP = {
        "tr": ["table", "tbody"],
        "td": ["table", "tbody", "tr"],
        "th": ["table", "thead", "tr"]
    };

    var INTERACTION_EVENTS = ["click", "mousedown", "mouseup", "touchstart", "touchend", "keydown", "keyup", "keypress"];

    var userInteractionCallbackList = [];
    var userInteractionCallbackWaiting = false;
    var userInteractionCallbackFunc = function() {
        userInteractionCallbackList.forEach(function(entry) {
            entry.callback.call(entry.context || this);
        });
        userInteractionCallbackList = [];
        userInteractionCallbackWaiting = false;
        INTERACTION_EVENTS.forEach(function(event) {
            document.body.removeEventListener(event, userInteractionCallbackFunc);
        });
    };

    return {

        ready: function(callback, context) {
            if (document.readyState === "complete" || (document.readyState !== "loading" && !document.documentElement.doScroll)) {
                Async.eventually(callback, context);
            } else {
                var completed;
                var done = false;
                var timer = null;
                completed = function() {
                    clearInterval(timer);
                    document.removeEventListener("DOMContentLoaded", completed);
                    window.removeEventListener("load", completed);
                    if (done)
                        return;
                    done = true;
                    callback.apply(context || this);
                };
                document.addEventListener("DOMContentLoaded", completed);
                window.addEventListener("load", completed);
                timer = setInterval(function() {
                    if (document.readyState === "complete" || (document.readyState !== "loading" && !document.documentElement.doScroll))
                        completed();
                }, 10);
            }
        },

        userInteraction: function(callback, context) {
            userInteractionCallbackList.push({
                callback: callback,
                context: context
            });
            if (!userInteractionCallbackWaiting) {
                userInteractionCallbackWaiting = true;
                INTERACTION_EVENTS.forEach(function(event) {
                    document.body.addEventListener(event, userInteractionCallbackFunc);
                });
            }
        },

        isTabHidden: function() {
            return document.hidden || document.webkitHidden || document.mozHidden || document.msHidden;
        },

        elementsByTemplate: function(template) {
            template = template.trim();
            var polyfill = Info.isInternetExplorer() && Info.internetExplorerVersion() < 9;
            /*
             * TODO: This is probably not a good fix.
             * 
             * Some tags, like tr, are not generated by the browser when under a generic tag like div.
             * In other words
             * 
             * <div>.innerHTML = "<tr><p>foo</p></tr>" will become <div><p>foo</p></div>
             * 
             * The quick fix here checks for an outer tag and picks the proper temporary parent tag.
             * 
             * This needs to be fixed properly in the future.
             */
            var parentTags = [];
            Objs.iter(TEMPLATE_TAG_MAP, function(value, key) {
                if (template.indexOf("<" + key) === 0) {
                    parentTags = value;
                    polyfill = false;
                }
            });
            var outerTemplate = [
                parentTags.map(function(t) {
                    return "<" + t + ">";
                }).join(""),
                polyfill ? "<br/>" : "",
                template,
                parentTags.map(function(t) {
                    return "</" + t + ">";
                }).join("")
            ].join("");
            var element = document.createElement("div");
            element.innerHTML = outerTemplate;
            parentTags.forEach(function() {
                element = element.children[0];
            });
            var result = [];
            for (var i = polyfill ? 1 : 0; i < element.children.length; ++i)
                result.push(element.children[i]);
            return result;
        },

        elementByTemplate: function(template) {
            var result = this.elementsByTemplate(template);
            return result.length > 0 ? result[0] : null;
        },

        changeTag: function(node, name) {
            var replacement = document.createElement(name);
            for (var i = 0; i < node.attributes.length; ++i) {
                var attr = node.attributes[i];
                replacement.setAttribute(attr.nodeName, "value" in attr ? attr.value : attr.nodeValue);
            }
            while (node.firstChild)
                replacement.appendChild(node.firstChild);
            if (node.parentNode)
                node.parentNode.replaceChild(replacement, node);
            return replacement;
        },

        traverseNext: function(node, skip_children) {
            node = this.unbox(node);
            if (node.firstChild && !skip_children)
                return node.firstChild;
            if (!node.parentNode)
                return null;
            if (node.nextSibling)
                return node.nextSibling;
            return this.traverseNext(node.parentNode, true);
        },

        splitNode: function(node, start_offset, end_offset) {
            start_offset = start_offset || 0;
            end_offset = end_offset || (node.wholeText ? node.wholeText.length : 0);
            if (end_offset < (node.wholeText ? node.wholeText.length : 0))
                node.splitText(end_offset);
            if (start_offset > 0)
                node = node.splitText(start_offset);
            return node;
        },

        __FULLSCREEN_EVENTS: ["fullscreenchange", "webkitfullscreenchange", "mozfullscreenchange", "MSFullscreenChange"],
        __FULLSCREEN_METHODS: ["requestFullscreen", "webkitRequestFullscreen", "mozRequestFullScreen", "msRequestFullscreen", "webkitEnterFullScreen"],
        __FULLSCREEN_ATTRS: ["fullscreenElement", "webkitFullscreenElement", "mozFullScreenElement", "msFullscreenElement"],
        __FULLSCREEN_EXIT_METHODS: ["exitFullscreen", "mozCancelFullScreen", "webkitExitFullscreen"],

        elementSupportsFullscreen: function(element) {
            return element && this.__FULLSCREEN_METHODS.some(function(key) {
                return key in element;
            });
        },

        elementEnterFullscreen: function(element) {
            var done = false;
            this.__FULLSCREEN_METHODS.forEach(function(key) {
                if (!done && (key in element)) {
                    element[key].call(element);
                    done = true;
                }
            });
        },

        // Will exit from document's full screen mode
        documentExitFullscreen: function() {
            this.__FULLSCREEN_EXIT_METHODS.forEach(function(key) {
                if (document[key]) {
                    document[key]();
                }
            });
        },

        elementIsFullscreen: function(element) {
            return this.__FULLSCREEN_ATTRS.some(function(key) {
                return document[key] === element;
            });
        },

        elementOnFullscreenChange: function(element, callback, context) {
            var self = this;
            var listener = function() {
                callback.call(context || this, element, self.elementIsFullscreen(element));
            };
            this.__FULLSCREEN_EVENTS.forEach(function(event) {
                element.addEventListener(event, listener, false);
            });
            return listener;
        },

        elementOffFullscreenChange: function(element, listener) {
            this.__FULLSCREEN_EVENTS.forEach(function(event) {
                element.removeEventListener(event, listener, false);
            });
        },

        entitiesToUnicode: function(s) {
            if (!s || !Types.is_string(s) || s.indexOf("&") < 0)
                return s;
            return s.split(">").map(function(s) {
                return s.split("<").map(function(s) {
                    var temp = document.createElement("span");
                    temp.innerHTML = s;
                    s = temp.textContent || temp.innerText;
                    if (temp.remove)
                        temp.remove();
                    return s;
                }).join("<");
            }).join(">");
        },

        unbox: function(element) {
            if (Types.is_string(element))
                element = document.querySelector(element);
            return !element || element.nodeType ? element : element.get(0);
        },

        triggerDomEvent: function(element, eventName, parameters, customEventParams) {
            element = this.unbox(element);
            eventName = eventName.toLowerCase();
            var onEvent = "on" + eventName;
            var onEventHandler = null;
            var onEventCalled = false;
            if (element[onEvent]) {
                onEventHandler = element[onEvent];
                element[onEvent] = function() {
                    if (onEventCalled)
                        return;
                    onEventCalled = true;
                    onEventHandler.apply(this, arguments);
                };
            }
            try {
                var event;
                try {
                    if (customEventParams)
                        event = new CustomEvent(eventName, customEventParams);
                    else
                        event = new Event(eventName);
                } catch (e) {
                    try {
                        if (customEventParams) {
                            event = document.createEvent('CustomEvent');
                            event.initCustomEvent(eventName, customEventParams.bubbles || false, customEventParams.cancelable || false, customEventParams.detail || false);
                        } else {
                            event = document.createEvent('Event');
                            event.initEvent(eventName, false, false);
                        }
                    } catch (e) {
                        event = document.createEventObject();
                        event.type = eventName;
                    }
                }
                Objs.extend(event, parameters);
                element.dispatchEvent(event);
                if (onEventHandler) {
                    if (!onEventCalled)
                        onEventHandler.call(element, event);
                    element[onEvent] = onEventHandler;
                }
            } catch (e) {
                if (onEventHandler)
                    element[onEvent] = onEventHandler;
                throw e;
            }
        },

        elementOffset: function(element) {
            element = this.unbox(element);
            var top = 0;
            var left = 0;
            if (element.getBoundingClientRect) {
                var box = element.getBoundingClientRect();
                top = box.top;
                left = box.left - (document.body.getBoundingClientRect ? document.body.getBoundingClientRect().left : 0);
            }
            docElem = document.documentElement;
            return {
                top: top + (window.pageYOffset || docElem.scrollTop) - (docElem.clientTop || 0),
                left: left + (window.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || 0)
            };
        },

        elementDimensions: function(element) {
            element = this.unbox(element);
            var cs, w, h;
            if (element && window.getComputedStyle) {
                try {
                    cs = window.getComputedStyle(element);
                } catch (e) {}
                if (cs) {
                    w = parseInt(cs.width, 10);
                    h = parseInt(cs.height, 10);
                    if (w && h) {
                        return {
                            width: w,
                            height: h
                        };
                    }
                }
            }
            if (element && element.currentStyle) {
                cs = element.currentStyle;
                w = element.clientWidth - parseInt(cs.paddingLeft || 0, 10) - parseInt(cs.paddingRight || 0, 10);
                h = element.clientHeight - parseInt(cs.paddingTop || 0, 10) - parseInt(cs.paddingTop || 0, 10);
                if (w && h) {
                    return {
                        width: w,
                        height: h
                    };
                }
            }
            if (element && element.getBoundingClientRect) {
                var box = element.getBoundingClientRect();
                h = box.bottom - box.top;
                w = box.right - box.left;
                return {
                    width: w,
                    height: h
                };
            }
            return {
                width: 0,
                height: 0
            };
        },

        childContainingElement: function(parent, element) {
            parent = this.unbox(parent);
            element = this.unbox(element);
            while (element.parentNode != parent) {
                if (element == document.body)
                    return null;
                element = element.parentNode;
            }
            return element;
        },

        elementBoundingBox: function(element) {
            var offset = this.elementOffset(element);
            var dimensions = this.elementDimensions(element);
            return {
                left: offset.left,
                top: offset.top,
                right: offset.left + dimensions.width - 1,
                bottom: offset.top + dimensions.height - 1
            };
        },

        pointWithinElement: function(x, y, element) {
            var bb = this.elementBoundingBox(element);
            return bb.left <= x && x <= bb.right && bb.top <= y && y <= bb.bottom;
        },

        elementFromPoint: function(x, y, disregarding) {
            disregarding = disregarding || [];
            if (!Types.is_array(disregarding))
                disregarding = [disregarding];
            var backup = [];
            for (var i = 0; i < disregarding.length; ++i) {
                disregarding[i] = this.unbox(disregarding[i]);
                backup.push(disregarding[i].style.zIndex);
                disregarding[i].style.zIndex = -1;
            }
            var element = document.elementFromPoint(x - window.pageXOffset, y - window.pageYOffset);
            for (i = 0; i < disregarding.length; ++i)
                disregarding[i].style.zIndex = backup[i];
            return element;
        },

        elementAddClass: function(element, cls) {
            if (!element.className)
                element.className = cls;
            else if (!this.elementHasClass(element, cls))
                element.className = element.className + " " + cls;
        },

        elementHasClass: function(element, cls) {
            return element.className.split(" ").some(function(name) {
                return name === cls;
            });
        },

        elementRemoveClass: function(element, cls) {
            element.className = element.className.split(" ").filter(function(name) {
                return name !== cls;
            }).join(" ");
        },

        elementInsertBefore: function(element, before) {
            before.parentNode.insertBefore(element, before);
        },

        elementInsertAfter: function(element, after) {
            if (after.nextSibling)
                after.parentNode.insertBefore(element, after.nextSibling);
            else
                after.parentNode.appendChild(element);
        },

        elementInsertAt: function(element, parent, index) {
            if (index >= parent.children.length)
                parent.appendChild(element);
            else
                parent.insertBefore(element, parent.children[Math.max(0, index)]);
        },

        elementIndex: function(element) {
            var idx = 0;
            while (element.previousElementSibling) {
                idx++;
                element = element.previousElementSibling;
            }
            return idx;
        },

        elementPrependChild: function(parent, child) {
            if (parent.children.length > 0)
                parent.insertBefore(child, parent.firstChild);
            else
                parent.appendChild(child);
        },

        // Will find closest parent element, will stop on stopSelector
        // example:  Dom.elementReplaceClasses(element, '.look-element-class-name', '.stop-on-class-name')
        elementFindClosestParent: function(element, selector, stopSelector) {
            var _returnVal = null;
            while (element) {
                if (element.className.indexOf(selector) > -1) {
                    _returnVal = element;
                    break;
                } else if (stopSelector && element.className.indexOf(stopSelector) > -1) {
                    break;
                }
                element = element.parentElement;
            }
            return _returnVal;
        },

        // Will replace class names on element
        elementReplaceClasses: function(element, replaceClass, replaceWith) {
            if (this.elementHasClass(element, replaceClass)) {
                this.elementRemoveClass(element, replaceClass);
                this.elementAddClass(element, replaceWith);
            }
        },

        // When element in visible port view, will return true
        isElementVisible: function(element, fraction) {
            fraction = fraction || 0.8;

            var offset = this.elementOffset(element);
            var x = offset.left;
            var y = offset.top;
            var w = element.offsetWidth;
            var h = element.offsetHeight;
            var right = x + w;
            var bottom = y + h;

            var visibleX = Math.max(0, Math.min(w, window.pageXOffset + window.innerWidth - x, right - window.pageXOffset));
            var visibleY = Math.max(0, Math.min(h, window.pageYOffset + window.innerHeight - y, bottom - window.pageYOffset));

            var visible = visibleX * visibleY / (w * h);

            return (visible > fraction);
        },

        keyboardUnfocus: function() {
            if (document.activeElement)
                document.activeElement.blur();
        }

    };
});

Scoped.define("module:FlashHelper", ["base:Time","base:Objs","base:Types","base:Net.Uri","base:Ids","module:Info","module:Dom"], function (Time, Objs, Types, Uri, Ids, Info, Dom) {
    return {

        getFlashObject: function(container) {
            container = Dom.unbox(container);
            var embed = container.getElementsByTagName("EMBED")[0];
            if (Info.isInternetExplorer() && Info.internetExplorerVersion() <= 10)
                embed = null;
            if (!embed)
                embed = container.getElementsByTagName("OBJECT")[0];
            if (!embed) {
                var objs = document.getElementsByTagName("OBJECT");
                for (var i = 0; i < objs.length; ++i)
                    if (container.contains(objs[i]))
                        embed = objs[i];
            }
            return embed;
        },

        embedTemplate: function(options) {
            options = options || {};
            var params = [];
            params.push({
                "objectKey": "classid",
                "value": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
            });
            params.push({
                "objectKey": "codebase",
                "value": "http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"
            });
            params.push({
                "embedKey": "align",
                "value": "middle"
            });
            params.push({
                "embedKey": "play",
                "value": "true"
            });
            params.push({
                "embedKey": "loop",
                "value": "false"
            });
            params.push({
                "embedKey": "type",
                "value": "application/x-shockwave-flash"
            });
            params.push({
                "embedKey": "pluginspage",
                "value": "http://www.adobe.com/go/getflashplayer"
            });
            params.push({
                "objectParam": "quality",
                "embedKey": "quality",
                "value": "high"
            });
            params.push({
                "objectParam": "allowScriptAccess",
                "embedKey": "allowScriptAccess",
                "value": "always"
            });
            params.push({
                "objectParam": "wmode",
                "embedKey": "wmode",
                "value": "opaque"
            });
            params.push({
                "objectParam": "movie",
                "embedKey": "src",
                "value": options.flashFile + (options.forceReload ? "?" + Time.now() : "")
            });
            if (options.width) {
                params.push({
                    "objectKey": "width",
                    "embedKey": "width",
                    "value": options.width
                });
            }
            if (options.height) {
                params.push({
                    "objectKey": "height",
                    "embedKey": "height",
                    "value": options.height
                });
            }
            if (options.bgcolor) {
                params.push({
                    "objectParam": "bgcolor",
                    "embedKey": "bgcolor",
                    "value": options.bgcolor
                });
            }
            if (options.FlashVars) {
                params.push({
                    "objectParam": "FlashVars",
                    "embedKey": "FlashVars",
                    "value": Types.is_object(options.FlashVars) ? Uri.encodeUriParams(options.FlashVars) : options.FlashVars
                });
            }
            params.push({
                "objectKey": "id",
                "value": options.objectId || Ids.uniqueId("flash")
            });
            var objectKeys = [];
            var objectParams = [];
            var embedKeys = [];
            Objs.iter(params, function(param) {
                if (param.objectKey)
                    objectKeys.push(param.objectKey + '="' + param.value + '"');
                if (param.embedKey)
                    embedKeys.push(param.embedKey + '="' + param.value + '"');
                if (param.objectParam)
                    objectParams.push('<param name="' + param.objectParam + '" value="' + param.value + '" />');
            }, this);
            return "<object " + objectKeys.join(" ") + ">" + objectParams.join(" ") + "<embed " + embedKeys.join(" ") + "></embed></object>";
        },

        embedFlashObject: function(container, options) {
            container = Dom.unbox(container);
            options = options || {};
            if (options.parentBgcolor) {
                try {
                    var hex = container.style.backgroundColor || "";
                    if (hex.indexOf("rgb") >= 0) {
                        var rgb = hex.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                        var convert = function(x) {
                            return ("0" + parseInt(x, 10).toString(16)).slice(-2);
                        };
                        if (rgb && rgb.length > 3)
                            hex = "#" + convert(rgb[1]) + convert(rgb[2]) + convert(rgb[3]);
                    }
                    options.bgcolor = hex;
                } catch (e) {}
            }
            if (options.fixHalfPixels) {
                try {
                    var offset = Dom.elementOffset(container);
                    if (offset.top % 1 !== 0)
                        container.style.marginTop = (Math.round(offset.top) - offset.top) + "px";
                    if (offset.left % 1 !== 0)
                        container.style.marginLeft = (Math.round(offset.left) - offset.left) + "px";
                } catch (e) {}
            }
            container.innerHTML = this.embedTemplate(options);
            return this.getFlashObject(container);
        }

    };
});

Scoped.define("module:Events", ["base:Class","base:Objs","base:Functions"], function (Class, Objs, Functions, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function() {
                inherited.constructor.call(this);
                this.__callbacks = {};
            },

            destroy: function() {
                this.clear();
                inherited.destroy.call(this);
            },

            on: function(element, events, callback, context) {
                events.split(" ").forEach(function(event) {
                    if (!event)
                        return;
                    var callback_function = Functions.as_method(callback, context || element);
                    element.addEventListener(event, callback_function, false);
                    this.__callbacks[event] = this.__callbacks[event] || [];
                    this.__callbacks[event].push({
                        element: element,
                        callback_function: callback_function,
                        callback: callback,
                        context: context
                    });
                }, this);
                return this;
            },

            off: function(element, events, callback, context) {
                events.split(" ").forEach(function(event) {
                    if (!event)
                        return;
                    var entries = this.__callbacks[event];
                    if (entries) {
                        var i = 0;
                        while (i < entries.length) {
                            var entry = entries[i];
                            if ((!element || element == entry.element) && (!callback || callback == entry.callback) && (!context || context == entry.context)) {
                                entry.element.removeEventListener(event, entry.callback_function, false);
                                entries[i] = entries[entries.length - 1];
                                entries.pop();
                            } else
                                ++i;
                        }
                    }
                }, this);
                return this;
            },

            clear: function() {
                Objs.iter(this.__callbacks, function(entries, event) {
                    entries.forEach(function(entry) {
                        entry.element.removeEventListener(event, entry.callback_function, false);
                    });
                });
                this.__callbacks = {};
            }

        };
    });
});

Scoped.define("module:DomMutation.NodeRemoveObserver", ["base:Classes.ConditionalInstance","base:Events.EventsMixin"], function (ConditionalInstance, EventsMixin, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(node) {
                inherited.constructor.call(this);
                this._node = node;
            },

            _nodeRemoved: function(node) {
                if (node !== this._node)
                    return;
                this.trigger("node-removed");
            }

        };
    }]);
});

Scoped.define("module:DomMutation.MutationObserverNodeRemoveObserver", ["module:DomMutation.NodeRemoveObserver","base:Objs"], function (Observer, Objs, scoped) {
    return Observer.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node) {
                inherited.constructor.call(this, node);
                var self = this;
                this._observer = new window.MutationObserver(function(mutations) {
                    Objs.iter(mutations, function(mutation) {
                        for (var i = 0; i < mutation.removedNodes.length; ++i)
                            self._nodeRemoved(mutation.removedNodes[i]);
                    });
                });
                this._observer.observe(node.parentNode, {
                    childList: true
                });
            },

            destroy: function() {
                this._observer.disconnect();
                inherited.destroy.call(this);
            }

        };
    }, {

        supported: function(node) {
            try {
                return !!window.MutationObserver;
            } catch (e) {
                return false;
            }
        }

    });
});

Scoped.define("module:DomMutation.DOMNodeRemovedNodeRemoveObserver", ["module:DomMutation.NodeRemoveObserver","module:Info","module:Events"], function (Observer, Info, Events, scoped) {
    return Observer.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node) {
                inherited.constructor.call(this, node);
                var events = this.auto_destroy(new Events());
                events.on(document, "DOMNodeRemoved", function(event) {
                    this._nodeRemoved(event.target);
                }, this);
            }

        };
    }, {

        supported: function(node) {
            return !Info.isInternetExplorer() || Info.internetExplorerVersion() >= 9;
        }

    });

});

Scoped.define("module:DomMutation.TimerNodeRemoveObserver", ["module:DomMutation.NodeRemoveObserver","base:Timers.Timer"], function (Observer, Timer, scoped) {
    return Observer.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node) {
                inherited.constructor.call(this, node);
                this._timer = new Timer({
                    context: this,
                    fire: this._fire,
                    delay: 100
                });
            },

            destroy: function() {
                this._timer.weakDestroy();
                inherited.destroy.call(this);
            },

            _fire: function() {
                if (!this._node.parentElement) {
                    this._timer.stop();
                    this._nodeRemoved(this._node);
                }
            }

        };
    }, {

        supported: function(node) {
            return true;
        }

    });

});

Scoped.extend("module:DomMutation.NodeRemoveObserver", ["module:DomMutation.NodeRemoveObserver","module:DomMutation.MutationObserverNodeRemoveObserver","module:DomMutation.DOMNodeRemovedNodeRemoveObserver","module:DomMutation.TimerNodeRemoveObserver"], function (Observer, MutationObserverNodeRemoveObserver, DOMNodeRemovedNodeRemoveObserver, TimerNodeRemoveObserver) {
    Observer.register(MutationObserverNodeRemoveObserver, 3);
    Observer.register(DOMNodeRemovedNodeRemoveObserver, 2);
    Observer.register(TimerNodeRemoveObserver, 1);
    return {};
});

Scoped.define("module:DomMutation.NodeResizeObserver", ["base:Class","base:Events.EventsMixin","module:Events"], function (Class, EventsMixin, Events, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(node) {
                inherited.constructor.call(this);
                var events = this.auto_destroy(new Events());
                events.on(window, "resize", function(event) {
                    this._resized();
                }, this);
            },

            _resized: function() {
                this.trigger("node-resized");
            }

        };
    }]);
});

Scoped.define("module:DomExtend.DomExtension", ["base:Class","base:Objs","base:Functions","base:Async","module:Dom","module:DomMutation.NodeRemoveObserver","module:DomMutation.NodeResizeObserver"], function (Class, Objs, Functions, Async, Dom, NodeRemoveObserver, NodeResizeObserver, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            _domMethods: [],
            _domAttrs: {},

            constructor: function(element, attrs) {
                inherited.constructor.call(this);
                this._element = Dom.unbox(element);
                this._element.domExtension = this;
                this._actualBB = null;
                this._idealBB = null;
                this._attrs = attrs || {};
                Objs.iter(this._domMethods, function(method) {
                    this._element[method] = Functions.as_method(this[method], this);
                }, this);
                Objs.iter(['get', 'set'], function(method) {
                    this._element[method] = Functions.as_method(this[method], this);
                }, this);
                Async.eventually(function() {
                    this._nodeRemoveObserver = this.auto_destroy(new NodeRemoveObserver(this._element));
                    this._nodeRemoveObserver.on("node-removed", this.weakDestroy, this);
                    this._nodeResizeObserver = this.auto_destroy(new NodeResizeObserver(this._element));
                    this._nodeResizeObserver.on("node-resized", function() {
                        this.recomputeBB();
                        this._notify("resized");
                    }, this);
                }, this);
                if (!this._element.style.display || this._element.style.display == "inline")
                    this._element.style.display = "inline-block";
            },

            domEvent: function(eventName) {
                Dom.triggerDomEvent(this._element, eventName);
            },

            readAttr: function(key) {
                return key in this._element.attributes ? this._element.attributes[key].value : (key in this._element ? this._element[key] : this._attrs[key]);
            },

            hasAttr: function(key) {
                return key in this._element.attributes || key in this._element || key in this._attrs;
            },

            writeAttr: function(key, value) {
                if (key in this._element.attributes)
                    this._element.attributes[key].value = value;
                else if (key in this._element)
                    this._element[key] = value;
                else
                    this._attrs[key] = value;
            },

            unsetAttr: function(key) {
                delete this._element[key];
                this._element.removeAttribute(key);
                delete this._attrs[key];
            },

            get: function(key) {
                var meta = this._domAttrs[key] || {};
                if (!(meta.get))
                    return this.readAttr(key);
                var value = Functions.callWithin(this, meta.get);
                this.writeAttr(key, value);
                return value;
            },

            set: function(key, value) {
                this.writeAttr(key, value);
                var meta = this._domAttrs[key] || {};
                if (meta.set)
                    Functions.callWithin(this, meta.set, value);
            },

            computeActualBB: function(idealBB) {
                var width = Dom.elementDimensions(this._element).width;
                //var height = Dom.elementDimensions(this._element).height;
                if (width < idealBB.width && !this._element.style.width) {
                    this._element.style.width = idealBB.width + "px";
                    width = Dom.elementDimensions(this._element).width;
                    var current = this._element;
                    while (current != document.body) {
                        current = current.parentNode;
                        width = Math.min(width, Dom.elementDimensions(current).width);
                    }
                    this._element.style.width = null;
                }
                /*
                if (height < idealBB.height && !this._element.style.height) {
                	this._element.style.height = idealBB.height + "px";
                	height = Dom.elementDimensions(this._element).height;
                	var current = this._element;
                	while (current != document) {
                		current = current.parentNode;
                		height = Math.min(height, Dom.elementDimensions(current).height);
                	}
                	this._element.style.height = null;
                }
                var arWidth = Math.round(height * idealBB.width / idealBB.height);
                var arHeight = Math.round(width * idealBB.height / idealBB.width);
                return {
                	width: Math.min(width, arWidth),
                	height: Math.min(height, arHeight)
                };
                */
                return {
                    width: width,
                    height: width * idealBB.height / idealBB.width
                };
            },

            idealBB: function() {
                return null;
            },

            recomputeBB: function() {
                var idealBB = this.idealBB();
                if (!idealBB)
                    return;
                var actualBB = this.computeActualBB(idealBB);
                this._idealBB = idealBB;
                this._actualBB = actualBB;
                this.setActualBB(actualBB);
            },

            setActualBB: function(actualBB) {}

        };
    });
});

Scoped.define("module:Upload.FileUploader", ["base:Classes.ConditionalInstance","base:Events.EventsMixin","base:Objs","base:Types","base:Async","base:Promise"], function (ConditionalInstance, EventsMixin, Objs, Types, Async, Promise, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                // idle, uploading, success, error
                this._state = "idle";
            },

            _setState: function(state, triggerdata) {
                this._state = state;
                this.trigger(state, triggerdata);
                this.trigger("state", state, triggerdata);
            },

            state: function() {
                return this._state;
            },

            data: function() {
                return this._data;
            },

            progress: function() {
                return {
                    uploaded: this._uploaded,
                    total: this._total
                };
            },

            reset: function() {
                if (this.state() === "error") {
                    this._setState("idle");
                    delete this._data;
                    delete this._uploaded;
                    delete this._total;
                }
            },

            upload: function() {
                if (this.state() !== "idle")
                    return this;
                this._setState("uploading");
                this.__upload();
                return this;
            },

            __upload: function() {
                this._options.resilience--;
                this._upload();
            },

            _upload: function() {},

            _progressCallback: function(uploaded, total) {
                if (this.state() !== "uploading")
                    return;
                this._uploaded = uploaded;
                this._total = total;
                this.trigger("progress", uploaded, total);
            },

            _successCallback: function(data) {
                if (this.state() !== "uploading")
                    return;
                this._data = data;
                this._setState("success", data);
            },

            _errorCallback: function(data) {
                if (this.state() !== "uploading")
                    return;
                try {
                    if (data.data)
                        data = data.data();
                    if (Types.is_string(data))
                        data = JSON.parse(data);
                } catch (e) {}
                if (this._options.resilience > 0) {
                    if (!this._options.resilienceCheck || this._options.resilienceCheck(data)) {
                        Async.eventually(function() {
                            this.__upload();
                        }, this, this._options.resilience_delay);
                        return;
                    }
                }
                if (!this._options.essential) {
                    this._successCallback({});
                    return;
                }
                this._data = data;
                this._setState("error", data);
            },

            uploadedBytes: function() {
                return this._uploaded;
            },

            totalBytes: function() {
                if (this._total)
                    return this._total;
                if (this._options.source) {
                    if (!this._options.isBlob && this._options.source.files && this._options.source.files[0])
                        return this._options.source.files[0].size;
                    return this._options.source.size || 0;
                }
                return 0;
            }

        };
    }], {

        _initializeOptions: function(options) {
            options = options || {};
            return Objs.extend({
                //url: "",
                //source: null,
                serverSupportChunked: false,
                serverSupportPostMessage: false,
                isBlob: typeof(window.Blob) !== "undefined" && options.source instanceof(window.Blob),
                resilience: 1,
                resilience_delay: 1000,
                essential: true,
                data: {}
            }, options);
        }

    });
});

Scoped.define("module:Upload.FormDataFileUploader", ["module:Upload.FileUploader","module:Info","base:Ajax.Support","base:Objs"], function (FileUploader, Info, AjaxSupport, Objs, scoped) {
    return FileUploader.extend({
        scoped: scoped
    }, {

        _upload: function() {
            return AjaxSupport.execute({
                method: "POST",
                uri: this._options.url,
                decodeType: "text",
                data: Objs.extend({
                    file: this._options.isBlob ? this._options.source : this._options.source.files[0]
                }, this._options.data)
            }, this._progressCallback, this).success(this._successCallback, this).error(this._errorCallback, this);
        }

    }, {

        supported: function(options) {
            if (Info.isInternetExplorer() && Info.internetExplorerVersion() <= 9)
                return false;
            try {
                new(window.FormData)();
            } catch (e) {
                return false;
            }
            return true;
        }

    });
});

Scoped.define("module:Upload.FormIframeFileUploader", ["module:Upload.FileUploader","base:Net.Uri","base:Objs","base:Async"], function (FileUploader, Uri, Objs, Async, scoped) {
    return FileUploader.extend({
        scoped: scoped
    }, {

        _upload: function() {
            var self = this;
            var iframe = document.createElement("iframe");
            var id = "upload-iframe-" + this.cid();
            iframe.id = id;
            iframe.name = id;
            iframe.style.display = "none";
            var form = document.createElement("form");
            form.method = "POST";
            form.target = id;
            form.style.display = "none";
            document.body.appendChild(iframe);
            document.body.appendChild(form);
            var oldParent = this._options.source.parent;
            form.appendChild(this._options.source);
            if (!this._options.source.name)
                this._options.source.name = "file";
            Objs.iter(this._options.data, function(value, key) {
                var input = document.createElement("input");
                input.type = "hidden";
                input.name = key;
                input.value = value;
                form.appendChild(input);
            }, this);
            var post_message_fallback = !("postMessage" in window);
            var handle_success = null;
            var message_event_handler = function(event) {
                handle_success(event.data);
            };
            iframe.onerror = function() {
                if (post_message_fallback)
                    window.postMessage = null;
                window.removeEventListener("message", message_event_handler, false);
                if (oldParent)
                    oldParent.appendChild(self._options.source);
                document.body.removeChild(form);
                document.body.removeChild(iframe);
                self._errorCallback();
            };
            var post_message_key = this._options.serverPostMessageKey || "_postmessage";
            var post_message_id_key = this._options.serverPostMessageIdKey || "_postmessageid";
            var post_message_id_value = this.cid();
            var support_id = this._options.serverSupportPostMessageId;
            var query_params = {};
            query_params[post_message_key] = true;
            if (support_id)
                query_params[post_message_id_key] = post_message_id_value;
            form.action = Uri.appendUriParams(this._options.url, query_params);
            form.encoding = form.enctype = "multipart/form-data";
            handle_success = function(raw_data) {
                try {
                    var data = JSON.parse(raw_data);
                    if (support_id && data[post_message_id_key] !== post_message_id_value)
                        return;
                    if (post_message_fallback)
                        window.postMessage = null;
                    if (oldParent)
                        oldParent.appendChild(self._options.source);
                    document.body.removeChild(form);
                    document.body.removeChild(iframe);
                    self._successCallback(data);
                    Async.eventually(function() {
                        window.removeEventListener("message", message_event_handler, false);
                    });
                } catch (e) {}
            };
            window.addEventListener("message", message_event_handler, false);
            if (post_message_fallback)
                window.postMessage = handle_success;
            form.submit();
        }

    }, {

        supported: function(options) {
            return !options.isBlob && options.serverSupportPostMessage;
        }

    });
});

Scoped.define("module:Upload.CordovaFileUploader", ["module:Upload.FileUploader","module:Info","base:Promise"], function (FileUploader, Info, Promise, scoped) {
    return FileUploader.extend({
        scoped: scoped
    }, {

        _acquirePermission: function() {
            var promise = Promise.create();
            if (Info.isAndroid()) {
                var perms = cordova.plugins.permissions;
                perms.checkPermission(perms.READ_EXTERNAL_STORAGE, function(status) {
                    if (!status.hasPermission) {
                        perms.requestPermission(perms.READ_EXTERNAL_STORAGE, function(status) {
                            if (status.hasPermission)
                                promise.asyncSuccess(true);
                            else
                                promise.asyncError("Access to storage was not granted");
                        }, function() {
                            promise.asyncError("Could not request storage permission");
                        });
                    } else
                        promise.asyncSuccess(true);
                }, function() {
                    promise.asyncError("Could not check storage permission");
                });
            } else
                promise.asyncSuccess(true);
            return promise;
        },

        _upload: function() {
            return this._acquirePermission().mapSuccess(function() {
                var self = this;
                //var fileURI = this._options.source.localURL;
                var fileURI = this._options.source.fullPath.split(':')[1];
                var fileUploadOptions = new window.FileUploadOptions();
                fileUploadOptions.fileKey = "file";
                fileUploadOptions.fileName = fileURI.substr(fileURI.lastIndexOf('/') + 1);
                fileUploadOptions.mimeType = this._options.source.type;
                fileUploadOptions.httpMethod = "POST";
                fileUploadOptions.params = this._options.data;
                var fileTransfer = new window.FileTransfer();
                fileTransfer.upload(fileURI, this._options.url, function(data) {
                    self._successCallback(data);
                }, function(data) {
                    self._errorCallback(data);
                }, fileUploadOptions);
            }, this);
        }

    }, {

        supported: function(options) {
            var result = !!navigator.device &&
                !!navigator.device.capture &&
                !!navigator.device.capture.captureVideo &&
                !!window.FileTransfer &&
                !!window.FileUploadOptions &&
                !options.isBlob &&
                ("localURL" in options.source);
            return result;
        }

    });
});

Scoped.define("module:Upload.MultiUploader", ["module:Upload.FileUploader","base:Objs"], function (FileUploader, Objs, scoped) {
    return FileUploader.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                this._uploaders = {};
                this._uploadLimit = this._options.uploadLimit || 5;
                this._uploadingCount = 0;
                this._end = !this._options.manualEnd;
            },

            end: function() {
                this._end = true;
                this._updateState();
            },

            addUploader: function(uploader) {
                this._uploaders[uploader.cid()] = uploader;
                uploader.on("state", this._updateState, this);
                uploader.on("progress", this._updateProgress, this);
                if (this.state() === "uploading") {
                    if (uploader.state() === "error")
                        uploader.reset();
                    if (uploader.state() === "idle" && this._uploadingCount < this._uploadLimit) {
                        this._uploadingCount++;
                        uploader.upload();
                    }
                }
                return this;
            },

            _upload: function() {
                Objs.iter(this._uploaders, function(uploader) {
                    if (uploader.state() === "error")
                        uploader.reset();
                    if (uploader.state() === "idle" && this._uploadingCount < this._uploadLimit) {
                        this._uploadingCount++;
                        uploader.upload();
                    }
                }, this);
                this._updateState();
            },

            _updateState: function() {
                if (this.state() !== "uploading")
                    return;
                this._uploadingCount = 0;
                var error = false;
                var idleCount = 0;
                Objs.iter(this._uploaders, function(uploader) {
                    switch (uploader.state()) {
                        case "uploading":
                            this._uploadingCount++;
                            break;
                        case "error":
                            error = true;
                            break;
                        case "idle":
                            idleCount++;
                            break;
                    }
                }, this);
                if (idleCount > 0 && this._uploadingCount < this._uploadLimit) {
                    Objs.iter(this._uploaders, function(uploader) {
                        if (this._uploadingCount < this._uploadLimit && uploader.state() === "idle") {
                            uploader.upload();
                            idleCount--;
                            this._uploadingCount++;
                        }
                    }, this);
                }
                if (this._uploadingCount > 0)
                    return;
                if (!this._end)
                    return;
                var datas = [];
                Objs.iter(this._uploaders, function(uploader) {
                    var result = (error && uploader.state() === "error") || (!error && uploader.state() === "success") ? uploader.data() : undefined;
                    datas.push(result);
                }, this);
                if (error > 0)
                    this._errorCallback(datas);
                else
                    this._successCallback(datas);
            },

            _updateProgress: function() {
                if (this.state() !== "uploading")
                    return;
                this._progressCallback(this.uploadedBytes(), this.totalBytes());
            },

            uploadedBytes: function() {
                var uploaded = 0;
                Objs.iter(this._uploaders, function(uploader) {
                    uploaded += uploader.uploadedBytes();
                }, this);
                return uploaded;
            },

            totalBytes: function() {
                var total = 0;
                Objs.iter(this._uploaders, function(uploader) {
                    total += uploader.totalBytes();
                }, this);
                return total;
            }

        };
    });
});

Scoped.define("module:Blobs", ["base:Promise"], function (Promise) {
    return {

        createBlobByArrayBufferView: function(arrayBuffer, offset, size, type) {
            try {
                return new(window.Blob)([new DataView(arrayBuffer, offset, size)], {
                    type: type
                });
            } catch (e) {
                try {
                    return new(window.Blob)([new Uint8Array(arrayBuffer, offset, size)], {
                        type: type
                    });
                } catch (e) {
                    var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;
                    var bb = new BlobBuilder();
                    bb.append(arrayBuffer.slice(offset, offset + size));
                    return bb.getBlob(type);
                }
            }
        },

        loadFileIntoArrayBuffer: function(file) {
            var promise = Promise.create();
            try {
                var fileReader = new FileReader();
                fileReader.onloadend = function(e) {
                    promise.asyncSuccess(e.target.result);
                };
                fileReader.readAsArrayBuffer(file.files ? file.files[0] : file);
            } catch (e) {
                promise.asyncError(e);
            }
            return e;
        },

        loadFileIntoString: function(file) {
            var promise = Promise.create();
            try {
                var fileReader = new FileReader();
                fileReader.onloadend = function(e) {
                    promise.asyncSuccess(e.target.result);
                };
                fileReader.readAsText(file.files ? file.files[0] : file);
            } catch (e) {
                promise.asyncError(e);
            }
            return e;
        }

    };
});

Scoped.define("module:Upload.ChunkedFileUploader", ["module:Upload.FileUploader","module:Upload.MultiUploader","module:Blobs","base:Promise","base:Objs","base:Tokens","base:Ajax.Support"], function (FileUploader, MultiUploader, Blobs, Promise, Objs, Tokens, AjaxSupport, scoped) {

    return FileUploader.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                this._multiUploader = new MultiUploader({
                    uploadLimit: this._options.uploadLimit
                });
                this._options.identifierParameter = this._options.identifierParameter || "identifier";
                this._options.chunks = Objs.extend({
                    size: 1000000,
                    chunkNumberParameter: "chunknumber"
                }, this._options.chunks);
                this._options.assembly = Objs.extend({
                    fileNameParameter: "filename",
                    totalSizeParameter: "totalsize",
                    chunkNumberParameter: "chunknumber",
                    fileTypeParameter: "filetype",
                    ajaxOptions: null
                }, this._options.assembly);
            },

            destroy: function() {
                this._multiUploader.destroy();
                inherited.destroy.call(this);
            },

            reset: function() {
                inherited.reset.call(this);
                this._multiUploader.destroy();
                this._multiUploader = new MultiUploader({
                    uploadLimit: this._options.uploadLimit
                });
            },

            __generateIdentifier: function() {
                return Tokens.generate_token();
            },

            _upload: function() {
                var identifier = this.__generateIdentifier();
                var file = this._options.isBlob ? this._options.source : this._options.source.files[0];
                Blobs.loadFileIntoArrayBuffer(file).success(function(arrayBuffer) {
                    var chunkNumber = 0;
                    while (chunkNumber * this._options.chunks.size < file.size) {
                        var data = {};
                        data[this._options.chunks.chunkNumberParameter] = chunkNumber + 1;
                        data[this._options.identifierParameter] = identifier;
                        var offset = chunkNumber * this._options.chunks.size;
                        var size = Math.min(this._options.chunks.size, file.size - offset);
                        this._multiUploader.addUploader(this._multiUploader.auto_destroy(FileUploader.create({
                            url: this._options.chunks.url || this._options.url,
                            source: Blobs.createBlobByArrayBufferView(arrayBuffer, offset, size, file.type),
                            data: Objs.extend(data, this._options.data)
                        })));
                        chunkNumber++;
                    }
                    this._multiUploader.on("error", function(error) {
                        this._errorCallback(error);
                    }, this).on("progress", function(uploaded, total) {
                        this._progressCallback(uploaded, total);
                    }, this).on("success", function() {
                        var data = {};
                        data[this._options.identifierParameter] = identifier;
                        data[this._options.assembly.fileNameParameter] = file.name || "blob";
                        data[this._options.assembly.totalSizeParameter] = file.size;
                        data[this._options.assembly.chunkNumberParameter] = chunkNumber;
                        data[this._options.assembly.fileTypeParameter] = file.type;
                        AjaxSupport.execute(Objs.extend({
                            method: "POST",
                            uri: this._options.assembly.url || this._options.url,
                            data: Objs.extend(data, this._options.data)
                        }, this._options.assembly.ajaxOptions)).success(function() {
                            this._successCallback();
                        }, this).error(function(error) {
                            this._errorCallback(error);
                        }, this);
                    }, this);
                    this._multiUploader.upload();
                }, this);
            }

        };
    }, {

        supported: function(options) {
            return typeof(window.Blob) !== "undefined" && typeof FileReader !== "undefined" && typeof DataView !== "undefined" && options.serverSupportsChunked;
        }

    });

});

Scoped.extend("module:Upload.FileUploader", ["module:Upload.FileUploader","module:Upload.FormDataFileUploader","module:Upload.FormIframeFileUploader","module:Upload.CordovaFileUploader","module:Upload.ChunkedFileUploader"], function (FileUploader, FormDataFileUploader, FormIframeFileUploader, CordovaFileUploader, ChunkedFileUploader) {
    FileUploader.register(FormDataFileUploader, 2);
    FileUploader.register(FormIframeFileUploader, 1);
    FileUploader.register(CordovaFileUploader, 4);
    FileUploader.register(ChunkedFileUploader, 5);
    return {};
});

Scoped.define("module:Upload.CustomUploader", ["module:Upload.FileUploader"], function (FileUploader, scoped) {
    return FileUploader.extend({
        scoped: scoped
    }, {

        _upload: function() {
            this.trigger("upload", this._options);
        },

        progressCallback: function(uploaded, total) {
            this._progressCallback(uploaded, total);
        },

        successCallback: function(data) {
            this._successCallback(data);
        },

        errorCallback: function(data) {
            this._errorCallback(data);
        }

    });
});

Scoped.define("module:Loader", ["base:Ajax.Support","module:Info"], function (AjaxSupport, Info) {
    return {

        loadScript: function(url, callback, context) {
            var executed = false;
            var head = document.getElementsByTagName("head")[0];
            var script = document.createElement("script");
            script.src = url;
            script.onload = script.onreadystatechange = function() {
                if (!executed && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
                    executed = true;
                    script.onload = script.onreadystatechange = null;
                    if (callback)
                        callback.call(context || this, url);
                    // Does not work properly if we remove the script for some reason if it is used the second time !?
                    //head.removeChild(script);
                }
            };
            head.appendChild(script);
        },

        loadStyles: function(url, callback, context) {
            var executed = false;
            var head = document.getElementsByTagName("head")[0];
            var style = document.createElement("link");
            style.rel = "stylesheet";
            style.href = url;
            style.onload = style.onreadystatechange = function() {
                if (!executed && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
                    executed = true;
                    style.onload = style.onreadystatechange = null;
                    if (callback)
                        callback.call(context || this, url);
                }
            };
            head.appendChild(style);
        },

        inlineStyles: function(styles) {
            var head = document.getElementsByTagName("head")[0];
            var style = document.createElement("style");
            if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 9) {
                style.setAttribute('type', 'text/css');
                style.styleSheet.cssText = styles;
            } else
                style.textContent = styles;
            head.appendChild(style);
            return style;
        },

        loadHtml: function(uri, callback, context) {
            AjaxSupport.execute({
                uri: uri,
                decodeType: "html"
            }).success(function(content) {
                callback.call(this, content, uri);
            }, context);
        },

        findScript: function(substr) {
            for (var i = 0; i < document.scripts.length; ++i)
                if (document.scripts[i].src.toLowerCase().indexOf(substr.toLowerCase()) >= 0)
                    return document.scripts[i];
            return null;
        },

        loadByIframe: function(options, callback, context) {
            var iframe = document.createElement("iframe");
            if (options.visible) {
                iframe.style.border = "none";
                iframe.style.width = "1px";
                iframe.style.height = "1px";
            } else {
                iframe.style.display = "none";
            }
            var loaded = function() {
                var body = null;
                var content = null;
                try {
                    body = iframe.contentDocument.body;
                    content = body.textContent || body.innerText;
                } catch (e) {}
                callback.call(context || this, content, body, iframe);
                if (options.remove)
                    document.body.removeChild(iframe);
            };
            if (iframe.attachEvent)
                iframe.attachEvent("onload", loaded);
            else
                iframe.onload = loaded;
            iframe.src = options.url;
            document.body.appendChild(iframe);
        }

    };
});

Scoped.define("module:Hotkeys", ["base:Objs"], function (Objs) {
    return {

        SHIFT_NUMS: {
            "`": "~",
            "1": "!",
            "2": "@",
            "3": "#",
            "4": "$",
            "5": "%",
            "6": "^",
            "7": "&",
            "8": "*",
            "9": "(",
            "0": ")",
            "-": "_",
            "=": "+",
            ";": ":",
            "'": "\"",
            ",": "<",
            ".": ">",
            "/": "?",
            "\\": "|"
        },

        SPECIAL_KEYS: {
            'esc': 27,
            'escape': 27,
            'tab': 9,
            'space': 32,
            'return': 13,
            'enter': 13,
            'backspace': 8,

            'scrolllock': 145,
            'scroll_lock': 145,
            'scroll': 145,
            'capslock': 20,
            'caps_lock': 20,
            'caps': 20,
            'numlock': 144,
            'num_lock': 144,
            'num': 144,

            'pause': 19,
            'break': 19,

            'insert': 45,
            'home': 36,
            'delete': 46,
            'end': 35,

            'pageup': 33,
            'page_up': 33,
            'pu': 33,

            'pagedown': 34,
            'page_down': 34,
            'pd': 34,

            'left': 37,
            'up': 38,
            'right': 39,
            'down': 40,

            'f1': 112,
            'f2': 113,
            'f3': 114,
            'f4': 115,
            'f5': 116,
            'f6': 117,
            'f7': 118,
            'f8': 119,
            'f9': 120,
            'f10': 121,
            'f11': 122,
            'f12': 123
        },

        MODIFIERS: ["ctrl", "alt", "shift", "meta"],

        keyCodeToCharacter: function(code) {
            if (code == 188)
                return ",";
            else if (code == 190)
                return ".";
            return String.fromCharCode(code).toLowerCase();
        },

        handleKeyEvent: function(hotkey, e, options) {
            options = Objs.extend({
                "disable_in_input": false,
                "keycode": false
            }, options);
            var keys = hotkey.toLowerCase().split("+");
            if (options.disable_in_input) {
                var element = e.target || e.srcElement || null;
                if (element && element.nodeType == 3)
                    element = element.parentNode;
                if (element && (element.tagName == 'INPUT' || element.tagName == 'TEXTAREA'))
                    return false;
            }
            var code = e.keyCode || e.which || 0;
            var character = this.keyCodeToCharacter(code);
            var kp = 0;
            var modifier_map = {};
            Objs.iter(this.MODIFIERS, function(mod) {
                modifier_map[mod] = {
                    pressed: e[mod + "Key"],
                    wanted: false
                };
            }, this);
            Objs.iter(keys, function(key) {
                if (key in modifier_map) {
                    modifier_map[key].wanted = true;
                    kp++;
                } else if (key.length > 1) {
                    if (this.SPECIAL_KEYS[key] == code)
                        kp++;
                } else if (options.keycode) {
                    if (options.keycode == code)
                        kp++;
                } else if (character == key || (e.shiftKey && this.SHIFT_NUMS[character] == key)) {
                    kp++;
                }
            }, this);
            /**
             * Allow to use use several keys for one action
             * @example: ba-hotkey:space^enter="function(){}"
             */
            var multipleKeys = hotkey.toLowerCase().split("^");
            if (multipleKeys.length > 1) {
                Objs.iter(multipleKeys, function(key) {
                    if (key.length > 1 && e.keyCode === this.SPECIAL_KEYS[key]) {
                        // Prevent browser scroll when press space
                        if (code === 32) e.preventDefault();

                        if (this.SPECIAL_KEYS[key] == code)
                            kp++;
                    }
                }, this);
            }
            return kp == keys.length && Objs.all(modifier_map, function(data) {
                return data.wanted == data.pressed;
            });
        },

        register: function(hotkey, callback, context, options) {
            options = Objs.extend({
                "type": "keyup",
                "propagate": false,
                "disable_in_input": false,
                "target": document,
                "keycode": false
            }, options);
            var self = this;
            var func = function(e) {
                if (self.handleKeyEvent(hotkey, e, options)) {
                    if (!options.propagate) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    callback.call(context || this, e);
                }
            };
            options.target.addEventListener(options.type, func, false);
            return {
                target: options.target,
                type: options.type,
                func: func
            };
        },

        unregister: function(handle) {
            handle.target.removeEventListener(handle.type, handle.func, false);
        }

    };
});

Scoped.define("module:Ajax.IframePostmessageAjax", ["base:Ajax.Support","base:Net.Uri","base:Net.HttpHeader","base:Promise","base:Types","base:Ajax.RequestException","base:Tokens","base:Objs"], function (AjaxSupport, Uri, HttpHeader, Promise, Types, RequestException, Tokens, Objs) {

    var id = 1;

    var Module = {

        supports: function(options) {
            if (!options.postmessage)
                return false;
            return true;
        },

        execute: function(options) {
            var postmessageName = "postmessage_" + Tokens.generate_token() + "_" + (id++);
            var params = Objs.objectBy(options.postmessage, postmessageName);
            params = Objs.extend(params, options.query);
            var uri = Uri.appendUriParams(options.uri, params);
            var iframe = document.createElement("iframe");
            iframe.id = postmessageName;
            iframe.name = postmessageName;
            iframe.style.display = "none";
            var form = document.createElement("form");
            form.method = options.method;
            form.target = postmessageName;
            form.action = uri;
            form.style.display = "none";
            var promise = Promise.create();
            document.body.appendChild(iframe);
            document.body.appendChild(form);
            Objs.iter(options.data, function(value, key) {
                var input = document.createElement("input");
                input.type = "hidden";
                input.name = key;
                input.value = Types.is_array(value) || Types.is_object(value) ? JSON.stringify(value) : value;
                form.appendChild(input);
            }, this);
            var post_message_fallback = !("postMessage" in window);
            var self = this;
            var handle_success = null;
            var message_event_handler = function(event) {
                handle_success(event.data);
            };
            handle_success = function(raw_data) {
                if (typeof raw_data === "string")
                    raw_data = JSON.parse(raw_data);
                if (!(postmessageName in raw_data))
                    return;
                raw_data = raw_data[postmessageName];
                if (post_message_fallback)
                    window.postMessage = null;
                window.removeEventListener("message", message_event_handler, false);
                document.body.removeChild(form);
                document.body.removeChild(iframe);
                AjaxSupport.promiseReturnData(promise, options, raw_data, "json"); //options.decodeType);
            };
            iframe.onerror = function() {
                if (post_message_fallback)
                    window.postMessage = null;
                window.removeEventListener("message", message_event_handler, false);
                document.body.removeChild(form);
                document.body.removeChild(iframe);
                // TODO
                //AjaxSupport.promiseRequestException(promise, xmlhttp.status, xmlhttp.statusText, xmlhttp.responseText, "json"); //options.decodeType);)
            };
            window.addEventListener("message", message_event_handler, false);
            if (post_message_fallback)
                window.postMessage = handle_success;
            form.submit();
            return promise;
        }

    };

    AjaxSupport.register(Module, 4);

    return Module;
});

Scoped.define("module:Ajax.JsonpScriptAjax", ["base:Ajax.Support","base:Net.Uri","base:Net.HttpHeader","base:Promise","base:Types","base:Ajax.RequestException","base:Tokens","base:Objs","base:Async","module:Info"], function (AjaxSupport, Uri, HttpHeader, Promise, Types, RequestException, Tokens, Objs, Async, Info) {

    var id = 1;

    var Module = {

        supports: function(options) {
            if (!options.jsonp)
                return false;
            if (options.method !== "GET")
                return false;
            return true;
        },

        execute: function(options) {
            var callbackName = "jsonp_" + Tokens.generate_token() + "_" + (id++);
            var params = Objs.objectBy(options.jsonp, callbackName);
            params = Objs.extend(params, options.query);
            params = Objs.extend(params, options.data);
            var uri = Uri.appendUriParams(options.uri, params);
            var hasResult = false;

            window[callbackName] = function(data) {
                if (hasResult)
                    return;
                hasResult = true;
                try {
                    delete window[callbackName];
                } catch (e) {
                    window[callbackName] = undefined;
                }
                AjaxSupport.promiseReturnData(promise, options, data, "json"); //options.decodeType);
            };

            var promise = Promise.create();

            var head = document.getElementsByTagName("head")[0];
            var script = document.createElement("script");
            var executed = false;
            script.onerror = function(event) {
                if (event) {
                    if (event.stopPropagation)
                        event.stopPropagation();
                    else
                        event.cancelBubble = true;
                }
                if (hasResult)
                    return;
                hasResult = true;
                AjaxSupport.promiseRequestException(promise, HttpHeader.HTTP_STATUS_BAD_REQUEST, HttpHeader.format(HttpHeader.HTTP_STATUS_BAD_REQUEST), null, "json"); //options.decodeType);)
            };
            script.onload = script.onreadystatechange = function() {
                if (!executed && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
                    executed = true;
                    script.onload = script.onreadystatechange = null;
                    head.removeChild(script);
                    if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 9) {
                        Async.eventually(function() {
                            if (!hasResult)
                                script.onerror();
                        });
                    }
                }
            };

            script.src = uri;
            head.appendChild(script);

            return promise;
        }

    };

    AjaxSupport.register(Module, 5);

    return Module;
});

Scoped.define("module:Ajax.XDomainRequestAjax", ["base:Ajax.Support","base:Net.Uri","base:Net.HttpHeader","base:Promise","base:Types","base:Ajax.RequestException","module:Info","base:Async","base:Ids"], function (AjaxSupport, Uri, HttpHeader, Promise, Types, RequestException, Info, Async, Ids) {

    var Module = {

        // IE Garbage Collection for XDomainRequest is broken
        __requests: {},

        supports: function(options) {
            if (!window.XDomainRequest)
                return false;
            if (options.forceJsonp || options.forcePostmessage)
                return false;
            if (!options.isCorsRequest)
                return false;
            if (!Info.isInternetExplorer() || Info.internetExplorerVersion() > 9)
                return false;
            // TODO: Check Data
            return true;
        },

        execute: function(options) {
            var uri = Uri.appendUriParams(options.uri, options.query || {});
            if (options.method === "GET")
                uri = Uri.appendUriParams(uri, options.data || {});
            var promise = Promise.create();

            var xdomreq = new XDomainRequest();
            Module.__requests[Ids.objectId(xdomreq)] = xdomreq;

            xdomreq.onload = function() {
                // TODO: Figure out response type.
                AjaxSupport.promiseReturnData(promise, options, xdomreq.responseText, "json"); //options.decodeType);
                delete Module.__requests[Ids.objectId(xdomreq)];
            };

            xdomreq.ontimeout = function() {
                AjaxSupport.promiseRequestException(promise, HttpHeader.HTTP_STATUS_GATEWAY_TIMEOUT, HttpHeader.format(HttpHeader.HTTP_STATUS_GATEWAY_TIMEOUT), null, "json"); //options.decodeType);)
                delete Module.__requests[Ids.objectId(xdomreq)];
            };

            xdomreq.onerror = function() {
                AjaxSupport.promiseRequestException(promise, HttpHeader.HTTP_STATUS_BAD_REQUEST, HttpHeader.format(HttpHeader.HTTP_STATUS_BAD_REQUEST), null, "json"); //options.decodeType);)
                delete Module.__requests[Ids.objectId(xdomreq)];
            };

            xdomreq.open(options.method, uri);

            Async.eventually(function() {
                if (options.method !== "GET" && !Types.is_empty(options.data)) {
                    if (options.contentType === "json")
                        xdomreq.send(JSON.stringify(options.data));
                    else {
                        xdomreq.send(Uri.encodeUriParams(options.data, undefined, true));
                    }
                } else
                    xdomreq.send();
            }, this);

            return promise;
        }

    };

    AjaxSupport.register(Module, 9);

    return Module;
});

Scoped.define("module:Ajax.XmlHttpRequestAjax", ["base:Ajax.Support","base:Net.Uri","base:Net.HttpHeader","base:Promise","base:Types","base:Objs","base:Ajax.RequestException","module:Info"], function (AjaxSupport, Uri, HttpHeader, Promise, Types, Objs, RequestException, Info) {

    var Module = {

        supports: function(options) {
            if (!window.XMLHttpRequest)
                return false;
            if (options.forceJsonp || options.forcePostmessage)
                return false;
            if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 10 && options.isCorsRequest)
                return false;
            try {
                Objs.iter(options.data, function(value) {
                    if ((typeof(window.Blob) !== "undefined" && value instanceof(window.Blob)) || (typeof File !== "undefined" && value instanceof File))
                        options.requireFormData = true;
                });
                if (options.requireFormData)
                    new(window.FormData)();
            } catch (e) {
                options.requireFormData = false;
            }
            return true;
        },

        execute: function(options, progress, progressCtx) {
            var uri = Uri.appendUriParams(options.uri, options.query || {});
            if (options.method === "GET")
                uri = Uri.appendUriParams(uri, options.data || {});
            var promise = Promise.create();

            var xmlhttp = new XMLHttpRequest();

            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState === 4) {
                    if (HttpHeader.isSuccessStatus(xmlhttp.status) || (xmlhttp.status === 0 && xmlhttp.responseText)) {
                        AjaxSupport.promiseReturnData(promise, options, options.contentType === "xml" ? xmlhttp.responseXML : xmlhttp.responseText, options.decodeType || "json");
                    } else {
                        AjaxSupport.promiseRequestException(promise, xmlhttp.status, xmlhttp.statusText, xmlhttp.responseText, options.decodeType || "json");
                    }
                }
            };

            if (progress) {
                (xmlhttp.upload || xmlhttp).onprogress = function(e) {
                    if (e.lengthComputable)
                        progress.call(progressCtx || this, e.loaded, e.total);
                };
            }

            xmlhttp.open(options.method, uri, true);

            if (options.corscreds)
                xmlhttp.withCredentials = true;

            if (options.bearer)
                xmlhttp.setRequestHeader('Authorization', 'Bearer ' + options.bearer);

            if (options.method !== "GET" && !Types.is_empty(options.data)) {
                if (options.requireFormData) {
                    var formData = new(window.FormData)();
                    Objs.iter(options.data, function(value, key) {
                        formData.append(key, value);
                    }, this);
                    // xmlhttp.setRequestHeader("Content-Type", "multipart/form-data");
                    xmlhttp.send(formData);
                } else if (options.contentType === "json") {
                    if (options.sendContentType)
                        xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                    xmlhttp.send(JSON.stringify(options.data));
                } else if (options.contentType === "xml") {
                    xmlhttp.overrideMimeType('application/xml');
                    xmlhttp.send(JSON.stringify(options.data));
                } else {
                    if (options.sendContentType)
                        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                    xmlhttp.send(Uri.encodeUriParams(options.data, undefined, true));
                }
            } else
                xmlhttp.send();

            return promise;
        }

    };

    AjaxSupport.register(Module, 10);

    return Module;
});

Scoped.define("module:Cookies", ["base:Net.Cookies"], function (Cookies) {
    return {

        get: function(key) {
            return Cookies.getCookielikeValue(document.cookie, key);
        },

        set: function(key, value, end, path, domain, secure) {
            document.cookie = Cookies.createCookielikeValue(key, value, end, path, domain, secure);
        },

        remove: function(key, value, path, domain) {
            document.cookie = Cookies.removeCookielikeValue(key, value, path, domain);
        },

        has: function(key) {
            return Cookies.hasCookielikeValue(document.cookie, key);
        },

        keys: function() {
            return Cookies.keysCookielike(document.cookie);
        }

    };
});

Scoped.define("module:DomMutation.NodeInsertObserver", ["base:Classes.ConditionalInstance","base:Events.EventsMixin"], function (ConditionalInstance, EventsMixin, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            _nodeInserted: function(node, expand) {
                if (expand) {
                    for (var i = 0; i < node.childNodes.length; ++i)
                        this._nodeInserted(node.childNodes[i], expand);
                }
                if (this._options.parent && node.parentNode !== this._options.parent)
                    return;
                if (this._options.root && !this._options.root.contains(node))
                    return;
                if (this._options.filter && !this._options.filter.call(this._options.context || this, node))
                    return;
                this.trigger("node-inserted", node);
            }

        };
    }]);
});

Scoped.define("module:DomMutation.MutationObserverNodeInsertObserver", ["module:DomMutation.NodeInsertObserver","base:Objs"], function (Observer, Objs, scoped) {
    return Observer.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                options = options || {};
                inherited.constructor.call(this, options);
                var self = this;
                this._observer = new window.MutationObserver(function(mutations) {
                    Objs.iter(mutations, function(mutation) {
                        for (var i = 0; i < mutation.addedNodes.length; ++i)
                            self._nodeInserted(mutation.addedNodes[i], true);
                    });
                });
                this._observer.observe(this._options.root || this._options.parent || document.body, {
                    childList: true,
                    subtree: !this._options.parent
                });
            },

            destroy: function() {
                this._observer.disconnect();
                inherited.destroy.call(this);
            }

        };
    }, {

        supported: function(node) {
            try {
                return !!window.MutationObserver;
            } catch (e) {
                return false;
            }
        }

    });
});

Scoped.define("module:DomMutation.DOMNodeInsertedNodeInsertObserver", ["module:DomMutation.NodeInsertObserver","module:Events"], function (Observer, Events, scoped) {
    return Observer.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                options = options || {};
                inherited.constructor.call(this, options);
                var events = this.auto_destroy(new Events());
                events.on(document, "DOMNodeInserted", function(event) {
                    this._nodeInserted(event.target, true);
                }, this);
            }

        };
    }, {

        supported: function(node) {
            return true;
        }

    });
});

Scoped.extend("module:DomMutation.NodeInsertObserver", ["module:DomMutation.NodeInsertObserver","module:DomMutation.MutationObserverNodeInsertObserver","module:DomMutation.DOMNodeInsertedNodeInsertObserver"], function (Observer, MutationObserverNodeInsertObserver, DOMNodeInsertedNodeInsertObserver) {
    Observer.register(MutationObserverNodeInsertObserver, 3);
    Observer.register(DOMNodeInsertedNodeInsertObserver, 2);
    return {};
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('base', 'root:BetaJS');
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('module', 'root:BetaJS.Flash');
Scoped.define("module:", function () {
	return {
    "guid": "3adc016a-e639-4d1a-b4cb-e90cab02bc4f",
    "version": "0.0.20"
};
});

Scoped.extend("module:", ["module:"], function () {
	return {
		options: {
			flashFile: "betajs-flash.swf"			
		}
	};
});

Scoped.define("module:FlashClassRegistry", ["base:Class"], function (Class,
		scoped) {
	return Class.extend({
		scoped : scoped
	}, {

		interfaces : {},

		register : function(cls, methods, statics) {
			this.interfaces[cls] = {
				methods: methods || {},
				statics: statics || {}
			};
		},
		
		get: function (cls) {
			return this.interfaces[cls];
		}

	});
});

Scoped.define("module:FlashObjectWrapper", ["base:Class","base:Objs","base:Functions"], function (Class, Objs, Functions, scoped) {
	return Class.extend({
		scoped : scoped
	}, function(inherited) {
		return {

			constructor : function(embedding, objectIdent, objectType) {
				inherited.constructor.call(this);
				this.__embedding = embedding;
				this.__ident = objectIdent;
				this.__type = objectType;
				if (embedding.__registry) {
					var lookup = embedding.__registry.get(objectType);
					if (lookup) {
						Objs.iter(lookup.methods, function (method) {
							this[method] = function () {
								var args = Functions.getArguments(arguments);
								args.unshift(method);
								args.unshift(this.__ident);
								return this.__embedding.flashCall.apply(this.__embedding, args);
							};
							this[method + "Void"] = function () {
								var args = Functions.getArguments(arguments);
								args.unshift(method);
								args.unshift(this.__ident);
								return this.__embedding.flashCallVoid.apply(this.__embedding, args);
							};
						}, this);
					}
				}
			},
			
			destroy: function () {
				try {
                    this.__embedding.flashDestroy(this.__ident);
                } catch (e) {}
				inherited.destroy.call(this);
			},
			
			set: function (key, value) {
				return this.__embedding.flashSet.call(this.__embedding, this.__ident, key, value);
			},

			get: function (key) {
				return this.__embedding.flashGet.call(this.__embedding, this.__ident, key);
			}
			
		};
	});
});

Scoped.define("module:FlashClassWrapper", ["base:Class","base:Objs","base:Functions"], function (Class, Objs, Functions, scoped) {
	return Class.extend({
		scoped : scoped
	}, function(inherited) {
		return {

			constructor : function(embedding, classType) {
				inherited.constructor.call(this);
				this.__embedding = embedding;
				this.__type = classType;
				if (embedding.__registry) {
					var lookup = embedding.__registry.get(classType);
					if (lookup) {
						Objs.iter(lookup.statics, function (method) {
							this[method] = function () {
								var args = Functions.getArguments(arguments);
								args.unshift(method);
								args.unshift(this.__type);
								return this.__embedding.flashStaticCall.apply(this.__embedding, args);
							};
							this[method + "Void"] = function () {
								var args = Functions.getArguments(arguments);
								args.unshift(method);
								args.unshift(this.__type);
								return this.__embedding.flashStaticCallVoid.apply(this.__embedding, args);
							};
						}, this);
					}
				}
			},
			
			set: function (key, value) {
				return this.__embedding.flashSetStatic.call(this.__embedding, this.__type, key, value);
			},

			get: function (key) {
				return this.__embedding.flashGetStatic.call(this.__embedding, this.__type, key);
			}

		};
	});
});

Scoped.define("module:FlashEmbedding", ["base:Class","base:Events.EventsMixin","browser:Dom","base:Strings","base:Functions","base:Types","base:Objs","base:Ids","base:Time","base:Timers.Timer","base:Async","base:Tokens","module:FlashObjectWrapper","module:FlashClassWrapper","browser:FlashHelper","module:"], function (Class, EventsMixin, Dom, Strings, Functions, Types, Objs, Ids, Time, Timer, Async, Tokens, FlashObjectWrapper, FlashClassWrapper, FlashHelper, mod, scoped) {
	return Class.extend({ scoped : scoped }, [EventsMixin, function(inherited) {
		return {

			constructor : function(container, options, flashOptions) {
				inherited.constructor.call(this);
				options = options || {};
				this.__registry = options.registry;
				this.__wrap = options.wrap;
				this.__hasEmbedding = options.hasEmbedding;
				this.__cache = {};
				this.__callbacks = {
					ready: Functions.as_method(this.__ready, this)
				};
				this.__namespace = options.namespace ? options.namespace : ("flash_" + Tokens.generate_token());
				this.__is_ready = false;
				this.__is_suspended = false;
				this.__throttle_status = "";
				this.__ready_queue = [];
				this.__wrappers = {};
				this.__staticWrappers = {};
				window[this.__namespace] = this.__callbacks;
				flashOptions = Objs.extend(Objs.clone(mod.options, 1), Objs.extend({
					FlashVars: {}
				}, flashOptions));
				flashOptions.FlashVars.ready = this.__namespace + ".ready";
				if (options.debug)
					flashOptions.FlashVars.debug = true;
				if (!container) {
					this.__helper_container = true;
					container = document.createElement("div");
					container.style.width = "1px";
					container.style.height = "1px";
					container.style.visibility = "hidden";
					container.style.position = "absolute";
					container.style.zIndex = -1;
					document.body.appendChild(container);
				}
				this.__container = Dom.unbox(container);
				this.__embedding = options.hasEmbedding ? FlashHelper.getFlashObject(this.__container) : FlashHelper.embedFlashObject(this.__container, flashOptions);
				this.__suspendedTimer = this.auto_destroy(new Timer({
					delay: 50,
					context: this,
					fire: this.__suspendedCheck
				}));
			},
			
			destroy: function () {
				try {
					window[this.__namespace] = null;
					delete window[this.__namespace];
				} catch (e) {}
				Objs.iter(this.__wrappers, function (wrapper) {
					wrapper.weakDestroy();
				});
				Objs.iter(this.__staticWrappers, function (wrapper) {
					wrapper.weakDestroy();
				});
				if (!this.__hasEmbedding) {
                    this.__container.innerHTML = "";
                    if (this.__helper_container)
                        this.__container.parentNode.removeChild(this.__container);
				}
				inherited.destroy.call(this);
			},
			
			registerCallback: function (callback, context) {
				var value = "__FLASHCALLBACK__" + Ids.uniqueId();
				var self = this;
				this.__callbacks[value] = function () {
					callback.apply(context || self, Objs.map(Functions.getArguments(arguments), self.unserialize, self));
				};
				return value;
			},
			
			unregisterCallback: function (value) {
				delete this.__callbacks[value];
			},
			
			serialize : function (value) {
				if (Types.is_array(value))
					return Objs.map(value, this.serialize, this);
				if (Types.is_function(value))
					value = this.registerCallback(value);
				if (Types.is_string(value)) {
					if (Strings.starts_with(value, "__FLASHCALLBACK__"))
						value = this.__namespace + "." + value;
				}
				if (FlashObjectWrapper.is_instance_of(value))
					value = value.__ident;
				if (FlashClassWrapper.is_instance_of(value))
					value = value.__type;
				return value;
			},

			unserialize : function(value) {
				if (Types.is_string(value) && Strings.starts_with(value, "__FLASHERR__"))
					throw Strings.strip_start(value, "__FLASHERR__");
				 if (Types.is_string(value) && Strings.starts_with(value, "__FLASHOBJ__")) {
					 if (this.__wrap) {
						var type = Strings.strip_start(value, "__FLASHOBJ__");
						type = Strings.splitFirst(type, "__").head.replace("::", ".");
						if (type.toLowerCase() != "object") {
							if (!(value in this.__wrappers))
								this.__wrappers[value] = new FlashObjectWrapper(this, value, type);
							return this.__wrappers[value];
						}
					 }
				}
				return value;
			},

			invoke : function(method, args) {
				if (!this.__is_ready)
					throw "Flash is not ready yet";
				args = args || [];
				return this.unserialize(this.__embedding[method].apply(this.__embedding, this.serialize(Functions.getArguments(args))));
			},

			invokeCached : function(method, args) {
				args = args || [];
				var key = method + "__" + Functions.getArguments(args).join("__");
				if (!(key in this.__cache))
					this.__cache[key] = this.invoke.call(this, method, args);
				return this.__cache[key];
			},
			
			getClass: function (className) {
				if (!this.__wrap)
					return null;
				if (!(className in this.__staticWrappers))
					this.__staticWrappers[className] = new FlashClassWrapper(this, className);
				return this.__staticWrappers[className];
			},
			
			newObject: function () {
				return this.flashCreate.apply(this, arguments);
			},
			
			newCallback: function () {
				return Types.is_string(arguments[0]) ? this.flashCreateCallbackObject.apply(this, arguments) : this.flashCreateCallbackFunction.apply(this, arguments);
			},
			
			flashCreateCallbackObject : function() {
				return this.invoke("create_callback_object", arguments);
			},
			
			flashCreateCallbackFunction : function() {
				return this.invoke("create_callback_function", arguments);
			},

			flashCreate : function() {
				return this.invoke("create", arguments);
			},

			flashDestroy : function () {
				return this.invoke("destroy", arguments);
			},

			flashCall : function() {
				return this.invoke("call", arguments);
			},

			flashCallVoid : function() {
				return this.invoke("call_void", arguments);
			},

			flashGet : function() {
				return this.invoke("get", arguments);
			},

			flashSet : function() {
				return this.invoke("set", arguments);
			},

			flashStaticCall : function() {
				return this.invoke("static_call", arguments);
			},

			flashStaticCallVoid : function() {
				return this.invoke("static_call_void", arguments);
			},

			flashGetStatic : function() {
				return this.invoke("get_static", arguments);
			},

			flashSetStatic : function() {
				return this.invoke("set_static", arguments);
			},

			flashMain : function() {
				return this.invokeCached("main");
			},
			
			__suspendedCheck: function () {
				if (this.__is_ready) {
					var test = Time.now();
					var tries = 10;
					while (tries > 0) {
						try {
							if (this.__embedding.echo(test) == test)
								break;
						} catch (e) {}
						tries--;
					}
					var result = tries === 0;
					if (result !== this.__is_suspended) {
						this.__is_suspended = result;
						this.trigger(result ? "suspended" : "resumed");
					}
					try {
						var status = this.__embedding.throttle();
						var changed = status !== this.__throttle_status;
						this.__throttle_status = status;
						if (changed)
							this.trigger(this.isThrottled() ? "throttled" : "unthrottled");
					} catch (e) {}
				}
			},
			
			isSuspended: function () {
				return this.__is_ready && this.__is_suspended;
			},

			isThrottled: function () {
				return this.__throttle_status === "throttle";
			},
			
			__ready: function () {
				if (!this.__is_ready) {
					this.__is_ready = true;
					this.__is_suspended = false;
					Async.eventually(function () {
						Objs.iter(this.__ready_queue, function (entry) {
							entry.callback.call(entry.context || this);
						}, this);
					}, this);
					this.trigger("ready");
				}
			},

			ready : function(callback, context) {
				if (this.__is_ready) {
					Async.eventually(function () {
						callback.call(context || this);
					}, this);
				} else {
					this.__ready_queue.push({
						callback: callback,
						context: context
					});
				}
			}

		};
	}]);
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('base', 'root:BetaJS');
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('flash', 'root:BetaJS.Flash');
Scoped.binding('module', 'root:BetaJS.Media');
Scoped.define("module:", function () {
	return {
    "guid": "8475efdb-dd7e-402e-9f50-36c76945a692",
    "version": "0.0.91"
};
});

Scoped.define("module:AudioPlayer.AudioPlayerWrapper", ["base:Classes.OptimisticConditionalInstance","base:Events.EventsMixin","base:Types","base:Objs","base:Strings","browser:Events"], function (OptimisticConditionalInstance, EventsMixin, Types, Objs, Strings, DomEvents, scoped) {
    return OptimisticConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options, transitionals) {
                inherited.constructor.call(this);
                options = Objs.extend(Objs.clone(options || {}, 1), transitionals);
                var sources = options.source || options.sources || [];
                if (Types.is_string(sources))
                    sources = sources.split(" ");
                else if (!Types.is_array(sources))
                    sources = [sources];
                var sourcesMapped = [];
                Objs.iter(sources, function(source) {
                    if (Types.is_string(source))
                        source = {
                            src: source.trim()
                        };
                    else if (typeof Blob !== 'undefined' && source instanceof Blob)
                        source = {
                            src: source
                        };
                    if (source.ext && !source.type)
                        source.type = "audio/" + source.ext;
                    if (!source.ext && source.type)
                        source.ext = Strings.last_after(source.type, "/");
                    if (!source.ext && !source.type && Types.is_string(source.src)) {
                        var temp = Strings.splitFirst(source.src, "?").head;
                        if (temp.indexOf(".") >= 0) {
                            source.ext = Strings.last_after(temp, ".");
                            source.type = "audio/" + source.ext;
                        }
                    }
                    if (source.ext)
                        source.ext = source.ext.toLowerCase();
                    if (source.type)
                        source.type = source.type.toLowerCase();
                    if (typeof Blob !== 'undefined' && source.src instanceof Blob)
                        source.src = (window.URL || window.webkitURL).createObjectURL(source.src);
                    sourcesMapped.push(source);
                }, this);
                this._sources = sourcesMapped;
                this._element = options.element;
                this._preload = options.preload || false;
                this._reloadonplay = options.reloadonplay || false;
                this._options = options;
                this._loop = options.loop || false;
                this._loaded = false;
                this._error = 0;
                this._domEvents = new DomEvents();
            },

            destroy: function() {
                this._domEvents.destroy();
                inherited.destroy.call(this);
            },

            sources: function() {
                return this._sources;
            },

            loaded: function() {
                return this._loaded;
            },

            buffered: function() {},

            _eventLoaded: function() {
                this._loaded = true;
                this.trigger("loaded");
            },

            _eventPlaying: function() {
                if (!this._loaded)
                    this._eventLoaded();
                this.trigger("playing");
            },

            _eventPaused: function() {
                this.trigger("paused");
            },

            _eventEnded: function() {
                this.trigger("ended");
            },

            _eventError: function(error) {
                this._error = error;
                this.trigger("error", error);
            },

            duration: function() {
                return this._element.duration;
            },

            position: function() {
                return this._element.currentTime;
            },

            error: function() {
                return this._error;
            },

            play: function() {
                if (this._reloadonplay)
                    this._element.load();
                this._reloadonplay = false;
                this._element.play();
            },

            pause: function() {
                this._element.pause();
            },

            setPosition: function(position) {
                this._element.currentTime = position;
            },

            muted: function() {
                return this._element.muted;
            },

            setMuted: function(muted) {
                this._element.muted = muted;
            },

            volume: function() {
                return this._element.volume;
            },

            setVolume: function(volume) {
                this._element.volume = volume;
            }

        };
    }], {

        ERROR_NO_PLAYABLE_SOURCE: 1,
        ERROR_FLASH_NOT_INSTALLED: 2

    });
});

Scoped.define("module:AudioPlayer.Html5AudioPlayerWrapper", ["module:AudioPlayer.AudioPlayerWrapper","browser:Info","base:Promise","base:Objs","base:Timers.Timer","base:Strings","base:Async","browser:Dom","browser:Events"], function (AudioPlayerWrapper, Info, Promise, Objs, Timer, Strings, Async, Dom, DomEvents, scoped) {
    return AudioPlayerWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            _initialize: function() {
                if (this._options.nohtml5)
                    return Promise.error(true);
                if (this._sources.length < 1)
                    return Promise.error(true);
                if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 9)
                    return Promise.error(true);
                if (this._options.forceflash)
                    return Promise.error(true);
                var self = this;
                var promise = Promise.create();
                this._element.innerHTML = "";
                var sources = this.sources();
                var ie9 = (Info.isInternetExplorer() && Info.internetExplorerVersion() == 9) || Info.isWindowsPhone();
                if (this._element.tagName.toLowerCase() !== "audio") {
                    this._element = Dom.changeTag(this._element, "audio");
                    this._transitionals.element = this._element;
                } else if (ie9) {
                    var str = Strings.splitLast(this._element.outerHTML, "</audio>").head;
                    Objs.iter(sources, function(source) {
                        str += "<source" + (source.type ? " type='" + source.type + "'" : "") + " src='" + source.src + "' />";
                    });
                    str += "</audio>";
                    var replacement = Dom.elementByTemplate(str);
                    Dom.elementInsertAfter(replacement, this._element);
                    this._element.parentNode.removeChild(this._element);
                    this._element = replacement;
                    this._transitionals.element = this._element;
                }
                if (Info.isSafari() && Info.safariVersion() < 6) {
                    this._element.src = sources[0].src;
                    this._preload = true;
                }
                /*
                var loadevent = "loadedmetadata";
                if (Info.isSafari() && Info.safariVersion() < 9)
                	loadevent = "loadstart";
                	*/
                var loadevent = "loadstart";
                this._domEvents.on(this._element, "loadevent", function() {
                    if ( /*loadevent === "loadstart" && */ this._element.networkState === this._element.NETWORK_NO_SOURCE) {
                        promise.asyncError(true);
                        return;
                    }
                    promise.asyncSuccess(true);
                }, this);
                var nosourceCounter = 10;
                var timer = new Timer({
                    context: this,
                    fire: function() {
                        if (this._element.networkState === this._element.NETWORK_NO_SOURCE) {
                            nosourceCounter--;
                            if (nosourceCounter <= 0)
                                promise.asyncError(true);
                        } else if (this._element.networkState === this._element.NETWORK_IDLE)
                            promise.asyncSuccess(true);
                        else if (this._element.networkState === this._element.NETWORK_LOADING) {
                            if (Info.isEdge() || Info.isInternetExplorer())
                                promise.asyncSuccess(true);
                            else if (Info.isFirefox() && sources[0].src.indexOf("blob:") === 0)
                                promise.asyncSuccess(true);
                        }
                    },
                    delay: 50
                });
                this._element.preload = this._preload ? "auto" : "none";
                if (this._loop)
                    this._element.loop = "loop";
                var errorCount = 0;
                var errorEvents = new DomEvents();
                if (!ie9) {
                    Objs.iter(sources, function(source) {
                        var sourceEl = document.createElement("source");
                        if (source.type)
                            sourceEl.type = source.type;
                        this._element.appendChild(sourceEl);
                        errorEvents.on(sourceEl, "error", function() {
                            errorCount++;
                            if (errorCount === sources.length)
                                promise.asyncError(true);
                        });
                        sourceEl.src = source.src;
                    }, this);
                } else {
                    var sourceEls = this._element.getElementsByTagName("SOURCE");
                    var cb = function() {
                        errorCount++;
                        if (errorCount === sources.length)
                            promise.asyncError(true);
                    };
                    for (var i = 0; i < sourceEls.length; ++i) {
                        errorEvents.on(sourceEls[i], "error", cb);
                    }
                }
                promise.callback(function() {
                    errorEvents.weakDestroy();
                    timer.destroy();
                }, this);
                promise.success(function() {
                    this._setup();
                }, this);
                try {
                    if (!Info.isChrome())
                        this._element.load();
                } catch (e) {}
                return promise;
            },

            destroy: function() {
                if (!Info.isInternetExplorer() || Info.internetExplorerVersion() > 8)
                    this._element.innerHTML = "";
                inherited.destroy.call(this);
            },

            _setup: function() {
                this._loaded = false;
                this._domEvents.on(this._element, "canplay", this._eventLoaded, this);
                this._domEvents.on(this._element, "playing", this._eventPlaying, this);
                this._domEvents.on(this._element, "pause", this._eventPaused, this);
                this._domEvents.on(this._element, "ended", this._eventEnded, this);
                var self = this;
                var sourceEls = this._element.getElementsByTagName("SOURCE");
                var cb = function() {
                    this._eventError(this.cls.ERROR_NO_PLAYABLE_SOURCE);
                };
                for (var i = 0; i < sourceEls.length; ++i) {
                    this._domEvents.on(sourceEls[i], "error", cb, this);
                }
                if (Info.isSafari() && (Info.safariVersion() > 5 || Info.safariVersion() < 9)) {
                    if (this._element.networkState === this._element.NETWORK_LOADING) {
                        Async.eventually(function() {
                            if (!this.destroyed() && this._element.networkState === this._element.NETWORK_LOADING && this._element.buffered.length === 0)
                                this._eventError(this.cls.ERROR_NO_PLAYABLE_SOURCE);
                        }, this, 10000);
                    }
                }
            },

            buffered: function() {
                return this._element.buffered.end(0);
            },

            play: function() {
                inherited.play.call(this);
            },

            pause: function() {
                this._element.pause();
            },

            setPosition: function(position) {
                this._element.currentTime = position;
            },

            muted: function() {
                return this._element.muted;
            },

            setMuted: function(muted) {
                this._element.muted = muted;
            },

            volume: function() {
                return this._element.volume;
            },

            setVolume: function(volume) {
                this._element.volume = volume;
            }

        };
    });
});

Scoped.extend("module:AudioPlayer.AudioPlayerWrapper", ["module:AudioPlayer.AudioPlayerWrapper","module:AudioPlayer.Html5AudioPlayerWrapper"], function (AudioPlayerWrapper, Html5AudioPlayerWrapper) {
    AudioPlayerWrapper.register(Html5AudioPlayerWrapper, 2);
    return {};
});

Scoped.define("module:AudioPlayer.FlashPlayer", ["browser:DomExtend.DomExtension","browser:Dom","browser:Info","flash:FlashClassRegistry","flash:FlashEmbedding","base:Strings","base:Async","base:Objs","base:Functions","base:Types","base:Promise"], function (Class, Dom, Info, FlashClassRegistry, FlashEmbedding, Strings, Async, Objs, Functions, Types, Promise, scoped) {
    var Cls = Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(element, attrs) {
                inherited.constructor.call(this, element, attrs);
                this._source = this.__preferedSource();
                this._embedding = this.auto_destroy(new FlashEmbedding(element, {
                    registry: this.cls.flashRegistry(),
                    wrap: true,
                    debug: false
                }));
                this._flashObjs = {};
                this._flashData = {
                    status: 'idle'
                };
                this.ready = Promise.create();
                this._embedding.ready(this.__initializeEmbedding, this);
            },

            __preferedSource: function() {
                var preferred = [".mp3", ".ogg", ".aac"];
                var sources = [];
                if (this.readAttr("src") || this.readAttr("source") || this.readAttr("sources")) {
                    var src = this.readAttr("src") || this.readAttr("source") || this.readAttr("sources");
                    if (Types.is_array(src))
                        sources = src;
                    else
                        sources.push(src);
                }
                var element = this._element;
                if (!(Info.isInternetExplorer() && Info.internetExplorerVersion() < 9)) {
                    for (var i = 0; i < this._element.childNodes.length; ++i) {
                        if (element.childNodes[i].tagName && element.childNodes[i].tagName.toLowerCase() == "source" && element.childNodes[i].src)
                            sources.push(element.childNodes[i].src.toLowerCase());
                    }
                } else {
                    var current = this._element;
                    while (true) {
                        var next = current.nextSibling;
                        if (!next || !next.tagName || next.tagName.toLowerCase() != "source")
                            break;
                        sources.push(next.src.toLowerCase());
                        current = next;
                    }
                }
                sources = Objs.map(sources, function(source) {
                    return source.src || source;
                });
                var source = sources[0];
                var currentExtIndex = preferred.length - 1;
                for (var k = sources.length - 1; k >= 0; --k) {
                    for (var j = 0; j <= currentExtIndex; ++j) {
                        if (Strings.ends_with(sources[k], preferred[j])) {
                            source = sources[k];
                            currentExtIndex = j;
                            break;
                        }
                    }
                }
                if (source.indexOf("://") == -1)
                    source = document.location.href + "/../" + source;

                return {
                    sourceUrl: source
                };
            },

            __initializeEmbedding: function() {
                this._flashObjs.main = this._embedding.flashMain();
                this._flashObjs.stage = this._flashObjs.main.get("stage");
                this._flashObjs.stage.set("scaleMode", "noScale");
                this._flashObjs.stage.set("align", "TL");
                this._flashObjs.soundTransform = this._embedding.newObject("flash.media.SoundTransform");
                this._flashObjs.sound = this._embedding.newObject("flash.media.Sound");
                this._flashObjs.urlRequest = this._embedding.newObject("flash.net.URLRequest", this._source.sourceUrl);
                this._flashObjs.sound.addEventListener("complete", this._embedding.newCallback(Functions.as_method(this.__requestComplete, this)));
                this._flashObjs.sound.loadVoid(this._flashObjs.urlRequest);
            },

            __requestComplete: function() {
                this._element.duration = this._flashObjs.sound.length;
                this.writeAttr("volume", 1.0);
                if (this.hasAttr("muted")) {
                    this._flashObjs.soundTransform.set("volume", 0.0);
                    this.writeAttr("volume", 0.0);
                }
                this.__lastPosition = 0;
                this.__paused = false;
                this.__playing = false;
                if (this.hasAttr("autoplay"))
                    this._element.play();
                this.ready.asyncSuccess(this);
            },

            _domMethods: ["play", "pause", "load"],

            _domAttrs: {
                "volume": {
                    set: "_setVolume"
                },
                "currentTime": {
                    get: "_getCurrentTime",
                    set: "_setCurrentTime"
                }
            },

            load: function() {},

            play: function() {
                if (this.__playing)
                    return;
                this.__playing = true;
                this.__paused = false;
                this._flashObjs.soundChannel = this._flashObjs.sound.play(this.__lastPosition, 0, this._flashObjs.soundTransform);
                this._flashObjs.soundChannel.addEventListener("soundComplete", this._embedding.newCallback(Functions.as_method(this.__soundComplete, this)));
                this.domEvent("playing");
            },

            pause: function() {
                if (!this.__playing || this.__paused)
                    return;
                this.__lastPosition = this._flashObjs.soundChannel.get("position");
                this.__playing = false;
                this.__paused = true;
                this._flashObjs.soundChannel.stop();
                this._flashObjs.soundChannel.destroy();
                this.domEvent("pause");
            },

            _setVolume: function(volume) {
                this._flashObjs.soundTransform.set("volume", volume);
                this.domEvent("volumechange");
            },

            _getCurrentTime: function() {
                return this.__playing ? this._flashObjs.soundTransform.get("position") : this.__lastPosition;
            },

            _setCurrentTime: function(time) {
                if (this.__playing)
                    this._flashObjs.soundTransform.set("position", time);
                else
                    this.__lastPosition = time;
            },

            __soundComplete: function() {
                this.__lastPosition = 0;
                this.__playing = false;
                this.__paused = false;
                this._flashObjs.soundChannel.destroy();
                this.domEvent("ended");
            }

        };
    }, {

        flashRegistry: function() {
            if (!this.__flashRegistry) {
                this.__flashRegistry = new FlashClassRegistry();
                this.__flashRegistry.register("flash.media.Sound", ["load", "play", "addEventListener"]);
                this.__flashRegistry.register("flash.media.SoundChannel", ["stop", "addEventListener"]);
                this.__flashRegistry.register("flash.net.URLRequest", []);
                this.__flashRegistry.register("flash.display.Stage", []);

                this.__flashRegistry.register("flash.net.NetStream", ["play", "pause", "resume", "addEventListener", "seek"]);
                this.__flashRegistry.register("flash.net.NetConnection", ["connect", "addEventListener"]);
                this.__flashRegistry.register("flash.media.SoundTransform", []);
            }
            return this.__flashRegistry;
        },

        polyfill: function(element, polyfilltag, force, eventual) {
            if (eventual) {
                var promise = Promise.create();
                Async.eventually(function() {
                    promise.asyncSuccess(Cls.polyfill(element, polyfilltag, force));
                });
                return promise;
            }
            if (element.tagName.toLowerCase() != "audio" || !("networkState" in element))
                return Cls.attach(element);
            else if (element.networkState == element.NETWORK_NO_SOURCE || force)
                return Cls.attach(Dom.changeTag(element, polyfilltag || "audiopoly"));
            return element;
        },

        attach: function(element, attrs) {
            var cls = new Cls(element, attrs);
            return element;
        }

    });
    return Cls;
});

Scoped.define("module:AudioPlayer.FlashPlayerWrapper", ["module:AudioPlayer.AudioPlayerWrapper","module:AudioPlayer.FlashPlayer","browser:Info","base:Promise","browser:Dom"], function (AudioPlayerWrapper, FlashPlayer, Info, Promise, Dom, scoped) {
    return AudioPlayerWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            _initialize: function() {
                if (this._options.noflash)
                    return Promise.error(true);
                if (this._sources.length < 1)
                    return Promise.error(true);
                if (Info.isMobile() || !Info.flash().supported())
                    return Promise.error(true);
                if (!Info.flash().installed() && this._options.flashinstallrequired)
                    return Promise.error(true);
                if (!Info.flash().installed()) {
                    this._eventError(this.cls.ERROR_NO_FLASH_INSTALLED);
                    return Promise.value(true);
                }
                var self = this;
                var promise = Promise.create();
                if (this._element.tagName.toLowerCase() !== "div") {
                    this._element = Dom.changeTag(this._element, "div");
                    this._transitionals.element = this._element;
                }
                var opts = {
                    sources: this.sources()
                };
                if (this._loop)
                    opts.loop = true;
                this._flashPlayer = new FlashPlayer(this._element, opts);
                return this._flashPlayer.ready.success(function() {
                    this._setup();
                }, this);
            },

            destroy: function() {
                if (this._flashPlayer)
                    this._flashPlayer.weakDestroy();
                this._element.innerHTML = "";
                inherited.destroy.call(this);
            },

            _setup: function() {
                this._loaded = true;
                this._eventLoaded();
                this._domEvents.on(this._element, "playing", this._eventPlaying, this);
                this._domEvents.on(this._element, "pause", this._eventPaused, this);
                this._domEvents.on(this._element, "ended", this._eventEnded, this);
                this._domEvents.on(this._element, "audioerror", function() {
                    this._eventError(this.cls.ERROR_NO_PLAYABLE_SOURCE);
                }, this);
            },

            position: function() {
                return this._element.get("currentTime");
            },

            buffered: function() {
                return this.position();
            },

            setPosition: function(position) {
                this._element.set("currentTime", position);
            },

            setVolume: function(volume) {
                this._element.set("volume", volume);
            }

        };
    });
});

Scoped.extend("module:AudioPlayer.AudioPlayerWrapper", ["module:AudioPlayer.AudioPlayerWrapper","module:AudioPlayer.FlashPlayerWrapper"], function (AudioPlayerWrapper, FlashPlayerWrapper) {
    AudioPlayerWrapper.register(FlashPlayerWrapper, 1);
    return {};
});

Scoped.define("module:AudioRecorder.AudioRecorderWrapper", ["base:Classes.ConditionalInstance","base:Events.EventsMixin","base:Objs","base:Promise"], function (ConditionalInstance, EventsMixin, Objs, Promise, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                this._element = this._options.element;
                this.ready = Promise.create();
            },

            destroy: function() {
                inherited.destroy.call(this);
            },

            bindMedia: function() {
                return this._bindMedia();
            },

            _bindMedia: function() {},

            unbindMedia: function() {
                return this._unbindMedia();
            },

            _unbindMedia: function() {},

            softwareDependencies: function() {
                return this._softwareDependencies();
            },

            _softwareDependencies: function() {},

            soundLevel: function() {},
            testSoundLevel: function(activate) {},

            getVolumeGain: function() {},
            setVolumeGain: function(volumeGain) {},

            enumerateDevices: function() {},
            currentDevices: function() {},
            setCurrentDevices: function(devices) {},

            startRecord: function(options) {},
            stopRecord: function(options) {},

            isFlash: function() {
                return false;
            },

            supportsLocalPlayback: function() {
                return false;
            },

            localPlaybackSource: function() {
                return null;
            },

            recordDelay: function(opts) {
                return 0;
            }

        };
    }], {

        _initializeOptions: function(options) {
            return Objs.extend({
                forceflash: false,
                noflash: false,
                recordVideo: false,
                recordAudio: true
            }, options);
        }

    });
});

Scoped.define("module:Encoding.WaveEncoder.Support", ["base:Promise","base:Scheduling.Helper"], function (Promise, SchedulingHelper) {
    return {

        dumpInputBuffer: function(inputBuffer, audioChannels, bufferSize, offset) {
            return {
                left: new Float32Array(inputBuffer.getChannelData(0)),
                right: audioChannels > 1 ? new Float32Array(inputBuffer.getChannelData(1)) : null,
                offset: offset || 0,
                endOffset: bufferSize
            };
        },

        waveChannelTransform: function(dumpedInputBuffer, volume, schedulable, schedulableCtx) {
            var promise = Promise.create();
            var volumeFactor = 0x7FFF * (volume || 1);
            var offset = dumpedInputBuffer.offset;
            var endOffset = dumpedInputBuffer.endOffset;
            var left = dumpedInputBuffer.left;
            var right = dumpedInputBuffer.right;
            var result = new Int16Array((endOffset - offset) * (right ? 2 : 1));
            var resultOffset = 0;
            SchedulingHelper.schedulable(function(steps) {
                while (steps > 0) {
                    steps--;
                    if (offset >= endOffset) {
                        promise.asyncSuccess(result);
                        return true;
                    }
                    result[resultOffset] = left[offset] * volumeFactor;
                    resultOffset++;
                    if (right) {
                        result[resultOffset] = right[offset] * volumeFactor;
                        resultOffset++;
                    }
                    offset++;
                }
                return false;
            }, 100, schedulable, schedulableCtx);
            return promise;
        },

        generateHeader: function(totalSize, audioChannels, sampleRate, buffer) {
            buffer = buffer || new ArrayBuffer(44);
            var view = new DataView(buffer);
            view.writeUTFBytes = function(offset, string) {
                for (var i = 0; i < string.length; i++)
                    this.setUint8(offset + i, string.charCodeAt(i));
            };
            // RIFF chunk descriptor
            view.writeUTFBytes(0, 'RIFF');
            view.setUint32(4, 44 + totalSize, true);
            view.writeUTFBytes(8, 'WAVE');
            // FMT sub-chunk
            view.writeUTFBytes(12, 'fmt ');
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true);
            // stereo (2 channels)
            view.setUint16(22, audioChannels, true);
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, sampleRate * 4, true);
            view.setUint16(32, audioChannels * 2, true);
            view.setUint16(34, 16, true);
            // data sub-chunk
            view.writeUTFBytes(36, 'data');
            view.setUint32(40, totalSize, true);
            return buffer;
        }

    };
});

Scoped.define("module:Encoding.WebmEncoder.Support", ["base:Promise","base:Scheduling.Helper","base:Types"], function (Promise, SchedulingHelper, Types) {
    return {

        parseWebP: function(riff) {
            var VP8 = riff.RIFF[0].WEBP[0];

            var frame_start = VP8.indexOf('\x9d\x01\x2a'); // A VP8 keyframe starts with the 0x9d012a header
            for (var i = 0, c = []; i < 4; i++) c[i] = VP8.charCodeAt(frame_start + 3 + i);

            var width, height, tmp;

            //the code below is literally copied verbatim from the bitstream spec
            tmp = (c[1] << 8) | c[0];
            width = tmp & 0x3FFF;
            tmp = (c[3] << 8) | c[2];
            height = tmp & 0x3FFF;
            return {
                width: width,
                height: height,
                data: VP8,
                riff: riff
            };
        },

        parseRIFF: function(string) {
            var offset = 0;
            var chunks = {};

            var f = function(i) {
                var unpadded = i.charCodeAt(0).toString(2);
                return (new Array(8 - unpadded.length + 1)).join('0') + unpadded;
            };

            while (offset < string.length) {
                var id = string.substr(offset, 4);
                var len = parseInt(string.substr(offset + 4, 4).split('').map(f).join(''), 2);
                var data = string.substr(offset + 4 + 4, len);
                offset += 4 + 4 + len;
                chunks[id] = chunks[id] || [];

                if (id == 'RIFF' || id == 'LIST')
                    chunks[id].push(this.parseRIFF(data));
                else
                    chunks[id].push(data);
            }
            return chunks;
        },

        isBlankFrame: function(canvas, frame, _pixTolerance, _frameTolerance) {
            var localCanvas = document.createElement('canvas');
            localCanvas.width = canvas.width;
            localCanvas.height = canvas.height;
            var context2d = localCanvas.getContext('2d');

            var sampleColor = {
                r: 0,
                g: 0,
                b: 0
            };
            var maxColorDifference = Math.sqrt(
                Math.pow(255, 2) +
                Math.pow(255, 2) +
                Math.pow(255, 2)
            );
            var pixTolerance = _pixTolerance && _pixTolerance >= 0 && _pixTolerance <= 1 ? _pixTolerance : 0;
            var frameTolerance = _frameTolerance && _frameTolerance >= 0 && _frameTolerance <= 1 ? _frameTolerance : 0;

            var matchPixCount, endPixCheck, maxPixCount;

            var image = new Image();
            image.src = frame.image;
            context2d.drawImage(image, 0, 0, canvas.width, canvas.height);
            var imageData = context2d.getImageData(0, 0, canvas.width, canvas.height);
            matchPixCount = 0;
            endPixCheck = imageData.data.length;
            maxPixCount = imageData.data.length / 4;

            for (var pix = 0; pix < endPixCheck; pix += 4) {
                var currentColor = {
                    r: imageData.data[pix],
                    g: imageData.data[pix + 1],
                    b: imageData.data[pix + 2]
                };
                var colorDifference = Math.sqrt(
                    Math.pow(currentColor.r - sampleColor.r, 2) +
                    Math.pow(currentColor.g - sampleColor.g, 2) +
                    Math.pow(currentColor.b - sampleColor.b, 2)
                );
                if (colorDifference <= maxColorDifference * pixTolerance)
                    matchPixCount++;
            }

            return maxPixCount - matchPixCount <= maxPixCount * frameTolerance;
        },

        makeSimpleBlock: function(data) {
            var flags = 0;
            if (data.keyframe) flags |= 128;
            if (data.invisible) flags |= 8;
            if (data.lacing) flags |= (data.lacing << 1);
            if (data.discardable) flags |= 1;
            if (data.trackNum > 127)
                throw "TrackNumber > 127 not supported";
            var out = [data.trackNum | 0x80, data.timecode >> 8, data.timecode & 0xff, flags].map(function(e) {
                return String.fromCharCode(e);
            }).join('') + data.frame;
            return out;
        },

        generateEBMLHeader: function(duration, width, height) {

            var doubleToString = function(num) {
                return [].slice.call(
                    new Uint8Array((new Float64Array([num])).buffer), 0).map(function(e) {
                    return String.fromCharCode(e);
                }).reverse().join('');
            };

            return [{
                "id": 0x1a45dfa3, // EBML
                "data": [{
                    "data": 1,
                    "id": 0x4286 // EBMLVersion
                }, {
                    "data": 1,
                    "id": 0x42f7 // EBMLReadVersion
                }, {
                    "data": 4,
                    "id": 0x42f2 // EBMLMaxIDLength
                }, {
                    "data": 8,
                    "id": 0x42f3 // EBMLMaxSizeLength
                }, {
                    "data": "webm",
                    "id": 0x4282 // DocType
                }, {
                    "data": 2,
                    "id": 0x4287 // DocTypeVersion
                }, {
                    "data": 2,
                    "id": 0x4285 // DocTypeReadVersion
                }]
            }, {
                "id": 0x18538067, // Segment
                "data": [{
                    "id": 0x1549a966, // Info
                    "data": [{
                        "data": 1e6, //do things in millisecs (num of nanosecs for duration scale)
                        "id": 0x2ad7b1 // TimecodeScale
                    }, {
                        "data": "whammy",
                        "id": 0x4d80 // MuxingApp
                    }, {
                        "data": "whammy",
                        "id": 0x5741 // WritingApp
                    }, {
                        "data": doubleToString(duration),
                        "id": 0x4489 // Duration
                    }]
                }, {
                    "id": 0x1654ae6b, // Tracks
                    "data": [{
                        "id": 0xae, // TrackEntry
                        "data": [{
                            "data": 1,
                            "id": 0xd7 // TrackNumber
                        }, {
                            "data": 1,
                            "id": 0x63c5 // TrackUID
                        }, {
                            "data": 0,
                            "id": 0x9c // FlagLacing
                        }, {
                            "data": "und",
                            "id": 0x22b59c // Language
                        }, {
                            "data": "V_VP8",
                            "id": 0x86 // CodecID
                        }, {
                            "data": "VP8",
                            "id": 0x258688 // CodecName
                        }, {
                            "data": 1,
                            "id": 0x83 // TrackType
                        }, {
                            "id": 0xe0, // Video
                            "data": [{
                                "data": width,
                                "id": 0xb0 // PixelWidth
                            }, {
                                "data": height,
                                "id": 0xba // PixelHeight
                            }]
                        }]
                    }]
                }]
            }];
        },

        __numToBuffer: function(num) {
            var parts = [];
            while (num > 0) {
                parts.push(num & 0xff);
                num = num >> 8;
            }
            return new Uint8Array(parts.reverse());
        },

        __strToBuffer: function(str) {
            return new Uint8Array(str.split('').map(function(e) {
                return e.charCodeAt(0);
            }));
        },

        __bitsToBuffer: function(bits) {
            var data = [];
            var pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';
            bits = pad + bits;
            for (var i = 0; i < bits.length; i += 8)
                data.push(parseInt(bits.substr(i, 8), 2));
            return new Uint8Array(data);
        },

        serializeEBML: function(json) {
            if (!Types.is_array(json))
                return json;
            var ebml = [];
            json.forEach(function(entry) {
                var data = entry.data;
                var tp = typeof data;
                if (tp === "object")
                    data = this.serializeEBML(data);
                else if (tp === "number")
                    data = this.__bitsToBuffer(data.toString(2));
                else if (tp === "string")
                    data = this.__strToBuffer(data);
                var len = data.size || data.byteLength || data.length;
                var zeroes = Math.ceil(Math.ceil(Math.log(len) / Math.log(2)) / 8);
                var size_str = len.toString(2);
                var padded = (new Array((zeroes * 7 + 7 + 1) - size_str.length)).join('0') + size_str;
                var size = (new Array(zeroes)).join('0') + '1' + padded;
                ebml.push(this.__numToBuffer(entry.id));
                ebml.push(this.__bitsToBuffer(size));
                ebml.push(data);
            }, this);
            return new Blob(ebml, {
                type: "video/webm"
            });
        },

        makeTimecodeDataBlock: function(data, clusterDuration) {
            return {
                data: this.makeSimpleBlock({
                    discardable: 0,
                    frame: data.slice(4),
                    invisible: 0,
                    keyframe: 1,
                    lacing: 0,
                    trackNum: 1,
                    timecode: Math.round(clusterDuration)
                }),
                id: 0xa3
            };
        },

        makeCluster: function(clusterFrames, clusterTimecode) {
            clusterFrames.unshift({
                "data": clusterTimecode,
                "id": 0xe7 // Timecode
            });
            return {
                "id": 0x1f43b675, // Cluster
                "data": clusterFrames
            };
        }

    };
});

Scoped.define("module:ImageRecorder.ImageRecorderWrapper", ["base:Classes.ConditionalInstance","base:Events.EventsMixin","base:Objs","base:Promise"], function (ConditionalInstance, EventsMixin, Objs, Promise, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                this._element = this._options.element;
                this.ready = Promise.create();
            },

            destroy: function() {
                inherited.destroy.call(this);
            },

            bindMedia: function() {
                return this._bindMedia();
            },

            _bindMedia: function() {},

            unbindMedia: function() {
                return this._unbindMedia();
            },

            _unbindMedia: function() {},

            softwareDependencies: function() {
                return this._softwareDependencies();
            },

            _softwareDependencies: function() {},

            cameraWidth: function() {
                return this._options.recordingWidth;
            },

            cameraHeight: function() {
                return this._options.recordingHeight;
            },

            lightLevel: function() {},
            blankLevel: function() {},
            deltaCoefficient: function() {},

            enumerateDevices: function() {},
            currentDevices: function() {},
            setCurrentDevices: function(devices) {},

            createSnapshot: function() {},
            removeSnapshot: function(snapshot) {},
            createSnapshotDisplay: function(parent, snapshot, x, y, w, h) {},
            updateSnapshotDisplay: function(snapshot, display, x, y, w, h) {},
            removeSnapshotDisplay: function(display) {},
            createSnapshotUploader: function(snapshot, type, uploaderOptions) {},

            isFlash: function() {
                return false;
            },

            snapshotToLocalPoster: function(snapshot) {
                return null;
            }

        };
    }], {

        _initializeOptions: function(options) {
            return Objs.extend({
                forceflash: false,
                noflash: false,
                recordingWidth: 640,
                recordingHeight: 480
            }, options);
        }

    });
});

Scoped.define("module:Player.Broadcasting", ["base:Class","browser:Loader","browser:Events"], function (Class, Loader, DomEvents, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function(instance) {
                inherited.constructor.apply(this);
                this.player = instance.player;
                this.googleCast = {};
                this.airplay = {};
                this.options = instance.commonOptions;
                this.googleCast.initialOptions = instance.castOptions;
                this.airplayOptions = instance.airplayOptions;

                this.player.on("pause-google-cast", function() {
                    this._googleCastRemotePause();
                }, this);

                this.player.on("play-google-cast", function() {
                    this._googleCastRemotePlay();
                }, this);

                this.player.on("google-cast-seeking", function(duration) {
                    this._seekToGoogleCast(duration);
                }, this);

                this.player.on("change-google-cast-volume", function(volume) {
                    volume = Math.min(1.0, volume);
                    this._changeGoogleCastVolume(volume);
                }, this);
            },

            attachAirplayEvent: function(video) {
                this._airplayEvent = this.auto_destroy(new DomEvents());
                this._airplayEvent.on(video, "webkitplaybacktargetavailabilitychanged", function(ev) {
                    switch (ev.availability) {
                        case "available":
                            this.player._broadcastingState.airplayConnected = true;
                            return true;
                        default:
                            return false;
                    }
                }, this);
            },

            attachGoggleCast: function() {
                var self = this;
                window.__onGCastApiAvailable = function(isAvailable) {
                    if (isAvailable) {
                        self._initializeCastApi();
                    }
                };

                Loader.loadScript('https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1', function() {

                });
            },

            _initializeCastApi: function() {
                var self = this;
                self.player.trigger("cast-available", true);
                var googleCastInitialOptions = this.googleCast.initialOptions;

                var options = {};
                // [0] default media receiver app ID
                // [1] Custom Receiver app ID
                // [2] Styled Media Receiver app ID # can also add https css files from cast console
                // [3] Remote Display Receiver app ID
                var applicationIds = [
                    chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
                    '41A5ADFD', '8AA2B3F9', 'DE815B4F'
                ];

                // [0] no auto join
                // [1] same appID, same URL, same tab
                // [2] same appID and same origin URL
                var autoJoinPolicy = [
                    chrome.cast.AutoJoinPolicy.PAGE_SCOPED,
                    chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED,
                    chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
                ];

                options.receiverApplicationId = applicationIds[2];
                options.autoJoinPolicy = autoJoinPolicy[1];

                cast.framework.CastContext.getInstance().setOptions(options);

                var castRemotePlayer = new cast.framework.RemotePlayer();
                castRemotePlayer.title = this.options.title;
                //castRemotePlayer.displayStatus =  "Please wait connecting",
                castRemotePlayer.canControlVolume = googleCastInitialOptions.canControlVolume;
                castRemotePlayer.canPause = googleCastInitialOptions.canPause;
                castRemotePlayer.canSeek = googleCastInitialOptions.canSeek;
                castRemotePlayer.duration = googleCastInitialOptions.duration;
                castRemotePlayer.imageUrl = googleCastInitialOptions.imageUrl;
                castRemotePlayer.isConnected = googleCastInitialOptions.isConnected;
                castRemotePlayer.isMuted = googleCastInitialOptions.isMuted;
                castRemotePlayer.isPaused = googleCastInitialOptions.isPaused;
                castRemotePlayer.title = this.options.title;
                castRemotePlayer.displayName = googleCastInitialOptions.displayName;

                var castRemotePlayerController = new cast.framework.RemotePlayerController(castRemotePlayer);
                //castRemotePlayerController methods
                //getSeekPosition(currentTime, duration), getSeekTime(currentPosition, duration)
                //castRemotePlayer.currentTime = position.in.seconds; muteOrUnmute(); playOrPause()
                // seek(), setVolumeLevel(), stop()


                castRemotePlayerController.addEventListener(
                    cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,
                    function() {
                        if (cast && cast.framework) {
                            if (castRemotePlayer.isConnected) {
                                self._setupCastRemotePlayer(castRemotePlayer, castRemotePlayerController);
                            } else {
                                self._destroyCastRemotePlayer(castRemotePlayer, castRemotePlayerController);
                            }
                        }
                    }
                );
            },

            _setupCastRemotePlayer: function(castRemotePlayer, castRemotePlayerController) {
                var self = this;
                var player = this.player;
                var options = this.castOptions;
                var sources = player._options.sources[0];
                var mediaURL = player._element.currentSrc;
                var mediaMimeType = sources.type;

                var castSession = cast.framework.CastContext.getInstance().getCurrentSession();

                var mediaInfo = new chrome.cast.media.MediaInfo(mediaURL, mediaMimeType);
                mediaInfo.metadata = new chrome.cast.media.GenericMediaMetadata();
                mediaInfo.metadata.metadataType = chrome.cast.media.MetadataType.GENERIC;
                mediaInfo.metadata.title = this.options.title;
                mediaInfo.metadata.images = [{
                    url: this.options.poster
                }];

                var request = new chrome.cast.media.LoadRequest(mediaInfo);

                this.googleCast.castRemotePlayer = castRemotePlayer;
                this.googleCast.castRemotePlayerController = castRemotePlayerController;
                this.googleCast.castMediaInfo = mediaInfo;
                this.googleCast.castSession = castSession;

                castSession.loadMedia(request).then(
                    function() {

                        player._broadcastingState.googleCastConnected = true;
                        player.trigger("cast-loaded", castRemotePlayer, castRemotePlayerController);


                        var currentPosition = self.options.currentPosition;
                        if (currentPosition > 0) self._seekToGoogleCast(currentPosition);

                        // Listeners available for further actions with remote player
                        // https://developers.google.com/cast/docs/reference/chrome/cast.framework#.RemotePlayerEventType
                        castRemotePlayerController.addEventListener(
                            cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED,
                            function() {
                                player.trigger("cast-playpause", castRemotePlayer.isPaused);
                            }
                        );

                        castRemotePlayerController.addEventListener(
                            cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED,
                            function() {
                                var currentTime = self._getGoogleCastCurrentMediaTime(castRemotePlayer);
                                var totalMediaDuration = self._getGoogleCastMediaDuration(castRemotePlayer);
                                player.trigger("cast-time-changed", currentTime, totalMediaDuration);
                            }
                        );
                    },
                    function(errorCode) {
                        console.warn('Remote media load error : ' + self._googleCastPlayerErrorMessages(errorCode));
                    }
                );

            },

            _destroyCastRemotePlayer: function(castRemotePlayer, castRemotePlayerController) {
                var player = this.player;
                var currentPosition = this._getGoogleCastCurrentMediaTime(castRemotePlayer);

                if (castRemotePlayer.savedPlayerState && !castRemotePlayer.isConnected)
                    currentPosition = castRemotePlayer.savedPlayerState.currentTime;

                if (player._broadcastingState.googleCastConnected && currentPosition > 0)
                    player.trigger("proceed-when-ending-googlecast", currentPosition);

                this.player._broadcastingState.googleCastConnected = false;
            },

            _getGoogleCastRemotePlayer: function() {
                if (!this.player._broadcastingState.googleCastConnected)
                    return;

                return this.googleCast.castRemotePlayer;
            },

            _getGoogleCastRemotePlayerController: function() {
                if (!this.player._broadcastingState.googleCastConnected)
                    return;

                return this.googleCast.castRemotePlayerController;
            },

            _getGoogleCastMediaInfo: function() {
                if (!this.player._broadcastingState.googleCastConnected)
                    return;

                return this.googleCast.castMediaInfo;
            },

            _getGoogleCastCurrentSession: function() {
                if (!this.player._broadcastingState.googleCastConnected)
                    return;

                return this.googleCast.castSession;
            },

            _getGoogleCastCurrentMediaTime: function(remotePlayer) {
                if (!this.player._broadcastingState.googleCastConnected)
                    return;

                return remotePlayer.currentTime;

            },

            _getGoogleCastMediaDuration: function(remotePlayer) {
                if (!this.player._broadcastingState.googleCastConnected)
                    return;

                return remotePlayer.duration;
            },

            _googleCastRemotePlay: function() {
                if (this.player._broadcastingState.googleCastConnected) {
                    var castRemotePlayer = this._getGoogleCastRemotePlayer();
                    var castRemotePlayerController = this._getGoogleCastRemotePlayerController();
                    if (castRemotePlayer.playerState === 'PAUSED')
                        castRemotePlayerController.playOrPause();
                    return castRemotePlayer;
                } else return false;
            },

            _googleCastRemotePause: function() {
                if (this.player._broadcastingState.googleCastConnected) {
                    var castRemotePlayer = this._getGoogleCastRemotePlayer();
                    var castRemotePlayerController = this._getGoogleCastRemotePlayerController();
                    if (castRemotePlayer.playerState === 'PLAYING')
                        castRemotePlayerController.playOrPause();
                    return castRemotePlayer;
                } else return false;
            },

            _seekToGoogleCast: function(time) {
                var castRemotePlayer = this._getGoogleCastRemotePlayer();
                var castRemotePlayerController = this._getGoogleCastRemotePlayerController();
                castRemotePlayer.currentTime = time;
                castRemotePlayerController.seek();
            },

            _changeGoogleCastVolume: function(volumePosition) {
                var castRemoteController = this._getGoogleCastRemotePlayerController();
                var castRemotePlayer = this._getGoogleCastRemotePlayer();
                castRemotePlayer.volumeLevel = volumePosition;
                castRemoteController.setVolumeLevel();
            },

            _googleCastPlayerErrorMessages: function(error) {
                switch (error.code) {
                    case chrome.cast.ErrorCode.API_NOT_INITIALIZED:
                        return 'The API is not initialized.' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.CANCEL:
                        return 'The operation was canceled by the user' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.CHANNEL_ERROR:
                        return 'A channel to the receiver is not available.' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.EXTENSION_MISSING:
                        return 'The Cast extension is not available.' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.INVALID_PARAMETER:
                        return 'The parameters to the operation were not valid.' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:
                        return 'No receiver was compatible with the session request.' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.SESSION_ERROR:
                        return 'A session could not be created, or a session was invalid.' +
                            (error.description ? ' :' + error.description : '');
                    case chrome.cast.ErrorCode.TIMEOUT:
                        return 'The operation timed out.' +
                            (error.description ? ' :' + error.description : '');
                }
            },

            lookForAirplayDevices: function(videoElement) {
                return videoElement.webkitShowPlaybackTargetPicker();
            }

        };
    });
});

Scoped.define("module:Player.FlashPlayer", ["browser:DomExtend.DomExtension","browser:Dom","browser:Info","flash:FlashClassRegistry","flash:FlashEmbedding","base:Strings","base:Async","base:Objs","base:Functions","base:Types","base:Promise"], function (Class, Dom, Info, FlashClassRegistry, FlashEmbedding, Strings, Async, Objs, Functions, Types, Promise, scoped) {
    var Cls = Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(element, attrs) {
                inherited.constructor.call(this, element, attrs);
                this._source = this.__preferedSource();
                this._embedding = this.auto_destroy(new FlashEmbedding(element, {
                    registry: this.cls.flashRegistry(),
                    wrap: true,
                    debug: false
                }));
                this._flashObjs = {};
                this._flashData = {
                    status: 'idle'
                };
                this.ready = Promise.create();
                this._embedding.ready(this.__initializeEmbedding, this);
            },

            __preferedSource: function() {
                var preferred = [".mp4", ".flv"];
                var sources = [];
                if (this.readAttr("src") || this.readAttr("source") || this.readAttr("sources")) {
                    var src = this.readAttr("src") || this.readAttr("source") || this.readAttr("sources");
                    if (Types.is_array(src))
                        sources = src;
                    else
                        sources.push(src);
                }
                var element = this._element;
                if (!(Info.isInternetExplorer() && Info.internetExplorerVersion() < 9)) {
                    for (var i = 0; i < this._element.childNodes.length; ++i) {
                        if (element.childNodes[i].tagName && element.childNodes[i].tagName.toLowerCase() == "source" && element.childNodes[i].src)
                            sources.push(element.childNodes[i].src.toLowerCase());
                    }
                } else {
                    var current = this._element;
                    while (true) {
                        var next = current.nextSibling;
                        if (!next || !next.tagName || next.tagName.toLowerCase() != "source")
                            break;
                        sources.push(next.src.toLowerCase());
                        current = next;
                    }
                }
                sources = Objs.map(sources, function(source) {
                    return source.src || source;
                });
                var source = sources[0];
                var currentExtIndex = preferred.length - 1;
                for (var k = sources.length - 1; k >= 0; --k) {
                    for (var j = 0; j <= currentExtIndex; ++j) {
                        if (Strings.ends_with(sources[k], preferred[j])) {
                            source = sources[k];
                            currentExtIndex = j;
                            break;
                        }
                    }
                }
                if (source.indexOf("://") == -1)
                    source = document.location.href + "/../" + source;

                var connectionUrl = null;
                var playUrl = source;
                if (Strings.starts_with(source, "rtmp")) {
                    var spl = Strings.splitLast(source, "/");
                    connectionUrl = spl.head;
                    playUrl = spl.tail;
                }
                return {
                    sourceUrl: source,
                    connectionUrl: connectionUrl,
                    playUrl: playUrl
                };
            },

            __initializeEmbedding: function() {
                this._flashObjs.main = this._embedding.flashMain();
                this._flashObjs.stage = this._flashObjs.main.get("stage");
                this._flashObjs.stage.set("scaleMode", "noScale");
                this._flashObjs.stage.set("align", "TL");

                if (this.readAttr("poster")) {
                    this._flashObjs.imageLoader = this._embedding.newObject("flash.display.Loader");
                    var contentLoaderInfo = this._flashObjs.imageLoader.get("contentLoaderInfo");
                    contentLoaderInfo.addEventListener("complete", this._embedding.newCallback(Functions.as_method(function() {
                        this.__imageLoaded = {
                            width: this._flashObjs.imageLoader.get("width"),
                            height: this._flashObjs.imageLoader.get("height")
                        };
                        if (!this.__metaLoaded)
                            this.recomputeBB();
                    }, this)));
                    contentLoaderInfo.addEventListener("ioError", this._embedding.newCallback(Functions.as_method(function() {
                        this.domEvent("postererror");
                    }, this)));
                    this._flashObjs.imageUrlRequest = this._embedding.newObject("flash.net.URLRequest", this.readAttr("poster"));
                    this._flashObjs.imageLoader.load(this._flashObjs.imageUrlRequest);
                    this._flashObjs.main.addChildVoid(this._flashObjs.imageLoader);
                }
                this._flashObjs.video = this._embedding.newObject(
                    "flash.media.Video",
                    this._flashObjs.stage.get("stageWidth"),
                    this._flashObjs.stage.get("stageHeight")
                );
                this._flashObjs.connection = this._embedding.newObject("flash.net.NetConnection");
                this._flashObjs.connection.addEventListener("netStatus", this._embedding.newCallback(Functions.as_method(this.__connectionStatusEvent, this)));
                this._flashObjs.connection.connectVoid(this._source.connectionUrl);
            },

            __connectionStatusEvent: function() {
                this._flashObjs.stream = this._embedding.newObject("flash.net.NetStream", this._flashObjs.connection);
                this._flashObjs.stream.set("client", this._embedding.newCallback("onMetaData", Functions.as_method(function(info) {
                    this._flashData.meta = info;
                    this._element.duration = info.duration;
                    this.__metaLoaded = true;
                    Async.eventually(this.recomputeBB, this);
                }, this)));
                this._flashObjs.stream.addEventListener("netStatus", this._embedding.newCallback(Functions.as_method(this.__streamStatusEvent, this)));
                this._flashObjs.soundTransform = this._embedding.newObject("flash.media.SoundTransform");
                this._flashObjs.stream.set("soundTransform", this._flashObjs.soundTransform);
                this._flashObjs.video.attachNetStreamVoid(this._flashObjs.stream);
                this.writeAttr("volume", 1.0);
                if (this.hasAttr("muted")) {
                    this._flashObjs.soundTransform.set("volume", 0.0);
                    this._flashObjs.stream.set("soundTransform", null);
                    this._flashObjs.stream.set("soundTransform", this._flashObjs.soundTransform);
                    this.writeAttr("volume", 0.0);
                }
                this._flashObjs.main.addChildVoid(this._flashObjs.video);
                if (this.hasAttr("autoplay"))
                    this._element.play();
                this.ready.asyncSuccess(this);
            },

            __streamStatusEvent: function(event) {
                var code = event.get("info").code;
                if (code == "NetStream.Play.StreamNotFound") {
                    this._flashData.status = "error";
                    this.domEvent("videoerror");
                }
                if (code == "NetStream.Play.Start")
                    this._flashData.status = "start";
                if (code == "NetStream.Play.Stop")
                    this._flashData.status = "stopping";
                if (code == "NetStream.Buffer.Empty" && this._flashData.status == "stopping") {
                    this._flashData.status = "stopped";
                    this.domEvent("ended");
                }
                if (this._flashData.status == "stopped" && this.hasAttr("loop")) {
                    this._flashData.status = "idle";
                    this._element.play();
                }
            },

            idealBB: function() {
                if (!this.__imageLoaded && !this.__metaLoaded)
                    return null;
                return {
                    width: this.__metaLoaded ? this._flashData.meta.width : this.__imageLoaded.width,
                    height: this.__metaLoaded ? this._flashData.meta.height : this.__imageLoaded.height
                };
            },

            setActualBB: function(actualBB) {
                ["object", "embed"].forEach(function(tag) {
                    var container = this._element.getElementsByTagName(tag.toUpperCase())[0];
                    if (container) {
                        ["width", "height"].forEach(function(attr) {
                            container.style[attr] = actualBB[attr] + "px";
                        });
                    }
                }, this);
                if (this.__metaLoaded) {
                    this._flashObjs.video.set("width", actualBB.width);
                    this._flashObjs.video.set("height", actualBB.height);
                }
                if (this.__imageLoaded) {
                    this._flashObjs.imageLoader.set("width", actualBB.width);
                    this._flashObjs.imageLoader.set("height", actualBB.height);
                }
            },

            videoWidth: function() {
                return this.__metaLoaded ? this._flashData.meta.width : (this.__imageLoaded ? this.__imageLoaded.width : NaN);
            },

            videoHeight: function() {
                return this.__metaLoaded ? this._flashData.meta.height : (this.__imageLoaded ? this.__imageLoaded.height : NaN);
            },

            _domMethods: ["play", "pause", "load"],

            _domAttrs: {
                "volume": {
                    set: "_setVolume"
                },
                "currentTime": {
                    get: "_getCurrentTime",
                    set: "_setCurrentTime"
                }
            },

            load: function() {},

            play: function() {
                if (this._flashObjs.main.imageLoader)
                    this._flashObjs.main.setChildIndex(this._flashObjs.video, 1);
                if (this._flashData.status === "paused")
                    this._flashObjs.stream.resumeVoid();
                else
                    this._flashObjs.stream.playVoid(this._source.playUrl);
                this._flashData.status = "playing";
                this.domEvent("playing");
            },

            pause: function() {
                if (this._flashData.status === "paused")
                    return;
                this._flashData.status = "paused";
                this._flashObjs.stream.pauseVoid();
                this.domEvent("pause");
            },

            _setVolume: function(volume) {
                this._flashObjs.soundTransform.set("volume", volume);
                this._flashObjs.stream.set("soundTransform", null);
                this._flashObjs.stream.set("soundTransform", this._flashObjs.soundTransform);
                this.domEvent("volumechange");
            },

            _getCurrentTime: function() {
                return this._flashObjs.stream.get("time");
            },

            _setCurrentTime: function(time) {
                this._flashObjs.stream.seek(time);
            }

        };
    }, {

        flashRegistry: function() {
            if (!this.__flashRegistry) {
                this.__flashRegistry = new FlashClassRegistry();
                this.__flashRegistry.register("flash.media.Video", ["attachNetStream"]);
                this.__flashRegistry.register("flash.display.Sprite", ["addChild", "setChildIndex"]);
                this.__flashRegistry.register("flash.display.Stage", []);
                this.__flashRegistry.register("flash.net.NetStream", ["play", "pause", "resume", "addEventListener", "seek"]);
                this.__flashRegistry.register("flash.net.NetConnection", ["connect", "addEventListener"]);
                this.__flashRegistry.register("flash.media.SoundTransform", []);
                this.__flashRegistry.register("flash.display.Loader", ["load"]);
                this.__flashRegistry.register("flash.net.URLRequest", []);
                this.__flashRegistry.register("flash.display.LoaderInfo", ["addEventListener"]);
            }
            return this.__flashRegistry;
        },

        polyfill: function(element, polyfilltag, force, eventual) {
            if (eventual) {
                var promise = Promise.create();
                Async.eventually(function() {
                    promise.asyncSuccess(Cls.polyfill(element, polyfilltag, force));
                });
                return promise;
            }
            if (element.tagName.toLowerCase() != "video" || !("networkState" in element))
                return Cls.attach(element);
            else if (element.networkState == element.NETWORK_NO_SOURCE || force)
                return Cls.attach(Dom.changeTag(element, polyfilltag || "videopoly"));
            return element;
        },

        attach: function(element, attrs) {
            var cls = new Cls(element, attrs);
            return element;
        }


    });
    return Cls;
});

Scoped.define("module:Player.Support", ["base:Promise","base:Objs"], function (Promise, Objs) {
    return {

        resolutionToLabel: function(width, height) {
            if (height < 300)
                return "SD";
            if (height < 400)
                return "360p";
            if (height < 500)
                return "480p";
            return "HD";
        },

        elementFileInfo: function(elementType, elementEvent, elementAttrs, file) {
            try {
                var element = document.createElement(elementType);
                Objs.iter(elementAttrs, function(value, key) {
                    element[key] = value;
                });
                var promise = Promise.create();
                var failed = false;
                var timer = setTimeout(function() {
                    failed = true;
                    promise.asyncError("Timeout");
                }, 1000);
                element[elementEvent] = function() {
                    if (failed)
                        return;
                    clearTimeout(timer);
                    promise.asyncSuccess(element);
                };
                element.src = (window.URL || window.webkitURL).createObjectURL(file);
                return promise;
            } catch (e) {
                return Promise.error(e);
            }
        },

        videoFileInfo: function(file) {
            return this.elementFileInfo("video", "onloadeddata", {
                volume: 0,
                muted: true,
                preload: true
            }, file).mapSuccess(function(video) {
                return {
                    width: video.videoWidth,
                    height: video.videoHeight,
                    duration: video.duration
                };
            });
        },

        audioFileInfo: function(file) {
            return this.elementFileInfo("audio", "onloadeddata", {
                volume: 0,
                muted: true,
                preload: true
            }, file).mapSuccess(function(audio) {
                return {
                    duration: audio.duration
                };
            });
        },

        imageFileInfo: function(file) {
            return this.elementFileInfo("img", "onload", {}, file).mapSuccess(function(image) {
                return {
                    width: image.width,
                    height: image.height
                };
            });
        }

    };
});

Scoped.define("module:Player.VideoPlayerWrapper", ["base:Classes.OptimisticConditionalInstance","base:Events.EventsMixin","base:Types","base:Objs","base:Strings","browser:Events"], function (OptimisticConditionalInstance, EventsMixin, Types, Objs, Strings, DomEvents, scoped) {
    return OptimisticConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options, transitionals) {
                inherited.constructor.call(this);
                options = Objs.extend(Objs.clone(options || {}, 1), transitionals);
                this._poster = options.poster || null;
                var sources = options.source || options.sources || [];
                if (Types.is_string(sources))
                    sources = sources.split(" ");
                else if (!Types.is_array(sources))
                    sources = [sources];
                var sourcesMapped = [];
                Objs.iter(sources, function(source) {
                    if (Types.is_string(source))
                        source = {
                            src: source.trim()
                        };
                    else if (typeof Blob !== 'undefined' && source instanceof Blob)
                        source = {
                            src: source
                        };
                    if (source.ext && !source.type)
                        source.type = "video/" + source.ext;
                    if (!source.ext && source.type)
                        source.ext = Strings.last_after(source.type, "/");
                    if (!source.ext && !source.type && Types.is_string(source.src)) {
                        var temp = Strings.splitFirst(source.src, "?").head;
                        if (temp.indexOf(".") >= 0) {
                            source.ext = Strings.last_after(temp, ".");
                            source.type = "video/" + source.ext;
                        }
                    }
                    if (source.ext)
                        source.ext = source.ext.toLowerCase();
                    if (source.type)
                        source.type = source.type.toLowerCase();
                    if (typeof Blob !== 'undefined' && source.src instanceof Blob)
                        source.src = (window.URL || window.webkitURL).createObjectURL(source.src);
                    if (typeof Blob !== 'undefined' && source.audiosrc instanceof Blob)
                        source.audiosrc = (window.URL || window.webkitURL).createObjectURL(source.audiosrc);
                    sourcesMapped.push(source);
                }, this);
                this._sources = sourcesMapped;
                this._element = options.element;
                this._preload = options.preload || false;
                this._reloadonplay = options.reloadonplay || false;
                this._options = options;
                this._loop = options.loop || false;
                this._loaded = false;
                this._postererror = false;
                this._error = 0;
                this._domEvents = new DomEvents();
                this._broadcastingState = {
                    googleCastConnected: false,
                    airplayConnected: false
                };
            },

            destroy: function() {
                this._domEvents.destroy();
                inherited.destroy.call(this);
            },

            poster: function() {
                return this._poster;
            },

            sources: function() {
                return this._sources;
            },

            loaded: function() {
                return this._loaded;
            },

            postererror: function() {
                return this._postererror;
            },

            buffered: function() {},

            _eventLoaded: function() {
                this._loaded = true;
                this.trigger("loaded");
            },

            _eventPlaying: function() {
                if (!this._loaded)
                    this._eventLoaded();
                this.trigger("playing");
            },

            _eventPaused: function() {
                if (this.duration() && this.duration() === this.position())
                    return;
                this.trigger("paused");
            },

            _eventEnded: function() {
                this.trigger("ended");
            },

            _eventError: function(error) {
                this._error = error;
                this.trigger("error", error);
            },

            _eventPosterError: function() {
                this._postererror = true;
                this.trigger("postererror");
            },

            supportsFullscreen: function() {
                return false;
            },

            duration: function() {
                return this._element.duration;
            },

            position: function() {
                return this._element.currentTime;
            },

            enterFullscreen: function() {},

            exitFullscreen: function() {},

            isFullscreen: function() {
                return false;
            },

            error: function() {
                return this._error;
            },

            play: function() {
                if (this._reloadonplay)
                    this._element.load();
                this._reloadonplay = false;
                this._element.play();
            },

            pause: function() {
                this._element.pause();
            },

            setPosition: function(position) {
                this._element.currentTime = position;
            },

            muted: function() {
                return this._element.muted;
            },

            setMuted: function(muted) {
                this._element.muted = muted;
            },

            volume: function() {
                return this._element.volume;
            },

            setVolume: function(volume) {
                this._element.volume = volume;
            },

            videoWidth: function() {},

            videoHeight: function() {}

        };
    }], {

        ERROR_NO_PLAYABLE_SOURCE: 1,
        ERROR_FLASH_NOT_INSTALLED: 2

    });
});

Scoped.define("module:Player.Html5VideoPlayerWrapper", ["module:Player.VideoPlayerWrapper","browser:Info","base:Promise","base:Objs","base:Timers.Timer","base:Strings","base:Async","browser:Dom","browser:Events"], function (VideoPlayerWrapper, Info, Promise, Objs, Timer, Strings, Async, Dom, DomEvents, scoped) {
    return VideoPlayerWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            _initialize: function() {
                if (this._options.nohtml5)
                    return Promise.error(true);
                if (this._sources.length < 1)
                    return Promise.error(true);
                if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 9)
                    return Promise.error(true);
                if (this._options.forceflash)
                    return Promise.error(true);
                var self = this;
                var promise = Promise.create();
                this._element.innerHTML = "";
                var sources = this.sources();
                var ie9 = (Info.isInternetExplorer() && Info.internetExplorerVersion() == 9) || Info.isWindowsPhone();
                if (this._element.tagName.toLowerCase() !== "video") {
                    this._element = Dom.changeTag(this._element, "video");
                    this._transitionals.element = this._element;
                } else if (ie9) {
                    var str = Strings.splitLast(this._element.outerHTML, "</video>").head;
                    Objs.iter(sources, function(source) {
                        str += "<source" + (source.type ? " type='" + source.type + "'" : "") + " src='" + source.src + "' />";
                    });
                    str += "</video>";
                    var replacement = Dom.elementByTemplate(str);
                    Dom.elementInsertAfter(replacement, this._element);
                    this._element.parentNode.removeChild(this._element);
                    this._element = replacement;
                    this._transitionals.element = this._element;
                }
                if (Info.isSafari() && Info.safariVersion() < 6) {
                    this._element.src = sources[0].src;
                    this._preload = true;
                }
                /*
                var loadevent = "loadedmetadata";
                if (Info.isSafari() && Info.safariVersion() < 9)
                	loadevent = "loadstart";
                	*/
                var loadevent = "loadstart";
                this._domEvents.on(this._element, "loadevent", function() {
                    if ( /*loadevent === "loadstart" && */ this._element.networkState === this._element.NETWORK_NO_SOURCE) {
                        promise.asyncError(true);
                        return;
                    }
                    promise.asyncSuccess(true);
                }, this);
                var nosourceCounter = 10;
                var timer = new Timer({
                    context: this,
                    fire: function() {
                        if (this._element.networkState === this._element.NETWORK_NO_SOURCE) {
                            nosourceCounter--;
                            if (nosourceCounter <= 0)
                                promise.asyncError(true);
                        } else if (this._element.networkState === this._element.NETWORK_IDLE)
                            promise.asyncSuccess(true);
                        else if (this._element.networkState === this._element.NETWORK_LOADING) {
                            if (Info.isEdge() || Info.isInternetExplorer())
                                promise.asyncSuccess(true);
                            else if (Info.isFirefox() && sources[0].src.indexOf("blob:") === 0)
                                promise.asyncSuccess(true);
                        }
                    },
                    delay: 50
                });
                this._element.preload = this._preload ? "auto" : "none";
                if (this._loop)
                    this._element.loop = "loop";
                var errorCount = 0;
                this._audioElement = null;
                var errorEvents = new DomEvents();
                if (!ie9) {
                    Objs.iter(sources, function(source) {
                        var sourceEl = document.createElement("source");
                        if (source.type)
                            sourceEl.type = source.type;
                        this._element.appendChild(sourceEl);
                        errorEvents.on(sourceEl, "error", function() {
                            errorCount++;
                            if (errorCount === sources.length)
                                promise.asyncError(true);
                        });
                        sourceEl.src = source.src;
                        if (source.audiosrc) {
                            if (!this._audioElement) {
                                this._audioElement = document.createElement("audio");
                                Dom.elementInsertAfter(this._audioElement, this._element);
                            }
                            var audioSourceEl = document.createElement("source");
                            if (source.type)
                                audioSourceEl.type = source.type;
                            this._audioElement.appendChild(audioSourceEl);
                            audioSourceEl.src = source.audiosrc;
                        }
                    }, this);
                } else {
                    var sourceEls = this._element.getElementsByTagName("SOURCE");
                    var cb = function() {
                        errorCount++;
                        if (errorCount === sources.length)
                            promise.asyncError(true);
                    };
                    for (var i = 0; i < sourceEls.length; ++i) {
                        errorEvents.on(sourceEls[i], "error", cb);
                    }
                }
                if (this.poster())
                    this._element.poster = this.posterURL();
                promise.callback(function() {
                    errorEvents.weakDestroy();
                    timer.destroy();
                }, this);
                promise.success(function() {
                    this._setup();
                }, this);
                try {
                    if (!Info.isChrome())
                        this._element.load();
                } catch (e) {}
                return promise;
            },

            posterURL: function() {
                var poster = this.poster();
                if (poster && typeof Blob !== 'undefined' && poster instanceof Blob)
                    return (window.URL || window.webkitURL).createObjectURL(poster);
                return poster;
            },

            destroy: function() {
                if (this._audioElement)
                    this._audioElement.remove();
                if (this.supportsFullscreen() && this.__fullscreenListener)
                    Dom.elementOffFullscreenChange(this._element, this.__fullscreenListener);
                if (!Info.isInternetExplorer() || Info.internetExplorerVersion() > 8)
                    this._element.innerHTML = "";
                inherited.destroy.call(this);
            },

            _setup: function() {
                this._loaded = false;
                this._domEvents.on(this._element, "canplay", this._eventLoaded, this);
                this._domEvents.on(this._element, "playing", this._eventPlaying, this);
                this._domEvents.on(this._element, "pause", this._eventPaused, this);
                this._domEvents.on(this._element, "ended", this._eventEnded, this);
                var self = this;
                var sourceEls = this._element.getElementsByTagName("SOURCE");
                var cb = function() {
                    this._eventError(this.cls.ERROR_NO_PLAYABLE_SOURCE);
                };
                for (var i = 0; i < sourceEls.length; ++i) {
                    this._domEvents.on(sourceEls[i], "error", cb, this);
                }
                if (this.poster()) {
                    var image = new Image();
                    image.onerror = function() {
                        delete self._element.poster;
                        delete self._element.preload;
                        self._eventPosterError();
                    };
                    image.src = this.posterURL();
                    image.onload = function() {
                        self.__imageWidth = image.width;
                        self.__imageHeight = image.height;
                    };
                }
                if (Info.isSafari() && (Info.safariVersion() > 5 || Info.safariVersion() < 9)) {
                    if (this._element.networkState === this._element.NETWORK_LOADING) {
                        Async.eventually(function() {
                            if (!this.destroyed() && this._element.networkState === this._element.NETWORK_LOADING && this._element.buffered.length === 0)
                                this._eventError(this.cls.ERROR_NO_PLAYABLE_SOURCE);
                        }, this, 10000);
                    }
                }
                if (this.supportsFullscreen()) {
                    this.__videoClassBackup = "";
                    this.__fullscreenListener = Dom.elementOnFullscreenChange(this._element, function(element, inFullscreen) {
                        this.trigger("fullscreen-change", inFullscreen);
                        if (inFullscreen) {
                            this.__videoClassBackup = this._element.className;
                            this._element.className = "";
                        } else {
                            this._element.className = this.__videoClassBackup;
                            this.__videoClassBackup = "";
                        }
                    }, this);
                }
            },

            buffered: function() {
                return this._element.buffered.end(0);
            },

            _fullscreenElement: function() {
                //fullscreen issue was present on Chromium based browsers. Could recreate on Iron and Chrome.
                if (Info.isChromiumBased() && !Info.isMobile()) {
                    return this._element.parentNode;
                }

                return Info.isFirefox() ? this._element.parentElement : this._element;
            },

            supportsFullscreen: function() {
                return Dom.elementSupportsFullscreen(this._fullscreenElement());
            },

            enterFullscreen: function() {
                Dom.elementEnterFullscreen(this._fullscreenElement());
            },

            exitFullscreen: function() {
                Dom.documentExitFullscreen();
            },

            isFullscreen: function() {
                return Dom.elementIsFullscreen(this._fullscreenElement());
            },

            videoWidth: function() {
                return this._element.width || this.__imageWidth || NaN;
            },

            videoHeight: function() {
                return this._element.height || this.__imageHeight || NaN;
            },

            play: function() {
                inherited.play.call(this);
                if (this._audioElement) {
                    if (this._reloadonplay)
                        this._audioElement.load();
                    this._audioElement.play();
                }
            },

            pause: function() {
                this._element.pause();
                if (this._audioElement)
                    this._audioElement.pause();
            },

            setPosition: function(position) {
                this._element.currentTime = position;
                if (this._audioElement)
                    this._audioElement.currentTime = position;
            },

            setSpeed: function(speed) {
                if (speed < 0.5 && speed > 4.0) {
                    console.warn('Maximum allowed speed range is from 0.5 to 4.0');
                    return;
                }
                this._element.playbackRate = speed;
                if (this._audioElement)
                    this._audioElement.playbackRate = speed;
            },

            muted: function() {
                return (this._audioElement ? this._audioElement : this._element).muted;
            },

            setMuted: function(muted) {
                (this._audioElement ? this._audioElement : this._element).muted = muted;
            },

            volume: function() {
                return (this._audioElement ? this._audioElement : this._element).volume;
            },

            setVolume: function(volume) {
                (this._audioElement ? this._audioElement : this._element).volume = volume;
            }

        };
    });
});

Scoped.define("module:Player.FlashPlayerWrapper", ["module:Player.VideoPlayerWrapper","module:Player.FlashPlayer","browser:Info","base:Promise","browser:Dom"], function (VideoPlayerWrapper, FlashPlayer, Info, Promise, Dom, scoped) {
    return VideoPlayerWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            _initialize: function() {
                if (this._options.noflash)
                    return Promise.error(true);
                if (this._sources.length < 1)
                    return Promise.error(true);
                if (Info.isMobile() || !Info.flash().supported())
                    return Promise.error(true);
                if (!Info.flash().installed() && this._options.flashinstallrequired)
                    return Promise.error(true);
                if (!Info.flash().installed()) {
                    this._eventError(this.cls.ERROR_NO_FLASH_INSTALLED);
                    return Promise.value(true);
                }
                var self = this;
                var promise = Promise.create();
                if (this._element.tagName.toLowerCase() !== "div") {
                    this._element = Dom.changeTag(this._element, "div");
                    this._transitionals.element = this._element;
                }
                var opts = {
                    poster: this.poster(),
                    sources: this.sources()
                };
                if (this._loop)
                    opts.loop = true;
                this._flashPlayer = new FlashPlayer(this._element, opts);
                return this._flashPlayer.ready.success(function() {
                    this._setup();
                }, this);
            },

            destroy: function() {
                if (this._flashPlayer)
                    this._flashPlayer.weakDestroy();
                this._element.innerHTML = "";
                inherited.destroy.call(this);
            },

            _setup: function() {
                this._loaded = true;
                this._eventLoaded();
                this._domEvents.on(this._element, "playing", this._eventPlaying, this);
                this._domEvents.on(this._element, "pause", this._eventPaused, this);
                this._domEvents.on(this._element, "ended", this._eventEnded, this);
                this._domEvents.on(this._element, "videoerror", function() {
                    this._eventError(this.cls.ERROR_NO_PLAYABLE_SOURCE);
                }, this);
                this._domEvents.on(this._element, "postererror", this._eventPosterError, this);
            },

            position: function() {
                return this._element.get("currentTime");
            },

            buffered: function() {
                return this.position();
            },

            setPosition: function(position) {
                this._element.set("currentTime", position);
            },

            setVolume: function(volume) {
                this._element.set("volume", volume);
            },

            videoWidth: function() {
                return this._flashPlayer ? this._flashPlayer.videoWidth() : null;
            },

            videoHeight: function() {
                return this._flashPlayer ? this._flashPlayer.videoHeight() : null;
            }

        };
    });
});

Scoped.extend("module:Player.VideoPlayerWrapper", ["module:Player.VideoPlayerWrapper","module:Player.Html5VideoPlayerWrapper"], function (VideoPlayerWrapper, Html5VideoPlayerWrapper) {
    VideoPlayerWrapper.register(Html5VideoPlayerWrapper, 2);
    return {};
});

Scoped.extend("module:Player.VideoPlayerWrapper", ["module:Player.VideoPlayerWrapper","module:Player.FlashPlayerWrapper"], function (VideoPlayerWrapper, FlashPlayerWrapper) {
    VideoPlayerWrapper.register(FlashPlayerWrapper, 1);
    return {};
});

Scoped.define("module:Flash.Support", ["base:Promise","base:Timers.Timer","base:Async","base:Objs","flash:FlashClassRegistry","flash:FlashEmbedding","browser:Info"], function (Promise, Timer, Async, Objs, FlashClassRegistry, FlashEmbedding, Info) {
    return {

        flashCanConnect: function(url, timeout) {
            if (!Info.flash().installed())
                return Promise.error(false);
            var promise = Promise.create();
            var registry = new FlashClassRegistry();
            registry.register("flash.net.NetConnection", ["connect", "addEventListener"]);
            var embedding = new FlashEmbedding(null, {
                registry: registry,
                wrap: true
            });
            embedding.ready(function() {
                var connection = embedding.newObject("flash.net.NetConnection");
                connection.addEventListener("netStatus", embedding.newCallback(function(event) {
                    if (event.get("info") && event.get("info").code === "NetConnection.Connect.Success")
                        promise.asyncSuccess(true);
                    else
                        promise.asyncError(false);
                }));
                connection.connectVoid(url);
            });
            var timer = null;
            if (timeout) {
                timer = new Timer({
                    delay: timeout,
                    once: true,
                    start: true,
                    fire: function() {
                        promise.asyncError();
                    }
                });
            }
            promise.callback(function() {
                if (timer)
                    timer.destroy();
                Async.eventually(function() {
                    embedding.destroy();
                });
            });
            return promise;
        },

        enumerateMediaSources: function() {
            if (!Info.flash().installed())
                return Promise.error(false);
            var promise = Promise.create();
            var registry = new FlashClassRegistry();
            registry.register("flash.media.Microphone");
            registry.register("flash.media.Camera");
            var embedding = new FlashEmbedding(null, {
                registry: registry,
                wrap: true
            });
            embedding.ready(function() {
                var videos = embedding.getClass("flash.media.Camera").get("names");
                var audios = embedding.getClass("flash.media.Microphone").get("names");
                promise.asyncSuccess({
                    videoCount: Objs.count(videos),
                    audioCount: Objs.count(audios),
                    video: Objs.map(videos, function(value, key) {
                        return {
                            id: key,
                            label: value
                        };
                    }),
                    audio: Objs.map(audios, function(value, key) {
                        return {
                            id: key,
                            label: value
                        };
                    })
                });
            });
            promise.callback(function() {
                Async.eventually(function() {
                    embedding.destroy();
                });
            });
            return promise;
        }

    };
});

Scoped.define("module:Recorder.PixelSampleMixin", [], function () {
    return {

        lightLevel: function(samples) {
            samples = samples || 100;
            var total_light = 0.0;
            this._pixelSample(samples, function(r, g, b) {
                total_light += r + g + b;
            });
            return total_light / (3 * samples);
        },

        blankLevel: function(samples) {
            samples = samples || 100;
            var total_light = 0.0;
            this._pixelSample(samples, function(r, g, b) {
                total_light += Math.pow(r, 2) + Math.pow(g, 2) + Math.pow(b, 2);
            });
            return Math.sqrt(total_light / (3 * samples));
        },

        _materializePixelSample: function(sample) {
            var result = [];
            this._pixelSample(sample, function(r, g, b) {
                result.push([r, g, b]);
            });
            return result;
        },

        deltaCoefficient: function(samples) {
            samples = samples || 100;
            var current = this._materializePixelSample(samples);
            if (!this.__deltaSample) {
                this.__deltaSample = current;
                return null;
            }
            var delta_total = 0.0;
            for (var i = 0; i < current.length; ++i)
                for (var j = 0; j < 3; ++j)
                    delta_total += Math.pow(current[i][j] - this.__deltaSample[i][j], 2);
            this.__deltaSample = current;
            return Math.sqrt(delta_total / (3 * samples));
        }

    };
});

Scoped.define("module:Flash.FlashAudioRecorder", ["browser:DomExtend.DomExtension","browser:Dom","browser:Info","flash:FlashClassRegistry","flash:FlashEmbedding","base:Strings","base:Async","base:Objs","base:Functions","base:Types","base:Timers.Timer","base:Time","base:Promise","base:Events.EventsMixin","module:Recorder.PixelSampleMixin"], function (Class, Dom, Info, FlashClassRegistry, FlashEmbedding, Strings, Async, Objs, Functions, Types, Timer, Time, Promise, EventsMixin, PixelSampleMixin, scoped) {
    var Cls = Class.extend({
        scoped: scoped
    }, [EventsMixin, PixelSampleMixin, function(inherited) {
        return {

            constructor: function(element, attrs) {
                inherited.constructor.call(this, element, attrs);
                this._embedding = this.auto_destroy(new FlashEmbedding(element, {
                    registry: this.cls.flashRegistry(),
                    wrap: true,
                    debug: false,
                    hasEmbedding: this.readAttr("hasembedding") || false,
                    namespace: this.readAttr("embednamespace") || null
                }, {
                    parentBgcolor: true,
                    fixHalfPixels: true
                }));
                this._flashObjs = {};
                this.ready = Promise.create();
                this.__status = "idle";
                this.__audioRate = this.readAttr('audiorate') || 44;
                this.__audioQuality = this.readAttr('audioquality') || 10;
                this.__microphoneCodec = this.readAttr("microphonecodec") || 'speex';
                this.__defaultGain = 55;
                this._embedding.ready(this.__initializeEmbedding, this);
            },

            __initializeEmbedding: function() {
                this.__hasMicrophoneActivity = false;
                this._flashObjs.main = this._embedding.flashMain();
                this._flashObjs.stage = this._flashObjs.main.get("stage");
                this._flashObjs.stage.set("scaleMode", "noScale");
                this._flashObjs.stage.set("align", "TL");
                this._flashObjs.Microphone = this._embedding.getClass("flash.media.Microphone");
                this._flashObjs.microphone = !Types.is_empty(this._flashObjs.Microphone.get('names').length > 0) ? this._flashObjs.Microphone.getMicrophone(0) : null;
                this.setMicrophoneProfile();
                this._currentMicrophone = 0;
                this._flashObjs.Security = this._embedding.getClass("flash.system.Security");
                this.ready.asyncSuccess(this);
                this.auto_destroy(new Timer({
                    delay: 100,
                    fire: this._fire,
                    context: this
                }));
            },

            isAccessGranted: function() {
                try {
                    return (!this._flashObjs.microphone || !this._flashObjs.microphone.get('muted'));
                } catch (e) {
                    return false;
                }
            },

            isSecurityDialogOpen: function() {
                var dummy = this._embedding.newObject("flash.display.BitmapData", 1, 1);
                var open = false;
                try {
                    dummy.draw(this._flashObjs.stage);
                } catch (e) {
                    open = true;
                }
                dummy.dispose();
                dummy.destroy();
                return open;
            },

            openSecurityDialog: function(fullSecurityDialog) {
                this.trigger("require_display");
                this._flashObjs.Security.showSettings("privacy");
            },

            grantAccess: function(fullSecurityDialog, allowDeny) {
                var promise = Promise.create();
                var timer = new Timer({
                    fire: function() {
                        if (this.destroyed()) {
                            timer.destroy();
                            return;
                        }
                        if (this.isSecurityDialogOpen())
                            return;
                        if (this.isAccessGranted()) {
                            timer.destroy();
                            promise.asyncSuccess(true);
                        } else {
                            if (allowDeny) {
                                timer.destroy();
                                promise.asyncError(true);
                            } else
                                this.openSecurityDialog(fullSecurityDialog);
                        }
                    },
                    context: this,
                    delay: 10,
                    start: true
                });
                return promise;
            },

            bindMedia: function(fullSecurityDialog, allowDeny) {
                return this.grantAccess(fullSecurityDialog, allowDeny).mapSuccess(function() {
                    this._mediaBound = true;
                }, this);
            },

            unbindMedia: function() {
                this._mediaBound = false;
            },

            enumerateDevices: function() {
                return {
                    audios: this._flashObjs.Microphone.get('names')
                };
            },

            selectMicrophone: function(index) {
                if (this._flashObjs.microphone)
                    this._flashObjs.microphone.weakDestroy();
                this.__hasMicrophoneActivity = false;
                this.__microphoneActivityTime = null;
                this._flashObjs.microphone = this._flashObjs.Microphone.getMicrophone(index);
                this._currentMicrophone = index;
                this.setMicrophoneProfile(this._currentMicrophoneProfile);
            },

            currentMicrophone: function() {
                return this._currentMicrophone;
            },

            microphoneInfo: function() {
                return this._flashObjs.microphone ? {
                    muted: this._flashObjs.microphone.get("muted"),
                    name: this._flashObjs.microphone.get("name"),
                    activityLevel: this._flashObjs.microphone.get("activityLevel"),
                    gain: this._flashObjs.microphone.get("gain"),
                    rate: this._flashObjs.microphone.get("rate"),
                    encodeQuality: this._flashObjs.microphone.get("encodeQuality"),
                    codec: this._flashObjs.microphone.get("codec"),
                    hadActivity: this.__hadMicrophoneActivity,
                    inactivityTime: this.__microphoneActivityTime ? Time.now() - this.__microphoneActivityTime : null
                } : {};
            },

            setMicrophoneProfile: function(profile) {
                if (!this._flashObjs.microphone)
                    return;
                profile = profile || {};
                this._flashObjs.microphone.setLoopBack(profile.loopback || false);
                this._flashObjs.microphone.set("gain", profile.gain || this.__defaultGain);
                this._flashObjs.microphone.setSilenceLevel(profile.silenceLevel || 0);
                this._flashObjs.microphone.setUseEchoSuppression(profile.echoSuppression || false);
                this._flashObjs.microphone.set("rate", profile.rate || this.__audioRate);
                this._flashObjs.microphone.set("encodeQuality", profile.encodeQuality || this.__audioQuality);
                this._flashObjs.microphone.set("codec", profile.codec || this.__microphoneCodec);
                this._currentMicrophoneProfile = profile;
            },

            getVolumeGain: function() {
                var gain = this._mediaBound ? this._flashObjs.micropone.get("gain") : 55;
                return gain / 55.0;
            },

            setVolumeGain: function(volumeGain) {
                this.__defaultGain = Math.min(Math.max(0, Math.round(volumeGain * 55)), 100);
                if (this._mediaBound && this._flashObjs.microphone)
                    this._flashObjs.microphone.set("gain", this.__defaultGain);
            },

            testSoundLevel: function(activate) {
                this.setMicrophoneProfile(activate ? {
                    loopback: true,
                    gain: 55,
                    silenceLevel: 100,
                    echoSuppression: true
                } : {});
            },

            soundLevel: function() {
                return this._flashObjs.microphone ? this._flashObjs.microphone.get("activityLevel") : 0;
            },

            _fire: function() {
                if (!this._mediaBound)
                    return;
                this.__hadMicrophoneActivity = this.__hadMicrophoneActivity || (this._flashObjs.microphone && this._flashObjs.microphone.get("activityLevel") > 0);
                if (this._flashObjs.microphone && this._flashObjs.microphone.get("activityLevel") > 0)
                    this.__microphoneActivityTime = Time.now();
            },

            _error: function(s) {
                this.__status = "error";
                this.trigger("error", s);
            },

            _status: function(s) {
                if (s && s !== this.__status) {
                    this.__status = s;
                    this.trigger("status", s);
                    this.trigger(s);
                }
                return this.__status;
            },

            __newCallback: function(endpoint, endpoints) {
                var active = true;
                var timer = null;
                var badEndpoint = function() {
                    clearTimeout(timer);
                    if (!active)
                        return;
                    active = false;
                    this.trigger("endpoint_connectivity", this.__endpoint, -1);
                    if (endpoints.length > 0) {
                        endpoint = endpoints.shift();
                        this._flashObjs.connection.closeVoid();
                        this._flashObjs.connection.destroy();
                        this._flashObjs.connection = this._embedding.newObject("flash.net.NetConnection");
                        this._flashObjs.connection.addEventListener("netStatus", this.__newCallback(endpoint, endpoints));
                        this.__endpoint = endpoint;
                        this._flashObjs.connection.connectVoid(endpoint.serverUrl);
                    } else
                        this._error("Could not connect to server");
                };
                var self = this;
                timer = setTimeout(function() {
                    badEndpoint.call(self);
                }, 10000);
                return this._embedding.newCallback(Functions.as_method(function(event) {
                    if (!active)
                        return;
                    var code = event.get("info").code;
                    if (code === "NetConnection.Connect.Closed" && this._status() === 'recording') {
                        active = false;
                        this._error("Connection to server interrupted.");
                        return;
                    }
                    if ((code === "NetConnection.Connect.Success" && this._status() !== 'connecting') ||
                        (code === "NetConnection.Connect.Closed" && this._status() === 'connecting') ||
                        (code === "NetConnection.Connect.Failed" && this._status() === 'connecting')) {
                        badEndpoint.call(this);
                        return;
                    }
                    if (code === "NetConnection.Connect.Closed" && this._status() === 'uploading') {
                        this._status('finished');
                        return;
                    }
                    if (code === "NetConnection.Connect.Success" && this._status() === 'connecting') {
                        this.trigger("endpoint_connectivity", this.__endpoint, 1);
                        clearTimeout(timer);
                        this._flashObjs.stream = this._embedding.newObject("flash.net.NetStream", this._flashObjs.connection);
                        this._flashObjs.stream.addEventListener("netStatus", this._embedding.newCallback(Functions.as_method(function(event) {
                            var code = event.get("info").code;
                            if (code === "NetStream.Record.Start") {
                                this._status('recording');
                                return;
                            }
                            if (code === "NetStream.Play.StreamNotFound") {
                                this._flashObjs.stream.closeVoid();
                                if (this._status() !== "none")
                                    this._error("Stream not found");
                                return;
                            }
                            if (code === "NetStream.Unpublish.Success" ||
                                (this._status() === "uploading" && code === "NetStream.Buffer.Empty" &&
                                    this.__streamType === "flv" && this._flashObjs.stream.get('bufferLength') === 0)) {
                                this._flashObjs.stream.closeVoid();
                                this._flashObjs.stream.destroy();
                                this._flashObjs.stream = null;
                                this._flashObjs.connection.closeVoid();
                                this._flashObjs.connection.destroy();
                                this._flashObjs.connection = null;
                                this._status('finished');
                            }
                        }, this)));
                        this._flashObjs.stream.set("bufferTime", 120);
                        this._flashObjs.stream.attachAudioVoid(this._flashObjs.microphone);
                        this._flashObjs.stream.publish(endpoint.streamName, "record");
                    }
                }, this));
            },

            startRecord: function(endpoints) {
                if (arguments.length > 1) {
                    endpoints = {
                        serverUrl: endpoints,
                        streamName: arguments[1]
                    };
                }
                if (!Types.is_array(endpoints))
                    endpoints = [endpoints];
                this._status("connecting");
                var endpoint = endpoints.shift();
                var cb = this.__newCallback(endpoint, endpoints);
                this._flashObjs.connection = this._embedding.newObject("flash.net.NetConnection");
                this._flashObjs.connection.addEventListener("netStatus", cb);
                this.__endpoint = endpoint;
                this._flashObjs.connection.connectVoid(endpoint.serverUrl);
            },

            stopRecord: function() {
                if (this._status() !== "recording")
                    return;
                this.__initialBufferLength = 0;
                this._status("uploading");
                this.__initialBufferLength = this._flashObjs.stream.get("bufferLength");
                try {
                    this._flashObjs.stream.attachAudioVoid(null);
                } catch (e) {}
                /*try {
                    if (this.__endpoint.serverUrl.indexOf("rtmpt") === 0) {
                        this._flashObjs.stream.publishVoid("null");
                        this._flashObjs.stream.closeVoid();
                    }
                } catch (e) {}*/
            },

            uploadStatus: function() {
                return {
                    total: this.__initialBufferLength,
                    remaining: this._flashObjs.stream.get("bufferLength")
                };
            }

        };
    }], {

        flashRegistry: function() {
            if (!this.__flashRegistry) {
                this.__flashRegistry = new FlashClassRegistry();
                this.__flashRegistry.register("flash.media.Microphone", ["setLoopBack", "setSilenceLevel", "setUseEchoSuppression"], ["getMicrophone"]);
                this.__flashRegistry.register("flash.media.SoundTransform", []);
                this.__flashRegistry.register("flash.net.NetStream", ["play", "pause", "resume", "addEventListener", "seek", "attachAudio", "publish", "close"]);
                this.__flashRegistry.register("flash.net.NetConnection", ["connect", "addEventListener", "call", "close"]);
                this.__flashRegistry.register("flash.display.Stage", []);
                this.__flashRegistry.register("flash.system.Security", [], ["allowDomain", "showSettings"]);
            }
            return this.__flashRegistry;
        },

        attach: function(element, attrs) {
            var cls = new Cls(element, attrs);
            return element;
        }


    });
    return Cls;
});

Scoped.define("module:AudioRecorder.FlashAudioRecorderWrapper", ["module:AudioRecorder.AudioRecorderWrapper","module:Flash.FlashAudioRecorder","browser:Dom","browser:Info","base:Promise","base:Objs","base:Timers.Timer","browser:Upload.CustomUploader","browser:Upload.MultiUploader"], function (AudioRecorderWrapper, FlashAudioRecorder, Dom, Info, Promise, Objs, Timer, CustomUploader, MultiUploader, scoped) {
    return AudioRecorderWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                if (this._element.tagName.toLowerCase() !== "div")
                    this._element = Dom.changeTag(this._element, "div");
                this._recorder = new FlashAudioRecorder(this._element, {
                    microphonecodec: this._options.rtmpMicrophoneCodec,
                    audioRate: this._options.audioBitrate ? Math.floor(this._options.audioBitrate / 1000) : undefined
                });
                this._recorder.ready.forwardCallback(this.ready);
                this._recorder.on("require_display", function() {
                    this.trigger("require_display");
                }, this);
                this._recorder.on("endpoint_connectivity", function(endpoint, connectivity) {
                    this.trigger("endpoint_connectivity", endpoint, connectivity);
                }, this);
            },

            destroy: function() {
                this._recorder.destroy();
                inherited.destroy.call(this);
            },

            _bindMedia: function() {
                return this._recorder.bindMedia(this._options.flashFullSecurityDialog);
            },

            _unbindMedia: function() {
                return this._recorder.unbindMedia();
            },

            soundLevel: function() {
                var sl = this._recorder.soundLevel();
                return sl <= 1 ? 1.0 : (1.0 + (sl - 1) / 100);
            },

            getVolumeGain: function() {
                return this._recorder.getVolumeGain();
            },

            setVolumeGain: function(volumeGain) {
                this._recorder.setVolumeGain(volumeGain);
            },

            testSoundLevel: function(activate) {
                this._recorder.testSoundLevel(activate);
            },

            enumerateDevices: function() {
                var result = this._recorder.enumerateDevices();
                return Promise.value({
                    audioCount: Objs.count(result.audios),
                    audio: Objs.map(result.audios, function(value, key) {
                        return {
                            id: key,
                            label: value
                        };
                    })
                });
            },

            currentDevices: function() {
                return {
                    audio: this._recorder.currentMicrophone()
                };
            },

            setCurrentDevices: function(devices) {
                if (devices && devices.audio)
                    this._recorder.selectMicrophone(devices.audio);
            },

            startRecord: function(options) {
                if (this._options.simulate)
                    return Promise.value(true);
                var self = this;
                var ctx = {};
                var promise = Promise.create();
                this._recorder.on("recording", function() {
                    promise.asyncSuccess();
                    self._recorder.off(null, null, ctx);
                }, ctx).on("error", function(s) {
                    promise.asyncError(s);
                    self._recorder.off(null, null, ctx);
                }, ctx);
                this._recorder.startRecord(options.rtmp);
                return promise;
            },

            stopRecord: function(options) {
                if (this._options.simulate)
                    return Promise.value(new MultiUploader());
                var self = this;
                var ctx = {};
                var uploader = new CustomUploader();
                var timer = null;
                timer = new Timer({
                    delay: 100,
                    context: this,
                    fire: function() {
                        if (!this._recorder || this._recorder.destroyed()) {
                            timer.destroy();
                            return;
                        }
                        var status = this._recorder.uploadStatus();
                        uploader.progressCallback(status.total - status.remaining, status.total);
                    }
                });
                this._recorder.on("finished", function() {
                    uploader.successCallback(true);
                    self._recorder.off(null, null, ctx);
                    timer.weakDestroy();
                }, ctx).on("error", function(s) {
                    uploader.errorCallback(s);
                    self._recorder.off(null, null, ctx);
                    timer.weakDestroy();
                }, ctx);
                this._recorder.stopRecord();
                return Promise.create(uploader);
            },

            isFlash: function() {
                return true;
            },

            _softwareDependencies: function() {
                return Info.flash().installed() ? Promise.value(true) : Promise.error([{
                    "title": "Adobe Flash",
                    "execute": function() {
                        window.open("https://get.adobe.com/flashplayer");
                    }
                }]);
            }

        };
    }, {

        supported: function(options) {
            return !Info.isMobile() && !options.noflash && Info.flash().supported() && !options.screen;
        }

    });
});

Scoped.extend("module:AudioRecorder.AudioRecorderWrapper", ["module:AudioRecorder.AudioRecorderWrapper","module:AudioRecorder.FlashAudioRecorderWrapper"], function (AudioRecorderWrapper, FlashAudioRecorderWrapper) {
    AudioRecorderWrapper.register(FlashAudioRecorderWrapper, 1);
    return {};
});

Scoped.define("module:Flash.FlashImageRecorder", ["browser:DomExtend.DomExtension","browser:Dom","browser:Info","flash:FlashClassRegistry","flash:FlashEmbedding","base:Strings","base:Async","base:Objs","base:Functions","base:Types","base:Timers.Timer","base:Time","base:Promise","base:Events.EventsMixin","module:Recorder.PixelSampleMixin"], function (Class, Dom, Info, FlashClassRegistry, FlashEmbedding, Strings, Async, Objs, Functions, Types, Timer, Time, Promise, EventsMixin, PixelSampleMixin, scoped) {
    var Cls = Class.extend({
        scoped: scoped
    }, [EventsMixin, PixelSampleMixin, function(inherited) {
        return {

            constructor: function(element, attrs) {
                inherited.constructor.call(this, element, attrs);
                this._embedding = this.auto_destroy(new FlashEmbedding(element, {
                    registry: this.cls.flashRegistry(),
                    wrap: true,
                    debug: false,
                    hasEmbedding: this.readAttr("hasembedding") || false,
                    namespace: this.readAttr("embednamespace") || null
                }, {
                    parentBgcolor: true,
                    fixHalfPixels: true
                }));
                this._flashObjs = {};
                this.ready = Promise.create();
                this.__videoRate = this.readAttr('videorate') || 0;
                this.__videoQuality = this.readAttr('videoquality') || 90;
                this.__cameraWidth = this.readAttr('camerawidth') || 640;
                this.__cameraHeight = this.readAttr('cameraheight') || 480;
                this._flip = Types.parseBool(this.readAttr("flip") || false);
                this._embedding.ready(this.__initializeEmbedding, this);
            },

            __initializeEmbedding: function() {
                this._flashObjs.main = this._embedding.flashMain();
                this._flashObjs.stage = this._flashObjs.main.get("stage");
                this._flashObjs.stage.set("scaleMode", "noScale");
                this._flashObjs.stage.set("align", "TL");
                this._flashObjs.video = this._embedding.newObject(
                    "flash.media.Video",
                    this._flashObjs.stage.get("stageWidth"),
                    this._flashObjs.stage.get("stageHeight")
                );
                this._flashObjs.cameraVideo = this._embedding.newObject(
                    "flash.media.Video",
                    this.__cameraWidth,
                    this.__cameraHeight
                );
                this._flashObjs.main.addChildVoid(this._flashObjs.video);
                this._flashObjs.Camera = this._embedding.getClass("flash.media.Camera");
                this._flashObjs.camera = this._flashObjs.Camera.getCamera(0);
                this._currentCamera = 0;
                this._flashObjs.Security = this._embedding.getClass("flash.system.Security");
                this.recomputeBB();
                this.ready.asyncSuccess(this);
                this.auto_destroy(new Timer({
                    delay: 100,
                    fire: this._fire,
                    context: this
                }));
            },

            isAccessGranted: function() {
                try {
                    return (!this._flashObjs.camera || !this._flashObjs.camera.get('muted'));
                } catch (e) {
                    return false;
                }
            },

            isSecurityDialogOpen: function() {
                var dummy = this._embedding.newObject("flash.display.BitmapData", 1, 1);
                var open = false;
                try {
                    dummy.draw(this._flashObjs.stage);
                } catch (e) {
                    open = true;
                }
                dummy.dispose();
                dummy.destroy();
                return open;
            },

            openSecurityDialog: function(fullSecurityDialog) {
                this.trigger("require_display");
                if (fullSecurityDialog)
                    this._flashObjs.Security.showSettings("privacy");
                else {
                    this._flashObjs.video.attachCamera(null);
                    this._flashObjs.video.attachCamera(this._flashObjs.camera);
                }
            },

            grantAccess: function(fullSecurityDialog, allowDeny) {
                var promise = Promise.create();
                var timer = new Timer({
                    fire: function() {
                        if (this.destroyed()) {
                            timer.destroy();
                            return;
                        }
                        if (this.isSecurityDialogOpen())
                            return;
                        if (this.isAccessGranted()) {
                            timer.destroy();
                            promise.asyncSuccess(true);
                        } else {
                            if (allowDeny) {
                                timer.destroy();
                                promise.asyncError(true);
                            } else
                                this.openSecurityDialog(fullSecurityDialog);
                        }
                    },
                    context: this,
                    delay: 10,
                    start: true
                });
                return promise;
            },

            bindMedia: function(fullSecurityDialog, allowDeny) {
                return this.grantAccess(fullSecurityDialog, allowDeny).mapSuccess(function() {
                    this._mediaBound = true;
                    this._attachCamera();
                }, this);
            },

            unbindMedia: function() {
                this._detachCamera();
                this._mediaBound = false;
            },

            _attachCamera: function() {
                if (this._flashObjs.camera) {
                    this._flashObjs.camera.setMode(this.__cameraWidth, this.__cameraHeight, this.__fps);
                    this._flashObjs.camera.setQuality(this.__videoRate, this.__videoQuality);
                    this._flashObjs.camera.setKeyFrameInterval(5);
                    this._flashObjs.video.attachCamera(this._flashObjs.camera);
                    this._flashObjs.cameraVideo.attachCamera(this._flashObjs.camera);
                }
                if (this._flip) {
                    if (this._flashObjs.video.get("scaleX") > 0)
                        this._flashObjs.video.set("scaleX", -this._flashObjs.video.get("scaleX"));
                    this._flashObjs.video.set("x", this._flashObjs.video.get("width"));
                }
            },

            _detachCamera: function() {
                this._flashObjs.video.attachCamera(null);
                this._flashObjs.cameraVideo.attachCamera(null);
            },

            enumerateDevices: function() {
                return {
                    videos: this._flashObjs.Camera.get('names')
                };
            },

            selectCamera: function(index) {
                if (this._flashObjs.camera)
                    this._flashObjs.camera.weakDestroy();
                this.__cameraActivityTime = null;
                this._flashObjs.camera = this._flashObjs.Camera.getCamera(index);
                this._currentCamera = index;
                if (this._mediaBound)
                    this._attachCamera();
            },

            currentCamera: function() {
                return this._currentCamera;
            },

            cameraInfo: function() {
                if (!this._flashObjs.camera)
                    return {};
                return {
                    muted: this._flashObjs.camera.get("muted"),
                    name: this._flashObjs.camera.get("name"),
                    activityLevel: this._flashObjs.camera.get("activityLevel"),
                    fps: this._flashObjs.camera.get("fps"),
                    width: this._flashObjs.camera.get("width"),
                    height: this._flashObjs.camera.get("height"),
                    inactivityTime: this.__cameraActivityTime ? Time.now() - this.__cameraActivityTime : null
                };
            },

            _pixelSample: function(samples, callback, context) {
                samples = samples || 100;
                var w = this._flashObjs.cameraVideo.get("width");
                var h = this._flashObjs.cameraVideo.get("height");
                var wc = Math.ceil(Math.sqrt(w / h * samples));
                var hc = Math.ceil(Math.sqrt(h / w * samples));
                var lightLevelBmp = this._embedding.newObject("flash.display.BitmapData", wc, hc);
                var scaleMatrix = this._embedding.newObject("flash.geom.Matrix");
                scaleMatrix.scale(wc / w, hc / h);
                lightLevelBmp.draw(this._flashObjs.cameraVideo, scaleMatrix);
                for (var i = 0; i < samples; ++i) {
                    var x = i % wc;
                    var y = Math.floor(i / wc);
                    var rgb = lightLevelBmp.getPixel(x, y);
                    callback.call(context || this, rgb % 256, (rgb / 256) % 256, (rgb / 256 / 256) % 256);
                }
                scaleMatrix.destroy();
                lightLevelBmp.destroy();
            },

            _fire: function() {
                if (!this._mediaBound)
                    return;
                if (this._flashObjs.camera) {
                    var currentCameraActivity = this._flashObjs.camera.get("activityLevel");
                    if (!this.__lastCameraActivity || this.__lastCameraActivity !== currentCameraActivity)
                        this.__cameraActivityTime = Time.now();
                    this.__lastCameraActivity = currentCameraActivity;
                }
            },

            createSnapshot: function() {
                var bmp = this._embedding.newObject(
                    "flash.display.BitmapData",
                    this._flashObjs.cameraVideo.get("videoWidth"),
                    this._flashObjs.cameraVideo.get("videoHeight")
                );
                bmp.draw(this._flashObjs.cameraVideo);
                return bmp;
            },

            postSnapshot: function(bmp, url, type, quality) {
                var promise = Promise.create();
                quality = quality || 90;
                var header = this._embedding.newObject("flash.net.URLRequestHeader", "Content-type", "application/octet-stream");
                var request = this._embedding.newObject("flash.net.URLRequest", url);
                request.set("requestHeaders", [header]);
                request.set("method", "POST");
                if (type === "jpg") {
                    var jpgEncoder = this._embedding.newObject("com.adobe.images.JPGEncoder", quality);
                    request.set("data", jpgEncoder.encode(bmp));
                    jpgEncoder.destroy();
                } else {
                    var PngEncoder = this._embedding.getClass("com.adobe.images.PNGEncoder");
                    request.set("data", PngEncoder.encode(bmp));
                }
                var poster = this._embedding.newObject("flash.net.URLLoader");
                poster.set("dataFormat", "BINARY");

                // In case anybody is wondering, no, the progress event does not work for uploads:
                // http://stackoverflow.com/questions/2106682/a-progress-event-when-uploading-bytearray-to-server-with-as3-php/2107059#2107059

                poster.addEventListener("complete", this._embedding.newCallback(Functions.as_method(function() {
                    promise.asyncSuccess(true);
                }, this)));
                poster.addEventListener("ioError", this._embedding.newCallback(Functions.as_method(function() {
                    promise.asyncError("IO Error");
                }, this)));
                poster.load(request);
                promise.callback(function() {
                    poster.destroy();
                    request.destroy();
                    header.destroy();
                });
                return promise;
            },

            createSnapshotDisplay: function(bmpData, x, y, w, h) {
                var bmp = this._embedding.newObject("flash.display.Bitmap", bmpData);
                this.updateSnapshotDisplay(bmpData, bmp, x, y, w, h);
                this._flashObjs.main.addChildVoid(bmp);
                return bmp;
            },

            updateSnapshotDisplay: function(bmpData, bmp, x, y, w, h) {
                bmp.set("x", x);
                bmp.set("y", y);
                bmp.set("scaleX", w / bmpData.get("width"));
                bmp.set("scaleY", h / bmpData.get("height"));
            },

            removeSnapshotDisplay: function(snapshot) {
                this._flashObjs.main.removeChildVoid(snapshot);
                snapshot.destroy();
            },

            idealBB: function() {
                return {
                    width: this.__cameraWidth,
                    height: this.__cameraHeight
                };
            },

            setActualBB: function(actualBB) {
                ["object", "embed"].forEach(function(tag) {
                    var container = this._element.getElementsByTagName(tag.toUpperCase())[0];
                    if (container) {
                        ["width", "height"].forEach(function(attr) {
                            container.style[attr] = actualBB[attr] + "px";
                        });
                    }
                }, this);
                var video = this._flashObjs.video;
                if (video) {
                    video.set("width", actualBB.width);
                    video.set("height", actualBB.height);
                    if (this._flip) {
                        if (video.get("scaleX") > 0)
                            video.set("scaleX", -video.get("scaleX"));
                        video.set("x", video.get("width"));
                    }
                }
            },

            _error: function(s) {
                this.__status = "error";
                this.trigger("error", s);
            }

        };
    }], {

        flashRegistry: function() {
            if (!this.__flashRegistry) {
                this.__flashRegistry = new FlashClassRegistry();
                this.__flashRegistry.register("flash.media.Camera", ["setMode", "setQuality", "setKeyFrameInterval", "addEventListener"], ["getCamera"]);
                this.__flashRegistry.register("flash.media.Video", ["attachCamera", "attachNetStream"]);
                this.__flashRegistry.register("flash.net.URLRequest", []);
                this.__flashRegistry.register("flash.net.URLRequestHeader", []);
                this.__flashRegistry.register("flash.net.URLLoader", ["addEventListener", "load"]);
                this.__flashRegistry.register("flash.display.Sprite", ["addChild", "removeChild", "setChildIndex"]);
                this.__flashRegistry.register("flash.display.Stage", []);
                this.__flashRegistry.register("flash.display.Loader", ["load"]);
                this.__flashRegistry.register("flash.display.LoaderInfo", ["addEventListener"]);
                this.__flashRegistry.register("flash.display.BitmapData", ["draw", "getPixel", "dispose"]);
                this.__flashRegistry.register("flash.display.Bitmap", []);
                this.__flashRegistry.register("flash.geom.Matrix", ["scale"]);
                this.__flashRegistry.register("flash.system.Security", [], ["allowDomain", "showSettings"]);
                this.__flashRegistry.register("com.adobe.images.PNGEncoder", [], ["encode"]);
                this.__flashRegistry.register("com.adobe.images.JPGEncoder", ["encode"]);
            }
            return this.__flashRegistry;
        },

        attach: function(element, attrs) {
            var cls = new Cls(element, attrs);
            return element;
        }


    });
    return Cls;
});

Scoped.define("module:ImageRecorder.FlashImageRecorderWrapper", ["module:ImageRecorder.ImageRecorderWrapper","module:Flash.FlashImageRecorder","browser:Dom","browser:Info","base:Promise","base:Objs","base:Timers.Timer","browser:Upload.CustomUploader","browser:Upload.MultiUploader"], function (FlashImageRecorderWrapper, FlashRecorder, Dom, Info, Promise, Objs, Timer, CustomUploader, MultiUploader, scoped) {
    return FlashImageRecorderWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                if (this._element.tagName.toLowerCase() !== "div")
                    this._element = Dom.changeTag(this._element, "div");
                this._recorder = new FlashRecorder(this._element, {
                    flip: !!this._options.flip,
                    camerawidth: this._options.recordingWidth,
                    cameraheight: this._options.recordingHeight,
                    fps: this._options.framerate,
                    videoRate: this._options.videoBitrate ? this._options.videoBitrate * 1000 : undefined
                });
                this._recorder.ready.forwardCallback(this.ready);
                this._recorder.on("require_display", function() {
                    this.trigger("require_display");
                }, this);
                this._recorder.on("endpoint_connectivity", function(endpoint, connectivity) {
                    this.trigger("endpoint_connectivity", endpoint, connectivity);
                }, this);
            },

            destroy: function() {
                this._recorder.destroy();
                inherited.destroy.call(this);
            },

            _bindMedia: function() {
                return this._recorder.bindMedia(this._options.flashFullSecurityDialog);
            },

            _unbindMedia: function() {
                return this._recorder.unbindMedia();
            },

            blankLevel: function() {
                return this._recorder.blankLevel();
            },

            deltaCoefficient: function() {
                return this._recorder.deltaCoefficient();
            },

            lightLevel: function() {
                return this._recorder.lightLevel();
            },

            enumerateDevices: function() {
                var result = this._recorder.enumerateDevices();
                return Promise.value({
                    videoCount: Objs.count(result.videos),
                    video: Objs.map(result.videos, function(value, key) {
                        return {
                            id: key,
                            label: value
                        };
                    })
                });
            },

            currentDevices: function() {
                return {
                    video: this._recorder.currentCamera()
                };
            },

            setCurrentDevices: function(devices) {
                if (devices && devices.video)
                    this._recorder.selectCamera(devices.video);
            },

            createSnapshot: function(type) {
                return this._recorder.createSnapshot();
            },

            createSnapshotDisplay: function(parent, snapshot, x, y, w, h) {
                return this._recorder.createSnapshotDisplay(snapshot, x, y, w, h);
            },

            updateSnapshotDisplay: function(snapshot, display, x, y, w, h) {
                return this._recorder.updateSnapshotDisplay(snapshot, display, x, y, w, h);
            },

            removeSnapshotDisplay: function(display) {
                this._recorder.removeSnapshotDisplay(display);
            },

            createSnapshotUploader: function(snapshot, type, uploaderOptions) {
                var uploader = new CustomUploader(Objs.extend({
                    source: snapshot,
                    type: type,
                    recorder: this._recorder
                }, uploaderOptions));
                uploader.on("upload", function(options) {
                    options.recorder.postSnapshot(
                            options.source,
                            options.url,
                            options.type
                        )
                        .success(uploader.successCallback, uploader)
                        .error(uploader.errorCallback, uploader);
                });
                return uploader;
            },

            isFlash: function() {
                return true;
            },

            _softwareDependencies: function() {
                return Info.flash().installed() ? Promise.value(true) : Promise.error([{
                    "title": "Adobe Flash",
                    "execute": function() {
                        window.open("https://get.adobe.com/flashplayer");
                    }
                }]);
            }

        };
    }, {

        supported: function(options) {
            return !Info.isMobile() && !options.noflash && Info.flash().supported() && !options.screen;
        }

    });
});

Scoped.extend("module:ImageRecorder.ImageRecorderWrapper", ["module:ImageRecorder.ImageRecorderWrapper","module:ImageRecorder.FlashImageRecorderWrapper"], function (ImageRecorderWrapper, FlashImageRecorderWrapper) {
    ImageRecorderWrapper.register(FlashImageRecorderWrapper, 1);
    return {};
});

Scoped.define("module:Flash.FlashRecorder", ["browser:DomExtend.DomExtension","browser:Dom","browser:Info","flash:FlashClassRegistry","flash:FlashEmbedding","base:Strings","base:Async","base:Objs","base:Functions","base:Types","base:Timers.Timer","base:Time","base:Promise","base:Events.EventsMixin","module:Recorder.PixelSampleMixin"], function (Class, Dom, Info, FlashClassRegistry, FlashEmbedding, Strings, Async, Objs, Functions, Types, Timer, Time, Promise, EventsMixin, PixelSampleMixin, scoped) {
    var Cls = Class.extend({
        scoped: scoped
    }, [EventsMixin, PixelSampleMixin, function(inherited) {
        return {

            constructor: function(element, attrs) {
                inherited.constructor.call(this, element, attrs);
                this._embedding = this.auto_destroy(new FlashEmbedding(element, {
                    registry: this.cls.flashRegistry(),
                    wrap: true,
                    debug: false,
                    hasEmbedding: this.readAttr("hasembedding") || false,
                    namespace: this.readAttr("embednamespace") || null
                }, {
                    parentBgcolor: true,
                    fixHalfPixels: true
                }));
                this._flashObjs = {};
                this.ready = Promise.create();
                this.__status = "idle";
                this.__disableVideo = this.readAttr('disablevideo') || false;
                this.__disableAudio = this.readAttr('disableaudio') || false;
                this.__cameraWidth = this.readAttr('camerawidth') || 640;
                this.__cameraHeight = this.readAttr('cameraheight') || 480;
                this.__audioRate = this.readAttr('audiorate') || 44;
                this.__audioQuality = this.readAttr('audioquality') || 10;
                this.__videoRate = this.readAttr('videorate') || 0;
                this.__videoQuality = this.readAttr('videoquality') || 90;
                this.__streamType = this.readAttr("streamtype") || 'mp4';
                this.__microphoneCodec = this.readAttr("microphonecodec") || 'speex';
                this.__fps = this.readAttr('fps') || 20;
                this.__defaultGain = 55;
                this._flip = Types.parseBool(this.readAttr("flip") || false);
                this._embedding.ready(this.__initializeEmbedding, this);
            },

            averageFrameRate: function() {
                return this.__fps;
            },

            __initializeEmbedding: function() {
                this.__hasMicrophoneActivity = false;
                this._flashObjs.main = this._embedding.flashMain();
                this._flashObjs.stage = this._flashObjs.main.get("stage");
                this._flashObjs.stage.set("scaleMode", "noScale");
                this._flashObjs.stage.set("align", "TL");
                this._flashObjs.video = this._embedding.newObject(
                    "flash.media.Video",
                    this._flashObjs.stage.get("stageWidth"),
                    this._flashObjs.stage.get("stageHeight")
                );
                this._flashObjs.cameraVideo = this._embedding.newObject(
                    "flash.media.Video",
                    this.__cameraWidth,
                    this.__cameraHeight
                );
                this._flashObjs.main.addChildVoid(this._flashObjs.video);
                this._flashObjs.Microphone = this._embedding.getClass("flash.media.Microphone");
                this._flashObjs.Camera = this._embedding.getClass("flash.media.Camera");
                this._flashObjs.microphone = !Types.is_empty(this._flashObjs.Microphone.get('names').length > 0) ? this._flashObjs.Microphone.getMicrophone(0) : null;
                this.setMicrophoneProfile();
                this._flashObjs.camera = this._flashObjs.Camera.getCamera(0);
                this._currentCamera = 0;
                this._currentMicrophone = 0;
                this._flashObjs.Security = this._embedding.getClass("flash.system.Security");
                this.recomputeBB();
                this.ready.asyncSuccess(this);
                this.auto_destroy(new Timer({
                    delay: 100,
                    fire: this._fire,
                    context: this
                }));
            },

            isAccessGranted: function() {
                try {
                    return ((!this._flashObjs.camera || !this._flashObjs.camera.get('muted')) &&
                        (!this._flashObjs.microphone || !this._flashObjs.microphone.get('muted')));
                } catch (e) {
                    return false;
                }
            },

            isSecurityDialogOpen: function() {
                var dummy = this._embedding.newObject("flash.display.BitmapData", 1, 1);
                var open = false;
                try {
                    dummy.draw(this._flashObjs.stage);
                } catch (e) {
                    open = true;
                }
                dummy.dispose();
                dummy.destroy();
                return open;
            },

            openSecurityDialog: function(fullSecurityDialog) {
                this.trigger("require_display");
                if (fullSecurityDialog)
                    this._flashObjs.Security.showSettings("privacy");
                else {
                    this._flashObjs.video.attachCamera(null);
                    this._flashObjs.video.attachCamera(this._flashObjs.camera);
                }
            },

            grantAccess: function(fullSecurityDialog, allowDeny) {
                var promise = Promise.create();
                var timer = new Timer({
                    fire: function() {
                        if (this.destroyed()) {
                            timer.destroy();
                            return;
                        }
                        if (this.isSecurityDialogOpen())
                            return;
                        if (this.isAccessGranted()) {
                            timer.destroy();
                            promise.asyncSuccess(true);
                        } else {
                            if (allowDeny) {
                                timer.destroy();
                                promise.asyncError(true);
                            } else
                                this.openSecurityDialog(fullSecurityDialog);
                        }
                    },
                    context: this,
                    delay: 10,
                    start: true
                });
                return promise;
            },

            bindMedia: function(fullSecurityDialog, allowDeny) {
                return this.grantAccess(fullSecurityDialog, allowDeny).mapSuccess(function() {
                    this._mediaBound = true;
                    this._attachCamera();
                }, this);
            },

            unbindMedia: function() {
                this._detachCamera();
                this._mediaBound = false;
            },

            _attachCamera: function() {
                if (this._flashObjs.camera) {
                    this._flashObjs.camera.setMode(this.__cameraWidth, this.__cameraHeight, this.__fps);
                    this._flashObjs.camera.setQuality(this.__videoRate, this.__videoQuality);
                    this._flashObjs.camera.setKeyFrameInterval(5);
                    this._flashObjs.video.attachCamera(this._flashObjs.camera);
                    this._flashObjs.cameraVideo.attachCamera(this._flashObjs.camera);
                }
                if (this.__disableVideo) {
                    this._flashObjs.video.attachCamera(null);
                    this._flashObjs.cameraVideo.attachCamera(null);
                }
                if (this._flip) {
                    if (this._flashObjs.video.get("scaleX") > 0)
                        this._flashObjs.video.set("scaleX", -this._flashObjs.video.get("scaleX"));
                    this._flashObjs.video.set("x", this._flashObjs.video.get("width"));
                }
            },

            _detachCamera: function() {
                this._flashObjs.video.attachCamera(null);
                this._flashObjs.cameraVideo.attachCamera(null);
            },

            enumerateDevices: function() {
                return {
                    audios: this._flashObjs.Microphone.get('names'),
                    videos: this._flashObjs.Camera.get('names')
                };
            },

            selectMicrophone: function(index) {
                if (this._flashObjs.microphone)
                    this._flashObjs.microphone.weakDestroy();
                this.__hasMicrophoneActivity = false;
                this.__microphoneActivityTime = null;
                this._flashObjs.microphone = this._flashObjs.Microphone.getMicrophone(index);
                this._currentMicrophone = index;
                this.setMicrophoneProfile(this._currentMicrophoneProfile);
            },

            selectCamera: function(index) {
                if (this._flashObjs.camera)
                    this._flashObjs.camera.weakDestroy();
                this.__cameraActivityTime = null;
                this._flashObjs.camera = this._flashObjs.Camera.getCamera(index);
                this._currentCamera = index;
                if (this._mediaBound)
                    this._attachCamera();
            },

            currentCamera: function() {
                return this._currentCamera;
            },

            currentMicrophone: function() {
                return this._currentMicrophone;
            },

            microphoneInfo: function() {
                return this._flashObjs.microphone ? {
                    muted: this._flashObjs.microphone.get("muted"),
                    name: this._flashObjs.microphone.get("name"),
                    activityLevel: this._flashObjs.microphone.get("activityLevel"),
                    gain: this._flashObjs.microphone.get("gain"),
                    rate: this._flashObjs.microphone.get("rate"),
                    encodeQuality: this._flashObjs.microphone.get("encodeQuality"),
                    codec: this._flashObjs.microphone.get("codec"),
                    hadActivity: this.__hadMicrophoneActivity,
                    inactivityTime: this.__microphoneActivityTime ? Time.now() - this.__microphoneActivityTime : null
                } : {};
            },

            cameraInfo: function() {
                if (!this._flashObjs.camera)
                    return {};
                return {
                    muted: this._flashObjs.camera.get("muted"),
                    name: this._flashObjs.camera.get("name"),
                    activityLevel: this._flashObjs.camera.get("activityLevel"),
                    fps: this._flashObjs.camera.get("fps"),
                    width: this._flashObjs.camera.get("width"),
                    height: this._flashObjs.camera.get("height"),
                    inactivityTime: this.__cameraActivityTime ? Time.now() - this.__cameraActivityTime : null
                };
            },

            setMicrophoneProfile: function(profile) {
                if (!this._flashObjs.microphone)
                    return;
                profile = profile || {};
                this._flashObjs.microphone.setLoopBack(profile.loopback || false);
                this._flashObjs.microphone.set("gain", profile.gain || this.__defaultGain);
                this._flashObjs.microphone.setSilenceLevel(profile.silenceLevel || 0);
                this._flashObjs.microphone.setUseEchoSuppression(profile.echoSuppression || false);
                this._flashObjs.microphone.set("rate", profile.rate || this.__audioRate);
                this._flashObjs.microphone.set("encodeQuality", profile.encodeQuality || this.__audioQuality);
                this._flashObjs.microphone.set("codec", profile.codec || this.__microphoneCodec);
                this._currentMicrophoneProfile = profile;
            },

            getVolumeGain: function() {
                var gain = this._mediaBound ? this._flashObjs.micropone.get("gain") : 55;
                return gain / 55.0;
            },

            setVolumeGain: function(volumeGain) {
                this.__defaultGain = Math.min(Math.max(0, Math.round(volumeGain * 55)), 100);
                if (this._mediaBound && this._flashObjs.microphone)
                    this._flashObjs.microphone.set("gain", this.__defaultGain);
            },

            _pixelSample: function(samples, callback, context) {
                samples = samples || 100;
                var w = this._flashObjs.cameraVideo.get("width");
                var h = this._flashObjs.cameraVideo.get("height");
                var wc = Math.ceil(Math.sqrt(w / h * samples));
                var hc = Math.ceil(Math.sqrt(h / w * samples));
                var lightLevelBmp = this._embedding.newObject("flash.display.BitmapData", wc, hc);
                var scaleMatrix = this._embedding.newObject("flash.geom.Matrix");
                scaleMatrix.scale(wc / w, hc / h);
                lightLevelBmp.draw(this._flashObjs.cameraVideo, scaleMatrix);
                for (var i = 0; i < samples; ++i) {
                    var x = i % wc;
                    var y = Math.floor(i / wc);
                    var rgb = lightLevelBmp.getPixel(x, y);
                    callback.call(context || this, rgb % 256, (rgb / 256) % 256, (rgb / 256 / 256) % 256);
                }
                scaleMatrix.destroy();
                lightLevelBmp.destroy();
            },

            testSoundLevel: function(activate) {
                this.setMicrophoneProfile(activate ? {
                    loopback: true,
                    gain: 55,
                    silenceLevel: 100,
                    echoSuppression: true
                } : {});
            },

            soundLevel: function() {
                return this._flashObjs.microphone ? this._flashObjs.microphone.get("activityLevel") : 0;
            },

            _fire: function() {
                if (!this._mediaBound)
                    return;
                this.__hadMicrophoneActivity = this.__hadMicrophoneActivity || (this._flashObjs.microphone && this._flashObjs.microphone.get("activityLevel") > 0);
                if (this._flashObjs.microphone && this._flashObjs.microphone.get("activityLevel") > 0)
                    this.__microphoneActivityTime = Time.now();
                if (this._flashObjs.camera) {
                    var currentCameraActivity = this._flashObjs.camera.get("activityLevel");
                    if (!this.__lastCameraActivity || this.__lastCameraActivity !== currentCameraActivity)
                        this.__cameraActivityTime = Time.now();
                    this.__lastCameraActivity = currentCameraActivity;
                }
            },

            createSnapshot: function() {
                var bmp = this._embedding.newObject(
                    "flash.display.BitmapData",
                    this._flashObjs.cameraVideo.get("videoWidth"),
                    this._flashObjs.cameraVideo.get("videoHeight")
                );
                bmp.draw(this._flashObjs.cameraVideo);
                return bmp;
            },

            postSnapshot: function(bmp, url, type, quality) {
                var promise = Promise.create();
                quality = quality || 90;
                var header = this._embedding.newObject("flash.net.URLRequestHeader", "Content-type", "application/octet-stream");
                var request = this._embedding.newObject("flash.net.URLRequest", url);
                request.set("requestHeaders", [header]);
                request.set("method", "POST");
                if (type === "jpg") {
                    var jpgEncoder = this._embedding.newObject("com.adobe.images.JPGEncoder", quality);
                    request.set("data", jpgEncoder.encode(bmp));
                    jpgEncoder.destroy();
                } else {
                    var PngEncoder = this._embedding.getClass("com.adobe.images.PNGEncoder");
                    request.set("data", PngEncoder.encode(bmp));
                }
                var poster = this._embedding.newObject("flash.net.URLLoader");
                poster.set("dataFormat", "BINARY");

                // In case anybody is wondering, no, the progress event does not work for uploads:
                // http://stackoverflow.com/questions/2106682/a-progress-event-when-uploading-bytearray-to-server-with-as3-php/2107059#2107059

                poster.addEventListener("complete", this._embedding.newCallback(Functions.as_method(function() {
                    promise.asyncSuccess(true);
                }, this)));
                poster.addEventListener("ioError", this._embedding.newCallback(Functions.as_method(function() {
                    promise.asyncError("IO Error");
                }, this)));
                poster.load(request);
                promise.callback(function() {
                    poster.destroy();
                    request.destroy();
                    header.destroy();
                });
                return promise;
            },

            createSnapshotDisplay: function(bmpData, x, y, w, h) {
                var bmp = this._embedding.newObject("flash.display.Bitmap", bmpData);
                this.updateSnapshotDisplay(bmpData, bmp, x, y, w, h);
                this._flashObjs.main.addChildVoid(bmp);
                return bmp;
            },

            updateSnapshotDisplay: function(bmpData, bmp, x, y, w, h) {
                bmp.set("x", x);
                bmp.set("y", y);
                bmp.set("scaleX", w / bmpData.get("width"));
                bmp.set("scaleY", h / bmpData.get("height"));
            },

            removeSnapshotDisplay: function(snapshot) {
                try {
                    this._flashObjs.main.removeChildVoid(snapshot);
                } catch (e) {}
                snapshot.destroy();
            },

            idealBB: function() {
                return {
                    width: this.__cameraWidth,
                    height: this.__cameraHeight
                };
            },

            setActualBB: function(actualBB) {
                ["object", "embed"].forEach(function(tag) {
                    var container = this._element.getElementsByTagName(tag.toUpperCase())[0];
                    if (container) {
                        ["width", "height"].forEach(function(attr) {
                            container.style[attr] = actualBB[attr] + "px";
                        });
                    }
                }, this);
                var video = this._flashObjs.video;
                if (video) {
                    video.set("width", actualBB.width);
                    video.set("height", actualBB.height);
                    if (this._flip) {
                        if (video.get("scaleX") > 0)
                            video.set("scaleX", -video.get("scaleX"));
                        video.set("x", video.get("width"));
                    }
                }
            },

            _error: function(s) {
                this.__status = "error";
                this.trigger("error", s);
            },

            _status: function(s) {
                if (s && s !== this.__status) {
                    this.__status = s;
                    this.trigger("status", s);
                    this.trigger(s);
                }
                return this.__status;
            },

            __newCallback: function(endpoint, endpoints) {
                var active = true;
                var timer = null;
                var badEndpoint = function() {
                    clearTimeout(timer);
                    if (!active)
                        return;
                    active = false;
                    this.trigger("endpoint_connectivity", this.__endpoint, -1);
                    if (endpoints.length > 0) {
                        endpoint = endpoints.shift();
                        this._flashObjs.connection.closeVoid();
                        this._flashObjs.connection.destroy();
                        this._flashObjs.connection = this._embedding.newObject("flash.net.NetConnection");
                        this._flashObjs.connection.addEventListener("netStatus", this.__newCallback(endpoint, endpoints));
                        this.__endpoint = endpoint;
                        this._flashObjs.connection.connectVoid(endpoint.serverUrl);
                    } else
                        this._error("Could not connect to server");
                };
                var self = this;
                timer = setTimeout(function() {
                    badEndpoint.call(self);
                }, 10000);
                return this._embedding.newCallback(Functions.as_method(function(event) {
                    if (!active)
                        return;
                    var code = event.get("info").code;
                    if (code === "NetConnection.Connect.Closed" && this._status() === 'recording') {
                        active = false;
                        this._error("Connection to server interrupted.");
                        return;
                    }
                    if ((code === "NetConnection.Connect.Success" && this._status() !== 'connecting') ||
                        (code === "NetConnection.Connect.Closed" && this._status() === 'connecting') ||
                        (code === "NetConnection.Connect.Failed" && this._status() === 'connecting')) {
                        badEndpoint.call(this);
                        return;
                    }
                    if (code === "NetConnection.Connect.Closed" && this._status() === 'uploading') {
                        this._status('finished');
                        return;
                    }
                    if (code === "NetConnection.Connect.Success" && this._status() === 'connecting') {
                        this.trigger("endpoint_connectivity", this.__endpoint, 1);
                        clearTimeout(timer);
                        if (this.__streamType === 'mp4')
                            this._flashObjs.connection.callVoid("setStreamType", null, "live");
                        this._flashObjs.stream = this._embedding.newObject("flash.net.NetStream", this._flashObjs.connection);
                        this._flashObjs.stream.addEventListener("netStatus", this._embedding.newCallback(Functions.as_method(function(event) {
                            var code = event.get("info").code;
                            if (code === "NetStream.Record.Start") {
                                this._status('recording');
                                return;
                            }
                            if (code === "NetStream.Play.StreamNotFound") {
                                this._flashObjs.stream.closeVoid();
                                if (this._status() !== "none")
                                    this._error("Stream not found");
                                return;
                            }
                            // buffer empty and stopped means OK to close stream
                            if (code === "NetStream.Buffer.Empty") {
                                if (this._status() === "uploading" && this.__streamType === 'mp4') {
                                    this._flashObjs.stream.publish(null);
                                }
                            }
                            if (code === "NetStream.Unpublish.Success" ||
                                (this._status() === "uploading" && code === "NetStream.Buffer.Empty" &&
                                    this.__streamType === "flv" && this._flashObjs.stream.get('bufferLength') === 0)) {
                                this._flashObjs.stream.closeVoid();
                                this._flashObjs.stream.destroy();
                                this._flashObjs.stream = null;
                                this._flashObjs.connection.closeVoid();
                                this._flashObjs.connection.destroy();
                                this._flashObjs.connection = null;
                                this._status('finished');
                            }
                        }, this)));
                        this._flashObjs.stream.set("bufferTime", 120);
                        if (this.__streamType === 'mp4') {
                            this._flashObjs.h264Settings = this._embedding.newObject("flash.media.H264VideoStreamSettings");
                            this._flashObjs.h264Settings.setProfileLevel("baseline", "3.1");
                            this._flashObjs.stream.set("videoStreamSettings", this._flashObjs.h264Settings);
                        }
                        if (!this.__disableVideo)
                            this._flashObjs.stream.attachCameraVoid(this._flashObjs.camera);
                        if (!this.__disableAudio)
                            this._flashObjs.stream.attachAudioVoid(this._flashObjs.microphone);
                        this._flashObjs.stream.publish(endpoint.streamName, "record");
                    }
                }, this));
            },

            startRecord: function(endpoints) {
                if (arguments.length > 1) {
                    endpoints = {
                        serverUrl: endpoints,
                        streamName: arguments[1]
                    };
                }
                if (!Types.is_array(endpoints))
                    endpoints = [endpoints];
                this._status("connecting");
                var endpoint = endpoints.shift();
                var cb = this.__newCallback(endpoint, endpoints);
                this._flashObjs.connection = this._embedding.newObject("flash.net.NetConnection");
                this._flashObjs.connection.addEventListener("netStatus", cb);
                this.__endpoint = endpoint;
                this._flashObjs.connection.connectVoid(endpoint.serverUrl);
            },

            stopRecord: function() {
                if (this._status() !== "recording")
                    return;
                this.__initialBufferLength = 0;
                this._status("uploading");
                this.__initialBufferLength = this._flashObjs.stream.get("bufferLength");
                try {
                    this._flashObjs.stream.attachAudioVoid(null);
                } catch (e) {}
                this._flashObjs.stream.attachCameraVoid(null);
                /*try {
                    if (this.__endpoint.serverUrl.indexOf("rtmpt") === 0) {
                        this._flashObjs.stream.publishVoid("null");
                        this._flashObjs.stream.closeVoid();
                    }
                } catch (e) {}*/
            },

            uploadStatus: function() {
                return {
                    total: this.__initialBufferLength,
                    remaining: this._flashObjs.stream.get("bufferLength")
                };
            }

        };
    }], {

        flashRegistry: function() {
            if (!this.__flashRegistry) {
                this.__flashRegistry = new FlashClassRegistry();
                this.__flashRegistry.register("flash.media.Microphone", ["setLoopBack", "setSilenceLevel", "setUseEchoSuppression"], ["getMicrophone"]);
                this.__flashRegistry.register("flash.media.Camera", ["setMode", "setQuality", "setKeyFrameInterval", "addEventListener"], ["getCamera"]);
                this.__flashRegistry.register("flash.media.Video", ["attachCamera", "attachNetStream"]);
                this.__flashRegistry.register("flash.media.SoundTransform", []);
                this.__flashRegistry.register("flash.media.H264VideoStreamSettings", ["setProfileLevel"]);
                this.__flashRegistry.register("flash.net.NetStream", ["play", "pause", "resume", "addEventListener", "seek", "attachCamera", "attachAudio", "publish", "close"]);
                this.__flashRegistry.register("flash.net.NetConnection", ["connect", "addEventListener", "call", "close"]);
                this.__flashRegistry.register("flash.net.URLRequest", []);
                this.__flashRegistry.register("flash.net.URLRequestHeader", []);
                this.__flashRegistry.register("flash.net.URLLoader", ["addEventListener", "load"]);
                this.__flashRegistry.register("flash.display.Sprite", ["addChild", "removeChild", "setChildIndex"]);
                this.__flashRegistry.register("flash.display.Stage", []);
                this.__flashRegistry.register("flash.display.Loader", ["load"]);
                this.__flashRegistry.register("flash.display.LoaderInfo", ["addEventListener"]);
                this.__flashRegistry.register("flash.display.BitmapData", ["draw", "getPixel", "dispose"]);
                this.__flashRegistry.register("flash.display.Bitmap", []);
                this.__flashRegistry.register("flash.geom.Matrix", ["scale"]);
                this.__flashRegistry.register("flash.system.Security", [], ["allowDomain", "showSettings"]);
                this.__flashRegistry.register("com.adobe.images.PNGEncoder", [], ["encode"]);
                this.__flashRegistry.register("com.adobe.images.JPGEncoder", ["encode"]);
            }
            return this.__flashRegistry;
        },

        attach: function(element, attrs) {
            var cls = new Cls(element, attrs);
            return element;
        }


    });
    return Cls;
});

Scoped.define("module:Recorder.VideoRecorderWrapper", ["base:Classes.ConditionalInstance","base:Events.EventsMixin","base:Objs","base:Promise"], function (ConditionalInstance, EventsMixin, Objs, Promise, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                this._element = this._options.element;
                this.ready = Promise.create();
            },

            destroy: function() {
                inherited.destroy.call(this);
            },

            bindMedia: function() {
                return this._bindMedia();
            },

            _bindMedia: function() {},

            unbindMedia: function() {
                return this._unbindMedia();
            },

            _unbindMedia: function() {},

            softwareDependencies: function() {
                return this._softwareDependencies();
            },

            _softwareDependencies: function() {},

            cameraWidth: function() {
                return this._options.recordingWidth;
            },

            cameraHeight: function() {
                return this._options.recordingHeight;
            },

            lightLevel: function() {},
            soundLevel: function() {},
            testSoundLevel: function(activate) {},
            blankLevel: function() {},
            deltaCoefficient: function() {},

            getVolumeGain: function() {},
            setVolumeGain: function(volumeGain) {},

            enumerateDevices: function() {},
            currentDevices: function() {},
            setCurrentDevices: function(devices) {},
            setCameraFace: function(faceFront) {},

            createSnapshot: function() {},
            removeSnapshot: function(snapshot) {},
            createSnapshotDisplay: function(parent, snapshot, x, y, w, h) {},
            updateSnapshotDisplay: function(snapshot, display, x, y, w, h) {},
            removeSnapshotDisplay: function(display) {},
            createSnapshotUploader: function(snapshot, type, uploaderOptions) {},

            startRecord: function(options) {},
            stopRecord: function(options) {},

            isFlash: function() {
                return false;
            },

            supportsLocalPlayback: function() {
                return false;
            },

            supportsCameraFace: function() {
                return false;
            },

            snapshotToLocalPoster: function(snapshot) {
                return null;
            },

            localPlaybackSource: function() {
                return null;
            },

            averageFrameRate: function() {
                return null;
            },

            recordDelay: function(opts) {
                return 0;
            }

        };
    }], {

        _initializeOptions: function(options) {
            return Objs.extend({
                forceflash: false,
                noflash: false,
                recordingWidth: 640,
                recordingHeight: 480,
                recordVideo: true,
                recordAudio: true
            }, options);
        }

    });
});

Scoped.define("module:Recorder.FlashVideoRecorderWrapper", ["module:Recorder.VideoRecorderWrapper","module:Flash.FlashRecorder","browser:Dom","browser:Info","base:Promise","base:Objs","base:Timers.Timer","browser:Upload.CustomUploader","browser:Upload.MultiUploader"], function (VideoRecorderWrapper, FlashRecorder, Dom, Info, Promise, Objs, Timer, CustomUploader, MultiUploader, scoped) {
    return VideoRecorderWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                if (this._element.tagName.toLowerCase() !== "div")
                    this._element = Dom.changeTag(this._element, "div");
                this._recorder = new FlashRecorder(this._element, {
                    flip: !!this._options.flip,
                    disableaudio: !this._options.recordAudio,
                    disablevideo: !this._options.recordVideo,
                    streamtype: this._options.rtmpStreamType,
                    camerawidth: this._options.recordingWidth,
                    cameraheight: this._options.recordingHeight,
                    microphonecodec: this._options.rtmpMicrophoneCodec,
                    fps: this._options.framerate,
                    audioRate: this._options.audioBitrate ? Math.floor(this._options.audioBitrate / 1000) : undefined,
                    videoRate: this._options.videoBitrate ? this._options.videoBitrate * 1000 : undefined
                });
                this._recorder.ready.forwardCallback(this.ready);
                this._recorder.on("require_display", function() {
                    this.trigger("require_display");
                }, this);
                this._recorder.on("endpoint_connectivity", function(endpoint, connectivity) {
                    this.trigger("endpoint_connectivity", endpoint, connectivity);
                }, this);
            },

            destroy: function() {
                this._recorder.destroy();
                inherited.destroy.call(this);
            },

            _bindMedia: function() {
                return this._recorder.bindMedia(this._options.flashFullSecurityDialog);
            },

            _unbindMedia: function() {
                return this._recorder.unbindMedia();
            },

            blankLevel: function() {
                return this._recorder.blankLevel();
            },

            deltaCoefficient: function() {
                return this._recorder.deltaCoefficient();
            },

            lightLevel: function() {
                return this._recorder.lightLevel();
            },

            soundLevel: function() {
                var sl = this._recorder.soundLevel();
                return sl <= 1 ? 1.0 : (1.0 + (sl - 1) / 100);
            },

            getVolumeGain: function() {
                return this._recorder.getVolumeGain();
            },

            setVolumeGain: function(volumeGain) {
                this._recorder.setVolumeGain(volumeGain);
            },

            testSoundLevel: function(activate) {
                this._recorder.testSoundLevel(activate);
            },

            enumerateDevices: function() {
                var result = this._recorder.enumerateDevices();
                return Promise.value({
                    videoCount: Objs.count(result.videos),
                    audioCount: Objs.count(result.audios),
                    video: Objs.map(result.videos, function(value, key) {
                        return {
                            id: key,
                            label: value
                        };
                    }),
                    audio: Objs.map(result.audios, function(value, key) {
                        return {
                            id: key,
                            label: value
                        };
                    })
                });
            },

            currentDevices: function() {
                return {
                    video: this._recorder.currentCamera(),
                    audio: this._recorder.currentMicrophone()
                };
            },

            setCurrentDevices: function(devices) {
                if (devices && devices.video)
                    this._recorder.selectCamera(devices.video);
                if (devices && devices.audio)
                    this._recorder.selectMicrophone(devices.audio);
            },

            createSnapshot: function(type) {
                return this._recorder.createSnapshot();
            },

            createSnapshotDisplay: function(parent, snapshot, x, y, w, h) {
                return this._recorder.createSnapshotDisplay(snapshot, x, y, w, h);
            },

            updateSnapshotDisplay: function(snapshot, display, x, y, w, h) {
                return this._recorder.updateSnapshotDisplay(snapshot, display, x, y, w, h);
            },

            removeSnapshotDisplay: function(display) {
                this._recorder.removeSnapshotDisplay(display);
            },

            createSnapshotUploader: function(snapshot, type, uploaderOptions) {
                var uploader = new CustomUploader(Objs.extend({
                    source: snapshot,
                    type: type,
                    recorder: this._recorder
                }, uploaderOptions));
                uploader.on("upload", function(options) {
                    options.recorder.postSnapshot(
                            options.source,
                            options.url,
                            options.type
                        )
                        .success(uploader.successCallback, uploader)
                        .error(uploader.errorCallback, uploader);
                });
                return uploader;
            },

            startRecord: function(options) {
                if (this._options.simulate)
                    return Promise.value(true);
                var self = this;
                var ctx = {};
                var promise = Promise.create();
                this._recorder.on("recording", function() {
                    promise.asyncSuccess();
                    self._recorder.off(null, null, ctx);
                }, ctx).on("error", function(s) {
                    promise.asyncError(s);
                    self._recorder.off(null, null, ctx);
                }, ctx);
                this._recorder.startRecord(options.rtmp);
                return promise;
            },

            stopRecord: function(options) {
                if (this._options.simulate)
                    return Promise.value(new MultiUploader());
                var self = this;
                var ctx = {};
                var uploader = new CustomUploader();
                var timer = null;
                timer = new Timer({
                    delay: 100,
                    context: this,
                    fire: function() {
                        if (!this._recorder || this._recorder.destroyed()) {
                            timer.destroy();
                            return;
                        }
                        var status = this._recorder.uploadStatus();
                        uploader.progressCallback(status.total - status.remaining, status.total);
                    }
                });
                this._recorder.on("finished", function() {
                    uploader.successCallback(true);
                    self._recorder.off(null, null, ctx);
                    timer.weakDestroy();
                }, ctx).on("error", function(s) {
                    uploader.errorCallback(s);
                    self._recorder.off(null, null, ctx);
                    timer.weakDestroy();
                }, ctx);
                this._recorder.stopRecord();
                return Promise.create(uploader);
            },

            isFlash: function() {
                return true;
            },

            averageFrameRate: function() {
                return this._recorder.averageFrameRate();
            },

            _softwareDependencies: function() {
                return Info.flash().installed() ? Promise.value(true) : Promise.error([{
                    "title": "Adobe Flash",
                    "execute": function() {
                        window.open("https://get.adobe.com/flashplayer");
                    }
                }]);
            }

        };
    }, {

        supported: function(options) {
            return !Info.isMobile() && !options.noflash && Info.flash().supported() && !options.screen;
        }

    });
});

Scoped.extend("module:Recorder.VideoRecorderWrapper", ["module:Recorder.VideoRecorderWrapper","module:Recorder.FlashVideoRecorderWrapper"], function (VideoRecorderWrapper, FlashVideoRecorderWrapper) {
    VideoRecorderWrapper.register(FlashVideoRecorderWrapper, 1);
    return {};
});

Scoped.define("module:WebRTC.Support", ["base:Promise","base:Objs","browser:Info","browser:Dom","base:Time"], function (Promise, Objs, Info, Dom, Time) {
    return {

        canvasSupportsImageFormat: function(imageFormat) {
            try {
                var data = document.createElement('canvas').toDataURL(imageFormat);
                var headerIdx = data.indexOf(";");
                return data.substring(0, data.indexOf(";")).indexOf(imageFormat) != -1;
            } catch (e) {
                return false;
            }
        },

        getGlobals: function() {
            var getUserMedia = null;
            var getUserMediaCtx = null;

            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia && Info.isFirefox()) {
                getUserMedia = navigator.mediaDevices.getUserMedia;
                getUserMediaCtx = navigator.mediaDevices;
            } else {
                getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
                getUserMediaCtx = navigator;
            }

            var URL = window.URL || window.webkitURL;
            var MediaRecorder = window.MediaRecorder;
            var AudioContext = window.AudioContext || window.webkitAudioContext;
            var audioContextScriptProcessor = null;
            var createAnalyser = null;
            if (AudioContext) {
                Dom.userInteraction(function() {
                    if (!this.__globals)
                        return;
                    var audioContext = new AudioContext();
                    this.__globals.audioContext = audioContext;
                    this.__globals.audioContextScriptProcessor = audioContext.createJavaScriptNode || audioContext.createScriptProcessor;
                    this.__globals.createAnalyser = audioContext.createAnalyser;
                }, this);
            }
            var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;
            var RTCIceCandidate = window.RTCIceCandidate || window.mozRTCIceCandidate || window.webkitRTCIceCandidate;
            var RTCSessionDescription = window.RTCSessionDescription || window.mozRTCSessionDescription || window.webkitRTCSessionDescription;
            var WebSocket = window.WebSocket;
            return {
                getUserMedia: getUserMedia,
                getUserMediaCtx: getUserMediaCtx,
                URL: URL,
                MediaRecorder: MediaRecorder,
                AudioContext: AudioContext,
                //createAnalyser: createAnalyser,
                //audioContextScriptProcessor: audioContextScriptProcessor,
                webpSupport: this.canvasSupportsImageFormat("image/webp"),
                RTCPeerConnection: RTCPeerConnection,
                RTCIceCandidate: RTCIceCandidate,
                RTCSessionDescription: RTCSessionDescription,
                WebSocket: WebSocket,
                supportedConstraints: navigator.mediaDevices && navigator.mediaDevices.getSupportedConstraints ? navigator.mediaDevices.getSupportedConstraints() : {}
            };
        },

        globals: function() {
            if (!this.__globals)
                this.__globals = this.getGlobals();
            return this.__globals;
        },

        userMediaSupported: function() {
            return !!this.globals().getUserMedia;
        },

        enumerateMediaSources: function() {
            var promise = Promise.create();
            var promiseCallback = function(sources) {
                var result = {
                    audio: {},
                    audioCount: 0,
                    video: {},
                    videoCount: 0
                };
                Objs.iter(sources, function(source) {
                    if (source.kind.indexOf("video") === 0) {
                        result.videoCount++;
                        result.video[source.id || source.deviceId] = {
                            id: source.id || source.deviceId,
                            label: source.label
                        };
                    }
                    if (source.kind.indexOf("audio") === 0) {
                        result.audioCount++;
                        result.audio[source.id || source.deviceId] = {
                            id: source.id || source.deviceId,
                            label: source.label
                        };
                    }
                });
                promise.asyncSuccess(result);
            };
            try {
                if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices)
                    navigator.mediaDevices.enumerateDevices().then(promiseCallback);
                else if (MediaStreamTrack && MediaStreamTrack.getSources)
                    MediaStreamTrack.getSources(promiseCallback);
                else
                    promise.asyncError("Unsupported");
            } catch (e) {
                promise.asyncError(e);
            }
            return promise;
        },

        streamQueryResolution: function(stream) {
            var promise = Promise.create();
            var video = this.bindStreamToVideo(stream);
            video.addEventListener("playing", function() {
                setTimeout(function() {
                    promise.asyncSuccess({
                        stream: stream,
                        width: video.videoWidth,
                        height: video.videoHeight
                    });
                    video.remove();
                }, 500);
            });
            return promise;
        },

        chromeExtensionMessage: function(extensionId, data) {
            var promise = Promise.create();
            chrome.runtime.sendMessage(extensionId, data, promise.asyncSuccessFunc());
            return promise;
        },

        chromeExtensionExtract: function(meta) {
            var result = {};
            if (Info.isChrome()) {
                result.extensionId = meta.chromeExtensionId;
                result.extensionInstallLink = meta.chromeExtensionInstallLink;
            } else if (Info.isOpera()) {
                result.extensionId = meta.operaExtensionId;
                result.extensionInstallLink = meta.operaExtensionInstallLink;
            }
            return result;
        },

        userMedia: function(options) {
            var promise = Promise.create();
            var result = this.globals().getUserMedia.call(this.globals().getUserMediaCtx, options, function(stream) {
                promise.asyncSuccess(stream);
            }, function(e) {
                promise.asyncError(e);
            });
            try {
                if (result.then) {
                    result.then(function(stream) {
                        promise.asyncSuccess(stream);
                    });
                }
                if (result["catch"]) {
                    result["catch"](function(e) {
                        promise.asyncError(e);
                    });
                }
            } catch (e) {}
            return promise;
        },

        /*
         * audio: {} | undefined
         * video: {} | undefined
         * 	  width, height, aspectRatio
         * screen: true | {chromeExtensionId, operaExtensionId} | false
         */
        userMedia2: function(options) {
            var opts = {};
            if (options.audio)
                opts.audio = options.audio;
            if (options.screen && !options.video)
                options.video = {};
            if (!options.video)
                return this.userMedia(opts);
            if (options.screen) {
                options.video.width = options.video.width || window.innerWidth || document.body.clientWidth;
                options.video.height = options.video.height || window.innerHeight || document.body.clientHeight;
            }
            if (Info.isFirefox()) {
                opts.video = {};
                if (options.screen) {
                    opts.video.mediaSource = "screen";
                    if (!navigator.mediaDevices || !navigator.mediaDevices.getSupportedConstraints || !navigator.mediaDevices.getSupportedConstraints().mediaSource)
                        return Promise.error("This browser does not support screen recording.");
                }
                if (options.video.aspectRatio && !(options.video.width && options.video.height)) {
                    if (options.video.width)
                        options.video.height = Math.round(options.video.width / options.video.aspectRatio);
                    else if (options.video.height)
                        options.video.width = Math.round(options.video.height * options.video.aspectRatio);
                }
                if (options.video.width) {
                    opts.video.width = {
                        ideal: options.video.width
                    };
                }
                if (options.video.height) {
                    opts.video.height = {
                        ideal: options.video.height
                    };
                }
                /* This is supposed to work according to docs, but it is not:
                 * https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Frame_rate
                 */
                /*
                if (options.video.frameRate) {
                    opts.video.frameRate = {
                        ideal: options.video.frameRate
                    };
                }
                */
                if (options.video.sourceId)
                    opts.video.sourceId = options.video.sourceId;
                if (options.video.cameraFaceFront !== undefined && Info.isMobile())
                    opts.video.facingMode = options.video.cameraFaceFront ? "front" : "environment";
                return this.userMedia(opts);
            } else {
                opts.video = {
                    mandatory: {}
                };
                if (options.video.width) {
                    opts.video.mandatory.minWidth = options.video.width;
                    opts.video.mandatory.maxWidth = options.video.width;
                }
                if (!options.video.width && options.video.height) {
                    opts.video.mandatory.minHeight = options.video.height;
                    opts.video.mandatory.maxHeight = options.video.height;
                }
                var as = options.video.aspectRatio ? options.video.aspectRatio : (options.video.width && options.video.height ? options.video.width / options.video.height : null);
                if (as) {
                    opts.video.mandatory.minAspectRatio = as;
                    opts.video.mandatory.maxAspectRatio = as;
                }
                if (options.video.sourceId)
                    opts.video.mandatory.sourceId = options.video.sourceId;
                if (options.video.cameraFaceFront !== undefined && Info.isMobile())
                    opts.video.facingMode = options.video.cameraFaceFront ? "front" : "environment";

                var probe = function(count) {
                    var mandatory = opts.video.mandatory;
                    return this.userMedia(opts).mapError(function(e) {
                        count--;
                        if (e.name !== "ConstraintNotSatisfiedError" && e.name !== "OverconstrainedError")
                            return e;
                        var c = (e.constraintName || e.constraint).toLowerCase();
                        Objs.iter(mandatory, function(value, key) {
                            var lkey = key.toLowerCase();
                            if (lkey.indexOf(c) >= 0) {
                                var flt = lkey.indexOf("aspect") > 0;
                                var d = lkey.indexOf("min") === 0 ? -1 : 1;
                                var u = Math.max(0, mandatory[key] * (1.0 + d / 10));
                                mandatory[key] = flt ? u : Math.round(u);
                                if (count < 0) {
                                    delete mandatory[key];
                                    count = 100;
                                }
                            }
                        }, this);
                        return probe.call(this, count);
                    }, this);
                };
                if (options.screen) {
                    var extensionId = this.chromeExtensionExtract(options.screen).extensionId;
                    if (!extensionId)
                        return Promise.error("This browser does not support screen recording.");
                    var pingTest = Time.now();
                    return this.chromeExtensionMessage(extensionId, {
                        type: "ping",
                        data: pingTest
                    }).mapSuccess(function(pingResponse) {
                        var promise = Promise.create();
                        if (!pingResponse || pingResponse.type !== "success" || pingResponse.data !== pingTest)
                            return Promise.error("This browser does not support screen recording.");
                        else
                            promise.asyncSuccess(true);
                        return promise.mapSuccess(function() {
                            return this.chromeExtensionMessage(extensionId, {
                                type: "acquire",
                                sources: ['window', 'screen', 'tab'],
                                url: window.self !== window.top ? window.location.href : null // if recorder is inside of iframe
                            }).mapSuccess(function(acquireResponse) {
                                if (!acquireResponse || acquireResponse.type !== 'success')
                                    return Promise.error("Could not acquire permission to access screen.");
                                opts.video.mandatory.chromeMediaSource = 'desktop';
                                opts.video.mandatory.chromeMediaSourceId = acquireResponse.streamId;
                                delete opts.audio;
                                return probe.call(this, 100).mapSuccess(function(videoStream) {
                                    return !options.audio ? videoStream : this.userMedia({
                                        audio: true
                                    }).mapError(function() {
                                        return Promise.value(videoStream);
                                    }).mapSuccess(function(audioStream) {
                                        try {
                                            return new MediaStream([videoStream.getVideoTracks()[0], audioStream.getAudioTracks()[0]]);
                                        } catch (e) {
                                            return videoStream;
                                        }
                                    });
                                }, this);
                            }, this);
                        }, this);
                    }, this);
                }
                return probe.call(this, 100);
            }
        },

        stopUserMediaStream: function(stream) {
            var stopped = false;
            try {
                if (stream.getTracks) {
                    stream.getTracks().forEach(function(track) {
                        track.stop();
                        stopped = true;
                    });
                }
            } catch (e) {}
            try {
                if (!stopped && stream.stop)
                    stream.stop();
            } catch (e) {}
        },

        bindStreamToVideo: function(stream, video, flip) {
            if (!video)
                video = document.createElement("video");
            video.volume = 0;
            video.muted = true;
            if ('mozSrcObject' in video)
                video.mozSrcObject = stream;
            else if ('srcObject' in video)
                video.srcObject = stream;
            else
                video.src = this.globals().URL.createObjectURL(stream);
            if (flip) {
                video.style["-moz-transform"] = "scale(-1, 1)";
                video.style["-webkit-transform"] = "scale(-1, 1)";
                video.style["-o-transform"] = "scale(-1, 1)";
                video.style.transform = "scale(-1, 1)";
                video.style.filter = "FlipH";
            } else {
                delete video.style["-moz-transform"];
                delete video.style["-webkit-transform"];
                delete video.style["-o-transform"];
                delete video.style.transform;
                delete video.style.filter;
            }
            video.autoplay = true;
            video.play();
            return video;
        },

        dataURItoBlob: function(dataURI) {
            // convert base64 to raw binary data held in a string
            var byteString = atob(dataURI.split(',')[1]);

            // separate out the mime component
            var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];

            // write the bytes of the string to an ArrayBuffer
            var arrayBuffer = new ArrayBuffer(byteString.length);
            var _ia = new Uint8Array(arrayBuffer);
            for (var i = 0; i < byteString.length; i++)
                _ia[i] = byteString.charCodeAt(i);
            var dataView = new DataView(arrayBuffer);
            var blob = new Blob([dataView], {
                type: mimeString
            });
            return blob;
        }

    };
});

Scoped.define("module:WebRTC.AudioAnalyser", ["base:Class","module:WebRTC.Support"], function (Class, Support, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(stream) {
                inherited.constructor.call(this);
                /*
                var AudioContext = Support.globals().AudioContext;
                this._audioContext = new AudioContext();
                */
                this._audioContext = Support.globals().audioContext;
                this._analyserNode = Support.globals().createAnalyser.call(this._audioContext);
                this._analyserNode.fftSize = 32;
                if (stream.getAudioTracks().length > 0) {
                    this._audioInput = this._audioContext.createMediaStreamSource(stream);
                    this._audioInput.connect(this._analyserNode);
                }
            },

            destroy: function() {
                this._analyserNode.disconnect();
                delete this._analyserNode;
                //this._audioContext.close();
                //delete this._audioContext;
                inherited.destroy.call(this);
            },

            soundLevel: function() {
                if (!this._audioInput)
                    return 0.0;
                var bufferLength = this._analyserNode.fftSize;
                var dataArray = new Uint8Array(bufferLength);
                this._analyserNode.getByteTimeDomainData(dataArray);
                var mx = 0.0;
                for (var i = 0; i < bufferLength; i++)
                    mx = Math.max(mx, Math.abs(dataArray[i] / 128.0));
                return mx;
            }

        };
    }, {

        supported: function() {
            return !!Support.globals().AudioContext && !!Support.globals().createAnalyser && !!Support.globals().audioContext;
        }

    });
});

Scoped.define("module:WebRTC.AudioRecorder", ["base:Class","base:Events.EventsMixin","base:Objs","base:Promise","base:Functions","module:WebRTC.Support","module:Encoding.WaveEncoder.Support"], function (Class, EventsMixin, Objs, Promise, Functions, Support, WaveEncoder, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(stream, options) {
                inherited.constructor.call(this);
                this._channels = [];
                this._recordingLength = 0;
                this._options = Objs.extend({
                    audioChannels: 2,
                    bufferSize: 16384,
                    sampleRate: 44100
                }, options);
                this._stream = stream;
                this._started = false;
                this._stopped = false;
                this._volumeGainValue = 1.0;
                //this.__initializeContext();
            },

            _audioProcess: function(e) {
                if (!this._started)
                    return;
                this._channels.push(WaveEncoder.dumpInputBuffer(e.inputBuffer, this._options.audioChannels, this._actualBufferSize));
                this._recordingLength += this._actualBufferSize;
                /*
                var sampleStartTime = e.playbackTime;
                var sampleStopTime = e.playbackTime + this._actualBufferSize / this._actualSampleRate;
                //var sampleStopTime = e.playbackTime;
                //var sampleStartTime = e.playbackTime - this._actualBufferSize / this._actualSampleRate;
                if (sampleStopTime <= this._startContextTime)
                	return;
                if (this._stopped && sampleStartTime > this._stopContextTime) {
                	this._started = false;
                	this._generateData();
                	return;
                }
                var offset = 0;
                var endOffset = this._actualBufferSize;
                if (sampleStartTime < this._startContextTime)
                	offset = Math.round((this._startContextTime - sampleStartTime) * this._actualSampleRate);
                if (this._stopped && sampleStopTime > this._stopContextTime)
                	endOffset = Math.round((this._stopContextTime - sampleStartTime) * this._actualSampleRate);
                this._channels.push(WaveEncoder.dumpInputBuffer(e.inputBuffer, this._options.audioChannels, endOffset, offset));
                this._recordingLength += endOffset - offset;
                if (this._stopped && sampleStopTime > this._stopContextTime) {
                	this._started = false;
                	this._generateData();
                	return;
                }
                */
            },

            destroy: function() {
                this.stop();
                //this.__finalizeContext();
                inherited.destroy.call(this);
            },

            getVolumeGain: function() {
                return this._volumeGainValue;
            },

            setVolumeGain: function(volumeGain) {
                this._volumeGainValue = volumeGain;
                if (this._volumeGain)
                    this._volumeGain.value.gain = volumeGain;
            },

            __initializeContext: function() {
                var AudioContext = Support.globals().AudioContext;
                this._audioContext = new AudioContext();
                this._actualSampleRate = this._audioContext.sampleRate || this._options.sampleRate;
                this._volumeGain = this._audioContext.createGain();
                this._volumeGain.gain.value = this._volumeGainValue;
                this._audioInput = this._audioContext.createMediaStreamSource(this._stream);
                this._audioInput.connect(this._volumeGain);
                this._scriptProcessor = Support.globals().audioContextScriptProcessor.call(
                    this._audioContext,
                    this._options.bufferSize,
                    this._options.audioChannels,
                    this._options.audioChannels
                );
                this._actualBufferSize = this._scriptProcessor.bufferSize;
                this._scriptProcessor.onaudioprocess = Functions.as_method(this._audioProcess, this);
                this._volumeGain.connect(this._scriptProcessor);
                this._scriptProcessor.connect(this._audioContext.destination);
            },

            __finalizeContext: function() {
                this._scriptProcessor.disconnect();
                this._volumeGain.disconnect();
                this._audioInput.disconnect();
                this._scriptProcessor.onaudioprocess = null;
                this._audioContext.close();
                delete this._scriptProcessor;
                delete this._volumeGain;
                delete this._audioInput;
                delete this._audioContext;
            },

            start: function() {
                if (this._started)
                    return Promise.value(true);
                this.__initializeContext();
                this._startContextTime = this._audioContext.currentTime;
                this._started = true;
                this._stopped = false;
                this._recordingLength = 0;
                this._channels = [];
                this.trigger("started");
                return Promise.value(true);
            },

            stop: function() {
                if (!this._started || this._stopped)
                    return;
                this._stopContextTime = this._audioContext.currentTime;
                this._stopped = true;
                this.trigger("stopped");
                this.__finalizeContext();
                this._started = false;
                this._generateData();
            },

            _generateData: function() {
                var volume = 1;
                var index = 44;
                var totalSize = this._recordingLength * this._options.audioChannels * 2 + 44;
                var buffer = new ArrayBuffer(totalSize);
                var view = new DataView(buffer);
                WaveEncoder.generateHeader(totalSize, this._options.audioChannels, this._actualSampleRate, buffer);
                this._channels.forEach(function(channel) {
                    WaveEncoder.waveChannelTransform(channel, volume).value().forEach(function(v) {
                        view.setInt16(index, v, true);
                        index += 2;
                    });
                });
                this._data = new Blob([view], {
                    type: 'audio/wav'
                });
                this._leftChannel = [];
                this._rightChannel = [];
                this._recordingLength = 0;
                this.trigger("data", this._data);
            }

        };
    }], {

        supported: function() {
            return !!Support.globals().AudioContext && !!Support.globals().audioContextScriptProcessor;
        }

    });
});

Scoped.define("module:WebRTC.MediaRecorder", ["base:Class","base:Events.EventsMixin","base:Functions","base:Promise","browser:Info","module:WebRTC.Support"], function (Class, EventsMixin, Functions, Promise, Info, Support, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(stream, options) {
                options = options || {};
                inherited.constructor.call(this);
                this._stream = stream;
                this._started = false;
                var MediaRecorder = Support.globals().MediaRecorder;
                /*
                 * This is supposed to work according to the docs, but it is not:
                 * 
                 * https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder/MediaRecorder#Example
                 */
                var mediaRecorderOptions = {
                    mimeType: ""
                };
                //mediaRecorderOptions.mimeType = "video/mp4";
                try {
                    if (options.audioonly) {
                        if (MediaRecorder.isTypeSupported('audio/mp3')) {
                            mediaRecorderOptions = {
                                mimeType: 'audio/mp3'
                            };
                        } else if (MediaRecorder.isTypeSupported('audio/ogg;codecs=opus')) {
                            mediaRecorderOptions = {
                                mimeType: 'audio/ogg;codecs=opus'
                            };
                        }
                    } else {
                        if (MediaRecorder.isTypeSupported('video/webm;codecs=vp9')) {
                            mediaRecorderOptions = {
                                mimeType: 'video/webm;codecs=vp9'
                            };
                        } else if (MediaRecorder.isTypeSupported('video/webm;codecs=vp8')) {
                            mediaRecorderOptions = {
                                mimeType: 'video/webm;codecs=vp8'
                            };
                        } else if (MediaRecorder.isTypeSupported('video/webm')) {
                            mediaRecorderOptions = {
                                mimeType: 'video/webm'
                            };
                        }
                    }
                } catch (e) {
                    mediaRecorderOptions = {};
                }
                if (options.videoBitrate)
                    mediaRecorderOptions.videoBitsPerSecond = options.videoBitrate * 1000;
                if (options.audioBitrate)
                    mediaRecorderOptions.audioBitsPerSecond = options.audioBitrate * 1000;
                this.__audioonly = options.audioonly;
                this.__mediaRecorderOptions = mediaRecorderOptions;
                this._mediaRecorder = new MediaRecorder(stream, mediaRecorderOptions);
                this._mediaRecorder.ondataavailable = Functions.as_method(this._dataAvailable, this);
                this._mediaRecorder.onstop = Functions.as_method(this._dataStop, this);
            },

            destroy: function() {
                this.stop();
                inherited.destroy.call(this);
            },

            start: function() {
                if (this._started)
                    return Promise.value(true);
                this._started = true;
                this._chunks = [];
                this._mediaRecorder.start(10);
                this.trigger("started");
                return Promise.value(true);
            },

            stop: function() {
                if (!this._started)
                    return;
                this._started = false;
                this._mediaRecorder.stop();
                this.trigger("stopped");
            },

            _dataAvailable: function(e) {
                if (e.data && e.data.size > 0)
                    this._chunks.push(e.data);
            },

            _dataStop: function(e) {
                this._data = new Blob(this._chunks, {
                    type: (this.__mediaRecorderOptions.mimeType.split(";"))[0] || (this.__audioonly ? "audio/ogg" : "video/webm")
                });
                this._chunks = [];
                if (Info.isFirefox()) {
                    var self = this;
                    var fileReader = new FileReader();
                    fileReader.onload = function() {
                        self._data = new Blob([this.result], {
                            type: self._data.type
                        });
                        self.trigger("data", self._data);
                    };
                    fileReader.readAsArrayBuffer(this._data);
                } else
                    this.trigger("data", this._data);
            }

        };
    }], {

        supported: function() {
            if (!Support.globals().MediaRecorder)
                return false;
            if (document.location.href.indexOf("https://") !== 0 && document.location.hostname !== "localhost") {
                if (Info.isOpera() || Info.isChrome())
                    return false;
            }
            if (Info.isOpera() && Info.operaVersion() < 44)
                return false;
            if (Info.isChrome() && Info.chromeVersion() < 57)
                return false;
            return true;
        }

    });
});

Scoped.define("module:WebRTC.PeerRecorder", ["base:Class","base:Events.EventsMixin","base:Functions","base:Objs","base:Promise","base:Async","browser:Info","module:WebRTC.Support"], function (Class, EventsMixin, Functions, Objs, Promise, Async, Info, Support, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(stream, options) {
                inherited.constructor.call(this);
                this._stream = stream;
                if (!options.videoBitrate && options.recorderWidth && options.recorderHeight)
                    options.videoBitrate = Math.round(options.recorderWidth * options.recorderHeight / 250);
                this._videoBitrate = options.videoBitrate || 1024;
                this._audioBitrate = options.audioBitrate || 256;
                this._audioonly = options.audioonly;
                this._started = false;
            },

            destroy: function() {
                this.stop();
                inherited.destroy.call(this);
            },

            start: function(options) {
                if (this._started)
                    return Promise.value(true);
                this._wssUrl = options.wssUrl;
                this._streamInfo = options.streamInfo;
                this._userData = options.userData || {};
                this._delay = options.delay || 0;
                this._started = true;
                this._wsConnection = new(Support.globals()).WebSocket(this._wssUrl);
                this._wsConnection.binaryType = 'arraybuffer';
                this._wsConnection.onopen = Functions.as_method(this._wsOnOpen, this);
                this._wsConnection.onmessage = Functions.as_method(this._wsOnMessage, this);
                this._wsConnection.onclose = Functions.as_method(this._wsOnClose, this);
                this._wsConnection.onerror = this._errorCallback("WS_CONNECTION");
                var promise = Promise.create();
                var ctx = {};
                var self = this;
                this.on("started", function() {
                    self.off(null, null, ctx);
                    promise.asyncSuccess(true);
                }, ctx).on("error", function(error) {
                    self.off(null, null, ctx);
                    promise.asyncError(error);
                }, ctx);
                return promise;
            },

            stop: function() {
                if (!this._started)
                    return;
                this._started = false;
                if (this._peerConnection)
                    this._peerConnection.close();
                this._peerConnection = null;
                if (this._wsConnection)
                    this._wsConnection.close();
                this._wsConnection = null;
                this.trigger("stopped");
            },

            _wsOnOpen: function() {
                this._peerConnection = new(Support.globals()).RTCPeerConnection({
                    'iceServers': []
                });
                if (this._stream.getTracks && this._peerConnection.addTrack) {
                    Objs.iter(this._stream.getTracks(), function(localTrack) {
                        this._peerConnection.addTrack(localTrack, this._stream);
                    }, this);
                } else
                    this._peerConnection.addStream(this._stream);
                this._peerConnection.createOffer(Functions.as_method(this._offerGotDescription, this), this._errorCallback("PEER_CREATE_OFFER"));
            },

            _wsOnMessage: function(evt) {
                var data = JSON.parse(evt.data);
                var status = parseInt(data.status, 10);
                var command = data.command;
                if (status !== 200) {
                    this._error("MESSAGE_ERROR", {
                        status: status,
                        description: data.statusDescription
                    });
                } else {
                    if (data.sdp !== undefined) {
                        this._peerConnection.setRemoteDescription(new(Support.globals()).RTCSessionDescription(data.sdp), function() {
                            // peerConnection.createAnswer(gotDescription, errorHandler);
                        }, this._errorCallback("PEER_REMOTE_DESCRIPTION"));
                    }
                    if (data.iceCandidates) {
                        Objs.iter(data.iceCandidates, function(iceCandidate) {
                            this._peerConnection.addIceCandidate(new(Support.globals()).RTCIceCandidate(iceCandidate));
                        }, this);
                    }
                    Async.eventually(function() {
                        this.trigger("started");
                    }, this, this._delay);
                }
                if (this._wsConnection)
                    this._wsConnection.close();
                this._wsConnection = null;
            },

            _offerGotDescription: function(description) {
                var enhanceData = {};
                if (this._audioBitrate)
                    enhanceData.audioBitrate = this._audioBitrate;
                if (this._videoBitrate && !this._audioonly)
                    enhanceData.videoBitrate = this._videoBitrate;
                description.sdp = this._enhanceSDP(description.sdp, enhanceData);
                this._peerConnection.setLocalDescription(description, Functions.as_method(function() {
                    this._wsConnection.send(JSON.stringify({
                        direction: "publish",
                        command: "sendOffer",
                        streamInfo: this._streamInfo,
                        sdp: description,
                        userData: this._userData
                    }));
                }, this), this._errorCallback("PEER_LOCAL_DESCRIPTION"));
            },

            _enhanceSDP: function(sdpStr, enhanceData) {
                var sdpLines = sdpStr.split(/\r\n/);
                var sdpSection = 'header';
                var hitMID = false;
                var sdpStrRet = '';
                Objs.iter(sdpLines, function(sdpLine) {
                    if (sdpLine.length <= 0)
                        return;
                    sdpStrRet += sdpLine + '\r\n';
                    if (sdpLine.indexOf("m=audio") === 0) {
                        sdpSection = 'audio';
                        hitMID = false;
                    } else if (sdpLine.indexOf("m=video") === 0) {
                        sdpSection = 'video';
                        hitMID = false;
                    }
                    if (sdpLine.indexOf("a=mid:") !== 0)
                        return;
                    if (hitMID)
                        return;
                    if ('audio'.localeCompare(sdpSection) === 0) {
                        if (enhanceData.audioBitrate !== undefined) {
                            sdpStrRet += 'b=AS:' + enhanceData.audioBitrate + '\r\n';
                            sdpStrRet += 'b=TIAS:' + (enhanceData.audioBitrate * 1024) + '\r\n';
                        }
                    } else if ('video'.localeCompare(sdpSection) === 0) {
                        if (enhanceData.videoBitrate !== undefined) {
                            sdpStrRet += 'b=AS:' + enhanceData.videoBitrate + '\r\n';
                            sdpStrRet += 'b=TIAS:' + (enhanceData.videoBitrate * 1024) + '\r\n';
                        }
                    }
                    hitMID = true;
                }, this);
                return sdpStrRet;
            },

            _wsOnClose: function() {},

            _error: function(errorName, errorData) {
                this.trigger("error", errorName, errorData);
                this.stop();
            },

            _errorCallback: function(errorName) {
                return Functions.as_method(function(errorData) {
                    this._error(errorName, errorData);
                }, this);
            }

        };
    }], {

        supported: function() {
            if (Info.isEdge())
                return false;
            if (Info.isSafari() && Info.safariVersion() < 11)
                return false;
            if (document.location.href.indexOf("https://") !== 0 && document.location.hostname !== "localhost") {
                if (Info.isChrome() && Info.chromeVersion() >= 47)
                    return false;
                if (Info.isOpera() && Info.operaVersion() >= 34)
                    return false;
            }
            return (Support.globals()).RTCPeerConnection &&
                (Support.globals()).RTCIceCandidate &&
                (Support.globals()).RTCSessionDescription &&
                (Support.globals()).WebSocket;
        }

    });
});

Scoped.define("module:WebRTC.RecorderWrapper", ["base:Classes.ConditionalInstance","base:Events.EventsMixin","base:Objs","module:WebRTC.Support","base:Time","module:Recorder.PixelSampleMixin"], function (ConditionalInstance, EventsMixin, Objs, Support, Time, PixelSampleMixin, scoped) {
    return ConditionalInstance.extend({
        scoped: scoped
    }, [EventsMixin, PixelSampleMixin, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                this._video = options.video;
                this._localPlaybackRequested = options.localPlaybackRequested;
                this._recording = false;
                this._bound = false;
                this._hasAudio = false;
                this._hasVideo = false;
                this._screen = options.screen;
                this._flip = !!options.flip;
            },

            _getConstraints: function() {
                return {
                    audio: this._options.recordAudio ? {
                        sourceId: this._options.audioId
                    } : false,
                    video: this._options.recordVideo ? {
                        /*
                        mandatory: {
                        	minWidth: this._options.recordResolution.width,
                        	maxWidth: this._options.recordResolution.width,
                        	minHeight: this._options.recordResolution.height,
                        	maxHeight: this._options.recordResolution.height
                        }
                        */
                        sourceId: this._options.videoId,
                        width: this._options.recordResolution.width,
                        height: this._options.recordResolution.height,
                        cameraFaceFront: this._options.cameraFaceFront
                    } : false,
                    screen: this._screen
                };
            },

            recordDelay: function(opts) {
                return 0;
            },

            stream: function() {
                return this._stream;
            },

            bindMedia: function() {
                if (this._bound)
                    return;
                return Support.userMedia2(this._getConstraints()).success(function(stream) {
                    this._hasAudio = this._options.recordAudio && stream.getAudioTracks().length > 0;
                    this._hasVideo = this._options.recordVideo && stream.getVideoTracks().length > 0;
                    this._bound = true;
                    this._stream = stream;
                    Support.bindStreamToVideo(stream, this._video, this._flip);
                    this.trigger("bound", stream);
                    this._boundMedia();
                }, this);
            },

            selectCamera: function(cameraId) {
                this._options.videoId = cameraId;
                if (this._bound) {
                    this.unbindMedia();
                    this.bindMedia();
                }
            },

            selectMicrophone: function(microphoneId) {
                this._options.audioId = microphoneId;
                if (this._bound) {
                    this.unbindMedia();
                    this.bindMedia();
                }
            },

            selectCameraFace: function(faceFront) {
                this._options.cameraFaceFront = faceFront;
                if (this._bound) {
                    this.unbindMedia();
                    this.bindMedia();
                }
            },

            startRecord: function(options) {
                if (this._recording)
                    return Promise.value(true);
                this._recording = true;
                var promise = this._startRecord(options);
                promise.success(function() {
                    this._startTime = Time.now();
                }, this);
                return promise;
            },

            stopRecord: function() {
                if (!this._recording)
                    return;
                this._recording = false;
                this._stopRecord();
                this._stopTime = Time.now();
            },

            duration: function() {
                return (this._recording || !this._stopTime ? Time.now() : this._stopTime) - this._startTime;
            },

            unbindMedia: function() {
                if (!this._bound || this._recording)
                    return;
                Support.stopUserMediaStream(this._stream);
                this._bound = false;
                this.trigger("unbound");
                this._unboundMedia();
            },

            createSnapshot: function(type) {
                return Support.dataURItoBlob(this._createSnapshot(type));
            },

            _createSnapshot: function(type) {
                var canvas = document.createElement('canvas');
                canvas.width = this._video.videoWidth || this._video.clientWidth;
                canvas.height = this._video.videoHeight || this._video.clientHeight;
                var context = canvas.getContext('2d');
                context.drawImage(this._video, 0, 0, canvas.width, canvas.height);
                var data = canvas.toDataURL(type);
                return data;
            },

            _pixelSample: function(samples, callback, context) {
                samples = samples || 100;
                var w = this._video.videoWidth || this._video.clientWidth;
                var h = this._video.videoHeight || this._video.clientHeight;
                var wc = Math.ceil(Math.sqrt(w / h * samples));
                var hc = Math.ceil(Math.sqrt(h / w * samples));
                var canvas = document.createElement('canvas');
                canvas.width = wc;
                canvas.height = hc;
                var ctx = canvas.getContext('2d');
                ctx.drawImage(this._video, 0, 0, wc, hc);
                for (var i = 0; i < samples; ++i) {
                    var x = i % wc;
                    var y = Math.floor(i / wc);
                    var data = ctx.getImageData(x, y, 1, 1).data;
                    callback.call(context || this, data[0], data[1], data[2]);
                }
            },

            _boundMedia: function() {},

            _unboundMedia: function() {},

            _startRecord: function(options) {},

            _stopRecord: function() {},

            _error: function(errorType, errorData) {
                this.trigger("error", errorType, errorData);
            },

            getVolumeGain: function() {},

            setVolumeGain: function(volumeGain) {},

            _dataAvailable: function(videoBlob, audioBlob, noUploading) {
                if (this.destroyed())
                    return;
                this.trigger("data", videoBlob, audioBlob, noUploading);
            },

            destroy: function() {
                this.stopRecord();
                this.unbindMedia();
                inherited.destroy.call(this);
            },

            averageFrameRate: function() {
                return null;
            }

        };
    }], {

        _initializeOptions: function(options) {
            return Objs.extend({
                // video: null,
                recordAudio: true,
                recordVideo: true,
                recordResolution: {
                    width: 320,
                    height: 200
                }
            }, options);
        },

        supported: function(options) {
            return !!Support.globals().getUserMedia && !!Support.globals().URL;
        }

    });
});

Scoped.define("module:AudioRecorder.WebRTCAudioRecorderWrapper", ["module:AudioRecorder.AudioRecorderWrapper","module:WebRTC.RecorderWrapper","module:WebRTC.Support","module:WebRTC.AudioAnalyser","browser:Dom","browser:Info","base:Time","base:Objs","browser:Upload.FileUploader","browser:Upload.MultiUploader","base:Promise"], function (AudioRecorderWrapper, RecorderWrapper, Support, AudioAnalyser, Dom, Info, Time, Objs, FileUploader, MultiUploader, Promise, scoped) {
    return AudioRecorderWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                if (this._element.tagName.toLowerCase() !== "audio")
                    this._element = Dom.changeTag(this._element, "audio");
                this._recorder = RecorderWrapper.create({
                    video: this._element,
                    recordVideo: false,
                    recordAudio: this._options.recordAudio,
                    audioBitrate: this._options.audioBitrate,
                    webrtcStreaming: this._options.webrtcStreaming,
                    webrtcStreamingIfNecessary: this._options.webrtcStreamingIfNecessary,
                    localPlaybackRequested: this._options.localPlaybackRequested
                });
                this._recorder.on("bound", function() {
                    if (this._analyser)
                        this.testSoundLevel(true);
                }, this);
                this._recorder.on("error", function(errorName, errorData) {
                    this.trigger("error", errorName, errorData);
                }, this);
                this.ready.asyncSuccess(true);
            },

            destroy: function() {
                if (this._analyser)
                    this._analyser.weakDestroy();
                this._recorder.destroy();
                inherited.destroy.call(this);
            },

            recordDelay: function(opts) {
                return this._recorder.recordDelay(opts);
            },

            _bindMedia: function() {
                return this._recorder.bindMedia();
            },

            _unbindMedia: function() {
                return this._recorder.unbindMedia();
            },

            getVolumeGain: function() {
                return this._recorder.getVolumeGain();
            },

            setVolumeGain: function(volumeGain) {
                this._recorder.setVolumeGain(volumeGain);
            },

            soundLevel: function() {
                if (!this._analyser && this._recorder && this._recorder.stream())
                    this._analyser = new AudioAnalyser(this._recorder.stream());
                return this._analyser ? this._analyser.soundLevel() : 0.0;
            },

            testSoundLevel: function(activate) {
                if (this._analyser) {
                    this._analyser.weakDestroy();
                    delete this._analyser;
                }
                if (activate)
                    this._analyser = new AudioAnalyser(this._recorder.stream());
            },

            currentDevices: function() {
                return {
                    audio: this._currentAudio
                };
            },

            enumerateDevices: function() {
                return Support.enumerateMediaSources().success(function(result) {
                    if (!this._currentAudio)
                        this._currentAudio = Objs.ithKey(result.audio);
                }, this);
            },

            setCurrentDevices: function(devices) {
                if (devices && devices.audio)
                    this._recorder.selectMicrophone(devices.audio);
            },

            startRecord: function(options) {
                this.__localPlaybackSource = null;
                return this._recorder.startRecord(options);
            },

            stopRecord: function(options) {
                var promise = Promise.create();
                this._recorder.once("data", function(videoBlob, audioBlob, noUploading) {
                    this.__localPlaybackSource = {
                        src: audioBlob || videoBlob
                    };
                    var multiUploader = new MultiUploader();
                    if (!this._options.simulate && !noUploading) {
                        if (videoBlob) {
                            multiUploader.addUploader(FileUploader.create(Objs.extend({
                                source: audioBlob || videoBlob
                            }, options.audio)));
                        }
                    }
                    promise.asyncSuccess(multiUploader);
                }, this);
                this._recorder.stopRecord();
                return promise;
            },

            supportsLocalPlayback: function() {
                return !!this.__localPlaybackSource.src;
            },

            localPlaybackSource: function() {
                return this.__localPlaybackSource;
            },

            _softwareDependencies: function() {
                return Promise.value(true);
            }

        };
    }, {

        supported: function(options) {
            if (options.forceflash)
                return false;
            if (!RecorderWrapper.anySupport(options))
                return false;
            return true;
        }

    });
});

Scoped.extend("module:AudioRecorder.AudioRecorderWrapper", ["module:AudioRecorder.AudioRecorderWrapper","module:AudioRecorder.WebRTCAudioRecorderWrapper"], function (AudioRecorderWrapper, WebRTCAudioRecorderWrapper) {
    AudioRecorderWrapper.register(WebRTCAudioRecorderWrapper, 2);
    return {};
});

Scoped.define("module:ImageRecorder.WebRTCImageRecorderWrapper", ["module:ImageRecorder.ImageRecorderWrapper","module:WebRTC.RecorderWrapper","module:WebRTC.Support","browser:Dom","browser:Info","base:Time","base:Objs","browser:Upload.FileUploader","browser:Upload.MultiUploader","base:Promise"], function (ImageRecorderWrapper, RecorderWrapper, Support, Dom, Info, Time, Objs, FileUploader, MultiUploader, Promise, scoped) {
    return ImageRecorderWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                if (this._element.tagName.toLowerCase() !== "video")
                    this._element = Dom.changeTag(this._element, "video");
                this._recorder = RecorderWrapper.create({
                    video: this._element,
                    flip: !!this._options.flip,
                    recordVideo: true,
                    recordAudio: false,
                    recordResolution: {
                        width: this._options.recordingWidth,
                        height: this._options.recordingHeight
                    },
                    videoBitrate: this._options.videoBitrate,
                    screen: this._options.screen
                });
                this._recorder.on("error", function(errorName, errorData) {
                    this.trigger("error", errorName, errorData);
                }, this);
                this.ready.asyncSuccess(true);
            },

            destroy: function() {
                this._recorder.destroy();
                inherited.destroy.call(this);
            },

            _bindMedia: function() {
                return this._recorder.bindMedia();
            },

            _unbindMedia: function() {
                return this._recorder.unbindMedia();
            },

            lightLevel: function() {
                return this._recorder.lightLevel();
            },

            blankLevel: function() {
                return this._recorder.blankLevel();
            },

            deltaCoefficient: function() {
                return this._recorder.deltaCoefficient();
            },

            currentDevices: function() {
                return {
                    video: this._currentVideo
                };
            },

            enumerateDevices: function() {
                return Support.enumerateMediaSources().success(function(result) {
                    if (!this._currentVideo)
                        this._currentVideo = Objs.ithKey(result.video);
                }, this);
            },

            setCurrentDevices: function(devices) {
                if (devices && devices.video)
                    this._recorder.selectCamera(devices.video);
            },

            createSnapshot: function(type) {
                return this._recorder.createSnapshot(type);
            },

            removeSnapshot: function(snapshot) {},

            createSnapshotDisplay: function(parent, snapshot, x, y, w, h) {
                var url = Support.globals().URL.createObjectURL(snapshot);
                var image = document.createElement("img");
                image.style.position = "absolute";
                this.updateSnapshotDisplay(snapshot, image, x, y, w, h);
                image.src = url;
                Dom.elementPrependChild(parent, image);
                return image;
            },

            updateSnapshotDisplay: function(snapshot, image, x, y, w, h) {
                image.style.left = x + "px";
                image.style.top = y + "px";
                image.style.width = w + "px";
                image.style.height = h + "px";
            },

            removeSnapshotDisplay: function(image) {
                image.remove();
            },

            createSnapshotUploader: function(snapshot, type, uploaderOptions) {
                return FileUploader.create(Objs.extend({
                    source: snapshot
                }, uploaderOptions));
            },

            snapshotToLocalPoster: function(snapshot) {
                return snapshot;
            },

            _softwareDependencies: function() {
                if (!this._options.screen || Support.globals().supportedConstraints.mediaSource)
                    return Promise.value(true);
                var ext = Support.chromeExtensionExtract(this._options.screen);
                var err = [{
                    title: "Screen Recorder Extension",
                    execute: function() {
                        window.open(ext.extensionInstallLink);
                    }
                }];
                var pingTest = Time.now();
                return Support.chromeExtensionMessage(ext.extensionId, {
                    type: "ping",
                    data: pingTest
                }).mapError(function() {
                    return err;
                }).mapSuccess(function(pingResponse) {
                    if (pingResponse && pingResponse.type === "success" && pingResponse.data === pingTest)
                        return true;
                    return Promise.error(err);
                });
            }

        };
    }, {

        supported: function(options) {
            if (options.forceflash)
                return false;
            if (!RecorderWrapper.anySupport(options))
                return false;
            if (options.screen) {
                if (Support.globals().supportedConstraints.mediaSource && Info.isFirefox() && Info.firefoxVersion() > 55)
                    return true;
                if (Info.isChrome() && options.screen.chromeExtensionId)
                    return true;
                if (Info.isOpera() && options.screen.operaExtensionId)
                    return true;
                return false;
            }
            return true;
        }

    });
});

Scoped.extend("module:ImageRecorder.ImageRecorderWrapper", ["module:ImageRecorder.ImageRecorderWrapper","module:ImageRecorder.WebRTCImageRecorderWrapper"], function (ImageRecorderWrapper, WebRTCImageRecorderWrapper) {
    ImageRecorderWrapper.register(WebRTCImageRecorderWrapper, 2);
    return {};
});

Scoped.define("module:Recorder.WebRTCVideoRecorderWrapper", ["module:Recorder.VideoRecorderWrapper","module:WebRTC.RecorderWrapper","module:WebRTC.Support","module:WebRTC.AudioAnalyser","browser:Dom","browser:Info","base:Time","base:Objs","browser:Upload.FileUploader","browser:Upload.MultiUploader","base:Promise"], function (VideoRecorderWrapper, RecorderWrapper, Support, AudioAnalyser, Dom, Info, Time, Objs, FileUploader, MultiUploader, Promise, scoped) {
    return VideoRecorderWrapper.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this, options);
                if (this._element.tagName.toLowerCase() !== "video")
                    this._element = Dom.changeTag(this._element, "video");
                this._recorder = RecorderWrapper.create({
                    video: this._element,
                    flip: !!this._options.flip,
                    framerate: this._options.framerate,
                    recordVideo: this._options.recordVideo,
                    recordAudio: this._options.recordAudio,
                    recordResolution: {
                        width: this._options.recordingWidth,
                        height: this._options.recordingHeight
                    },
                    videoBitrate: this._options.videoBitrate,
                    audioBitrate: this._options.audioBitrate,
                    webrtcStreaming: this._options.webrtcStreaming,
                    webrtcStreamingIfNecessary: this._options.webrtcStreamingIfNecessary,
                    localPlaybackRequested: this._options.localPlaybackRequested,
                    screen: this._options.screen
                });
                this._recorder.on("bound", function() {
                    if (this._analyser)
                        this.testSoundLevel(true);
                }, this);
                this._recorder.on("error", function(errorName, errorData) {
                    this.trigger("error", errorName, errorData);
                }, this);
                this.ready.asyncSuccess(true);
            },

            destroy: function() {
                if (this._analyser)
                    this._analyser.weakDestroy();
                this._recorder.destroy();
                inherited.destroy.call(this);
            },

            recordDelay: function(opts) {
                return this._recorder.recordDelay(opts);
            },

            _bindMedia: function() {
                return this._recorder.bindMedia();
            },

            _unbindMedia: function() {
                return this._recorder.unbindMedia();
            },

            lightLevel: function() {
                return this._recorder.lightLevel();
            },

            blankLevel: function() {
                return this._recorder.blankLevel();
            },

            getVolumeGain: function() {
                return this._recorder.getVolumeGain();
            },

            setVolumeGain: function(volumeGain) {
                this._recorder.setVolumeGain(volumeGain);
            },

            deltaCoefficient: function() {
                return this._recorder.deltaCoefficient();
            },

            soundLevel: function() {
                if (!this._analyser && this._recorder && this._recorder.stream() && AudioAnalyser.supported())
                    this._analyser = new AudioAnalyser(this._recorder.stream());
                return this._analyser ? this._analyser.soundLevel() : 0.0;
            },

            testSoundLevel: function(activate) {
                if (this._analyser) {
                    this._analyser.weakDestroy();
                    delete this._analyser;
                }
                if (activate && AudioAnalyser.supported())
                    this._analyser = new AudioAnalyser(this._recorder.stream());
            },

            currentDevices: function() {
                return {
                    video: this._currentVideo,
                    audio: this._currentAudio
                };
            },

            enumerateDevices: function() {
                return Support.enumerateMediaSources().success(function(result) {
                    if (!this._currentVideo)
                        this._currentVideo = Objs.ithKey(result.video);
                    if (!this._currentAudio)
                        this._currentAudio = Objs.ithKey(result.audio);
                }, this);
            },

            setCurrentDevices: function(devices) {
                if (devices && devices.video)
                    this._recorder.selectCamera(devices.video);
                if (devices && devices.audio)
                    this._recorder.selectMicrophone(devices.audio);
            },

            setCameraFace: function(faceFront) {
                if (Info.isMobile())
                    this._recorder.selectCameraFace(faceFront);
            },

            createSnapshot: function(type) {
                return this._recorder.createSnapshot(type);
            },

            removeSnapshot: function(snapshot) {},

            createSnapshotDisplay: function(parent, snapshot, x, y, w, h) {
                var url = Support.globals().URL.createObjectURL(snapshot);
                var image = document.createElement("img");
                image.style.position = "absolute";
                this.updateSnapshotDisplay(snapshot, image, x, y, w, h);
                image.src = url;
                if (parent.tagName.toLowerCase() === "video")
                    Dom.elementInsertAfter(image, parent);
                else
                    Dom.elementPrependChild(parent, image);
                return image;
            },

            updateSnapshotDisplay: function(snapshot, image, x, y, w, h) {
                image.style.left = x + "px";
                image.style.top = y + "px";
                image.style.width = w + "px";
                image.style.height = h + "px";
            },

            removeSnapshotDisplay: function(image) {
                image.remove();
            },

            createSnapshotUploader: function(snapshot, type, uploaderOptions) {
                return FileUploader.create(Objs.extend({
                    source: snapshot
                }, uploaderOptions));
            },

            startRecord: function(options) {
                this.__localPlaybackSource = null;
                return this._recorder.startRecord(options);
            },

            stopRecord: function(options) {
                var promise = Promise.create();
                this._recorder.once("data", function(videoBlob, audioBlob, noUploading) {
                    this.__localPlaybackSource = {
                        src: videoBlob,
                        audiosrc: audioBlob
                    };
                    var multiUploader = new MultiUploader();
                    if (!this._options.simulate && !noUploading) {
                        if (videoBlob) {
                            multiUploader.addUploader(FileUploader.create(Objs.extend({
                                source: videoBlob
                            }, options.video)));
                        }
                        if (audioBlob) {
                            multiUploader.addUploader(FileUploader.create(Objs.extend({
                                source: audioBlob
                            }, options.audio)));
                        }
                    }
                    promise.asyncSuccess(multiUploader);
                }, this);
                this._recorder.stopRecord();
                return promise;
            },

            supportsLocalPlayback: function() {
                return !!this.__localPlaybackSource.src;
            },

            supportsCameraFace: function() {
                return Info.isMobile();
            },

            snapshotToLocalPoster: function(snapshot) {
                return snapshot;
            },

            localPlaybackSource: function() {
                return this.__localPlaybackSource;
            },

            averageFrameRate: function() {
                return this._recorder.averageFrameRate();
            },

            _softwareDependencies: function() {
                if (!this._options.screen || Support.globals().supportedConstraints.mediaSource)
                    return Promise.value(true);
                var ext = Support.chromeExtensionExtract(this._options.screen);
                var err = [{
                    title: "Screen Recorder Extension",
                    execute: function() {
                        window.open(ext.extensionInstallLink);
                    }
                }];
                var pingTest = Time.now();
                return Support.chromeExtensionMessage(ext.extensionId, {
                    type: "ping",
                    data: pingTest
                }).mapError(function() {
                    return err;
                }).mapSuccess(function(pingResponse) {
                    if (pingResponse && pingResponse.type === "success" && pingResponse.data === pingTest)
                        return true;
                    return Promise.error(err);
                });
            }

        };
    }, {

        supported: function(options) {
            if (options.forceflash)
                return false;
            if (!RecorderWrapper.anySupport(options))
                return false;
            if (options.screen) {
                if (Support.globals().supportedConstraints.mediaSource && Info.isFirefox() && Info.firefoxVersion() > 55)
                    return true;
                if (Info.isChrome() && options.screen.chromeExtensionId)
                    return true;
                if (Info.isOpera() && options.screen.operaExtensionId)
                    return true;
                return false;
            }
            return true;
        }

    });
});

Scoped.extend("module:Recorder.WebRTCVideoRecorderWrapper", ["module:Recorder.VideoRecorderWrapper","module:Recorder.WebRTCVideoRecorderWrapper"], function (VideoRecorderWrapper, WebRTCVideoRecorderWrapper) {
    VideoRecorderWrapper.register(WebRTCVideoRecorderWrapper, 2);
    return {};
});

Scoped.define("module:WebRTC.PeerRecorderWrapper", ["module:WebRTC.RecorderWrapper","module:WebRTC.PeerRecorder","module:WebRTC.MediaRecorder","browser:Info","base:Async"], function (RecorderWrapper, PeerRecorder, MediaRecorder, Info, Async, scoped) {
    return RecorderWrapper.extend({
        scoped: scoped
    }, {

        _boundMedia: function() {
            this._recorder = new PeerRecorder(this._stream, {
                recorderWidth: this._options.recordResolution.width,
                recorderHeight: this._options.recordResolution.height,
                videoBitrate: this._options.videoBitrate,
                audioBitrate: this._options.audioBitrate,
                audioonly: !this._options.recordVideo
            });
            if (this._localPlaybackRequested && MediaRecorder.supported())
                this.__localMediaRecorder = new MediaRecorder(this._stream);
            this._recorder.on("error", this._error, this);
        },

        _unboundMedia: function() {
            this._recorder.destroy();
            if (this.__localMediaRecorder)
                this.__localMediaRecorder.weakDestroy();
        },

        _startRecord: function(options) {
            if (this.__localMediaRecorder)
                this.__localMediaRecorder.start();
            return this._recorder.start(options.webrtcStreaming);
        },

        _stopRecord: function() {
            this._recorder.stop();
            var localBlob = null;
            if (this.__localMediaRecorder) {
                this.__localMediaRecorder.once("data", function(blob) {
                    localBlob = blob;
                });
                this.__localMediaRecorder.stop();
            }
            Async.eventually(function() {
                this._dataAvailable(localBlob, null, true);
            }, this, this.__stopDelay || this._options.webrtcStreaming.stopDelay || 0);
        },

        recordDelay: function(opts) {
            this.__stopDelay = opts.webrtcStreaming.stopDelay;
            return opts.webrtcStreaming.delay || 0;
        },

        getVolumeGain: function() {},

        setVolumeGain: function(volumeGain) {},

        averageFrameRate: function() {
            return null;
        }

    }, function(inherited) {
        return {

            supported: function(options) {
                if (!inherited.supported.call(this, options))
                    return false;
                /*
                if (!options.recordVideo)
                    return false;
                    */
                if (options.screen && Info.isFirefox())
                    return false;
                return options.webrtcStreaming && PeerRecorder.supported() && !options.webrtcStreamingIfNecessary;
            }

        };
    });
});

Scoped.define("module:WebRTC.PeerRecorderWrapperIfNecessary", ["module:WebRTC.PeerRecorderWrapper","base:Objs"], function (PeerRecorderWrapper, Objs, scoped) {
    return PeerRecorderWrapper.extend({
        scoped: scoped
    }, {}, function(inherited) {
        return {

            supported: function(options) {
                options = Objs.clone(options, 1);
                delete options.webrtcStreamingIfNecessary;
                return inherited.supported.call(this, options);
            }

        };
    });
});

Scoped.define("module:WebRTC.MediaRecorderWrapper", ["module:WebRTC.RecorderWrapper","module:WebRTC.MediaRecorder"], function (RecorderWrapper, MediaRecorder, scoped) {
    return RecorderWrapper.extend({
        scoped: scoped
    }, {

        _boundMedia: function() {
            this._recorder = new MediaRecorder(this._stream, {
                videoBitrate: this._options.videoBitrate,
                audioBitrate: this._options.audioBitrate,
                audioonly: !this._options.recordVideo
            });
            this._recorder.on("data", function(blob) {
                this._dataAvailable(blob);
            }, this);
        },

        _unboundMedia: function() {
            this._recorder.destroy();
        },

        _startRecord: function() {
            return this._recorder.start();
        },

        _stopRecord: function() {
            this._recorder.stop();
        },

        getVolumeGain: function() {},

        setVolumeGain: function(volumeGain) {},

        averageFrameRate: function() {
            return null;
        }

    }, function(inherited) {
        return {

            supported: function(options) {
                if (!inherited.supported.call(this, options))
                    return false;
                /*
                if (!options.recordVideo)
                    return false;
                    */
                return MediaRecorder.supported();
            }

        };
    });
});

Scoped.define("module:WebRTC.WhammyRecorder", ["base:Class","base:Events.EventsMixin","base:Objs","base:Time","base:Functions","base:Promise","base:Async","module:WebRTC.Support","module:Encoding.WebmEncoder.Support"], function (Class, EventsMixin, Objs, Time, Functions, Promise, Async, Support, WebmSupport, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {

        var CLUSTER_MAX_DURATION = 30000;
        var NO_STREAM_WIDTH = 40;
        var NO_STREAM_HEIGHT = 30;
        var NO_STREAM_WEBP = "data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAADwAgCdASooAB4APpFGnkslo6KhpWgAsBIJaQAAKUNt8AD++E0AAAAA";

        return {

            constructor: function(stream, options) {
                inherited.constructor.call(this);
                this._stream = stream;
                this._options = Objs.extend({
                    recordWidth: 320,
                    recordHeight: 240,
                    quality: undefined,
                    video: null,
                    framerate: null
                }, options);
                this._started = false;
            },

            destroy: function() {
                this._started = false;
                this.trigger("stopped");
                inherited.destroy.call(this);
            },

            start: function() {
                if (this._started)
                    return Promise.value(true);
                this._started = true;
                if (this._options.video) {
                    this._options.recordWidth = this._options.video.videoWidth || this._options.video.clientWidth;
                    this._options.recordHeight = this._options.video.videoHeight || this._options.video.clientHeight;
                }
                this._video = document.createElement('video');
                this._video.width = this._options.recordWidth || NO_STREAM_WIDTH;
                this._video.height = this._options.recordHeight || NO_STREAM_HEIGHT;
                if (this._stream)
                    Support.bindStreamToVideo(this._stream, this._video);
                this._canvas = document.createElement('canvas');
                this._canvas.width = this._options.recordWidth || NO_STREAM_WIDTH;
                this._canvas.height = this._options.recordHeight || NO_STREAM_HEIGHT;
                this._context = this._canvas.getContext('2d');
                this._frames = [];
                //this._isOnStartedDrawingNonBlankFramesInvoked = false;
                this._lastTime = Time.now();
                this._startTime = this._lastTime;
                this.trigger("started");
                Async.eventually(this._process, [], this);
                return Promise.value(true);
            },

            stop: function() {
                if (!this._started)
                    return;
                this._started = false;
                this.trigger("stopped");
                this._generateData();
            },

            _process: function() {
                if (!this._started)
                    return;
                var now = Time.now();
                var duration = now - this._lastTime;
                this._lastTime = now;
                this._context.drawImage(this._video, 0, 0, this._canvas.width, this._canvas.height);
                this._frames.push({
                    duration: duration,
                    image: this._stream ? this._canvas.toDataURL('image/webp', this._options.quality) : NO_STREAM_WEBP
                });
                /*
		        if (!this._isOnStartedDrawingNonBlankFramesInvoked && !WebmSupport.isBlankFrame(this._canvas, this._frames[this._frames.length - 1])) {
		            this._isOnStartedDrawingNonBlankFramesInvoked = true;
		            this.trigger("onStartedDrawingNonBlankFrames");
		        }
		        */
                var maxTime = this._options.framerate ? 1000 / this._options.framerate : 10;
                Async.eventually(this._process, [], this, Math.max(1, maxTime - (Time.now() - now)));
            },

            averageFrameRate: function() {
                return this._frames.length > 0 ? (this._frames.length / (Time.now() - this._startTime) * 1000) : null;
            },

            _generateData: function() {
                if (!this._frames.length)
                    return;
                this._data = this.__compile(this._stream ? this.__dropBlackFrames(this._canvas, this._frames) : this._frames);
                this.trigger("data", this._data);
            },

            __compile: function(frames) {
                var totalDuration = 0;
                var width = null;
                var height = null;
                var clusters = [];

                var clusterTimecode = 0;

                var clusterFrames = null;
                var clusterDuration = null;

                frames.forEach(function(frame) {
                    if (!clusterFrames) {
                        clusterFrames = [];
                        clusterDuration = 0;
                    }

                    var webp = WebmSupport.parseWebP(WebmSupport.parseRIFF(atob(frame.image.slice(23))));

                    clusterFrames.push(WebmSupport.serializeEBML(WebmSupport.makeTimecodeDataBlock(webp.data, clusterDuration)));

                    clusterDuration += frame.duration;
                    totalDuration += frame.duration;
                    width = width || webp.width;
                    height = height || webp.height;

                    if (clusterDuration >= CLUSTER_MAX_DURATION) {
                        clusters.push(WebmSupport.serializeEBML(WebmSupport.makeCluster(clusterFrames, clusterTimecode)));
                        clusterTimecode = totalDuration;
                        clusterFrames = null;
                        clusterDuration = 0;
                    }
                }, this);

                if (clusterFrames)
                    clusters.push(WebmSupport.serializeEBML(WebmSupport.makeCluster(clusterFrames, clusterTimecode)));

                var EBML = WebmSupport.generateEBMLHeader(totalDuration, width, height);
                EBML[1].data = EBML[1].data.concat(clusters);
                return WebmSupport.serializeEBML(EBML);
            },

            __dropBlackFrames: function(canvas, _frames, _pixTolerance, _frameTolerance) {
                var idx = 0;
                while (idx < _frames.length) {
                    if (!WebmSupport.isBlankFrame(canvas, _frames[idx], _pixTolerance, _frameTolerance))
                        break;
                    idx++;
                }
                return _frames.slice(idx);
            },

            createSnapshot: function(type) {
                this._context.drawImage(this._video, 0, 0, this._canvas.width, this._canvas.height);
                return this._canvas.toDataURL(type);
            }

        };
    }], {

        supported: function(nostream) {
            return nostream || Support.globals().webpSupport;
        }

    });
});

Scoped.define("module:WebRTC.WhammyAudioRecorderWrapper", ["module:WebRTC.RecorderWrapper","module:WebRTC.AudioRecorder","module:WebRTC.WhammyRecorder","browser:Info","base:Promise"], function (RecorderWrapper, AudioRecorder, WhammyRecorder, Info, Promise, scoped) {
    return RecorderWrapper.extend({
        scoped: scoped
    }, {
        /*
        		_getConstraints: function () {
        			return {
        				audio: this._options.recordAudio,
        				video: this._options.recordVideo
        			}
        		},
        */
        _createSnapshot: function(type) {
            return this._whammyRecorder.createSnapshot(type);
        },

        _boundMedia: function() {
            this._videoBlob = null;
            this._audioBlob = null;
            if (this._hasVideo) {
                this._whammyRecorder = new WhammyRecorder(this._stream, {
                    //recorderWidth: this._options.recordResolution.width,
                    //recorderHeight: this._options.recordResolution.height,
                    video: this._video,
                    framerate: this._options.framerate
                });
            } else {
                this._whammyRecorder = new WhammyRecorder(null, {
                    framerate: this._options.framerate
                });
            }
            if (this._hasAudio) {
                this._audioRecorder = new AudioRecorder(this._stream);
                this._audioRecorder.on("data", function(blob) {
                    this._audioBlob = blob;
                    if (this._videoBlob || !this._hasVideo)
                        this._dataAvailable(this._videoBlob, this._audioBlob);
                }, this);
            }
            //if (this._hasVideo) {
            this._whammyRecorder.on("data", function(blob) {
                this._videoBlob = blob;
                if (this._audioBlob || !this._hasAudio)
                    this._dataAvailable(this._videoBlob, this._audioBlob);
            }, this);
            //}
            /*
            this._whammyRecorder.on("onStartedDrawingNonBlankFrames", function () {
            	if (this._recording)
            		this._audioRecorder.start();
            }, this);
            */
        },

        _unboundMedia: function() {
            if (this._hasAudio)
                this._audioRecorder.destroy();
            //if (this._hasVideo)
            this._whammyRecorder.destroy();
        },

        _startRecord: function() {
            var promises = [];
            //if (this._hasVideo)
            promises.push(this._whammyRecorder.start());
            if (this._hasAudio)
                promises.push(this._audioRecorder.start());
            return Promise.and(promises);
        },

        _stopRecord: function() {
            //if (this._hasVideo)
            this._whammyRecorder.stop();
            if (this._hasAudio)
                this._audioRecorder.stop();
        },

        getVolumeGain: function() {
            return this._audioRecorder ? this._audioRecorder.getVolumeGain() : 1.0;
        },

        setVolumeGain: function(volumeGain) {
            if (this._audioRecorder)
                this._audioRecorder.setVolumeGain(volumeGain);
        },

        averageFrameRate: function() {
            return this._whammyRecorder.averageFrameRate();
            //return this._hasVideo ? this._whammyRecorder.averageFrameRate() : 0;
        }


    }, function(inherited) {
        return {

            supported: function(options) {
                if (!inherited.supported.call(this, options))
                    return false;
                if (document.location.href.indexOf("https://") !== 0 && document.location.hostname !== "localhost") {
                    if (Info.isChrome() && Info.chromeVersion() >= 47)
                        return false;
                    if (Info.isOpera() && Info.operaVersion() >= 34)
                        return false;
                }
                return AudioRecorder.supported() && WhammyRecorder.supported(!options.recordVideo);
            }

        };
    });
});

Scoped.extend("module:WebRTC.RecorderWrapper", ["module:WebRTC.RecorderWrapper","module:WebRTC.PeerRecorderWrapper","module:WebRTC.MediaRecorderWrapper","module:WebRTC.WhammyAudioRecorderWrapper","module:WebRTC.PeerRecorderWrapperIfNecessary"], function (RecorderWrapper, PeerRecorderWrapper, MediaRecorderWrapper, WhammyAudioRecorderWrapper, PeerRecorderWrapperIfNecessary) {
    RecorderWrapper.register(PeerRecorderWrapper, 4);
    RecorderWrapper.register(MediaRecorderWrapper, 3);
    RecorderWrapper.register(WhammyAudioRecorderWrapper, 2);
    RecorderWrapper.register(PeerRecorderWrapperIfNecessary, 1);
    return {};
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('base', 'root:BetaJS');
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('module', 'root:BetaJS.Dynamics');
Scoped.define("module:Data.ScopeManager", ["base:Class","base:Trees.TreeNavigator","base:Classes.ObjectIdScopeMixin","base:Trees.TreeQueryEngine"], function (Class, TreeNavigator, ObjectIdScopeMixin, TreeQueryEngine, scoped) {
    return Class.extend({
        scoped: scoped
    }, [TreeNavigator, ObjectIdScopeMixin, function(inherited) {
        return {

            constructor: function(root) {
                inherited.constructor.call(this);
                this.__root = root;
                this.__watchers = [];
                this.__query = this._auto_destroy(new TreeQueryEngine(this));
            },

            nodeRoot: function() {
                return this.__root;
            },

            nodeId: function(node) {
                return node.cid();
            },

            nodeParent: function(node) {
                return node.__parent;
            },

            nodeChildren: function(node) {
                return node.__children;
            },

            nodeData: function(node) {
                return node.data();
            },

            nodeWatch: function(node, func, context) {
                node.on("data", function() {
                    func.call(context, "data");
                }, context);
                node.on("add", function(child) {
                    func.call(context, "addChild", child);
                }, context);
                node.on("destroy", function() {
                    func.call(context, "remove");
                }, context);
            },

            nodeUnwatch: function(node, func, context) {
                node.off(null, null, context);
            },

            query: function(scope, query) {
                return this.__query.query(scope, query);
            }

        };
    }]);
});

Scoped.define("module:Data.AbstractMultiScope", ["base:Class","base:Events.EventsMixin","base:Events.ListenMixin"], function (Class, EventsMixin, ListenMixin, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, ListenMixin, function(inherited) {
        return {

            constructor: function() {
                inherited.constructor.call(this);
                var iter = this.iterator();
                while (iter.hasNext())
                    this.delegateEvents(null, iter.next());
            },

            destroy: function() {
                var iter = this.iterator();
                while (iter.hasNext())
                    iter.next().off(null, null, this);
                inherited.destroy.call(this);
            },

            set: function(key, value) {
                var iter = this.iterator();
                while (iter.hasNext())
                    iter.next().set(key, value);
                return this;
            },

            get: function(key) {
                var iter = this.iterator();
                return iter.hasNext() ? iter.next().get(key) : null;
            },

            setProp: function(key, value) {
                var iter = this.iterator();
                while (iter.hasNext())
                    iter.next().setProp(key, value);
                return this;
            },

            getProp: function(key) {
                var iter = this.iterator();
                return iter.hasNext() ? iter.next().getProp(key) : null;
            },

            define: function(name, func) {
                var iter = this.iterator();
                while (iter.hasNext())
                    iter.next().define(name, func);
                return this;
            },

            /* Deprecated */
            call: function(name) {
                return this.execute.apply(this, arguments);
            },

            execute: function(name) {
                var iter = this.iterator();
                var result = null;
                while (iter.hasNext()) {
                    var obj = iter.next();
                    var local = obj.execute.apply(obj, arguments);
                    result = result || local;
                }
                return result;
            },

            materialize: function(returnFirst) {
                return returnFirst ? this.iterator().next() : this.iterator().asArray();
            },

            iterator: function() {
                throw "Abstract";
            },

            _addScope: function(scope) {
                this.delegateEvents(null, scope);
                this.trigger("addscope", scope);
                return this;
            },

            _removeScope: function(scope) {
                scope.off(null, null, this);
                this.trigger("removescope", scope);
                return this;
            }

        };
    }]);
});

Scoped.define("module:Data.MultiScope", ["module:Data.AbstractMultiScope","base:Iterators.ArrayIterator"], function (Class, ArrayIterator, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(owner, base, query) {
                this.__owner = owner;
                this.__base = base;
                this.__queryStr = query;
                this.__query = this.auto_destroy(this.__owner.__manager.query(this.__owner, query));
                inherited.constructor.call(this);
                this.__query.on("add", this._addScope, this);
                this.__query.on("remove", this._removeScope, this);
            },

            iterator: function() {
                return new ArrayIterator(this.__query.result());
            },

            parent: function() {
                return this.__owner.scope(this.__base, this.__queryStr + "<");
            },

            root: function() {
                return this.__owner.root();
            },

            children: function() {
                return this.__owner.scope(this.__base, this.__queryStr + ">");
            },

            scope: function(base, query) {
                if (arguments.length < 2) {
                    query = this.__queryStr + base;
                    base = this.__base;
                }
                return this.__owner.scope(base, query);
            },

            freeze: function() {
                this.__query.off("add", null, this);
            }

        };
    });
});

Scoped.define("module:Data.ManualMultiScope", ["module:Data.AbstractMultiScope"], function (Class, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(iteratorCallback, iteratorContext) {
                this.__iteratorCallback = iteratorCallback;
                this.__iteratorContext = iteratorContext;
                inherited.constructor.call(this);
            },

            iterator: function() {
                return this.__iteratorCallback.call(this.__iteratorContext);
            },

            addScope: function(scope) {
                return this._addScope(scope);
            },

            removeScope: function(scope) {
                return this._removeScope(scope);
            }

        };
    });
});

Scoped.define("module:Data.Friendgroup", ["base:Class","base:Types","base:Objs","base:Iterators.ObjectValuesIterator","module:Data.ManualMultiScope"], function (Class, Types, Objs, ObjectValuesIterator, ManualMultiScope, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(parent) {
                inherited.constructor.call(this);
                this.parent = parent;
                this._registeredScopes = {};
                this._watchScopes = {};
            },

            destroy: function() {
                Objs.iter(this._watchScopes, function(m) {
                    m.weakDestroy();
                });
                inherited.destroy.call(this);
            },

            registerScope: function(scope, identifier) {
                this._registeredScopes[identifier] = this._registeredScopes[identifier] || {};
                this._registeredScopes[identifier][scope.cid()] = scope;
            },

            unregisterScope: function(scope, identifier) {
                delete this._registeredScopes[identifier][scope.cid()];
                if (Types.is_empty(this._registeredScopes[identifier]))
                    delete this._registeredScopes[identifier];
            },

            watchScope: function(reference, identifier) {
                if (!this._watchScopes[identifier]) {
                    this._watchScopes[identifier] = new ManualMultiScope(function() {
                        return this.iterateScopes(identifier);
                    }, this);
                }
                this._watchScopes[identifier].increaseRef(reference);
                return this._watchScopes[identifier];
            },

            unwatchScope: function(reference, identifier) {
                if (this._watchScopes[identifier]) {
                    this._watchScopes[identifier].decreaseRef(reference);
                    if (this._watchScopes[identifier].destroyed())
                        delete this._watchScopes[identifier];
                }
                return this;
            },

            iterateScopes: function(identifier) {
                return this._registeredScopes[identifier] || !this.parent ?
                    new ObjectValuesIterator(this._registeredScopes[identifier] || {}) :
                    this.parent.iterateScopes(identifier);
            }

        };
    });
});

Scoped.define("module:Data.Scope", ["base:Class","base:Events.EventsMixin","base:Events.ListenMixin","base:Classes.ObjectIdMixin","base:Functions","base:Types","base:Strings","base:Objs","base:Ids","base:Properties.Properties","base:Collections.Collection","base:Events.Events","module:Data.ScopeManager","module:Data.MultiScope","module:Data.Friendgroup"], function (Class, EventsMixin, ListenMixin, ObjectIdMixin, Functions, Types, Strings, Objs, Ids, Properties, Collection, Events, ScopeManager, MultiScope, Friendgroup, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, ListenMixin, ObjectIdMixin, function(inherited) {
        return {

            constructor: function(options) {
                options = Objs.extend({
                    functions: {},
                    data: {},
                    parent: null,
                    scopes: {},
                    bind: {},
                    attrs: {},
                    extendables: [],
                    collections: {},
                    computed: {},
                    events: {},
                    channels: {},
                    registerchannels: [],
                    friends: {}
                }, options);
                if (options.bindings)
                    options.bind = Objs.extend(options.bind, options.bindings);
                this._channels = {};
                this.__channelCache = {};
                var parent = options.parent;
                this.__manager = parent ? parent.__manager : this._auto_destroy(new ScopeManager(this));
                inherited.constructor.call(this);
                this.__parent = parent;
                this.__root = parent ? parent.root() : this;
                this.__children = {};
                this.__extendables = Objs.objectify(options.extendables);
                this.__properties = options.properties || new Properties();
                this.__properties.increaseRef(this);
                this.__properties.on("change", function(key, value, oldValue) {
                    this.trigger("change:" + key, value, oldValue);
                }, this);
                this.__functions = Objs.map(options.functions, function(value) {
                    return Types.is_string(value) ? Functions.as_method(this[value], this) : value;
                }, this);
                this.__scopes = {};
                this.__data = options.data;
                Objs.iter(Types.is_function(options.attrs) ? options.attrs.call(this) : options.attrs, function(value, key) {
                    if (!this.__properties.has(key))
                        this.set(key, value);
                }, this);
                this.setAll();
                Objs.iter(options.collections, function(value, key) {
                    if (Types.is_array(options.collections)) {
                        key = value;
                        value = [];
                    }
                    if (!this.__properties.has(key) || (Class.is_instance_of(this.__properties.get(key)) && this.__properties.get(key).destroyed())) {
                        this.set(key, this.auto_destroy(new Collection({
                            objects: value,
                            release_references: true
                        })));
                    }
                }, this);
                if (parent)
                    parent.__add(this);
                this.scopes = Objs.map(options.scopes, function(key) {
                    return this.scope(key);
                }, this);
                Objs.iter(options.bind, function(value, key) {
                    var i = value.indexOf(":");
                    this.bind(this.scope(value.substring(0, i)), key, {
                        secondKey: value.substring(i + 1)
                    });
                }, this);
                Objs.iter(options.computed, function(value, key) {
                    var splt = Strings.splitFirst(key, ":");
                    this.__properties.compute(splt.head, value, this, splt.tail.split(","));
                }, this);
                Objs.iter(options.events, function(value, key) {
                    this.on(key, value, this);
                }, this);
                Objs.iter(options.registerchannels, this.registerChannel, this);
                Objs.iter(options.channels, function(value, key) {
                    var splt = Strings.splitFirst(key, ":");
                    var channel = this.channel(splt.head);
                    if (channel)
                        this.listenOn(this.channel(splt.head), splt.tail, value, this);
                }, this);
                if (this.friendgroup || !parent)
                    this.friendgroup = this.auto_destroy(new Friendgroup(parent ? parent.friendgroup : null));
                else
                    this.friendgroup = parent.friendgroup;
                this.friends = {};
                this.__friends = options.friends;
                Objs.iter(this.__friends, function(value, key) {
                    this.friends[key] = this.friendgroup.watchScope(this, value);
                }, this);
            },

            friendgroup: false,

            destroy: function() {
                this.trigger("destroy");
                Objs.iter(this.__friends, function(value) {
                    this.friendgroup.unwatchScope(this, value);
                }, this);
                Objs.iter(this.__scopes, function(scope) {
                    scope.destroy();
                });
                Objs.iter(this.__children, function(child) {
                    child.destroy();
                });
                this.__properties.decreaseRef(this);
                if (this.__parent)
                    this.__parent.__remove(this);
                inherited.destroy.call(this);
            },

            __object_id_scope: function() {
                return this.__manager;
            },

            __add: function(child) {
                this.__children[child.cid()] = child;
                this.trigger("add", child);
            },

            __remove: function(child) {
                this.trigger("remove", child);
                delete this.__children[child.cid()];
            },

            data: function(key, value) {
                if (arguments.length === 0)
                    return this.__data;
                if (arguments.length === 1)
                    return this.__data[key];
                this.__data[key] = value;
                this.trigger("data", key, value);
                return this;
            },

            set: function(key, value, force) {
                if (key in this.__extendables)
                    value = Objs.tree_extend(this.__properties.get(key) || {}, value);
                this.__properties.set(key, value, force);
                return this;
            },

            setAll: function(obj) {
                this.__properties.setAll(obj);
                return this;
            },

            get: function(key) {
                return this.__properties.get(key);
            },

            setProp: function(key, value) {
                this.__properties.setProp(key, value);
                return this;
            },

            getProp: function(key) {
                return this.__properties.getProp(key);
            },

            define: function(name, func, ctx) {
                this.__functions[name] = Functions.as_method(func, ctx || this);
                return this;
            },

            /* Deprecated */
            call: function(name) {
                return this.execute.apply(this, arguments);
            },

            execute: function(name) {
                var args = Functions.getArguments(arguments, 1);
                try {
                    if (Types.is_string(name))
                        return this.__functions[name].apply(this, args);
                    else
                        return name.apply(this, args);
                } catch (e) {
                    return this.handle_call_exception(name, args, e);
                }
            },

            handle_call_exception: function(name, args, e) {
                throw e;
            },

            parent: function() {
                return this.__parent;
            },

            _eventChain: function() {
                return this.parent();
            },

            registerChannel: function(s) {
                this._channels[s] = this.auto_destroy(new Events());
            },

            channel: function(s) {
                if (!(s in this.__channelCache)) {
                    var result = null;
                    if (this._channels[s])
                        result = this._channels[s];
                    else if (this.__parent)
                        result = this.__parent.channel(s);
                    this.__channelCache[s] = result;
                }
                return this.__channelCache[s];
            },

            root: function() {
                return this.__root;
            },

            children: function() {
                return this.scope(">");
            },

            properties: function() {
                return this.__properties;
            },

            compute: function(key, callback, dependencies) {
                this.properties().compute(key, callback, this, dependencies);
            },

            scope: function(base, query) {
                if (arguments.length < 2) {
                    query = base;
                    base = this;
                }
                if (!query)
                    return base;
                if (base && base.instance_of(MultiScope))
                    base = base.iterator().next();
                if (!base)
                    return base;
                var ident = Ids.objectId(base) + "_" + query;
                if (!this.__scopes[ident])
                    this.__scopes[ident] = new MultiScope(this, base, query);
                return this.__scopes[ident];
            },

            bind: function(scope, key, options) {
                if (scope.instance_of(MultiScope)) {
                    var iter = scope.iterator();
                    while (iter.hasNext())
                        this.properties().bind(key, iter.next().properties(), options);
                    scope.on("addscope", function(s) {
                        this.properties().bind(key, s.properties(), options);
                    }, this);
                    scope.on("removescope", function(s) {
                        this.properties().unbind(key, s.properties());
                    }, this);
                } else
                    this.properties().bind(key, scope.properties(), options);
            }

        };
    }], {

        _extender: {
            functions: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            },
            friends: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            }

        }

    });
});

Scoped.define("module:Parser", ["base:Types","base:Objs","base:JavaScript"], function (Types, Objs, JavaScript) {
    return {

        __cache: {},

        __functions: {},

        secureMode: false,

        compileFunction: function(code) {
            code = code.trim();
            if (!(code in this.__functions)) {
                if (this.secureMode)
                    throw ("Dynamics Secure Mode prevents creation of function code '" + code + "'.");
                /*jslint evil: true */
                this.__functions[code] = new Function("obj", "with (obj) { return " + code + "; }");
            }
            return this.__functions[code];
        },

        registerFunctions: function(codes) {
            this.__functions = Objs.extend(this.__functions, codes);
        },

        parseText: function(text) {
            if (!text)
                return null;
            var chunks = [];
            while (text) {
                var i = text.indexOf("{{");
                var dynamic = null;
                if (i === 0) {
                    i = text.indexOf("}}");
                    while (i + 2 < text.length && text.charAt(i + 2) == "}")
                        i++;
                    if (i >= 0) {
                        i += 2;
                        dynamic = this.parseCode(text.substring(2, i - 2));
                    } else
                        i = text.length;
                } else if (i < 0)
                    i = text.length;
                chunks.push(dynamic ? dynamic : text.substring(0, i));
                text = text.substring(i);
            }
            if (chunks.length == 1)
                return Types.is_string(chunks[0]) ? null : chunks[0];
            var dependencies = {};
            Objs.iter(chunks, function(chunk) {
                if (!Types.is_string(chunk)) {
                    Objs.iter(chunk.dependencies, function(dep) {
                        dependencies[dep] = true;
                    });
                }
            });
            return {
                func: function(obj) {
                    var s = null;
                    Objs.iter(chunks, function(chunk) {
                        var result = Types.is_string(chunk) ? chunk : chunk.func(obj);
                        s = s === null ? result : (s + result);
                    });
                    return s;
                },
                dependencies: Objs.keys(dependencies)
            };
        },

        parseCode: function(code) {
            var result = this.__cache[code];
            if (!result) {
                var bidirectional = false;
                var html = false;
                var c = code;
                if (c.charAt(0) == "=") {
                    bidirectional = true;
                    c = c.substring(1);
                } else if (c.charAt(0) == "-") {
                    html = true;
                    c = c.substring(1);
                }
                var i = c.lastIndexOf("::");
                var args = null;
                if (i >= 0) {
                    args = c.substring(0, i).trim();
                    c = c.substring(i + 2);
                }
                result = {
                    bidirectional: bidirectional,
                    html: html,
                    args: args,
                    variable: bidirectional ? c : null,
                    func: this.compileFunction(c),
                    dependencies: Objs.keys(Objs.objectify(JavaScript.extractIdentifiers(c, true)))
                };
                this.__cache[code] = result;
            }
            return Objs.clone(result, 1);
        }

    };
});

Scoped.define("module:Data.Mesh", ["base:Class","base:Events.EventsMixin","base:Properties.ObservableMixin","base:Objs","base:Types","base:Strings","base:Ids","base:Functions","base:Classes.SharedObjectFactory"], function (Class, EventsMixin, ObservableMixin, Objs, Types, Strings, Ids, Functions, SharedObjectFactory, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(environment, context, defaults) {
                inherited.constructor.call(this);
                this.__environment = environment;
                this.__defaults = defaults;
                this.__context = context;
                this.__watchers = {};
                this.__acquiredProperties = {};
            },

            destroy: function() {
                Objs.iter(this.__watchers, function(watcher) {
                    this.__destroyWatcher(watcher);
                }, this);
                Objs.iter(this.__acquiredProperties, function(prop) {
                    prop.decreaseRef(this);
                }, this);
                inherited.destroy.call(this);
            },

            watch: function(expressions, callback, context) {
                Objs.iter(expressions, function(expression) {
                    var watcher = this.__createWatcher(expression);
                    watcher.cbs[Ids.objectId(context)] = {
                        callback: callback,
                        context: context
                    };
                }, this);
            },

            unwatch: function(expressions, context) {
                Objs.iter(expressions, function(expression) {
                    var watcher = this.__createWatcher(expression, true);
                    if (watcher) {
                        delete watcher.cbs[Ids.objectId(context)];
                        this.__destroyWatcher(watcher, true);
                    }
                }, this);
            },

            __destroyWatcher: function(watcher, weak) {
                if (Types.is_string(watcher))
                    watcher = this.__watchers[watcher];
                if (!watcher || (weak && !(Types.is_empty(watcher.cbs) && Types.is_empty(watcher.children))))
                    return;
                Objs.iter(watcher.children, this.__destroyWatcher, this);
                this.__unbindWatcher(watcher);
                if (watcher.parent)
                    delete watcher.parent.children[watcher.key];
                delete this.__watchers[watcher.expression];
                if (watcher.parent && Types.is_empty(watcher.parent.cbs) && Types.is_empty(watcher.parent.children))
                    this.__destroyWatcher(watcher.parent);
            },

            __createWatcher: function(expression, weak) {
                var watcher = this.__watchers[expression];
                if (watcher || weak)
                    return watcher;
                var split = Strings.splitLast(expression, ".");
                var parent = split.head ? this.__createWatcher(split.head) : null;
                watcher = {
                    cbs: {},
                    parent: parent,
                    key: split.tail,
                    expression: expression,
                    children: {},
                    properties: null,
                    propertiesPrefix: null
                };
                if (parent)
                    parent.children[split.tail] = watcher;
                this.__watchers[expression] = watcher;
                this.__bindWatcher(watcher);
                return watcher;
            },

            __unbindWatcher: function(watcher) {
                if (watcher.properties)
                    watcher.properties.off(null, null, watcher);
                Objs.iter(watcher.children, this.__unbindWatcher, this);
            },

            __bindWatcher: function(watcher) {
                var n = null;
                for (var i = this.__environment.length - 1; i >= 0; --i) {
                    var scope = this.__environment[i];
                    n = this._navigate(scope, watcher.expression);
                    if (n.properties && !n.tail)
                        break;
                    n = null;
                }
                if (n === null) {
                    var defScope = this.__defaults.watch || this.__environment[0];
                    n = this._navigate(defScope, watcher.expression);
                    if (!n.properties && ObservableMixin.__observable_guid === defScope.__observable_guid)
                        n.properties = defScope;
                    if (!n.properties)
                        n = null;
                }
                if (n === null)
                    return;
                watcher.properties = n.properties;
                var exp = n.head + (n.head && n.tail ? "." : "") + n.tail;
                watcher.propertiesPrefix = exp;
                watcher.properties.on("change:" + watcher.propertiesPrefix, function(value, oldValue, force) {
                    Objs.iter(watcher.children, this.__unbindWatcher, this);
                    Objs.iter(watcher.children, this.__bindWatcher, this);
                    if (watcher.value != value || force) {
                        watcher.value = value;
                        Objs.iter(watcher.cbs, function(cb) {
                            cb.callback.apply(cb.context);
                        }, this);
                    }
                }, this);
                var value = watcher.properties.get(exp);
                if (value != watcher.value) {
                    watcher.value = value;
                    Objs.iter(watcher.cbs, function(cb) {
                        cb.callback.apply(cb.context);
                    }, this);
                }
                Objs.iter(watcher.children, this.__bindWatcher, this);
            },

            read: function(expression) {
                for (var i = this.__environment.length - 1; i >= 0; --i) {
                    var ret = this._read(this.__environment[i], expression);
                    if (ret) {
                        if (Types.is_function(ret.value))
                            return Functions.as_method(ret.value, ret.context);
                        return ret.value;
                    }
                }
                return null;
            },

            write: function(expression, value) {
                for (var i = this.__environment.length - 1; i >= 0; --i) {
                    if (this._write(this.__environment[i], expression, value, false))
                        return;
                }
                this._write(this.__defaults.write || this.__environment[0], expression, value, true);
            },

            execute: function(expressions, callback, readonly) {
                var data = {};
                var exprs = [];
                Objs.iter(expressions, function(expression) {
                    var value = this.read(expression);
                    if (value !== null || !(Strings.splitFirst(expression, ".").head in window)) {
                        exprs.push(expression);
                        data[expression] = value;
                    }
                }, this);

                var expanded = this.__expand(data);

                var result = callback.call(this.__context, expanded);
                if (!readonly) {
                    var collapsed = this.__collapse(expanded, exprs);
                    for (var expression in collapsed) {
                        if (!(expression in data) || data[expression] != collapsed[expression])
                            this.write(expression, collapsed[expression]);
                    }
                }
                return result;
            },

            _sub_navigate: function(properties, head, tail, parent, current) {
                var base = {
                    properties: properties,
                    head: head,
                    tail: tail,
                    parent: parent,
                    current: current
                };
                if (!tail || !current || !Types.is_object(current))
                    return base;
                var splt = Strings.splitFirst(tail, ".");
                var hd = head ? head + "." + splt.head : splt.head;
                if (SharedObjectFactory.is_instance_of(current) && !current.destroyed()) {
                    current = current.acquire(this);
                    this.__acquiredProperties[current.cid()] = current;
                }
                if (ObservableMixin.__observable_guid === current.__observable_guid && !current.destroyed()) {
                    if (current.hasKey(splt.head))
                        return this._sub_navigate(current, splt.head, splt.tail, current, current.get(splt.head));
                    else if (splt.head in current)
                        return this._sub_navigate(properties, hd, splt.tail, current, current[splt.head]);
                    else {
                        return {
                            properties: current,
                            head: splt.head,
                            tail: splt.tail,
                            parent: current,
                            current: null
                        };
                    }
                } else if (splt.head in current)
                    return this._sub_navigate(properties, hd, splt.tail, current, current[splt.head]);
                else
                    return base;
            },

            _navigate: function(scope, expression) {
                return this._sub_navigate(null, "", expression, null, scope);
            },

            _read: function(scope, expression) {
                var n = this._navigate(scope, expression);
                if (n.tail)
                    return null;
                return {
                    value: n.current,
                    context: n.parent == scope ? this.__context : n.parent
                };
            },

            _write: function(scope, expression, value, force) {
                var n = this._navigate(scope, expression);
                if (n.tail && !force)
                    return false;
                var tail = n.tail.split(".");
                if (n.properties)
                    n.properties.set(n.head + (n.head && n.tail ? "." : "") + n.tail, value);
                else {
                    var current = n.current;
                    for (var i = 0; i < tail.length - 1; ++i) {
                        current[tail[i]] = {};
                        current = current[tail[i]];
                    }
                    current[tail[tail.length - 1]] = value;
                }
                return true;
            },

            __expand: function(obj) {
                var result = {};
                Objs.iter(obj, function(value, key) {
                    var current = result;
                    var keys = key.split(".");
                    for (var i = 0; i < keys.length - 1; ++i) {
                        if (!(keys[i] in current) || !Types.is_object(current[keys[i]]) || current[keys[i]] === null)
                            current[keys[i]] = {};
                        current = current[keys[i]];
                    }
                    current[keys[keys.length - 1]] = value;
                });
                return result;
            },

            __collapse: function(obj, expressions) {
                var result = {};
                Objs.iter(expressions, function(expression) {
                    var keys = expression.split(".");
                    var current = obj;
                    for (var i = 0; i < keys.length; ++i)
                        current = current[keys[i]];
                    result[expression] = current;
                });
                return result;
            }

        };
    }]);
});

Scoped.define("module:Registries", ["base:Classes.ClassRegistry","base:Exceptions.AsyncExceptionThrower","browser:Dom","base:Strings"], function (ClassRegistry, AsyncExceptionThrower, Dom, Strings) {
    return {

        handler: new ClassRegistry({}, true),
        partial: new ClassRegistry({}, true),
        prefixes: {
            "ba": true
        },

        prefixNormalize: function(s, returnOriginal) {
            var splt = Strings.splitFirst(s || "", "-");
            return this.prefixes[splt.head] ? splt.tail : s;
        },

        templates: {

            cache: {},

            create: function(template) {
                template = template.trim();
                var cached = this.cache[template];
                if (!cached) {
                    if (template.indexOf("<") === 0)
                        cached = Dom.elementsByTemplate(template);
                    else
                        cached = [document.createTextNode(template)];
                    this.cache[template] = cached;
                }
                return cached.map(function(element) {
                    return element.cloneNode(true);
                });
            }

        },

        throwException: function(e) {
            try {
                if (!this.exceptionThrower)
                    this.exceptionThrower = new AsyncExceptionThrower();
                this.exceptionThrower.throwException(e);
            } catch (ex) {}
        },

        handlerCache: {

            cache: {},
            cacheDom: null,

            suspend: function(handler, element) {
                element = Dom.unbox(element);
                if (!this.cacheDom) {
                    this.cacheDom = document.createElement("div");
                    this.cacheDom.setAttribute("ba-ignore", "");
                    this.cacheDom.style.display = "none";
                    document.body.appendChild(this.cacheDom);
                }
                var name = handler.data("tagname");
                this.cache[name] = this.cache[name] || [];
                var children = [];
                for (var i = 0; i < element.children.length; ++i)
                    children.push(element.children[i]);
                this.cache[name].push({
                    handler: handler,
                    elements: children
                });
                children.forEach(function(child) {
                    this.cacheDom.appendChild(child);
                }, this);
            },

            resume: function(name, element, parentHandler) {
                element = Dom.unbox(element);
                if (!this.cache[name] || this.cache[name].length === 0)
                    return null;
                var record = this.cache[name].shift();
                element.innerHTML = "";
                record.elements.forEach(function(child) {
                    element.appendChild(child);
                });
                record.handler._handlerInitialize({
                    parentHandler: parentHandler,
                    parentElement: element
                });
                return record.handler;
            }

        }

    };
});

Scoped.define("module:Exceptions.TagHandlerException", ["base:Exceptions.Exception"], function (Exception, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(clsname, tag) {
                inherited.constructor.call(this, clsname + " is expecting a tag handler, but no registered tag handler for " + tag + " has been found.");
            }

        };
    });
});

Scoped.define("module:Handlers.Attr", ["base:Class","module:Exceptions.TagHandlerException","module:Parser","base:Types","base:Objs","base:Async","base:Strings","module:Registries","browser:Dom","browser:Events"], function (Class, TagHandlerException, Parser, Types, Objs, Async, Strings, Registries, Dom, Events, scoped) {
    var Cls;
    Cls = Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, attribute, dataNode) {
                inherited.constructor.call(this);
                this._dataNode = dataNode || node;
                this._node = node;
                this._tagHandler = null;
                this._attrName = attribute.name;
                this._isEvent = this._attrName.indexOf("on") === 0;
                this._updatable = !this._isEvent;
                this._attrValue = attribute.value;
                this._dyn = Parser.parseText(this._attrValue);
                if (this._dyn) {
                    var self = this;
                    this._dataNode.mesh().watch(this._dyn.dependencies, function() {
                        self.__updateAttr();
                    }, this);
                }
                this.updateElement(node.element(), attribute);
            },

            destroy: function() {
                if (this._partial)
                    this._partial.destroy();
                if (this._dyn)
                    this._dataNode.mesh().unwatch(this._dyn.dependencies, this);
                inherited.destroy.call(this);
            },

            __inputVal: function(el, value) {
                var valueKey = el.type === 'checkbox' || el.type === 'radio' ? 'checked' : 'value';
                if (arguments.length > 1) {
                    value = value === null || value === undefined ? "" : value;
                    if (el.type === "select-one") {
                        Async.eventually(function() {
                            el[valueKey] = value;
                        });
                    } else
                        el[valueKey] = value;
                }
                return el[valueKey];
            },

            _events: function() {
                if (!this.__events)
                    this.__events = this.auto_destroy(new Events());
                return this.__events;
            },

            updateElement: function(element, attribute) {
                this._element = element;
                attribute = attribute || element.attributes[this._attrName];
                this._attribute = attribute;
                var splt = Strings.splitFirst(this._attrName, ":");
                this._partialCls = Registries.partial.get(splt.head);
                if (this._partial) {
                    this._partial.destroy();
                    this._partial = null;
                }
                this.__updateAttr();
                if (this._partialCls) {
                    this._partial = Registries.partial.create(splt.head, this._node, this._dyn ? this._dyn.args : {}, this._attrValue, splt.tail);
                    if (this._partial.cls.meta.value_hidden)
                        this._attribute.value = "";
                }
                if (this._dyn) {
                    if (this._dyn.bidirectional && this._attrName == "value") {
                        this._events().on(this._element, "change keyup keypress keydown blur focus update input", function() {
                            this._dataNode.mesh().write(this._dyn.variable, this.__inputVal(this._element));
                        }, this);
                    }
                    if (this._isEvent) {
                        this._attribute.value = '';
                        this._events().on(this._element, this._attrName.substring(2), function() {
                            // Ensures the domEvent does not continue to
                            // overshadow another variable after the __executeDyn call ends.
                            var oldDomEvent = this._node._locals.domEvent;
                            this._node._locals.domEvent = arguments;
                            this._node.__executeDyn(this._dyn);
                            if (this._node && this._node._locals)
                                this._node._locals.domEvent = oldDomEvent;
                        }, this);
                    }
                }
            },

            __updateAttr: function() {
                if (!this._updatable)
                    return;
                var value = this._attrValue;
                if (this._dyn && (!this._partialCls || !this._partialCls.manualExecute))
                    value = this._dataNode.__executeDyn(this._dyn);
                if ((value != this._attrValue || Types.is_array(value)) && !(!value && !this._attrValue)) {
                    var old = this._attrValue;
                    this._attrValue = value;

                    if (!this._partial || !this._partial.cls.meta.value_hidden) {
                        var result = Dom.entitiesToUnicode(value);


                        /*
                         *  Fixing a Safari bug. These three lines will cause Safari to crash: 
                         *     
                         *     <style> [class^="randomstring"] { background: white; } </style>
                         *	   <div class="" id="test"></div>
                         *	   <script> document.getElementById("test").attributes.class.value = null; </script>
                         *
                         */
                        if (result === null && this._attrName === "class")
                            result = "";


                        this._attribute.value = result;
                    }

                    if (this._partial)
                        this._partial.change(value, old);
                    if (this._attrName === "value" && this._element.value !== value)
                        this.__inputVal(this._element, value);
                    if (this._tagHandler && this._dyn && !this._partial)
                        this._tagHandler.properties().set(Registries.prefixNormalize(this._attrName), value);
                }
            },

            bindTagHandler: function(handler) {
                this.unbindTagHandler(this._tagHandler);
                this._tagHandler = handler;
                if (!this._partial) {
                    var innerKey = Registries.prefixNormalize(this._attrName);
                    if (innerKey) {
                        this._tagHandler.setArgumentAttr(innerKey, Class.is_pure_json(this._attrValue) ? Objs.clone(this._attrValue, 1) : this._attrValue);
                        if (this._dyn && this._dyn.bidirectional) {
                            if (Class.is_pure_json(this._attrValue)) {
                                this._tagHandler.properties().bind(innerKey, this._node._handler.properties(), {
                                    deep: true,
                                    left: true,
                                    right: true,
                                    secondKey: this._dyn.variable
                                });
                            } else {
                                this._tagHandler.properties().on("change:" + innerKey, function(value) {
                                    this._dataNode.mesh().write(this._dyn.variable, value);
                                }, this);
                            }
                        }
                    }
                } else if (this._partial) {
                    this._partial.bindTagHandler(handler);
                }
            },

            prepareTagHandler: function(createArguments) {
                if (this._partial)
                    this._partial.prepareTagHandler(createArguments);
            },

            unbindTagHandler: function(handler) {
                if (this._partial) {
                    this._partial.unbindTagHandler(handler);
                }
                if (this._tagHandler)
                    this._tagHandler.properties().off(null, null, this);
                this._tagHandler = null;
            },

            activate: function() {
                if (this._partial) {
                    if (this._partial.cls.meta.requires_tag_handler && !this._tagHandler) {
                        Registries.throwException(new TagHandlerException(this._partial.cls.classname, this._node.tag()));
                        return;
                    }
                    this._partial.activate();
                }
            },

            deactivate: function() {
                if (this._partial)
                    this._partial.deactivate();
            }

        };
    });
    return Cls;
});

Scoped.define("module:Handlers.Node", ["base:Class","base:Events.EventsMixin","base:Ids","browser:Dom","browser:Info","module:Parser","module:Data.Mesh","base:Objs","base:Types","module:Registries","module:Handlers.Attr"], function (Class, EventsMixin, Ids, Dom, Info, Parser, Mesh, Objs, Types, Registries, Attr, scoped) {
    var Cls;
    Cls = Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(handler, parent, element, locals) {
                inherited.constructor.call(this);
                this._handler = handler;
                this._parent = parent;
                if (parent)
                    parent._children[Ids.objectId(this)] = this;
                this._element = element;

                this._tag = element.tagName ? element.tagName.toLowerCase() : "";
                if (this._tag.indexOf(":") >= 0)
                    this._tag = this._tag.substring(this._tag.indexOf(":") + 1);
                this._dynTag = Parser.parseText(this._tag);
                this._tagHandler = null;

                this._template = element.outerHTML;
                this._innerTemplate = element.innerHTML;
                this._locals = locals || {};
                this._active = true;
                this._dyn = null;
                this._children = {};
                this._locked = true;
                this._attrs = {};
                this._expandChildren = true;
                this._touchedInner = false;

                this._mesh = new Mesh([window, this.properties(), this._locals, this._handler.functions, this._handler.friends || {}, this._handler._mesh_extend], this._handler, {
                    read: this.properties(),
                    write: this.properties(),
                    watch: this.properties()
                });

                if (this._element.attributes) {
                    // Copy attributes first before registering it, preventing a bug when partials add attributes during initialization
                    var attrs = [];
                    for (var i = 0; i < this._element.attributes.length; ++i)
                        attrs.push(this._element.attributes[i]);
                    Objs.iter(attrs, this._registerAttr, this);
                }

                this._locked = false;
                this._active = !this._active;
                if (this._active)
                    this.deactivate();
                else
                    this.activate();
            },

            destroy: function() {
                Objs.iter(this._attrs, function(attr) {
                    attr.destroy();
                });
                this._removeChildren();
                if (this._tagHandler && !this._tagHandler.destroyed()) {
                    if (this._tagHandler.cacheable && this._tagHandler.cls.cacheable)
                        Registries.handlerCache.suspend(this._tagHandler, this._element);
                    else
                        this._tagHandler.weakDestroy();
                }
                if (this._dyn)
                    this.properties().off(null, null, this._dyn);
                if (this._parent)
                    delete this._parent._children[Ids.objectId(this)];
                this._mesh.destroy();
                inherited.destroy.call(this);
            },

            _registerAttr: function(attribute) {
                if (attribute.name in this._attrs)
                    // Is this ever being called? The method doesn't exist!?
                    this._attrs[attribute.name].updateAttribute(attribute);
                else
                    this._attrs[attribute.name] = new Attr(this, attribute);
            },

            tag: function() {
                return this._tag;
            },

            element: function() {
                return this._element;
            },

            __dynOff: function(dyn) {
                this._mesh.unwatch(dyn.dependencies, dyn);
            },

            __dynOn: function(dyn, cb) {
                var self = this;
                this._mesh.watch(dyn.dependencies, function() {
                    cb.apply(self);
                }, dyn);
            },

            mesh: function() {
                return this._mesh;
            },

            __executeDyn: function(dyn, readonly) {
                return Types.is_object(dyn) ? this._mesh.execute(dyn.dependencies, dyn.func, readonly) : dyn;
            },

            __tagValue: function() {
                if (!this._dynTag)
                    return this._tag;
                return this.__executeDyn(this._dynTag, true);
            },

            __unregisterTagHandler: function() {
                if (this._tagHandler) {
                    Objs.iter(this._attrs, function(attr) {
                        attr.unbindTagHandler(this._tagHandler);
                    }, this);
                    this.off(null, null, this._tagHandler);
                    if (this._tagHandler.cacheable && this._tagHandler.cls.cacheable)
                        Registries.handlerCache.suspend(this._tagHandler, this._element);
                    else
                        this._tagHandler.weakDestroy();
                    this._tagHandler = null;
                    Objs.iter(this._handler.getInheritableAttributes(this.__tagValue()), function(attr) {
                        this._attrs[attr.name].weakDestroy();
                        delete this._attrs[attr.name];
                    }, this);
                }
            },

            __registerTagHandler: function() {
                this.__unregisterTagHandler();
                var tagv = this.__tagValue();
                if (!tagv)
                    return;
                if (this._dynTag && this._element.tagName.toLowerCase() != tagv.toLowerCase()) {
                    this._element = Dom.changeTag(this._element, tagv);
                    Objs.iter(this._attrs, function(attr) {
                        attr.updateElement(this._element);
                    }, this);
                }
                if (!Registries.handler.get(tagv))
                    return false;
                if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 9) {
                    var isActiveElement = this._element === this._handler.activeElement();
                    this._element = Dom.changeTag(this._element, tagv);
                    Objs.iter(this._attrs, function(attr) {
                        attr.updateElement(this._element);
                    }, this);
                    if (isActiveElement)
                        this._handler._updateActiveElement(this._element);
                }
                var createArguments = {
                    parentElement: this._element,
                    parentHandler: this._handler,
                    autobind: false,
                    cacheable: false,
                    tagName: tagv
                };
                Objs.iter(this._handler.getInheritableAttributes(this.__tagValue()), function(attr) {
                    this._attrs[attr.name] = new Attr(attr.node, attr);
                }, this);
                Objs.iter(this._attrs, function(attr) {
                    attr.prepareTagHandler(createArguments);
                }, this);
                if (createArguments.ignoreTagHandler)
                    return;
                if (createArguments.cacheable)
                    this._tagHandler = Registries.handlerCache.resume(tagv, this._element, this._handler);
                if (!this._tagHandler)
                    this._tagHandler = Registries.handler.create(tagv, createArguments);
                Objs.iter(this._handler.inheritables, function(key) {
                    this._tagHandler.set(key, this._handler.get(key));
                }, this);
                Objs.iter(this._attrs, function(attr) {
                    attr.bindTagHandler(this._tagHandler);
                }, this);
                this._tagHandler.activate();
                return true;
            },

            activate: function() {
                if (this._locked || this._active)
                    return;
                this._locked = true;
                this._active = true;
                if (this._dynTag) {
                    this.__dynOn(this._dynTag, function() {
                        this.__registerTagHandler();
                    });
                }
                var registered = this.__registerTagHandler();
                if (!registered && this._expandChildren) {
                    if (this._restoreInnerTemplate)
                        this._element.innerHTML = this._innerTemplate;
                    this._touchedInner = true;
                    if (this._element.nodeType == 3) {
                        this._dyn = Parser.parseText(this._element.textContent || this._element.innerText || this._element.nodeValue);
                        if (this._dyn) {
                            this.__dynOn(this._dyn, function() {
                                this.__updateDyn();
                            });
                        }
                    }
                    this.__updateDyn(true);
                    for (var i = 0; i < this._element.childNodes.length; ++i)
                        if (!this._element.childNodes[i]["ba-handled"])
                            this._registerChild(this._element.childNodes[i]);
                }
                Objs.iter(this._attrs, function(attr) {
                    attr.activate();
                });
                this._locked = false;
            },

            __updateDyn: function(force) {
                if (!this._dyn)
                    return;
                var value = this.__executeDyn(this._dyn);
                if (force || value != this._dyn.value) {
                    this._dyn.value = value;
                    if (this._dyn.html) {
                        var htmlElement = Dom.elementByTemplate(value);
                        (this._htmlElement || this._element).replaceWith(htmlElement);
                        this._htmlElement = htmlElement;
                    } else {
                        var converted = Dom.entitiesToUnicode(value === null ? "" : value);
                        if ("textContent" in this._element)
                            this._element.textContent = converted;
                        if ("innerText" in this._element)
                            this._element.innerText = converted;
                        if (Info.isInternetExplorer() && Info.internetExplorerVersion() < 9 && ("data" in this._element))
                            this._element.data = converted;
                    }
                }
            },

            _registerChild: function(element, locals) {
                return new Cls(this._handler, this, element, Objs.extend(Objs.clone(this._locals, 1), locals));
            },

            _removeChildren: function() {
                Objs.iter(this._children, function(child) {
                    child.destroy();
                });
            },

            deactivate: function() {
                if (!this._active)
                    return;
                this._active = false;
                if (this._locked)
                    return;
                this._locked = true;
                Objs.iter(this._attrs, function(attr) {
                    attr.deactivate();
                });
                this._removeChildren();
                if (this._dynTag)
                    this.__dynOff(this._dynTag);
                this.__unregisterTagHandler();
                if (this._dyn) {
                    this.__dynOff(this._dyn);
                    this._dyn = null;
                }
                if (this._touchedInner)
                    this._element.innerHTML = "";
                this._restoreInnerTemplate = true;
                this._locked = false;
            },

            properties: function() {
                return this._handler.properties();
            }

        };
    }]);
    return Cls;
});

Scoped.define("module:Handlers.HandlerNameRegistry", ["base:Class","base:Objs"], function (Class, Objs, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            __handlers: {},

            destroy: function() {
                Objs.iter(this.__handlers, function(value, name) {
                    this.unregister(name);
                }, this);
                inherited.destroy.call(this);
            },

            register: function(handler, name) {
                this.unregister(name);
                this.__handlers[name] = handler;
                handler.on("destroy", function() {
                    this.unregister(name);
                }, this);
            },

            unregister: function(name) {
                if (name in this.__handlers) {
                    var handler = this.__handlers[name];
                    delete this.__handlers[name];
                    if (!handler.destroyed())
                        handler.off(null, null, this);
                }
            },

            get: function(name) {
                return this.__handlers[name];
            }

        };

    });
});

Scoped.define("module:Handlers.HandlerMixin", ["base:Objs","base:Strings","base:Functions","base:Types","browser:Loader","module:Handlers.Node","module:Registries","module:Handlers.HandlerNameRegistry","browser:DomMutation.NodeRemoveObserver","browser:Dom"], function (Objs, Strings, Functions, Types, Loader, Node, Registries, HandlerNameRegistry, NodeRemoveObserver, Dom) {
    return {

        _notifications: {
            construct: "__handlerConstruct",
            destroy: "__handlerDestruct"
        },

        __handlerConstruct: function() {
            this._inheritableAttributes = {};
            this.__activated = false;
            this._mesh_extend = {
                string: Functions.as_method(this.string, this),
                stringUnicode: Functions.as_method(this.stringUnicode, this)
            };
        },

        __handlerDestruct: function() {
            Objs.iter(this.__rootNodes, function(node) {
                var element = node.element();
                node.destroy();
                if (this.remove_on_destroy)
                    element.innerHTML = "";
            }, this);
        },

        template: null,
        templateUrl: null,

        string: function(key) {
            if (this.cls.string)
                return this.cls.string(key);
            if (this.parent())
                return this.parent().string(key);
            return key;
        },

        stringUnicode: function(key) {
            if (this.cls.stringUnicode)
                return this.cls.stringUnicode(key);
            if (this.parent())
                return this.parent().stringUnicode(key);
            return key;
        },

        remove_on_destroy: false,

        _handlerInitialize: function(options) {
            options = options || {};
            if (options.name_registry)
                this.__nameRegistry = this.auto_destroy(new HandlerNameRegistry());
            this.__types = options.types || {};
            this._parentHandler = options.parentHandler || null;
            this._parentElement = options.parentElement;
            this._argumentAttrs = {};
            this.template = options.template || this.template;
            this.templateUrl = options.templateUrl || this.templateUrl;
            if (this.templateUrl)
                this.templateUrl = Strings.replaceAll(this.templateUrl, "%", Strings.last_after(this.cls.classname || "", ".").toLowerCase());
            this.__elements = options.element ? [Dom.unbox(options.element)] : [];
            var initialContentElement = Dom.unbox(options.element ? options.element : this._parentElement);
            if (!initialContentElement)
                throw (this.cls.classname + " requires an existing DOM element to attach to.");
            this.initialContent = initialContentElement.innerHTML;
            this.__activeElement = options.element ? Dom.unbox(options.element) : Dom.unbox(this._parentElement);
            if (options.remove_observe) {
                this.__removeObserver = this.auto_destroy(NodeRemoveObserver.create(this.__activeElement));
                this.__removeObserver.on("node-removed", function() {
                    this.weakDestroy();
                }, this);
            }
            this.__activeElement.dynamicshandler = this;
        },

        _handlerInitializeTemplate: function(template, parentElement) {
            var compiled = Registries.templates.create(template);
            if (this.__elements.length > 0) {
                this.__activeElement = this.__elements[0];
                this.__elements[0].innerHTML = "";
                compiled.forEach(function(child) {
                    this.__elements[0].appendChild(child);
                }, this);
            } else if (parentElement) {
                this.__activeElement = Dom.unbox(parentElement);
                this.__elements = compiled;
                this.__activeElement.innerHTML = "";
                compiled.forEach(function(child) {
                    this.__activeElement.appendChild(child);
                }, this);
            } else {
                this.__elements = compiled;
                this.__activeElement = this.__elements[0].parentNode;
            }
        },

        nameRegistry: function() {
            return this.__nameRegistry || (this.parent() ? this.parent().nameRegistry() : null);
        },

        byName: function(name) {
            return this.nameRegistry().get(name);
        },

        __assocs: {},

        addAssoc: function(name, registeredName) {
            this.__assocs[name] = registeredName;
        },

        removeAssoc: function(name) {
            delete this.__assocs[name];
        },

        activated: function() {
            return this.__activated;
        },

        assoc: function(name) {
            return this.byName(this.__assocs[name] || name);
        },

        setArgumentAttr: function(key, value) {
            if (key in this.__extendables)
                value = Objs.tree_extend(this.properties().get(key) || {}, value);
            if (this.__types[key])
                value = Types.parseType(value, this.__types[key]);
            this.properties().set(key, value);
            this._argumentAttrs[key] = true;
        },

        isArgumentAttr: function(key) {
            return !!this._argumentAttrs[key];
        },

        activeElement: function() {
            return this.__activeElement;
        },

        // Deprecated
        element: function() {
            return this.__elements;
        },

        _updateActiveElement: function(activeElement) {
            this.__activeElement = Dom.unbox(activeElement);
            if (this.__removeObserver) {
                this.__removeObserver.weakDestroy();
                this.__removeObserver = this.auto_destroy(NodeRemoveObserver.create(this.__activeElement));
                this.__removeObserver.on("node-removed", function() {
                    this.weakDestroy();
                }, this);
            }
        },

        _deferActivate: function() {
            return false;
        },

        activate: function() {
            if (this._deferActivate())
                return;
            if (this.__activated)
                return;
            this.__activated = true;
            if (this.template)
                this._handlerInitializeTemplate(this.template, this._parentElement);
            else {
                if (this.templateUrl) {
                    this.__activated = false;
                    Loader.loadHtml(this.templateUrl, function(template) {
                        this.templateUrl = null;
                        this.template = template;
                        this.activate();
                    }, this);
                    return;
                }
            }

            this._notify("_activate");
            this.__rootNodes = [];
            this.__elements.forEach(function(element) {
                this.__rootNodes.push(new Node(this, null, element));
            }, this);
            this._preAfterActivate(this.__activeElement);
            this._afterActivate(this.__activeElement);
            if (this.__activeElement.dynamicshandlerpromise) {
                this.__activeElement.dynamicshandlerpromise.forEach(function(promise) {
                    promise.asyncSuccess(this.__activeElement.dynamicshandler);
                }, this);
                this.__activeElement.dynamicshandlerpromise = null;
                try {
                    delete this.__activeElement.dynamicshandlerpromise;
                } catch (e) {}
            }
            this.trigger("dynamic-activated");
        },

        _afterActivate: function(activeElement) {},

        registerInheritableAttribute: function(tagName, attrKey, attrValue, node) {
            tagName = Registries.prefixNormalize(tagName, true);
            this._inheritableAttributes[tagName] = this._inheritableAttributes[tagName] || {};
            this._inheritableAttributes[tagName][attrKey] = {
                value: attrValue,
                name: attrKey,
                node: node
            };
        },

        unregisterInheritableAttribute: function(tagName, attrKey) {
            tagName = Registries.prefixNormalize(tagName, true);
            if (this._inheritableAttributes[tagName]) {
                delete this._inheritableAttributes[tagName][attrKey];
                if (Types.is_empty(this._inheritableAttributes[tagName]))
                    delete this._inheritableAttributes[tagName];
            }
        },

        getInheritableAttributes: function(tagName) {
            tagName = Registries.prefixNormalize(tagName, true);
            return Objs.values(this._inheritableAttributes[tagName]);
        }

    };
});

Scoped.define("module:Exceptions.DynamicsCallException", ["base:Exceptions.Exception"], function (Exception, scoped) {
    return Exception.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(clsname, methodname, args, e) {
                inherited.constructor.call(this, "Dynamics Exception in '" + clsname + "' calling method '" + methodname + "' : " + e);
            }

        };
    });
});

Scoped.define("module:Dynamic", ["module:Data.Scope","module:Parser","module:Handlers.HandlerMixin","module:Exceptions.DynamicsCallException","base:Objs","base:Strings","base:Types","base:Functions","base:Promise","base:Events.Events","base:Loggers.LoggableMixin","module:Registries","browser:Dom","browser:Events","base:Class"], function (Scope, Parser, HandlerMixin, DynamicsCallException, Objs, Strings, Types, Functions, Promise, Events, LoggableMixin, Registries, Dom, DomEvents, Class, scoped) {
    var Cls;
    Cls = Scope.extend({
        scoped: scoped
    }, [HandlerMixin, LoggableMixin, function(inherited) {
        return {

            supportsGc: true,

            _notifications: {
                _activate: "__createActivate"
            },

            constructor: function(options) {
                this.initial = this.initial || {};
                options = Objs.extend(Objs.clone(this.initial, 1), options);
                this.domevents = Objs.extend(this.domevents, options.domevents);
                this.windowevents = Objs.extend(this.windowevents, options.windowevents);
                Objs.iter(this.cls.__initialForward, function(key) {
                    if (!(key in this))
                        return;
                    if (key in options) {
                        if (Types.is_object(this[key]) && Types.is_object(options[key]))
                            options[key] = Objs.extend(Objs.clone(this[key], 1), options[key]);
                    } else
                        options[key] = this[key];
                }, this);
                if (options.typedAttrs && options.types) {
                    Objs.iter(options.typedAttrs, function(value, key) {
                        options.attrs[key] = options.types[key] ? Types.parseType(value, options.types[key]) : value;
                    });
                }
                this.__dispose = options.dispose;
                Objs.iter(this.object_functions, function(key) {
                    this[key] = function() {
                        var args = Functions.getArguments(arguments);
                        args.unshift(key);
                        return this.execute.apply(this, args);
                    };
                }, this);
                if (!options.parent && options.parentHandler) {
                    var ph = options.parentHandler;
                    while (ph && !options.parent) {
                        options.parent = ph.instance_of(Cls) ? ph : null;
                        ph = ph._parentHandler;
                    }
                }
                inherited.constructor.call(this, options);
                this.__references = options.references;
                Objs.iter(this.__references, function(reference) {
                    this.on("change:" + reference, function(newReference, oldReference) {
                        if (oldReference && Class.is_class_instance(oldReference) && !oldReference.destroyed())
                            oldReference.decreaseRef(this);
                        if (newReference && Class.is_class_instance(newReference) && !newReference.destroyed())
                            newReference.increaseRef(this);
                    }, this);
                    var ref = this.get(reference);
                    if (ref && Class.is_class_instance(ref) && !ref.destroyed())
                        ref.increaseRef(this);
                }, this);
                this._channels.global = this.cls.__globalEvents;
                if (options.tagName) {
                    this._tagName = options.tagName;
                    this.data("tagname", this._tagName);
                }
                this.functions = this.__functions;
                this._handlerInitialize(options);
                this.__createActivate = options.create || function() {};
                this.dom_events = {};
                this.window_events = {};
                this.__domEvents = new DomEvents();
                this.inheritables = (this.parent() ? this.parent().inheritables : []).concat(this.inheritables || []);
                this.friendgroup.registerScope(this, this.cls.registeredName());
            },

            handle_call_exception: function(name, args, e) {
                Registries.throwException(new DynamicsCallException(this.cls.classname, name, args, e));
                return null;
            },

            _preAfterActivate: function(activeElement) {
                this.__domEvents.clear();
                var self = this;
                Objs.iter(this.domevents, function(target, event) {
                    var ev = event.split(" ");
                    var source = [activeElement];
                    if (ev.length > 1)
                        source = activeElement.querySelectorAll(ev[1]);
                    var f = function(eventData) {
                        self.execute(target, eventData, this);
                    };
                    for (var i = 0; i < source.length; ++i) {
                        this.__domEvents.on(source[i], ev[0], f);
                    }
                }, this);
                Objs.iter(this.windowevents, function(target, event) {
                    this.__domEvents.on(window, event, function(eventData) {
                        self.execute(target, eventData, this);
                    });
                }, this);
            },

            destroy: function() {
                this.friendgroup.unregisterScope(this, this.cls.registeredName());
                if (this.free)
                    this.free();
                Objs.iter(this.__references, function(reference) {
                    var ref = this.get(reference);
                    if (ref && Class.is_class_instance(ref) && !ref.destroyed())
                        ref.decreaseRef(this);
                }, this);
                Objs.iter(this.__dispose, function(attr) {
                    var obj = this.get(attr);
                    this.set(attr, null);
                    if (obj && obj.weakDestroy)
                        obj.weakDestroy();
                }, this);
                this.__domEvents.destroy();
                inherited.destroy.call(this);
            }

        };
    }], {

        __initialForward: [
            "functions", "attrs", "extendables", "collections", "template", "create", "scopes", "bindings", "computed", "types", "events", "dispose", "channels", "registerchannels", "references", "friends"
        ],

        __globalEvents: new Events(),

        canonicName: function() {
            return this.classname ? Strings.last_after(this.classname, ".").toLowerCase() : "";
        },

        registeredName: function() {
            return this.__registeredName || ("ba-" + this.canonicName());
        },

        findByElement: function(element) {
            if (!element)
                return null;
            element = Dom.unbox(element);
            return element && element.dynamicshandler ? element.dynamicshandler : null;
        },

        findByElementPromise: function(element) {
            if (!element)
                return null;
            element = Dom.unbox(element);
            if (!element)
                return null;
            if (element.dynamicshandler)
                return Promise.value(element.dynamicshandler);
            element.dynamicshandlerpromise = element.dynamicshandlerpromise || [];
            var promise = Promise.create();
            element.dynamicshandlerpromise.push(promise);
            return promise;
        },

        register: function(key, registry) {
            registry = registry || Registries.handler;
            this.__registeredName = key || this.registeredName();
            registry.register(this.__registeredName, this);
            return this;
        },

        registerFunctions: function(code) {
            Parser.registerFunctions(code);
            return this;
        },

        activate: function(options) {
            var dyn = new this(options || {
                element: document.body,
                name_registry: true
            });
            dyn.activate();
            return dyn;
        },

        attachStringTable: function(stringTable) {
            this.__stringTable = stringTable;
            return this;
        },

        addStrings: function(strings) {
            this.__stringTable.register(strings, this.registeredName());
            return this;
        },

        string: function(key) {
            var result = null;
            if (this.__stringTable)
                result = this.__stringTable.get(key, this.registeredName());
            if (!result && this.parent.string)
                result = this.parent.string(key);
            return result;
        },

        stringUnicode: function(key) {
            var result = null;
            if (this.__stringTable)
                result = this.__stringTable.get(key, this.registeredName());
            if (!result && this.parent.string)
                result = this.parent.string(key);
            return Dom.entitiesToUnicode(result);
        },

        _extender: {
            events: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            },
            types: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            },
            registerchannels: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            },
            channels: function(base, overwrite) {
                return Objs.extend(Objs.clone(base, 1), overwrite);
            },
            attrs: function(base, overwrite) {
                if (Types.is_function(base))
                    if (Types.is_function(overwrite)) {
                        return function() {
                            return Objs.extend(base.call(this), overwrite.call(this));
                        };
                    } else {
                        return function() {
                            return Objs.extend(base.call(this), overwrite);
                        };
                    }
                else if (Types.is_function(overwrite)) {
                    return function() {
                        return Objs.extend(Objs.clone(base, 1), overwrite.call(this));
                    };
                } else
                    return Objs.extend(Objs.clone(base, 1), overwrite);
            },
            inheritables: function(first, second) {
                return (first || []).concat(second || []);
            },
            dispose: function(first, second) {
                return (first || []).concat(second || []);
            },
            references: function(first, second) {
                return (first || []).concat(second || []);
            }
        }

    });
    return Cls;
});

Scoped.define("module:Handlers.Partial", ["base:Class","base:JavaScript","base:Functions","base:Strings","module:Parser","module:Registries"], function (Class, JavaScript, Functions, Strings, Parser, Registries, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value, postfix) {
                inherited.constructor.call(this);
                this._node = node;
                this._args = args;
                this._value = value;
                this._active = false;
                this._postfix = postfix;
            },

            change: function(value, oldValue) {
                this._value = value;
                this._change(value, oldValue);
                this._apply(value, oldValue);
            },

            activate: function() {
                if (this._active)
                    return;
                this._active = true;
                this._activate();
                this._apply(this._value, null);
            },

            deactivate: function() {
                if (!this._active)
                    return;
                this._active = false;
                this._deactivate();
            },

            bindTagHandler: function(handler) {},

            unbindTagHandler: function(handler) {},

            prepareTagHandler: function(createArguments) {},

            _change: function(value, oldValue) {},

            _activate: function() {},

            _deactivate: function() {},

            _apply: function(value, oldValue) {},

            _execute: function(code) {
                code = code || this._value;
                var dyn = Parser.parseText(code) || Parser.parseCode(code);
                this._node.__executeDyn(dyn);
            },

            _valueExecute: function(args) {
                var value = this._value.trim();
                var simplified = value;
                if (Strings.starts_with(simplified, "{{") && Strings.ends_with(simplified, "}}"))
                    simplified = Strings.strip_end(Strings.strip_start(simplified, "{{"), "}}");
                if (JavaScript.isProperIdentifier(simplified)) {
                    args = Functions.getArguments(args);
                    args.unshift(simplified);
                    this._node._handler.execute.apply(this._node._handler, args);
                } else
                    this._execute(value);
            }


        };
    }, {

        meta: {
            // value_hidden: false
            // requires_tag_handler: false
        },

        register: function(key, registry) {
            registry = registry || Registries.partial;
            registry.register(key, this);
        }

    });
});

Scoped.define("module:Partials.StylesPartial", ["module:Handlers.Partial"], function (Partial, scoped) {
    var Cls = Partial.extend({
        scoped: scoped
    }, {

        _apply: function(value) {
            for (var key in value)
                this._node._element.style[key] = value[key];
        }

    });
    Cls.register("ba-styles");
    return Cls;
});

Scoped.define("module:Partials.ShowPartial", ["module:Handlers.Partial"], function (Partial, scoped) {
    /**
     * @name ba-show
     *
     * @description
     * The ba-show partials controls showing the internal Html on the Dom based on
     * the truth value of the given expression.
     *
     * @param {expression} baShow Expression to evaluate for truth. If true,
     * internal html will be displayed. If false, internal html will not be
     * displayed. Expression must be wrapped in {{}} so it will be evaluated, as
     * seen below.
     *
     * @example <p ba-show="{{1 === 1}}">Hi</p>
     * // Evalues to <p>Hi</p>
     * @example <p ba-show="{{1 === 2}}">Hi</p>
     * // Evalues to <p style="display: none;">Hi</p>
     */
    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value) {
                inherited.constructor.apply(this, arguments);
                this.__oldDisplay = undefined;
                this.__readOldDisplay = false;
                this.__hidden = false;
                if (!value)
                    this.__hide();
            },

            __hide: function() {
                if (this.__hidden)
                    return;
                this.__hidden = true;
                if (!this.__readOldDisplay) {
                    this.__oldDisplay = this._node._element.style.display;
                    this.__readOldDisplay = true;
                }
                this._node._element.style.display = "none";
            },

            __show: function() {
                if (!this.__hidden)
                    return;
                this.__hidden = false;
                this._node._element.style.display = this.__oldDisplay && this.__oldDisplay !== 'none' ? this.__oldDisplay : "";
            },

            _apply: function(value) {
                if (value)
                    this.__show();
                else
                    this.__hide();
            }

        };
    });
    Cls.register("ba-show");
    return Cls;
});

Scoped.define("module:Partials.IfPartial", ["module:Partials.ShowPartial"], function (Partial, scoped) {
    /**
     * @name ba-if
     *
     * @description
     * The ba-if partial controls rendering of internal Html based on the truth
     * value of a given expression. It differs from ba-show in that ba-show
     * renders internal Html, but hides it, while ba-if will not render the
     * internal Html at all.
     *
     * @param {expression} baIf Expression to evaluate for truth. If true,
     * internal html will be rendered. If false, internal html will not be
     * rendered. Note, if the expression should be evaluted, it must be wrapped in
     * {{}}. See the examples below.
     *
     * @example <div ba-if="{{1 === 1}}"><h1>Hi</h1><div>
     * // Evaluated to <div><h1>Hi</h1></div>
     *
     * @example <div ba-if="{{1 === 2}}"></h1>Hi</h1></div>
     * // Evaluated to <div></div>
     */
    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value) {
                inherited.constructor.apply(this, arguments);
                if (!value)
                    node.deactivate();
            },

            _apply: function(value) {
                inherited._apply.call(this, value);
                if (value)
                    this._node.activate();
                else
                    this._node.deactivate();
            }

        };
    });
    Cls.register("ba-if");
    return Cls;
});

Scoped.define("module:Partials.ClickPartial", ["module:Handlers.Partial","browser:Events"], function (Partial, Events, scoped) {
    /**
     * @name ba-click
     *
     * @description
     * The ba-click partial allows the specification of custom on clicked
     * behavior. By default, the click propagation is prevented. Should you want
     * the click to propagate, use the `onclick` Html tag.
     *
     * @param {expression} baClick Expression to evaluate upon click. If click is
     * within the scope of another directive, the Expression can be an exposed method of
     * the parent directive.
     *
     * @example <button ba-click="showing = !showing">
     * // Expression is evaluated (ex. showing now equals inverse) on click.
     *
     * @example <button ba-click="exposedMethod()">
     * // Calls parentDirective.call("exposedMethod") on click.
     *
     * @example <button ba-click="exposedMethod(arg)">
     * // Calls parentDirective.call("exposedMethod", arg) on click.
     */
    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value) {
                inherited.constructor.apply(this, arguments);
                var events = this.auto_destroy(new Events());
                events.on(this._node.element(), "click", function(e) {
                    e.stopPropagation();
                    this._execute();
                }, this);
            }

        };
    }, {

        manualExecute: true

    });
    Cls.register("ba-click");
    return Cls;
});

Scoped.define("module:Partials.EventPartial", ["module:Handlers.Partial","base:Functions"], function (Partial, Functions, scoped) {
    var Cls = Partial.extend({
        scoped: scoped
    }, {

        bindTagHandler: function(handler) {
            var pf = this._postfix.trim();
            var fwd = pf.indexOf("~") === 0;
            if (fwd)
                pf = pf.substring(1);
            handler.on(pf, function() {
                if (fwd) {
                    var args = Functions.getArguments(arguments);
                    args.unshift(this._value || pf);
                    this._node._handler.trigger.apply(this._node._handler, args);
                } else
                    this._valueExecute(arguments);
            }, this);
        }

    }, {

        manualExecute: true

    });
    Cls.register("ba-event");
    return Cls;
});

Scoped.define("module:Partials.OnPartial", ["module:Handlers.Partial","browser:Events"], function (Partial, Events, scoped) {
    /**
     * @name ba-on
     *
     * @description
     * The ba-on partial executes the given expression when triggered by the
     * specified Dom event on the given Html element. For a complete list of Dom
     * events, see {@link http://www.w3schools.com/jsref/dom_obj_event.asp}
     *
     * @postfix {event} event The event triggering the expression is specified as
     * a post fix of the ba-on directive. See the examples.
     *
     * @param {expression} baOn Expression to evaluate upon the occurence of the
     * event. If within the scope of another directive, the expression can be an
     * exposed method of the parent directive (see ba-click documentation for
     * greater detail).
     *
     * @example <button ba-on:mouseover="alert('Hi')">Hi</button>
     * // Will alert('Hi') when the mouseover event occurs on the button.
     */
    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value, postfix) {
                inherited.constructor.apply(this, arguments);
                var events = this.auto_destroy(new Events());
                events.on(this._node._element, postfix.trim(), function() {
                    this._execute(value.trim());
                }, this);
            }

        };
    }, {

        manualExecute: true

    });
    Cls.register("ba-on");
    return Cls;
});

Scoped.define("module:Partials.TogglePartial", ["module:Handlers.Partial"], function (Partial, scoped) {
    var mapping = {
        readonly: "readOnly",
        playsinline: "playsInline"
    };

    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value, postfix) {
                inherited.constructor.apply(this, arguments);
                this._apply(value);
            },

            _apply: function(value) {
                this._node.element()[mapping[this._postfix] || this._postfix] = value ? this._postfix : null;
            }

        };
    });
    Cls.register("ba-toggle");
    return Cls;
});

Scoped.define("module:Partials.TemplatePartial", ["module:Handlers.Partial"], function (Partial, scoped) {

    var Cls = Partial.extend({
        scoped: scoped
    }, {

        bindTagHandler: function(handler) {
            if (this._value)
                handler.template = this._value;
        }

    }, {

        meta: {
            requires_tag_handler: true,
            value_hidden: true
        }

    });
    Cls.register("ba-template");
    return Cls;

});

Scoped.define("module:Partials.HotkeyPartial", ["module:Handlers.Partial","browser:Events","browser:Hotkeys"], function (Partial, Events, Hotkeys, scoped) {
    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value) {
                inherited.constructor.apply(this, arguments);
                var events = this.auto_destroy(new Events());
                var hotkey = this._postfix;
                events.on(this._node._element, "keydown", function(e) {
                    if (Hotkeys.handleKeyEvent(hotkey, e))
                        this._valueExecute([e]);
                }, this);
            }

        };
    }, {

        manualExecute: true

    });
    Cls.register("ba-hotkey");
    return Cls;
});

Scoped.define("module:Partials.RepeatPartial", ["module:Handlers.Partial","base:Promise","base:Properties.Properties","base:Collections.Collection","base:Collections.FilteredCollection","base:Objs","base:Classes.SharedObjectFactory","module:Parser","module:Registries"], function (Partial, Promise, Properties, Collection, FilteredCollection, Objs, SharedObjectFactory, Parser, Registries, scoped) {
    /**
     * @name ba-repeat
     *
     * @description
     * Instantiate once for each instance in the collection. Render only the inner html
     * of the element for each instance.
     *
     * @param {object} instance Object representing a single element in the
     * collection. Updated as collection is iterated through.
     *
     * @param {object} collection Object representing multiple elements, each of
     * which will be instantiated.
     *
     * @example <ul ba-repeat-element="{{ i :: [1,2] }}"><li>{{i}}</li></ul>
     * // Evaluates to <ul><li>1</li><li>2</li></ul>
     */

    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value) {
                inherited.constructor.apply(this, arguments);
                this.__registered = false;
                args = args.split("::");
                if (args.length > 1)
                    this.__dynOpts = Parser.parseCode(args[0].trim());
                args = args[args.length - 1];
                args = args.split("~");
                this.__repeatArg = args[0].trim();
                this._destroyCollection = false;
                this._releaseValueCollection = false;
                if (args.length > 1) {
                    this.__repeatFilter = Parser.parseCode(args[1].trim());
                    var self = this;
                    node.mesh().watch(this.__repeatFilter.dependencies, function() {
                        self.__filterChanged();
                    }, this.__repeatFilter);
                }
                node._expandChildren = false;
                try {
                    node._element.innerHTML = "";
                } catch (e) {}
            },

            destroy: function() {
                this.__unregister();
                if (this.__repeatFilter)
                    this._node.mesh().unwatch(this.__repeatFilter.dependencies, this.__repeatFilter);
                inherited.destroy.call(this);
            },

            _activate: function() {
                this.__register();
                if (this.__dynOpts)
                    this.__dynOptsCache = this._node.mesh().execute(this.__dynOpts.dependencies, this.__dynOpts.func);
            },

            _deactivate: function() {
                this.__unregister();
            },

            __filterChanged: function() {
                if (!this._active)
                    return;
                this._collection.setFilter(this.__filterFunc, this);
            },

            _change: function(value, oldValue) {
                this.__register(value);
            },

            __filterFunc: function(prop) {
                var filter = this.__repeatFilter;
                if (!filter)
                    return true;
                var self = this;
                return this._node.mesh().execute(filter.dependencies, function(obj) {
                    obj[self.__repeatArg] = self._isArray ? prop.get("value") : prop.data();
                    return filter.func.call(this, obj);
                }, true);
            },

            _iterateCollection: function(callback) {
                this._collection.iterate(callback, this);
            },

            __register: function() {
                this.__unregister();
                if (Collection.is_instance_of(this._value) && this._value.destroyed())
                    return;
                if (SharedObjectFactory.is_instance_of(this._value)) {
                    this._isArray = false;
                    this._releaseValueCollection = true;
                    this._valueCollection = this._value.acquire();
                } else {
                    this._isArray = !Collection.is_instance_of(this._value);
                    this._releaseValueCollection = !Collection.is_instance_of(this._value);
                    this._valueCollection = this._releaseValueCollection ? new Collection({
                        objects: Objs.map(this._value, function(val) {
                            return new Properties({
                                value: val
                            });
                        }),
                        release_references: true
                    }) : this._value;
                }
                this._destroyCollection = !!this.__repeatFilter;
                this._collection = this._destroyCollection ? new FilteredCollection(this._valueCollection, {
                    filter: this.__filterFunc,
                    context: this
                }) : this._valueCollection;
                this._collectionChildren = {};
                this._iterateCollection(this.__addItem);
                this._collection.on("add", this.__addItem, this);
                this._collection.on("remove", function(item) {
                    this.__removeItem(item, this._collection.bulkOperationInProgress());
                }, this);
                this._collection.on("reindexed", function(item) {
                    if (this._collection.count() < 2)
                        return;
                    var idx = this._collection.getIndex(item);
                    if (idx === 0)
                        this._prependItem(this._collection.getByIndex(1), item);
                    else
                        this._appendItem(this._collection.getByIndex(idx - 1), item);
                }, this);
            },

            __unregister: function() {
                if (this._collection && !this._collection.destroyed()) {
                    this._iterateCollection(function(item) {
                        this.__removeItem(item, true);
                    }, this);
                }
                var element = this._node._element;
                this._node._removeChildren();
                element.innerHTML = "";
                if (this._collection && !this._collection.destroyed())
                    this._collection.off(null, null, this);
                if (this._valueCollection && !this._valueCollection.destroyed())
                    this._valueCollection.off(null, null, this);
                if (this._destroyCollection && this._collection)
                    this._collection.weakDestroy();
                if (this._releaseValueCollection && this._valueCollection && !this._valueCollection.destroyed())
                    this._valueCollection.decreaseRef();
                this._valueCollection = null;
                this._collection = null;
            },

            __addItem: function(item) {
                if (this._collectionChildren[item.cid()])
                    return;
                var locals = {};
                if (this.__repeatArg)
                    locals[this.__repeatArg] = this._isArray ? item.get("value") : item;
                var result = [];
                var elements = this._newItemElements();
                elements.forEach(function(element) {
                    result.push(this._node._registerChild(element, locals));
                }, this);
                this._collectionChildren[item.cid()] = {
                    item: item,
                    nodes: result
                };
                var idx = this._collection.getIndex(item);
                if (idx < this._collection.count() - 1)
                    this._prependItem(this._collection.getByIndex(idx + 1), item);
            },

            __removeItem: function(item, instant) {
                if (!this._collectionChildren[item.cid()])
                    return;
                Objs.iter(this._collectionChildren[item.cid()].nodes, function(node) {
                    var ele = node.element();
                    var removePromise = Promise.create();
                    if (this.__dynOptsCache && this.__dynOptsCache.onremove && !instant)
                        this.__dynOptsCache.onremove.call(this._handler, item, ele).forwardCallback(removePromise);
                    else
                        removePromise.asyncSuccess(true);
                    removePromise.success(function() {
                        node.weakDestroy();
                        if (ele.parentNode)
                            ele.parentNode.removeChild(ele);
                    });
                }, this);
                delete this._collectionChildren[item.cid()];
            },

            _itemData: function(item) {
                return this._collectionChildren[item.cid()];
            },

            _itemDataElements: function(item) {
                var itemData = this._itemData(item);
                if (!itemData)
                    return null;
                var result = [];
                Objs.iter(itemData.nodes, function(node) {
                    result.push(node.element());
                });
                return result;
            },

            _prependItem: function(base, item) {
                var baseDataElements = this._itemDataElements(base);
                var itemDataElements = this._itemDataElements(item);
                if (!baseDataElements || !itemDataElements)
                    return;
                Objs.iter(itemDataElements, function(element) {
                    element.parentNode.insertBefore(element, baseDataElements[0]);
                });
            },

            _appendItem: function(base, item) {
                var baseDataElements = this._itemDataElements(base);
                var itemDataElements = this._itemDataElements(item);
                if (!baseDataElements || !itemDataElements)
                    return;
                var current = baseDataElements[baseDataElements.length - 1];
                Objs.iter(itemDataElements, function(element) {
                    current.parentNode.insertBefore(element, current.nextSibling);
                    current = element;
                });
            },

            _newItemElements: function() {
                var elements = Registries.templates.create(this._node._innerTemplate);
                var parent = this._node.element();
                elements.forEach(function(element) {
                    parent.appendChild(element);
                });
                return elements;
            }

        };
    });
    Cls.register("ba-repeat");
    return Cls;
});

Scoped.define("module:Partials.RepeatElementPartial", ["module:Partials.RepeatPartial","base:Collections.Collection","base:Collections.FilteredCollection","base:Objs","module:Parser","base:Properties.Properties","browser:Dom"], function (Partial, Collection, FilteredCollection, Objs, Parser, Properties, Dom, scoped) {
    /**
     * @name ba-repeat-element
     *
     * @description
     * Instantiate entire Html element (both element and the html is closes)
     * once for each instance in the collection.
     * Differs from ba-repeat, in that while ba-repeat instantiates just the
     * inner Html contents of the given element for each instance in the
     * collection, ba-repeat-element instantiates the Html element and the inner
     * Html contents. See examples.
     * 
     * @param {object} instance Object representing a single element in the
     * collection. Updated as collection is iterated through.
     *
     * @param {object} collection Object representing multiple elements, each of
     * which will be instantiated.
     *
     * @example <p ba-repeat-element="{{ i :: [1,2,3] }}">{{i}}</p>
     * // Evalues to <p>1</p><p>2</p><p>3</p>
     */
    var Cls = Partial.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(node, args, value) {
                inherited.constructor.apply(this, arguments);
                var temp = Dom.elementByTemplate(node._template);
                temp.removeAttribute("ba-repeat-element");
                this.__filteredTemplate = temp.outerHTML.trim();
            },

            _activate: function() {
                this._node.element().style.display = "none";
                inherited._activate.call(this);
            },

            _iterateCollection: function(callback) {
                var a = this._collection.iterator().asArray();
                for (var i = a.length - 1; i >= 0; --i)
                    callback.call(this, a[i]);
            },

            _newItemElements: function() {
                var element = Dom.elementByTemplate(this.__filteredTemplate);
                this._node.element().parentNode.insertBefore(element, this._node.element().nextSibling);
                element["ba-handled"] = true;
                return [element];
            },

            prepareTagHandler: function(createArguments) {
                createArguments.ignoreTagHandler = true;
            }

        };
    });
    Cls.register("ba-repeat-element");
    return Cls;
});

Scoped.define("module:Partials.DataPartial", ["module:Handlers.Partial"], function (Partial, scoped) {
    var Cls = Partial.extend({
        scoped: scoped
    }, {

        _apply: function(value) {
            this._node._tagHandler.data(this._postfix, value);
        },

        bindTagHandler: function(handler) {
            this._apply(this._value);
        }

    }, {

        meta: {
            requires_tag_handler: true
        }

    });
    Cls.register("ba-data");
    return Cls;
});

Scoped.define("module:Partials.AttrsPartial", ["module:Handlers.Partial","base:Objs","base:Class"], function (Partial, Objs, Class, scoped) {
    /**
     * @name ba-attrs
     *
     * @description
     * The ba-attrs partial allows the specification of an object that will
     * provide attributes accessible within the element containing the ba-attrs
     * html attribute.
     *
     * @param {object} baAttrs Object containing individual attributes.
     *
     * @example <div ba-attrs="{{{test: 'hi'}}}">{{test}}</div>
     * // Evaluates to <div ba-attrs="{{{test: 'hi'}}}">hi</div>
     */
    var Cls = Partial.extend({
        scoped: scoped
    }, {

        _apply: function(value) {
            if (!this._active)
                return;
            var props = this._node._tagHandler ? this._node._tagHandler.properties() : this._node.properties();
            for (var key in value)
                props.set(key, value[key]);
        },

        bindTagHandler: function(handler) {
            for (var key in this._value)
                handler.setArgumentAttr(key, Class.is_pure_json(this._value[key]) ? Objs.clone(this._value[key], 1) : this._value[key]);
        }

    });
    Cls.register("ba-attrs");
    return Cls;
});

Scoped.define("module:DomObserver", ["base:Class","base:Objs","browser:DomMutation.NodeInsertObserver","module:Registries","module:Dynamic","browser:Dom"], function (Class, Objs, NodeInsertObserver, Registries, Dynamic, Dom, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this);
                options = options || {};
                this.__initialRoot = options.root;
                this.__persistent_dynamics = !!options.persistent_dynamics;
                this.__allowed_dynamics = options.allowed_dynamics ? Objs.objectify(options.allowed_dynamics) : null;
                this.__forbidden_dynamics = options.forbidden_dynamics ? Objs.objectify(options.forbidden_dynamics) : null;
                this.__ignore_existing = options.ignore_existing;
                this.__dynamics = {};
                this.__enabled = false;
                if (!("enabled" in options) || options.enabled)
                    this.enable();
            },

            enable: function() {
                if (this.__enabled)
                    return;
                this.__enabled = true;
                this.__root = Dom.unbox(this.__initialRoot || document.body);
                if (!this.__ignore_existing)
                    Objs.iter(Registries.handler.classes(), this.__registerExisting, this);
                this.__observer = NodeInsertObserver.create({
                    root: this.__root,
                    filter: this.__observerFilter,
                    context: this
                });
                this.__observer.on("node-inserted", this.__nodeInserted, this);
            },

            disable: function() {
                if (!this.__enabled)
                    return;
                this.__enabled = false;
                this.__observer.weakDestroy();
            },

            __registerExisting: function(cls, key) {
                if (this.__forbidden_dynamics && this.__forbidden_dynamics[key])
                    return;
                if (this.__allowed_dynamics && !this.__allowed_dynamics[key])
                    return;
                var tags = this.__root.getElementsByTagName(key.toUpperCase());
                for (var i = 0; i < tags.length; ++i) {
                    var elem = tags[i];
                    if (!elem.dynamicshandler)
                        this.__nodeInserted(elem);
                }
            },

            addAllowedDynamic: function(key) {
                this.__allowed_dynamics = this.__allowed_dynamics || {};
                this.__allowed_dynamics[key] = true;
                var cls = (Registries.handler.classes())[key];
                if (this.__enabled && !this.__ignore_existing && cls)
                    this.__registerExisting(cls, key);
            },

            destroy: function() {
                this.disable();
                Objs.iter(this.__dynamics, function(dynamic) {
                    dynamic.off(null, null, this);
                    if (!this.__persistent_dynamics)
                        dynamic.weakDestroy();
                }, this);
                inherited.destroy.call(this);
            },

            __observerFilter: function(node) {
                if (node.dynamicshandler || !node.tagName)
                    return false;
                var tag = node.tagName.toLowerCase();
                if (!Registries.handler.get(tag))
                    return false;
                if (this.__forbidden_dynamics && this.__forbidden_dynamics[tag])
                    return false;
                if (this.__allowed_dynamics && !this.__allowed_dynamics[tag])
                    return false;
                return true;
            },

            __nodeInserted: function(node) {
                var dynamic = new Dynamic({
                    element: node,
                    remove_observe: true
                });
                this.__dynamics[dynamic.cid()] = dynamic;
                dynamic.on("destroy", function() {
                    delete this.__dynamics[dynamic.cid()];
                }, this);
                dynamic.activate();
            }

        };
    }, {

        __singleton: null,

        activate: function(options) {
            if (!this.__singleton)
                this.__singleton = new this(options);
        }

    });
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('base', 'root:BetaJS');
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('media', 'root:BetaJS.Media');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.define("module:", function () {
	return {
    "guid": "7a20804e-be62-4982-91c6-98eb096d2e70",
    "version": "0.0.108"
};
});

Scoped.define("module:Ads.AbstractVideoAdProvider", ["base:Class"], function (
    Class, scoped) {
    return Class.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this);
                this._options = options;
            },

            options: function() {
                return this._options;
            },

            _newPrerollAd: function(options) {},

            newPrerollAd: function(options) {
                return this._newPrerollAd(options);
            },

            register: function(name) {
                this.cls.registry[name] = this;
            }

        };
    }, {

        registry: {}

    });
});

Scoped.define("module:Ads.AbstractPrerollAd", ["base:Class","base:Events.EventsMixin"], function (Class, EventsMixin, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(provider, options) {
                inherited.constructor.call(this);
                this._provider = provider;
                this._options = options;
            },

            executeAd: function(options) {
                this._options.adElement.style.display = "";
                this._executeAd(options);
            },

            _adFinished: function() {
                this._options.adElement.style.display = "none";
                this.trigger("finished");
            },

            _adSkipped: function() {
                this._options.adElement.style.display = "none";
                this.trigger("adskipped");
            }

        };
    }]);
});

Scoped.define("module:Ads.AdSensePrerollAd", ["module:Ads.AbstractPrerollAd"], function (AbstractVideoPrerollAd, scoped) {
    return AbstractVideoPrerollAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(provider, options) {
                inherited.constructor.call(this, provider, options);
                this._adDisplayContainer = new google.ima.AdDisplayContainer(this._options.adElement, this._options.videoElement);
                // Must be done as the result of a user action on mobile
                this._adDisplayContainer.initialize();
                //Re-use this AdsLoader instance for the entire lifecycle of your page.
                this._adsLoader = new google.ima.AdsLoader(this._adDisplayContainer);

                var self = this;
                this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, function() {
                    self._adError();
                }, false);
                this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, function() {
                    self._adLoaded.apply(self, arguments);
                }, false);

                this._adsRequest = new google.ima.AdsRequest();
                this._adsRequest.adTagUrl = this._provider.options().adTagUrl;
            },

            _executeAd: function(options) {
                // Specify the linear and nonlinear slot sizes. This helps the SDK to
                // select the correct creative if multiple are returned.
                this._adsRequest.linearAdSlotWidth = options.width;
                this._adsRequest.linearAdSlotHeight = options.height;
                // adsRequest.nonLinearAdSlotWidth = 640;
                // adsRequest.nonLinearAdSlotHeight = 150;

                this._adsLoader.requestAds(this._adsRequest);
            },

            _adError: function() {
                if (this._adsManager)
                    this._adsManager.destroy();
                this._adFinished();
            },

            _adLoaded: function(adsManagerLoadedEvent) {
                // Get the ads manager.
                this._adsManager = adsManagerLoadedEvent.getAdsManager(this._options.videoElement);
                // See API reference for contentPlayback

                try {
                    // Initialize the ads manager. Ad rules playlist will start at this time.
                    this._adsManager.init(this._adsRequest.linearAdSlotWidth, this._adsRequest.linearAdSlotHeight, google.ima.ViewMode.NORMAL);
                    // Call start to show ads. Single video and overlay ads will
                    // start at this time; this call will be ignored for ad rules, as ad rules
                    // ads start when the adsManager is initialized.
                    this._adsManager.start();
                } catch (adError) {
                    // An error may be thrown if there was a problem with the VAST response.
                }

                var self = this;
                // Add listeners to the required events.
                this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, function() {
                    self._adError();
                }, false);

                //this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED, function () {});
                this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED, function() {
                    self._adFinished();
                });

                //this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED, function () {});
                this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED, function() {
                    self._adSkipped();
                });
            }

        };
    });
});

Scoped.define("module:Ads.AdSenseVideoAdProvider", ["module:Ads.AbstractVideoAdProvider","module:Ads.AdSensePrerollAd"], function (AbstractVideoAdProvider, AdSensePrerollAd, scoped) {
        return AbstractVideoAdProvider.extend({
            scoped: scoped
        }, {

            _newPrerollAd: function(options) {
                return new AdSensePrerollAd(this, options);
            }

        });
    });

Scoped.define("module:Ads.VAST.Ad", ["base:Class","base:Objs","base:Events.EventsMixin"], function (Class, Objs, EventsMixin, scoped) {
    return Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.id = null;
                this.sequence = null;
                this.system = null;
                this.title = null;
                this.description = null;
                this.advertiser = null;
                this.pricing = null;
                this.survey = null;
                this.errorURLTemplates = [];
                this.impressionURLTemplates = [];
                this.creatives = [];
                this.extensions = [];

                this.trackingEvents = {};
                this.availableTrackingEvents = ['creativeView', 'start', 'firstQuartile', 'midpoint', 'thirdQuartile', 'complete', 'rewind', 'skip', 'closeLinear', 'close', 'mute', 'unmute', 'pause', 'resume', 'playerExpand', 'playerCollapse', 'acceptInvitationLinear', 'timeSpentViewing', 'otherAdInteraction', 'progress', 'acceptInvitation', 'adExpand', 'adCollapse', 'minimize', 'overlayViewDuration', 'fullscreen', 'exitFullscreen', 'clickthrough'];

                Objs.iter(this.availableTrackingEvents, function(_event) {
                    this.trackingEvents[_event] = null;
                }, this);

            }
        };
    }], {
        isNumeric: function(n) {
            return !isNaN(parseFloat(n)) && isFinite(n);
        },

        trackAd: function(URLTemplates, variables) {
            var URL, URLs, i, j, len, results;
            URLs = this.resolveURLTemplates(URLTemplates, variables);
            results = [];
            for (j = 0, len = URLs.length; j < len; j++) {
                URL = URLs[j];
                if (typeof window !== "undefined" && window !== null) {
                    i = new Image();
                    results.push(i.src = URL);
                } else {

                }
            }
            return results;
        },

        resolveURLTemplates: function(URLTemplates, variables) {
            var URLTemplate, URLs, j, key, len, macro1, macro2, resolveURL, value;
            if (!variables) {
                variables = {};
            }
            URLs = [];
            if (variables.ASSETURI) {
                variables.ASSETURI = this.encodeURIComponentRFC3986(variables.ASSETURI);
            }
            if (variables.CONTENTPLAYHEAD) {
                variables.CONTENTPLAYHEAD = this.encodeURIComponentRFC3986(variables.CONTENTPLAYHEAD);
            }
            if ((variables.ERRORCODE) && !/^[0-9]{3}$/.test(variables.ERRORCODE)) {
                variables.ERRORCODE = 900;
            }
            variables.CACHEBUSTING = this.leftpad(Math.round(Math.random() * 1.0e+8).toString());
            variables.TIMESTAMP = this.encodeURIComponentRFC3986((new Date()).toISOString());
            variables.RANDOM = variables.random = variables.CACHEBUSTING;
            for (j = 0, len = URLTemplates.length; j < len; j++) {
                URLTemplate = URLTemplates[j];
                resolveURL = URLTemplate;
                if (!resolveURL) {
                    continue;
                }
                for (key in variables) {
                    value = variables[key];
                    macro1 = "[" + key + "]";
                    macro2 = "%%" + key + "%%";
                    resolveURL = resolveURL.replace(macro1, value);
                    resolveURL = resolveURL.replace(macro2, value);
                }
                URLs.push(resolveURL);
            }
            return URLs;
        },

        leftpad: function(str) {
            if (str.length < 8) {
                return ((function() {
                    var j, ref, results;
                    results = [];
                    for (j = 0, ref = 8 - str.length; 0 <= ref ? j < ref : j > ref; 0 <= ref ? j++ : j--) {
                        results.push('0');
                    }
                    return results;
                })()).join('') + str;
            } else {
                return str;
            }
        },

        encodeURIComponentRFC3986: function(str) {
            return encodeURIComponent(str).replace(/[!'()*]/g, function(c) {
                return '%' + c.charCodeAt(0).toString(16);
            });
        },

        storage: (function() {
            var data, isDisabled, storage, storageError;
            try {
                storage = typeof window !== "undefined" && window !== null ? window.localStorage || window.sessionStorage : null;
            } catch (error) {
                storageError = error;
                storage = null;
            }
            isDisabled = function(store) {
                var e, testValue;
                try {
                    testValue = '__VAST__';
                    store.setItem(testValue, testValue);
                    if (store.getItem(testValue) !== testValue) {
                        return true;
                    }
                } catch (error) {
                    e = error;
                    return true;
                }
                return false;
            };
            if ((storage === null) || isDisabled(storage)) {
                data = {};
                storage = {
                    length: 0,
                    getItem: function(key) {
                        return data[key];
                    },
                    setItem: function(key, value) {
                        data[key] = value;
                        this.length = Object.keys(data).length;
                    },
                    removeItem: function(key) {
                        delete data[key];
                        this.length = Object.keys(data).length;
                    },
                    clear: function() {
                        data = {};
                        this.length = 0;
                    }
                };
            }
            return storage;
        })()
    });
});

Scoped.define("module:Ads.VAST.Response", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                this.ads = [];
                this.errorURLTemplates = [];
            }
        };
    });
});

Scoped.define("module:Ads.VAST.CompanionAd", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.id = null;
                this.width = 0;
                this.height = 0;
                this.type = null;
                this.staticResource = null;
                this.htmlRecource = null;
                this.iframeResource = null;
                this.altText = null;
                this.companionClickThroughURLTemplate = null;
                this.companionClickTrackingURLTemplates = [];
            }
        };
    });
});

Scoped.define("module:Ads.VAST.Creative", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function(creativeAttributes) {
                inherited.constructor.call(this);

                if (creativeAttributes === null) {
                    creativeAttributes = {};
                }

                this.id = creativeAttributes.id || null;
                this.adId = creativeAttributes.adId || null;
                this.sequence = creativeAttributes.sequence || null;
                this.apiFramework = creativeAttributes.apiFramework || null;

            }
        };
    });
});

Scoped.define("module:Ads.VAST.CreativeLinear", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.type = "linear";
                this.duration = 0;
                this.skipDelay = null;
                this.mediaFiles = [];
                this.videoClickThroughURLTemplate = null;
                this.videoClickTrackingURLTemplates = [];
                this.videoCustomClickURLTemplates = [];
                this.adParameters = null;
                this.icons = [];
            }
        };
    });
});

Scoped.define("module:Ads.VAST.CreativeNonLinear", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.type = "nonlinear";
                this.variations = [];

            }
        };
    });
});

Scoped.define("module:Ads.VAST.AdExtension", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.attributes = {};
                this.children = [];
            }
        };
    });
});

Scoped.define("module:Ads.VAST.AdExtensionChild", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.name = null;
                this.value = null;
                this.attributes = {};
            }
        };
    });
});

Scoped.define("module:Ads.VAST.Icon", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.program = null;
                this.height = 0;
                this.width = 0;
                this.xPosition = 0;
                this.yPosition = 0;
                this.apiFramework = null;
                this.offset = null;
                this.duration = 0;
                this.type = null;
                this.staticResource = null;
                this.htmlResource = null;
                this.iframeResource = null;
                this.iconClickThroughURLTemplate = null;
                this.iconClickTrackingURLTemplates = [];
                this.iconViewTrackingURLTemplate = null;
            }
        };
    });
});

Scoped.define("module:Ads.VAST.MediaFile", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function(inherited) {
                this.id = null;
                this.fileURL = null;
                this.deliveryType = "progressive";
                this.mimeType = null;
                this.codec = null;
                this.bitrate = 0;
                this.minBitrate = 0;
                this.maxBitrate = 0;
                this.width = 0;
                this.height = 0;
                this.apiFramework = null;
                this.scalable = null;
                this.maintainAspectRatio = null;
            }
        };
    });
});

Scoped.define("module:Ads.VAST.CreativeCompanion", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function(inherited) {
                inherited.constructor.call(this);
                this.type = "companion";
                this.variations = [];

            }
        };
    });
});

Scoped.define("module:Ads.VAST.NonLinear", ["module:Ads.VAST.Ad"], function (VASTAd, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function() {
                inherited.constructor.call(this);
                this.id = null;
                this.width = 0;
                this.height = 0;
                this.expandedWidth = 0;
                this.expandedHeight = 0;
                this.scalable = true;
                this.maintainAspectRatio = true;
                this.minSuggestedDuration = 0;
                this.apiFramework = "static";
                this.type = null;
                this.staticResource = null;
                this.htmlResource = null;
                this.iframeResource = null;
                this.nonlinearClickThroughURLTemplate = null;
                this.nonlinearClickTrackingURLTemplates = [];
                this.adParameters = null;
            }
        };
    });
});

Scoped.define("module:Ads.VAST.Parser", ["module:Ads.VAST.Ad","base:Ajax.Support","module:Ads.VAST.Response","module:Ads.VAST.CreativeLinear","module:Ads.VAST.MediaFile","module:Ads.VAST.CreativeCompanion","module:Ads.VAST.CreativeNonLinear","module:Ads.VAST.CompanionAd","module:Ads.VAST.AdExtension","module:Ads.VAST.AdExtensionChild","module:Ads.VAST.NonLinear"], function (VASTAd, AjaxSupport, VASTResponse, VASTCreativeLinear, VASTMediaFile, VASTCreativeCompanion, VASTCreativeNonLinear, VASTCompanionAd, VASTAdExtension, VASTAdExtensionChild, VASTNonLinear, scoped) {
        return VASTAd.extend({
            scoped: scoped
        }, function(inherited) {
            return {
                constructor: function() {
                    inherited.constructor.call(this);
                    this.URLTemplateFilters = [];
                },

                _indexOf: function(item) {
                    for (var i = 0, l = this.length; i < l; i++) {
                        if (i in this && this[i] === item) return i;
                    }
                    return -1;
                },

                addURLTemplateFilter: function(func) {
                    if (typeof func === 'function') {
                        URLTemplateFilters.push(func);
                    }
                },

                removeURLTemplateFilter: function() {
                    return URLTemplateFilters.pop();
                },

                countURLTemplateFilters: function() {
                    return URLTemplateFilters.length;
                },

                clearUrlTemplateFilters: function() {
                    URLTemplateFilters = [];
                    return URLTemplateFilters;
                },

                parse: function(url, options, cb) {
                    if (!cb) {
                        if (typeof options === 'function') {
                            cb = options;
                        }
                        options = {};
                    }
                    return this._parse(url, null, options, function(err, response) {
                        return cb(err, response);
                    });
                },

                track: function(templates, errorCode) {
                    return VASTAd.trackAd(templates, errorCode);
                },

                _parse: function(url, parentURLs, options, cb) {
                    var filter, i, len;

                    if (!cb) {
                        if (typeof options === 'function') {
                            cb = options;
                        }
                        options = {};
                    }

                    for (i = 0, len = this.URLTemplateFilters.length; i < len; i++) {
                        filter = URLTemplateFilters[i];
                        url = filter(url);
                    }

                    if (parentURLs === null) {
                        parentURLs = [];
                    }
                    parentURLs.push(url);

                    return AjaxSupport.execute({
                        uri: url,
                        contentType: "xml",
                        decodeType: "xml"
                    }).error(function(err) {
                        cb(err, null);
                    }).success(function(xml) {
                        return this.parseXmlDocument(url, parentURLs, options, xml, cb);
                    }, this);
                },

                __indexOf: [].indexOf || function(item) {
                    for (var i = 0, l = this.length; i < l; i++) {
                        if (i in this && this[i] === item) return i;
                    }
                    return -1;
                },

                parseXmlDocument: function(url, parentURLs, options, xml, cb) {
                    var ad, complete, i, j, len, len1, loopIndex, node, ref, ref1, response, _self;
                    _self = this;
                    response = new VASTResponse();
                    if (!(((xml !== null ? xml.documentElement : void 0) !== null) && xml.documentElement.nodeName === "VAST")) {
                        return cb(new Error('Invalid VAST XMLDocument'));
                    }

                    ref = xml.documentElement.childNodes;
                    for (i = 0, len = ref.length; i < len; i++) {
                        node = ref[i];
                        if (node.nodeName === 'Error') {
                            response.errorURLTemplates.push(this.parseNodeText(node));
                        }
                    }

                    ref1 = xml.documentElement.childNodes;
                    for (j = 0, len1 = ref1.length; j < len1; j++) {
                        node = ref1[j];
                        if (node.nodeName === 'Ad') {
                            ad = this.parseAdElement(node);
                            if (ad !== null) {
                                response.ads.push(ad);
                            } else {
                                this.track(response.errorURLTemplates, {
                                    ERRORCODE: 101,
                                    ERRORMESSAGE: 'VAST schema validation error.'
                                });
                            }
                        }
                    }

                    complete = function(error, errorAlreadyRaised) {
                        var k, len2, noCreatives, ref2;
                        if (error === null) {
                            error = null;
                        }
                        if (errorAlreadyRaised === null) {
                            errorAlreadyRaised = false;
                        }
                        if (!response) {
                            return;
                        }
                        noCreatives = true;
                        ref2 = response.ads;
                        for (k = 0, len2 = ref2.length; k < len2; k++) {
                            ad = ref2[k];
                            if (ad.nextWrapperURL) {
                                return;
                            }
                            if (ad.creatives.length > 0) {
                                noCreatives = false;
                            }
                        }
                        if (noCreatives) {
                            if (!errorAlreadyRaised) {
                                _self.track(response.errorURLTemplates, {
                                    ERRORCODE: 303,
                                    ERRORMESSAGE: 'No VAST response after one or more Wrappers (No creatives)'
                                });
                            }
                        }
                        if (response.ads.length === 0) {
                            response = null;
                        }
                        return cb(error, response);
                    };

                    loopIndex = response.ads.length;
                    while (loopIndex--) {
                        ad = response.ads[loopIndex];
                        if (!ad.nextWrapperURL) {
                            continue;
                        }
                        this._handleComplete.call(this, ad, url, response, parentURLs, options, complete);
                    }
                    return complete();
                },


                _handleComplete: function(ad, url, response, parentURLs, options, complete) {
                    var _ref2;
                    if (parentURLs.length > (options.wrapperLimit ? options.wrapperLimit : 9) || (_ref2 = ad.nextWrapperURL, this.__indexOf.call(parentURLs, _ref2) >= 0)) {
                        this.track(ad.errorURLTemplates, {
                            ERRORCODE: 302,
                            ERRORMESSAGE: 'Wrapper limit reached, as defined by the video player. Too many Wrapper responses have been received with no InLine response.'
                        });
                        response.ads.splice(response.ads.indexOf(ad), 1);
                        complete(new Error("Wrapper limit reached, as defined by the video player"));
                        return;
                    }

                    if (url) {
                        ad.nextWrapperURL = this.resolveVastAdTagURI(ad.nextWrapperURL, url);
                    }

                    return this._parse(ad.nextWrapperURL, parentURLs, options, function(err, wrappedResponse) {
                        var _errorAlreadyRaised, _index, _k, _len2, _ref3, _wrappedAd;
                        _errorAlreadyRaised = false;
                        if (err) {
                            this.track(ad.errorURLTemplates, {
                                ERRORCODE: 301,
                                ERRORMESSAGE: 'Timeout of VAST URI provided in Wrapper element, or of VAST URI provided in a subsequent Wrapper element. (URI was either unavailable or reached a timeout as defined by the video player.)'
                            });
                            response.ads.splice(response.ads.indexOf(ad), 1);
                            _errorAlreadyRaised = true;
                        } else if (!wrappedResponse) {
                            this.track(ad.errorURLTemplates, {
                                ERRORCODE: 303,
                                ERRORMESSAGE: 'No VAST response after one or more Wrappers'
                            });
                            response.ads.splice(response.ads.indexOf(ad), 1);
                            _errorAlreadyRaised = true;
                        } else {
                            response.errorURLTemplates = response.errorURLTemplates.concat(wrappedResponse.errorURLTemplates);
                            _index = response.ads.indexOf(ad);
                            response.ads.splice(_index, 1);
                            _ref3 = wrappedResponse.ads;
                            for (_k = 0, _len2 = _ref3.length; _k < _len2; _k++) {
                                _wrappedAd = _ref3[_k];
                                this.mergeWrapperAdData(_wrappedAd, ad);
                                response.ads.splice(++_index, 0, _wrappedAd);
                            }
                        }
                        delete ad.nextWrapperURL;
                        return complete(err, _errorAlreadyRaised);
                    });
                },

                resolveVastAdTagURI: function(vastAdTagUrl, originalUrl) {
                    var baseURL, protocol;
                    if (vastAdTagUrl.indexOf('//') === 0) {
                        protocol = location.protocol;
                        return "" + protocol + vastAdTagUrl;
                    }
                    if (vastAdTagUrl.indexOf('://') === -1) {
                        baseURL = originalUrl.slice(0, originalUrl.lastIndexOf('/'));
                        return baseURL + "/" + vastAdTagUrl;
                    }
                    return vastAdTagUrl;
                },

                mergeWrapperAdData: function(wrappedAd, ad) {
                    var base, creative, eventName, i, j, k, l, len, len1, len2, len3, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, results, urls;
                    wrappedAd.errorURLTemplates = ad.errorURLTemplates.concat(wrappedAd.errorURLTemplates);
                    wrappedAd.impressionURLTemplates = ad.impressionURLTemplates.concat(wrappedAd.impressionURLTemplates);
                    wrappedAd.extensions = ad.extensions.concat(wrappedAd.extensions);
                    ref = wrappedAd.creatives;
                    for (i = 0, len = ref.length; i < len; i++) {
                        creative = ref[i];
                        if (((ref1 = ad.trackingEvents) !== null ? ref1[creative.type] : void 0) !== null) {
                            ref2 = ad.trackingEvents[creative.type];
                            for (eventName in ref2) {
                                urls = ref2[eventName];
                                if (creative.trackingEvents[eventName]) {
                                    base[eventName] = creative.trackingEvents[eventName];
                                } else {
                                    base[eventName] = [];
                                }
                                creative.trackingEvents[eventName] = creative.trackingEvents[eventName].concat(urls);
                            }
                        }
                    }
                    if ((ref3 = ad.videoClickTrackingURLTemplates) !== null ? ref3.length : void 0) {
                        ref4 = wrappedAd.creatives;
                        for (j = 0, len1 = ref4.length; j < len1; j++) {
                            creative = ref4[j];
                            if (creative.type === 'linear') {
                                creative.videoClickTrackingURLTemplates = creative.videoClickTrackingURLTemplates.concat(ad.videoClickTrackingURLTemplates);
                            }
                        }
                    }
                    if ((ref5 = ad.videoCustomClickURLTemplates) ? ref5.length : void 0) {
                        ref6 = wrappedAd.creatives;
                        for (k = 0, len2 = ref6.length; k < len2; k++) {
                            creative = ref6[k];
                            if (creative.type === 'linear') {
                                creative.videoCustomClickURLTemplates = creative.videoCustomClickURLTemplates.concat(ad.videoCustomClickURLTemplates);
                            }
                        }
                    }
                    if (ad.videoClickThroughURLTemplate) {
                        ref7 = wrappedAd.creatives;
                        results = [];
                        for (l = 0, len3 = ref7.length; l < len3; l++) {
                            creative = ref7[l];
                            if (creative.type === 'linear' && (creative.videoClickThroughURLTemplate === null)) {
                                results.push(creative.videoClickThroughURLTemplate = ad.videoClickThroughURLTemplate);
                            } else {
                                results.push(void 0);
                            }
                        }
                        return results;
                    }
                },

                childByName: function(node, name) {
                    var child, i, len, ref;
                    ref = node.childNodes;
                    for (i = 0, len = ref.length; i < len; i++) {
                        child = ref[i];
                        if (child.nodeName === name) {
                            return child;
                        }
                    }
                },

                childsByName: function(node, name) {
                    var child, childs, i, len, ref;
                    childs = [];
                    ref = node.childNodes;
                    for (i = 0, len = ref.length; i < len; i++) {
                        child = ref[i];
                        if (child.nodeName === name) {
                            childs.push(child);
                        }
                    }
                    return childs;
                },

                parseAdElement: function(adElement) {
                    var adTypeElement, i, len, ref, ref1;
                    ref = adElement.childNodes;
                    for (i = 0, len = ref.length; i < len; i++) {
                        adTypeElement = ref[i];
                        if ((ref1 = adTypeElement.nodeName) !== "Wrapper" && ref1 !== "InLine") {
                            continue;
                        }
                        this.copyNodeAttribute("id", adElement, adTypeElement);
                        this.copyNodeAttribute("sequence", adElement, adTypeElement);
                        if (adTypeElement.nodeName === "Wrapper") {
                            return this.parseWrapperElement(adTypeElement);
                        } else if (adTypeElement.nodeName === "InLine") {
                            return this.parseInLineElement(adTypeElement);
                        }
                    }
                },

                parseWrapperElement: function(wrapperElement) {
                    var ad, base, base1, eventName, i, item, j, k, l, len, len1, len2, len3, name1, ref, ref1, ref2, ref3, ref4, url, urls, wrapperCreativeElement, wrapperURLElement;
                    ad = this.parseInLineElement(wrapperElement);
                    wrapperURLElement = this.childByName(wrapperElement, "VASTAdTagURI");
                    if (wrapperURLElement) {
                        ad.nextWrapperURL = this.parseNodeText(wrapperURLElement);
                    } else {
                        wrapperURLElement = this.childByName(wrapperElement, "VASTAdTagURL");
                        if (wrapperURLElement) {
                            ad.nextWrapperURL = this.parseNodeText(this.childByName(wrapperURLElement, "URL"));
                        }
                    }
                    ref = ad.creatives;
                    for (i = 0, len = ref.length; i < len; i++) {
                        wrapperCreativeElement = ref[i];
                        if ((ref1 = wrapperCreativeElement.type) === 'linear' || ref1 === 'nonlinear') {
                            if (wrapperCreativeElement.trackingEvents) {
                                ad.trackingEvents = ad.trackingEvents ? ad.trackingEvents : {};
                                name1 = wrapperCreativeElement.type;
                                base[name1] = ad.trackingEvents[name1] ? ad.trackingEvents[name1] : {};
                                ref2 = wrapperCreativeElement.trackingEvents;
                                for (eventName in ref2) {
                                    urls = ref2[eventName];
                                    if (urls !== null) {
                                        base1[eventName] = ad.trackingEvents[wrapperCreativeElement.type][eventName] ? ad.trackingEvents[wrapperCreativeElement.type][eventName] : [];
                                        for (j = 0, len1 = urls.length; j < len1; j++) {
                                            url = urls[j];
                                            ad.trackingEvents[wrapperCreativeElement.type][eventName].push(url);
                                        }
                                    }
                                }
                            }
                            if (wrapperCreativeElement.videoClickTrackingURLTemplates) {
                                ad.videoClickTrackingURLTemplates = ad.videoClickTrackingURLTemplates || [];
                                ref3 = wrapperCreativeElement.videoClickTrackingURLTemplates;
                                for (k = 0, len2 = ref3.length; k < len2; k++) {
                                    item = ref3[k];
                                    ad.videoClickTrackingURLTemplates.push(item);
                                }
                            }
                            if (wrapperCreativeElement.videoClickThroughURLTemplate) {
                                ad.videoClickThroughURLTemplate = wrapperCreativeElement.videoClickThroughURLTemplate;
                            }
                            if (wrapperCreativeElement.videoCustomClickURLTemplates) {
                                ad.videoCustomClickURLTemplates = ad.videoCustomClickURLTemplates || [];
                                ref4 = wrapperCreativeElement.videoCustomClickURLTemplates;
                                for (l = 0, len3 = ref4.length; l < len3; l++) {
                                    item = ref4[l];
                                    ad.videoCustomClickURLTemplates.push(item);
                                }
                            }
                        }
                    }
                    if (ad.nextWrapperURL) {
                        return ad;
                    }
                },

                parseInLineElement: function(inLineElement) {
                    var ad, creative, creativeAttributes, creativeElement, creativeTypeElement, i, j, k, len, len1, len2, node, ref, ref1, ref2;
                    ad = new VASTAd();
                    ad.id = inLineElement.getAttribute("id") || null;
                    ad.sequence = inLineElement.getAttribute("sequence") || null;
                    ref = inLineElement.childNodes;
                    for (i = 0, len = ref.length; i < len; i++) {
                        node = ref[i];
                        switch (node.nodeName) {
                            case "Error":
                                ad.errorURLTemplates.push(this.parseNodeText(node));
                                break;
                            case "Impression":
                                ad.impressionURLTemplates.push(this.parseNodeText(node));
                                break;
                            case "Creatives":
                                ref1 = this.childsByName(node, "Creative");
                                for (j = 0, len1 = ref1.length; j < len1; j++) {
                                    creativeElement = ref1[j];
                                    creativeAttributes = {
                                        id: creativeElement.getAttribute('id') || null,
                                        adId: this.parseCreativeAdIdAttribute(creativeElement),
                                        sequence: creativeElement.getAttribute('sequence') || null,
                                        apiFramework: creativeElement.getAttribute('apiFramework') || null
                                    };
                                    ref2 = creativeElement.childNodes;
                                    for (k = 0, len2 = ref2.length; k < len2; k++) {
                                        creativeTypeElement = ref2[k];
                                        switch (creativeTypeElement.nodeName) {
                                            case "Linear":
                                                creative = this.parseCreativeLinearElement(creativeTypeElement, creativeAttributes);
                                                if (creative) {
                                                    ad.creatives.push(creative);
                                                }
                                                break;
                                            case "NonLinearAds":
                                                creative = this.parseNonLinear(creativeTypeElement, creativeAttributes);
                                                if (creative) {
                                                    ad.creatives.push(creative);
                                                }
                                                break;
                                            case "CompanionAds":
                                                creative = this.parseCompanionAd(creativeTypeElement, creativeAttributes);
                                                if (creative) {
                                                    ad.creatives.push(creative);
                                                }
                                        }
                                    }
                                }
                                break;
                            case "Extensions":
                                this.parseExtension(ad.extensions, this.childsByName(node, "Extension"));
                                break;
                            case "AdSystem":
                                ad.system = {
                                    value: this.parseNodeText(node),
                                    version: node.getAttribute("version") || null
                                };
                                break;
                            case "AdTitle":
                                ad.title = this.parseNodeText(node);
                                break;
                            case "Description":
                                ad.description = this.parseNodeText(node);
                                break;
                            case "Advertiser":
                                ad.advertiser = this.parseNodeText(node);
                                break;
                            case "Pricing":
                                ad.pricing = {
                                    value: this.parseNodeText(node),
                                    model: node.getAttribute("model") || null,
                                    currency: node.getAttribute("currency") || null
                                };
                                break;
                            case "Survey":
                                ad.survey = this.parseNodeText(node);
                        }
                    }
                    return ad;
                },

                parseExtension: function(collection, extensions) {
                    var childNode, ext, extChild, extChildNodeAttr, extNode, extNodeAttr, i, j, k, l, len, len1, len2, len3, ref, ref1, ref2, results, txt;
                    results = [];
                    for (i = 0, len = extensions.length; i < len; i++) {
                        extNode = extensions[i];
                        ext = new VASTAdExtension();
                        if (extNode.attributes) {
                            ref = extNode.attributes;
                            for (j = 0, len1 = ref.length; j < len1; j++) {
                                extNodeAttr = ref[j];
                                ext.attributes[extNodeAttr.nodeName] = extNodeAttr.nodeValue;
                            }
                        }
                        ref1 = extNode.childNodes;
                        for (k = 0, len2 = ref1.length; k < len2; k++) {
                            childNode = ref1[k];
                            txt = this.parseNodeText(childNode);
                            if (childNode.nodeName !== '#comment' && txt !== '') {
                                extChild = new VASTAdExtensionChild();
                                extChild.name = childNode.nodeName;
                                extChild.value = txt;
                                if (childNode.attributes) {
                                    ref2 = childNode.attributes;
                                    for (l = 0, len3 = ref2.length; l < len3; l++) {
                                        extChildNodeAttr = ref2[l];
                                        extChild.attributes[extChildNodeAttr.nodeName] = extChildNodeAttr.nodeValue;
                                    }
                                }
                                ext.children.push(extChild);
                            }
                        }
                        results.push(collection.push(ext));
                    }
                    return results;
                },

                parseCreativeLinearElement: function(creativeElement, creativeAttributes) {
                    var adParamsElement, base, clickTrackingElement, creative, customClickElement, eventName, htmlElement, i, icon, iconClickTrackingElement, iconClicksElement, iconElement, iconsElement, iframeElement, j, k, l, len, len1, len10, len2, len3, len4, len5, len6, len7, len8, len9, m, maintainAspectRatio, mediaFile, mediaFileElement, mediaFilesElement, n, o, offset, p, percent, q, r, ref, ref1, ref10, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9, s, scalable, skipOffset, staticElement, trackingElement, trackingEventsElement, trackingURLTemplate, videoClicksElement;
                    creative = new VASTCreativeLinear(creativeAttributes);
                    creative.duration = this.parseDuration(this.parseNodeText(this.childByName(creativeElement, "Duration")));
                    if (creative.duration === -1 && creativeElement.parentNode.parentNode.parentNode.nodeName !== 'Wrapper') {
                        return null;
                    }
                    skipOffset = creativeElement.getAttribute("skipoffset");
                    if (skipOffset === null) {
                        creative.skipDelay = null;
                    } else if (skipOffset.charAt(skipOffset.length - 1) === "%") {
                        percent = parseInt(skipOffset, 10);
                        creative.skipDelay = creative.duration * (percent / 100);
                    } else {
                        creative.skipDelay = this.parseDuration(skipOffset);
                    }
                    videoClicksElement = this.childByName(creativeElement, "VideoClicks");
                    if (videoClicksElement) {
                        creative.videoClickThroughURLTemplate = this.parseNodeText(this.childByName(videoClicksElement, "ClickThrough"));
                        ref = this.childsByName(videoClicksElement, "ClickTracking");
                        for (i = 0, len = ref.length; i < len; i++) {
                            clickTrackingElement = ref[i];
                            creative.videoClickTrackingURLTemplates.push(this.parseNodeText(clickTrackingElement));
                        }
                        ref1 = this.childsByName(videoClicksElement, "CustomClick");
                        for (j = 0, len1 = ref1.length; j < len1; j++) {
                            customClickElement = ref1[j];
                            creative.videoCustomClickURLTemplates.push(this.parseNodeText(customClickElement));
                        }
                    }
                    adParamsElement = this.childByName(creativeElement, "AdParameters");
                    if (adParamsElement) {
                        creative.adParameters = this.parseNodeText(adParamsElement);
                    }
                    ref2 = this.childsByName(creativeElement, "TrackingEvents");
                    for (k = 0, len2 = ref2.length; k < len2; k++) {
                        trackingEventsElement = ref2[k];
                        ref3 = this.childsByName(trackingEventsElement, "Tracking");
                        for (l = 0, len3 = ref3.length; l < len3; l++) {
                            trackingElement = ref3[l];
                            eventName = trackingElement.getAttribute("event");
                            trackingURLTemplate = this.parseNodeText(trackingElement);
                            if (eventName && trackingURLTemplate) {
                                if (eventName === "progress") {
                                    offset = trackingElement.getAttribute("offset");
                                    if (!offset) {
                                        continue;
                                    }
                                    if (offset.charAt(offset.length - 1) === '%') {
                                        eventName = "progress-" + offset;
                                    } else {
                                        eventName = "progress-" + (Math.round(this.parseDuration(offset)));
                                    }
                                }
                                if ((base = creative.trackingEvents)[eventName] === null) {
                                    base[eventName] = [];
                                }

                                if (creative.trackingEvents[eventName]) {
                                    creative.trackingEvents[eventName].push(trackingURLTemplate);
                                }

                            }
                        }
                    }
                    ref4 = this.childsByName(creativeElement, "MediaFiles");
                    for (m = 0, len4 = ref4.length; m < len4; m++) {
                        mediaFilesElement = ref4[m];
                        ref5 = this.childsByName(mediaFilesElement, "MediaFile");
                        for (n = 0, len5 = ref5.length; n < len5; n++) {
                            mediaFileElement = ref5[n];
                            mediaFile = new VASTMediaFile();
                            mediaFile.id = mediaFileElement.getAttribute("id");
                            mediaFile.fileURL = this.parseNodeText(mediaFileElement);
                            mediaFile.deliveryType = mediaFileElement.getAttribute("delivery");
                            mediaFile.codec = mediaFileElement.getAttribute("codec");
                            mediaFile.mimeType = mediaFileElement.getAttribute("type");
                            mediaFile.apiFramework = mediaFileElement.getAttribute("apiFramework");
                            mediaFile.bitrate = parseInt(mediaFileElement.getAttribute("bitrate") || 0, 10);
                            mediaFile.minBitrate = parseInt(mediaFileElement.getAttribute("minBitrate") || 0, 10);
                            mediaFile.maxBitrate = parseInt(mediaFileElement.getAttribute("maxBitrate") || 0, 10);
                            mediaFile.width = parseInt(mediaFileElement.getAttribute("width") || 0, 10);
                            mediaFile.height = parseInt(mediaFileElement.getAttribute("height") || 0, 10);
                            scalable = mediaFileElement.getAttribute("scalable");
                            if (scalable && typeof scalable === "string") {
                                scalable = scalable.toLowerCase();
                                if (scalable === "true") {
                                    mediaFile.scalable = true;
                                } else if (scalable === "false") {
                                    mediaFile.scalable = false;
                                }
                            }
                            maintainAspectRatio = mediaFileElement.getAttribute("maintainAspectRatio");
                            if (maintainAspectRatio && typeof maintainAspectRatio === "string") {
                                maintainAspectRatio = maintainAspectRatio.toLowerCase();
                                if (maintainAspectRatio === "true") {
                                    mediaFile.maintainAspectRatio = true;
                                } else if (maintainAspectRatio === "false") {
                                    mediaFile.maintainAspectRatio = false;
                                }
                            }
                            creative.mediaFiles.push(mediaFile);
                        }
                    }
                    iconsElement = this.childByName(creativeElement, "Icons");
                    if (iconsElement) {
                        ref6 = this.childsByName(iconsElement, "Icon");
                        for (o = 0, len6 = ref6.length; o < len6; o++) {
                            iconElement = ref6[o];
                            icon = new VASTIcon();
                            icon.program = iconElement.getAttribute("program");
                            icon.height = parseInt(iconElement.getAttribute("height") || 0, 10);
                            icon.width = parseInt(iconElement.getAttribute("width") || 0, 10);
                            icon.xPosition = this.parseXPosition(iconElement.getAttribute("xPosition"));
                            icon.yPosition = this.parseYPosition(iconElement.getAttribute("yPosition"));
                            icon.apiFramework = iconElement.getAttribute("apiFramework");
                            icon.offset = this.parseDuration(iconElement.getAttribute("offset"));
                            icon.duration = this.parseDuration(iconElement.getAttribute("duration"));
                            ref7 = this.childsByName(iconElement, "HTMLResource");
                            for (p = 0, len7 = ref7.length; p < len7; p++) {
                                htmlElement = ref7[p];
                                icon.type = htmlElement.getAttribute("creativeType") || 'text/html';
                                icon.htmlResource = this.parseNodeText(htmlElement);
                            }
                            ref8 = this.childsByName(iconElement, "IFrameResource");
                            for (q = 0, len8 = ref8.length; q < len8; q++) {
                                iframeElement = ref8[q];
                                icon.type = iframeElement.getAttribute("creativeType") || 0;
                                icon.iframeResource = this.parseNodeText(iframeElement);
                            }
                            ref9 = this.childsByName(iconElement, "StaticResource");
                            for (r = 0, len9 = ref9.length; r < len9; r++) {
                                staticElement = ref9[r];
                                icon.type = staticElement.getAttribute("creativeType") || 0;
                                icon.staticResource = this.parseNodeText(staticElement);
                            }
                            iconClicksElement = this.childByName(iconElement, "IconClicks");
                            if (iconClicksElement) {
                                icon.iconClickThroughURLTemplate = this.parseNodeText(this.childByName(iconClicksElement, "IconClickThrough"));
                                ref10 = this.childsByName(iconClicksElement, "IconClickTracking");
                                for (s = 0, len10 = ref10.length; s < len10; s++) {
                                    iconClickTrackingElement = ref10[s];
                                    icon.iconClickTrackingURLTemplates.push(this.parseNodeText(iconClickTrackingElement));
                                }
                            }
                            icon.iconViewTrackingURLTemplate = this.parseNodeText(this.childByName(iconElement, "IconViewTracking"));
                            creative.icons.push(icon);
                        }
                    }
                    return creative;
                },

                parseNonLinear: function(creativeElement, creativeAttributes) {
                    var adParamsElement, base, clickTrackingElement, creative, eventName, htmlElement, i, iframeElement, j, k, l, len, len1, len2, len3, len4, len5, len6, m, n, nonlinearAd, nonlinearResource, o, ref, ref1, ref2, ref3, ref4, ref5, ref6, staticElement, trackingElement, trackingEventsElement, trackingURLTemplate;
                    creative = new VASTCreativeNonLinear(creativeAttributes);
                    ref = this.childsByName(creativeElement, "TrackingEvents");
                    for (i = 0, len = ref.length; i < len; i++) {
                        trackingEventsElement = ref[i];
                        ref1 = this.childsByName(trackingEventsElement, "Tracking");
                        for (j = 0, len1 = ref1.length; j < len1; j++) {
                            trackingElement = ref1[j];
                            eventName = trackingElement.getAttribute("event");
                            trackingURLTemplate = this.parseNodeText(trackingElement);
                            if (eventName && trackingURLTemplate) {
                                if ((base = creative.trackingEvents)[eventName] === null) {
                                    base[eventName] = [];
                                }

                                if (creative.trackingEvents[eventName] && trackingURLTemplate !== null) {
                                    creative.trackingEvents[eventName].push(trackingURLTemplate);
                                }
                            }
                        }
                    }
                    ref2 = this.childsByName(creativeElement, "NonLinear");
                    for (k = 0, len2 = ref2.length; k < len2; k++) {
                        nonlinearResource = ref2[k];
                        nonlinearAd = new VASTNonLinear();
                        nonlinearAd.id = nonlinearResource.getAttribute("id") || null;
                        nonlinearAd.width = nonlinearResource.getAttribute("width");
                        nonlinearAd.height = nonlinearResource.getAttribute("height");
                        nonlinearAd.expandedWidth = nonlinearResource.getAttribute("expandedWidth");
                        nonlinearAd.expandedHeight = nonlinearResource.getAttribute("expandedHeight");
                        nonlinearAd.scalable = this.parseBoolean(nonlinearResource.getAttribute("scalable"));
                        nonlinearAd.maintainAspectRatio = this.parseBoolean(nonlinearResource.getAttribute("maintainAspectRatio"));
                        nonlinearAd.minSuggestedDuration = this.parseDuration(nonlinearResource.getAttribute("minSuggestedDuration"));
                        nonlinearAd.apiFramework = nonlinearResource.getAttribute("apiFramework");
                        ref3 = this.childsByName(nonlinearResource, "HTMLResource");
                        for (l = 0, len3 = ref3.length; l < len3; l++) {
                            htmlElement = ref3[l];
                            nonlinearAd.type = htmlElement.getAttribute("creativeType") || 'text/html';
                            nonlinearAd.htmlResource = this.parseNodeText(htmlElement);
                        }
                        ref4 = this.childsByName(nonlinearResource, "IFrameResource");
                        for (m = 0, len4 = ref4.length; m < len4; m++) {
                            iframeElement = ref4[m];
                            nonlinearAd.type = iframeElement.getAttribute("creativeType") || 0;
                            nonlinearAd.iframeResource = this.parseNodeText(iframeElement);
                        }
                        ref5 = this.childsByName(nonlinearResource, "StaticResource");
                        for (n = 0, len5 = ref5.length; n < len5; n++) {
                            staticElement = ref5[n];
                            nonlinearAd.type = staticElement.getAttribute("creativeType") || 0;
                            nonlinearAd.staticResource = this.parseNodeText(staticElement);
                        }
                        adParamsElement = this.childByName(nonlinearResource, "AdParameters");
                        if (adParamsElement) {
                            nonlinearAd.adParameters = this.parseNodeText(adParamsElement);
                        }
                        nonlinearAd.nonlinearClickThroughURLTemplate = this.parseNodeText(this.childByName(nonlinearResource, "NonLinearClickThrough"));
                        ref6 = this.childsByName(nonlinearResource, "NonLinearClickTracking");
                        for (o = 0, len6 = ref6.length; o < len6; o++) {
                            clickTrackingElement = ref6[o];
                            nonlinearAd.nonlinearClickTrackingURLTemplates.push(this.parseNodeText(clickTrackingElement));
                        }
                        creative.variations.push(nonlinearAd);
                    }
                    return creative;
                },

                parseCompanionAd: function(creativeElement, creativeAttributes) {
                    var base, child, clickTrackingElement, companionAd, companionResource, creative, eventName, htmlElement, i, iframeElement, j, k, l, len, len1, len2, len3, len4, len5, len6, len7, m, n, o, p, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, staticElement, trackingElement, trackingEventsElement, trackingURLTemplate;
                    creative = new VASTCreativeCompanion(creativeAttributes);
                    ref = this.childsByName(creativeElement, "Companion");
                    for (i = 0, len = ref.length; i < len; i++) {
                        companionResource = ref[i];
                        companionAd = new VASTCompanionAd();
                        companionAd.id = companionResource.getAttribute("id") || null;
                        companionAd.width = companionResource.getAttribute("width");
                        companionAd.height = companionResource.getAttribute("height");
                        companionAd.companionClickTrackingURLTemplates = [];
                        ref1 = this.childsByName(companionResource, "HTMLResource");
                        for (j = 0, len1 = ref1.length; j < len1; j++) {
                            htmlElement = ref1[j];
                            companionAd.type = htmlElement.getAttribute("creativeType") || 'text/html';
                            companionAd.htmlResource = this.parseNodeText(htmlElement);
                        }
                        ref2 = this.childsByName(companionResource, "IFrameResource");
                        for (k = 0, len2 = ref2.length; k < len2; k++) {
                            iframeElement = ref2[k];
                            companionAd.type = iframeElement.getAttribute("creativeType") || 0;
                            companionAd.iframeResource = this.parseNodeText(iframeElement);
                        }
                        ref3 = this.childsByName(companionResource, "StaticResource");
                        for (l = 0, len3 = ref3.length; l < len3; l++) {
                            staticElement = ref3[l];
                            companionAd.type = staticElement.getAttribute("creativeType") || 0;
                            ref4 = this.childsByName(companionResource, "AltText");
                            for (m = 0, len4 = ref4.length; m < len4; m++) {
                                child = ref4[m];
                                companionAd.altText = this.parseNodeText(child);
                            }
                            companionAd.staticResource = this.parseNodeText(staticElement);
                        }
                        ref5 = this.childsByName(companionResource, "TrackingEvents");
                        for (n = 0, len5 = ref5.length; n < len5; n++) {
                            trackingEventsElement = ref5[n];
                            ref6 = this.childsByName(trackingEventsElement, "Tracking");
                            for (o = 0, len6 = ref6.length; o < len6; o++) {
                                trackingElement = ref6[o];
                                eventName = trackingElement.getAttribute("event");
                                trackingURLTemplate = this.parseNodeText(trackingElement);
                                if (eventName && trackingURLTemplate) {
                                    if ((base = companionAd.trackingEvents)[eventName] === null) {
                                        base[eventName] = [];
                                    }
                                    companionAd.trackingEvents[eventName].push(trackingURLTemplate);
                                }
                            }
                        }
                        ref7 = this.childsByName(companionResource, "CompanionClickTracking");
                        for (p = 0, len7 = ref7.length; p < len7; p++) {
                            clickTrackingElement = ref7[p];
                            companionAd.companionClickTrackingURLTemplates.push(this.parseNodeText(clickTrackingElement));
                        }
                        companionAd.companionClickThroughURLTemplate = this.parseNodeText(this.childByName(companionResource, "CompanionClickThrough"));
                        companionAd.companionClickTrackingURLTemplate = this.parseNodeText(this.childByName(companionResource, "CompanionClickTracking"));
                        creative.variations.push(companionAd);
                    }
                    return creative;
                },

                parseDuration: function(durationString) {
                    var durationComponents, hours, minutes, seconds, secondsAndMS;
                    if (!(durationString)) {
                        return -1;
                    }
                    if (VASTAd.isNumeric(durationString)) {
                        return parseInt(durationString, 10);
                    }
                    durationComponents = durationString.split(":");
                    if (durationComponents.length !== 3) {
                        return -1;
                    }
                    secondsAndMS = durationComponents[2].split(".");
                    seconds = parseInt(secondsAndMS[0], 10);
                    if (secondsAndMS.length === 2) {
                        seconds += parseFloat("0." + secondsAndMS[1]);
                    }
                    minutes = parseInt(durationComponents[1] * 60, 10);
                    hours = parseInt(durationComponents[0] * 60 * 60, 10);
                    if (isNaN(hours) || isNaN(minutes) || isNaN(seconds) || minutes > 60 * 60 || seconds > 60) {
                        return -1;
                    }
                    return hours + minutes + seconds;
                },

                parseXPosition: function(xPosition) {
                    if (xPosition === "left" || xPosition === "right") {
                        return xPosition;
                    }
                    return parseInt(xPosition || 0, 10);
                },

                parseYPosition: function(yPosition) {
                    if (yPosition === "top" || yPosition === "bottom") {
                        return yPosition;
                    }
                    return parseInt(yPosition || 0, 10);
                },

                parseBoolean: function(booleanString) {
                    return booleanString === 'true' || booleanString === 'TRUE' || booleanString === '1';
                },

                parseNodeText: function(node) {
                    return node && (node.textContent || node.text || '').trim();
                },

                copyNodeAttribute: function(attributeName, nodeSource, nodeDestination) {
                    var attributeValue;
                    attributeValue = nodeSource.getAttribute(attributeName);
                    if (attributeValue) {
                        return nodeDestination.setAttribute(attributeName, attributeValue);
                    }
                },

                parseCreativeAdIdAttribute: function(creativeElement) {
                    return creativeElement.getAttribute('AdID') || creativeElement.getAttribute('adID') || creativeElement.getAttribute('adId') || null;
                }
            };
        });
    });

Scoped.define("module:Ads.VAST.Client", ["module:Ads.VAST.Ad","module:Ads.VAST.Parser","base:Objs"], function (VASTAd, VASTParser, Objs, scoped) {
    return VASTAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {
            constructor: function(parameters) {
                inherited.constructor.call(this);
                var defineProperty;
                this.cappingFreeLunch = 0;
                this.cappingMinimumTimeInterval = 60 * 1000; // don't allow ad request before 1 minute
                this.lastSuccessfullAd = +new Date();
                this.options = {
                    withCredentials: false,
                    timeout: 1000
                };

                defineProperty = Object.defineProperty;

                Objs.iter(['lastSuccessfullAd', 'totalCalls', 'totalCallsTimeout'], function(property) {
                    defineProperty(this, property, {
                        get: function() {
                            return VASTAd.storage.getItem(property);
                        },
                        set: function(value) {
                            return VASTAd.storage.setItem(property, value);
                        },
                        configurable: false,
                        enumerable: true
                    });
                }, this);

                if (this.lastSuccessfullAd === null)
                    this.lastSuccessfullAd = 0;

                if (this.totalCalls === null)
                    this.totalCalls = 0;

                if (this.totalCallsTimeout === null)
                    this.totalCallsTimeout = 0;

            },

            getAd: function(url, opts, cb) {
                var now, options, timeSinceLastCall;
                now = +new Date();

                if (!cb)
                    if (typeof opts === 'function')
                        cb = opts;
                options = {};

                options = Objs.extend(this.options, opts);

                var parser = new VASTParser();

                if (this.totalCallsTimeout < now) {
                    this.totalCalls = 1;
                    this.totalCallsTimeout = now + (60 * 60 * 1000);
                } else {
                    this.totalCalls++;
                }

                if (this.cappingFreeLunch >= this.totalCalls) {
                    cb(new Error("VAST call canceled - FreeLunch capping not reached yet " + this.totalCalls), null);
                    return;
                }

                timeSinceLastCall = now - this.lastSuccessfullAd;
                if (timeSinceLastCall < 0) {
                    this.lastSuccessfullAd = 0;
                } else if (now - this.lastSuccessfullAd < this.cappingMinimumTimeInterval) {
                    cb(new Error("VAST call cancelled - (" + this.cappingMinimumTimeInterval + ")ms minimum interval reached"), null);
                    return;
                }

                return parser.parse(url, options, (function(_this) {
                    return function(err, response) {
                        if (err)
                            cb(err, null);
                        else {
                            return cb(null, response);
                        }
                    };
                })(this));
            }
        };
    });
});

Scoped.define("module:Ads.VAST.Tracker", ["module:Ads.VAST.Ad","module:Ads.VAST.CreativeLinear","module:Ads.VAST.NonLinear","module:Ads.VAST.CompanionAd","module:Ads.VAST.Client","base:Events.ListenMixin"], function (VASTAd, VASTCreativeLinear, VASTNonLinear, VASTCompanionAd, VASTClient, ListenMixin, scoped) {
        return VASTAd.extend({
            scoped: scoped
        }, [ListenMixin, function(inherited) {
            return {
                constructor: function(ad, creative, variation) {
                    inherited.constructor.call(this, ad, creative, variation);
                    var eventName, events, trackingEvents;
                    this.ad = ad;
                    this.creative = creative;
                    this.variation = variation || null;
                    this.muted = false;
                    this.impressed = false;
                    this.skipable = false;
                    this.skipDelayDefault = -1;

                    this.emitAlwaysEvents = ['creativeView', 'start', 'firstQuartile', 'midpoint', 'thirdQuartile', 'complete', 'rewind', 'skip', 'closeLinear', 'close'];
                    trackingEvents = creative ? creative.trackingEvents : {};

                    for (eventName in trackingEvents) {
                        events = trackingEvents[eventName];
                        if (events)
                            this.trackingEvents[eventName] = events.slice(0);
                    }

                    if (creative instanceof VASTCreativeLinear) {
                        this.setAdDuration(this.creative.duration);
                        this.skipDelay = creative.skipDelay;
                        this.linear = true;
                        this.clickThroughURLTemplate = creative.videoClickThroughURLTemplate;
                        this.clickTrackingURLTemplate = creative.videoClickTrackingURLTemplate;
                    } else {
                        this.skipDelay = -1;
                        this.linear = false;
                        if (this.variation) {
                            if (this.variation instanceof VASTNonLinear) {
                                this.clickThroughURLTemplate = this.variation.nonlinearClickThroughURLTemplate;
                                this.clickTrackingURLTemplates = this.variation.nonlinearClickTrackingURLTemplates;
                            } else if (this.variation instanceof VASTCompanionAd) {
                                this.clickThroughURLTemplate = this.variation.companionClickThroughURLTemplate;
                                this.clickTrackingURLTemplates = this.variation.companionClickTrackingURLTemplates;
                            }
                        }
                    }

                    this.on('adstart', function() {
                        VASTClient.lastSuccessfullAd = +new Date();
                    });


                },

                setAdDuration: function(duration) {
                    this.assetDuration = duration;
                    this.quartiles = {
                        'firstQuartile': Math.round(25 * this.assetDuration) / 100,
                        'midpoint': Math.round(50 * this.assetDuration) / 100,
                        'thirdQuartile': Math.round(75 * this.assetDuration) / 100
                    };
                    return this.quartiles;
                },

                setAdProgress: function(progress) {
                    var eventName, events, i, len, percent, quartile, ref, skipDelay, time;
                    skipDelay = this.skipDelay === null ? this.skipDelayDefault : this.skipDelay;
                    if (skipDelay !== -1 && !this.skipable) {
                        if (skipDelay > progress) {
                            this.trigger('adskip-countdown', skipDelay - progress);
                        } else {
                            this.skipable = true;
                            this.trigger('adskip-countdown', 0);
                        }
                    }
                    if (this.linear && this.assetDuration > 0) {
                        events = [];
                        if (progress > 0) {
                            events.push("start");
                            percent = Math.round(progress / this.assetDuration * 100);
                            events.push("progress-" + percent + "%");
                            events.push("progress-" + (Math.round(progress)));
                            ref = this.quartiles;
                            for (quartile in ref) {
                                time = ref[quartile];
                                if ((time <= progress && progress <= (time + 1))) {
                                    events.push(quartile);
                                }
                            }
                        }
                        for (i = 0, len = events.length; i < len; i++) {
                            eventName = events[i];
                            if (eventName !== null)
                                this.track(eventName, true);
                        }
                        if (progress < this.progress) {
                            this.track("rewind");
                        }
                    }
                    this.progress = progress;
                    return progress;
                },

                setAdMuted: function(muted) {
                    if (this.muted !== muted) {
                        this.track(muted ? "mute" : "unmute");
                    }
                    this.muted = muted;
                    return muted;
                },

                setAdPaused: function(paused) {
                    if (this.paused !== paused) {
                        this.track(paused ? "pause" : "resume");
                    }
                    this.paused = paused;
                    return paused;
                },

                setAdFullscreen: function(fullscreen) {
                    if (this.fullscreen !== fullscreen) {
                        this.track(fullscreen ? "fullscreen" : "exitFullscreen");
                    }
                    this.fullscreen = fullscreen;
                    return fullscreen;
                },

                setAdExpand: function(expanded) {
                    if (this.expanded !== expanded) {
                        this.track(expanded ? "expand" : "collapse");
                    }
                    this.expanded = expanded;
                    return expanded;
                },

                setAdSkipDelay: function(duration) {
                    if (typeof duration === 'number') {
                        this.skipDelay = duration;
                        return duration;
                    }
                },

                loadAd: function() {
                    if (!this.impressed) {
                        this.impressed = true;
                        this.trackAdURLs(this.ad.impressionURLTemplates);
                        return this.track("creativeView");
                    }
                },

                errorAdWithCode: function(errorCode) {
                    return this.trackAdURLs(this.ad.errorURLTemplates, {
                        ERRORCODE: errorCode
                    });
                },

                errorAdWithCodeAndMessage: function(errorCode, errorMessage) {
                    return this.trackAdURLs(this.ad.errorURLTemplates, {
                        ERRORCODE: errorCode,
                        ERRORMESSAGE: errorMessage
                    });
                },

                completeAd: function() {
                    return this.track("complete");
                },

                closeAd: function() {
                    return this.track(this.linear ? "closeLinear" : "close");
                },

                stopAd: function() {},

                skipAd: function() {
                    this.track("skip");
                    this.trackingEvents = [];
                    return this.trackingEvents;
                },

                clickAd: function() {
                    var clickThroughURL, ref, variables;
                    if ((ref = this.clickTrackingURLTemplates) !== null ? ref.length : void 0) {
                        this.trackAdURLs(this.clickTrackingURLTemplates);
                    }
                    if (this.clickThroughURLTemplate !== null) {
                        if (this.linear) {
                            variables = {
                                CONTENTPLAYHEAD: this.adProgressFormated()
                            };
                        }
                        clickThroughURL = VASTAd.resolveURLTemplates([this.clickThroughURLTemplate], variables)[0];
                        return this.trigger("clickthrough", clickThroughURL);
                    }
                },

                track: function(eventName, once) {
                    var idx, trackingURLTemplates;
                    if (!once) {
                        once = false;
                    }
                    if (eventName === 'closeLinear' && ((!this.trackingEvents[eventName]) && (this.trackingEvents.close))) {
                        eventName = 'close';
                    }
                    trackingURLTemplates = this.trackingEvents[eventName];
                    idx = this.emitAlwaysEvents.indexOf(eventName);
                    if (trackingURLTemplates) {
                        this.trigger(eventName, '');
                        this.trackAdURLs(trackingURLTemplates);
                    } else if (idx !== -1) {
                        this.trigger(eventName, '');
                    }
                    if (once === true) {
                        delete this.trackingEvents[eventName];
                        delete this.trackingEvents[eventName];
                        if (idx > -1) {
                            this.emitAlwaysEvents.splice(idx, 1);
                        }
                    }
                },

                trackAdURLs: function(URLTemplates, variables) {
                    var _ref;
                    if (!variables) {
                        variables = {};
                    }
                    if (this.linear) {
                        if (((_ref = this.creative.mediaFiles[0]) !== null ? _ref.fileURL : void 0) !== null) {
                            variables.ASSETURI = this.creative.mediaFiles[0].fileURL;
                        }
                        variables.CONTENTPLAYHEAD = this.adProgressFormated();
                    }
                    return VASTAd.trackAd(URLTemplates, variables);
                },

                adProgressFormated: function() {
                    var h, m, ms, s, seconds;
                    seconds = parseInt(this.progress, 10);
                    h = seconds / (60 * 60);
                    if (h.length < 2) {
                        h = "0" + h;
                    }
                    m = seconds / 60 % 60;
                    if (m.length < 2) {
                        m = "0" + m;
                    }
                    s = seconds % 60;
                    if (s.length < 2) {
                        s = "0" + m;
                    }
                    ms = parseInt((this.progress - seconds) * 100, 10);
                    return h + ":" + m + ":" + s + "." + ms;
                }
            };
        }]);
    });

Scoped.define("module:Ads.VAST.VAST", ["base:Class","module:Ads.VAST.Client","module:Ads.VAST.Tracker","module:Ads.VAST.Ad","base:Objs","base:Promise","base:Events.EventsMixin","base:Types"], function (Class, VASTClient, VASTTracker, VASTAd, Objs, Promise, EventsMixin, Types, scoped) {
        return Class.extend({
            scoped: scoped
        }, [EventsMixin, function(inherited) {
            return {
                constructor: function(options, requestOptions) {
                    inherited.constructor.call(this);
                    options = Types.is_array(options) ? options : [options];
                    var vastClient, _promise, _self;
                    this.vastServerResponses = [];
                    this.timeout = 5000;
                    this.adPodTimeout = 100;
                    this.companion = undefined;
                    this.sources = [];
                    this.companion = {};

                    _self = this;
                    _promise = Promise.create();

                    vastClient = this.auto_destroy(new VASTClient(options));

                    Objs.iter(options, function(vast) {
                        if (vast.adServer) {
                            if (vast.skipAfter) {
                                _self.skipAdAfter = vast.skipAfter;
                            }
                            vastClient.getAd(vast.adServer, requestOptions, function(err, response) {
                                if (err) {
                                    var _errorMessage = 'Error occurred during loading provided link. ' + err;
                                    _promise.asyncError({
                                        message: _errorMessage
                                    });
                                } else {
                                    _self.vastServerResponses.push(response);
                                    _promise.asyncSuccess(_self.vastServerResponses);
                                }
                            });
                        } else {
                            _promise.asyncError({
                                message: 'Video Ad options are not correct, asServer are required'
                            });
                        }
                    }, this);

                    _promise.success(function(responses) {
                        this.executeAd(responses[0]);
                    }, this);

                    _promise.error(function(error) {
                        this.trigger("adresponseerror", error);
                    }, this);
                },

                executeAd: function(response) {
                    var _ad, _adIds, _crIds, _creative, _foundCreative, _foundCompanion, _self;
                    _self = this;
                    if (response)
                        for (_adIds = 0; _adIds < response.ads.length; _adIds++) {
                            _ad = response.ads[_adIds];
                            for (_crIds = 0; _crIds < _ad.creatives.length; _crIds++) {
                                _creative = _ad.creatives[_crIds];
                                _foundCreative = false;
                                _foundCompanion = false;

                                if (_creative.type === 'linear' && !_foundCreative) {
                                    if (_creative.skipDelay > 0)
                                        this.skipAdAfter = _creative.skipDelay;

                                    if (_creative.mediaFiles.length) {

                                        this.sources = this.createSourceObjects(_creative.mediaFiles);

                                        if (!this.sources.length) {
                                            _self.trigger("adcanceled");
                                            return;
                                        }

                                        this.vastTracker = new VASTTracker(_ad, _creative);
                                        _foundCreative = true;
                                    }
                                }

                                if (_creative.type === 'companion' && !_foundCompanion) {
                                    this.companion = _creative;
                                    _foundCompanion = true;
                                }
                            }
                            if (this.vastTracker) {
                                this.persistentTrigger("vastready");
                                break;
                            } else {
                                VASTAd.trackAd(_ad.errorURLTemplates, {
                                    ERRORCODE: 403
                                });
                            }
                        }

                    if (!this.vastTracker) {
                        this.persistentTrigger("adcanceled");
                    }
                },

                createSourceObjects: function(mediaFiles) {
                    var _sources, _mediaFile, _source;
                    _sources = [];
                    for (var i = 0, j = mediaFiles.length; i < j; i++) {
                        _mediaFile = mediaFiles[i];
                        _source = {
                            type: _mediaFile.mimeType,
                            src: _mediaFile.fileURL
                        };

                        if (this._canPlaySource(_source)) {
                            _sources[i] = ({
                                type: _mediaFile.mimeType,
                                src: _mediaFile.fileURL,
                                width: _mediaFile.width,
                                height: _mediaFile.height
                            });
                        }
                    }

                    return _sources;
                },

                _canPlaySource: function(source) {
                    var _ext, _mimeType, _allowedMimeTypes;
                    _allowedMimeTypes = [
                        "application/vnd.apple.mpegurl",
                        "video/3gpp",
                        "video/mp4",
                        "video/mpeg",
                        "video/ogg",
                        "video/quicktime",
                        "video/webm",
                        "video/x-m4v",
                        "video/ms-asf",
                        "video/x-ms-wmv",
                        "video/x-msvideo"
                    ];

                    if (source.type) {
                        _mimeType = source.type;
                    } else if (source.src) {
                        _ext = this._ext(source.src);
                        _mimeType = 'video/' + _ext;
                    } else {
                        return false;
                    }

                    return Objs.contains_value(_allowedMimeTypes, _mimeType);
                },

                _ext: function(url) {
                    return (url = url.substr(1 + url.lastIndexOf("/")).split('?')[0]).split('#')[0].substr(url.lastIndexOf("."));
                }

            };
        }]);
    });

Scoped.define("module:Ads.VastPrerollAd", ["module:Ads.AbstractPrerollAd","module:Ads.VAST.VAST"], function (AbstractVideoPrerollAd, VAST, scoped) {
    return AbstractVideoPrerollAd.extend({
        scoped: scoped
    }, function(inherited) {
        return {

            constructor: function(provider, options) {
                inherited.constructor.call(this, provider, options);
                this._vast = new VAST(this._provider.options(), {});
                this._vast.once("adresponseerror", function(err) {
                    // some error actions, no respond from ad server
                }, this);
            },

            _executeAd: function(options) {
                this._adplayer = new BetaJS.MediaComponents.VideoPlayer.Dynamics.Adplayer({
                    element: this._options.adElement,
                    attrs: {
                        css: this._options.dynamic.get("css")
                    }
                });
                this._adplayer._vast = this._vast;
                this._adplayer._preroll = this;
                this._adplayer.activate();
            },

            _adFinished: function() {
                this._options.adElement.style.display = "none";
                this.trigger("finished");
            },

            _adSkipped: function() {
                this._options.adElement.style.display = "none";
                this.trigger("adskipped");
            }

        };
    });
});

Scoped.define("module:Ads.VastVideoAdProvider", ["module:Ads.AbstractVideoAdProvider","module:Ads.VastPrerollAd"], function (AbstractVideoAdProvider, VastPrerollAd, scoped) {
        return AbstractVideoAdProvider.extend({
            scoped: scoped
        }, {

            _newPrerollAd: function(options) {
                return new VastPrerollAd(this, options);
            }

        });
    });

Scoped.define("module:Assets", ["base:Classes.LocaleTable","browser:Info"], function (LocaleTable, Info) {

    var strings = new LocaleTable();
    strings.setWeakLocale(Info.language());

    return {

        strings: strings,

        playerthemes: {},

        recorderthemes: {},

        imageviewerthemes: {},

        audioplayerthemes: {}

    };
});

Scoped.extend("module:Assets", ["module:Assets"], function (Assets) {
    var languages = {"language:ar":{"ba-videoplayer-playbutton.tooltip":"&#x627;&#x646;&#x642;&#x631; &#x644;&#x62A;&#x634;&#x63A;&#x64A;&#x644; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;.","ba-videoplayer-playbutton.rerecord":"&#x627;&#x639;&#x62F; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;","ba-videoplayer-playbutton.submit-video":"&#x62A;&#x623;&#x643;&#x64A;&#x62F; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videoplayer-loader.tooltip":"&#x62C;&#x627;&#x631; &#x62A;&#x62D;&#x645;&#x64A;&#x644; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; ...","ba-videoplayer-controlbar.change-resolution":"&#x62A;&#x63A;&#x64A;&#x64A;&#x631; &#x627;&#x644;&#x62F;&#x642;&#x629;","ba-videoplayer-controlbar.video-progress":"&#x62A;&#x642;&#x62F;&#x645; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videoplayer-controlbar.rerecord-video":"&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;&#x61F;","ba-videoplayer-controlbar.submit-video":"&#x62A;&#x623;&#x643;&#x64A;&#x62F; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videoplayer-controlbar.play-video":"&#x634;&#x63A;&#x644; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videoplayer-controlbar.pause-video":"&#x625;&#x64A;&#x642;&#x627;&#x641; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x645;&#x624;&#x642;&#x62A;&#x627;","ba-videoplayer-controlbar.elapsed-time":"&#x627;&#x644;&#x648;&#x642;&#x62A; &#x627;&#x644;&#x645;&#x646;&#x642;&#x636;&#x64A;","ba-videoplayer-controlbar.total-time":"&#x637;&#x648;&#x644; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x627;&#x644;&#x643;&#x644;&#x64A;","ba-videoplayer-controlbar.fullscreen-video":"&#x639;&#x631;&#x636; &#x645;&#x644;&#x621; &#x627;&#x644;&#x634;&#x627;&#x634;&#x629;","ba-videoplayer-controlbar.volume-button":"&#x62A;&#x639;&#x64A;&#x64A;&#x646; &#x645;&#x633;&#x62A;&#x648;&#x649; &#x627;&#x644;&#x635;&#x648;&#x62A;","ba-videoplayer-controlbar.volume-mute":"&#x643;&#x62A;&#x645; &#x627;&#x644;&#x635;&#x648;&#x62A;","ba-videoplayer-controlbar.volume-unmute":"&#x625;&#x644;&#x63A;&#x627;&#x621; &#x643;&#x62A;&#x645; &#x627;&#x644;&#x635;&#x648;&#x62A;","ba-videoplayer.video-error":"&#x644;&#x642;&#x62F; &#x62D;&#x62F;&#x62B; &#x62E;&#x637;&#x623;&#x60C; &#x631;&#x62C;&#x627;&#x621; &#x623;&#x639;&#x62F; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629; &#x644;&#x627;&#x62D;&#x642;&#x627;. &#x627;&#x646;&#x642;&#x631; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;.","ba-videorecorder-chooser.record-video":"&#x62A;&#x633;&#x62C;&#x64A;&#x644; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videorecorder-chooser.upload-video":"&#x631;&#x641;&#x639; &#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videorecorder-controlbar.settings":"&#x625;&#x639;&#x62F;&#x627;&#x62F;&#x627;&#x62A;","ba-videorecorder-controlbar.camerahealthy":"&#x627;&#x644;&#x625;&#x636;&#x627;&#x621;&#x629; &#x62C;&#x64A;&#x62F;&#x629;","ba-videorecorder-controlbar.cameraunhealthy":"&#x627;&#x644;&#x625;&#x636;&#x627;&#x621;&#x629; &#x644;&#x64A;&#x633;&#x62A; &#x627;&#x644;&#x623;&#x645;&#x62B;&#x644;","ba-videorecorder-controlbar.microphonehealthy":"&#x627;&#x644;&#x635;&#x648;&#x62A; &#x62C;&#x64A;&#x62F;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x644;&#x627; &#x64A;&#x645;&#x643;&#x646; &#x627;&#x644;&#x62A;&#x642;&#x627;&#x637; &#x623;&#x64A; &#x635;&#x648;&#x62A;","ba-videorecorder-controlbar.record":"&#x633;&#x62C;&#x644;","ba-videorecorder-controlbar.record-tooltip":"&#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x644;&#x62A;&#x633;&#x62C;&#x64A;&#x644;.","ba-videorecorder-controlbar.rerecord":"&#x627;&#x639;&#x62F; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x644;&#x625;&#x639;&#x627;&#x62F;&#x629;.","ba-videorecorder-controlbar.upload-covershot":"&#x631;&#x641;&#x639; &#x635;&#x648;&#x631;&#x629; &#x627;&#x644;&#x648;&#x627;&#x62C;&#x647;&#x629;.","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x62A;&#x62D;&#x645;&#x64A;&#x644; &#x644;&#x642;&#x637;&#x629; &#x645;&#x62E;&#x635;&#x635;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;.","ba-videorecorder-controlbar.stop":"&#x62A;&#x648;&#x642;&#x641;","ba-videorecorder-controlbar.stop-tooltip":"&#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x644;&#x62A;&#x648;&#x642;&#x641;.","ba-videorecorder-controlbar.skip":"&#x62A;&#x62E;&#x637;&#x649;","ba-videorecorder-controlbar.skip-tooltip":"&#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x644;&#x62A;&#x62E;&#x637;&#x64A;.","ba-videorecorder.recorder-error":"&#x644;&#x642;&#x62F; &#x62D;&#x62F;&#x62B; &#x62E;&#x637;&#x623;&#x60C; &#x631;&#x62C;&#x627;&#x621; &#x623;&#x639;&#x62F; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629; &#x644;&#x627;&#x62D;&#x642;&#x627;. &#x627;&#x646;&#x642;&#x631; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;.","ba-videorecorder.attach-error":"&#x644;&#x645; &#x646;&#x62A;&#x645;&#x643;&#x646; &#x645;&#x646; &#x627;&#x644;&#x648;&#x635;&#x648;&#x644; &#x625;&#x644;&#x649; &#x648;&#x627;&#x62C;&#x647;&#x629; &#x627;&#x644;&#x643;&#x627;&#x645;&#x64A;&#x631;&#x627;. &#x627;&#x639;&#x62A;&#x645;&#x627;&#x62F;&#x627; &#x639;&#x644;&#x649; &#x627;&#x644;&#x62C;&#x647;&#x627;&#x632; &#x648;&#x627;&#x644;&#x645;&#x62A;&#x635;&#x641;&#x62D;&#x60C; &#x642;&#x62F; &#x62A;&#x62D;&#x62A;&#x627;&#x62C; &#x625;&#x644;&#x649; &#x62A;&#x62B;&#x628;&#x64A;&#x62A; &#x641;&#x644;&#x627;&#x634; &#x623;&#x648; &#x627;&#x644;&#x648;&#x635;&#x648;&#x644; &#x625;&#x644;&#x649; &#x627;&#x644;&#x635;&#x641;&#x62D;&#x629; &#x639;&#x628;&#x631; &#x645;&#x62A;&#x635;&#x641;&#x62D; &#x627;&#x62E;&#x631;.","ba-videorecorder.access-forbidden":"&#x62A;&#x645; &#x62D;&#x638;&#x631; &#x627;&#x644;&#x62F;&#x62E;&#x648;&#x644; &#x625;&#x644;&#x649; &#x627;&#x644;&#x643;&#x627;&#x645;&#x64A;&#x631;&#x627;. &#x627;&#x646;&#x642;&#x631; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;","ba-videorecorder.pick-covershot":"&#x627;&#x62E;&#x62A;&#x64A;&#x627;&#x631; &#x635;&#x648;&#x631;&#x629; &#x627;&#x644;&#x648;&#x627;&#x62C;&#x647;&#x629;.","ba-videorecorder.uploading":"&#x62C;&#x627;&#x631;&#x64A; &#x627;&#x644;&#x631;&#x641;&#x639;","ba-videorecorder.uploading-failed":"&#x641;&#x634;&#x644; &#x641;&#x64A; &#x627;&#x644;&#x631;&#x641;&#x639; - &#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;.","ba-videorecorder.verifying":"&#x62C;&#x627;&#x631;&#x64A; &#x627;&#x644;&#x62A;&#x62D;&#x642;&#x642;","ba-videorecorder.verifying-failed":"&#x641;&#x634;&#x644; &#x639;&#x645;&#x644;&#x64A;&#x629; &#x627;&#x644;&#x62A;&#x62D;&#x642;&#x642; - &#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;.","ba-videorecorder.rerecord-confirm":"&#x62A;&#x622;&#x643;&#x64A;&#x62F; &#x627;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;&#x61F;","ba-videorecorder.video_file_too_large":"&#x645;&#x644;&#x641; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x643;&#x628;&#x64A;&#x631; &#x62C;&#x62F;&#x627; (&#x66A; s) - &#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629; &#x628;&#x627;&#x633;&#x62A;&#x62E;&#x62F;&#x627;&#x645; &#x645;&#x644;&#x641; &#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x623;&#x635;&#x63A;&#x631;.","ba-videorecorder.unsupported_video_type":"&#x635;&#x64A;&#x63A;&#x629; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x63A;&#x64A;&#x631; &#x645;&#x62F;&#x639;&#x648;&#x645;&#x629; :&#x66A; s - &#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;.","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x627;&#x644;&#x62E;&#x631;&#x648;&#x62C; &#x645;&#x646; &#x627;&#x644;&#x634;&#x627;&#x634;&#x629; &#x627;&#x644;&#x643;&#x627;&#x645;&#x644;&#x629;","ba-videoplayer-share.share":"&#x634;&#x627;&#x631;&#x643; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;","ba-videorecorder-chooser.record-screen":"&#x633;&#x62C;&#x644; &#x627;&#x644;&#x634;&#x627;&#x634;&#x629;","ba-videoplayer-controlbar.pause-video-disabled":"&#x625;&#x64A;&#x642;&#x627;&#x641; &#x645;&#x624;&#x642;&#x62A; &#x63A;&#x64A;&#x631; &#x645;&#x62A;&#x648;&#x627;&#x641;&#x642;","ba-videorecorder-chooser.record-audio":"&#x62A;&#x633;&#x62C;&#x64A;&#x644; &#x635;&#x648;&#x62A;&#x64A;","ba-videorecorder-controlbar.stop-available-after":"&#x627;&#x644;&#x62D;&#x62F; &#x627;&#x644;&#x623;&#x62F;&#x646;&#x649; &#x644;&#x648;&#x642;&#x62A; &#x627;&#x644;&#x62A;&#x633;&#x62C;&#x64A;&#x644; &#x647;&#x648;&#x66A; d &#x62B;&#x627;&#x646;&#x64A;&#x629;","ba-videorecorder-controlbar.cancel":"&#x625;&#x644;&#x63A;&#x627;&#x621;","ba-videorecorder-controlbar.cancel-tooltip":"&#x627;&#x646;&#x642;&#x631; &#x647;&#x646;&#x627; &#x644;&#x644;&#x625;&#x644;&#x63A;&#x627;&#x621;.","ba-videorecorder.cancel-confirm":"&#x647;&#x644; &#x62A;&#x631;&#x64A;&#x62F; &#x62D;&#x642;&#x627; &#x625;&#x644;&#x63A;&#x627;&#x621; &#x62A;&#x62D;&#x645;&#x64A;&#x644; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;&#x61F;","ba-videoplayer-adslot.elapsed-time":"&#x648;&#x642;&#x62A; &#x625;&#x644;&#x627;&#x633;&#x628;&#x62F;","ba-videoplayer-adslot.volume-button":"&#x62A;&#x639;&#x64A;&#x64A;&#x646; &#x645;&#x633;&#x62A;&#x648;&#x649; &#x627;&#x644;&#x635;&#x648;&#x62A;","ba-videoplayer-adslot.volume-mute":"&#x635;&#x648;&#x62A; &#x645;&#x646;&#x62E;&#x641;&#x636;","ba-videoplayer-adslot.volume-unmute":"&#x625;&#x644;&#x63A;&#x627;&#x621; &#x635;&#x648;&#x62A; &#x627;&#x644;&#x635;&#x648;&#x62A;","ba-videoplayer-adslot.ad-will-end-after":"&#x633;&#x64A;&#x646;&#x62A;&#x647;&#x64A; &#x627;&#x644;&#x625;&#x639;&#x644;&#x627;&#x646; &#x628;&#x639;&#x62F;&#x66A; s","ba-videoplayer-adslot.can-skip-after":"&#x62A;&#x62E;&#x637;&#x64A; &#x628;&#x639;&#x62F;&#x66A; d","ba-videoplayer-adslot.skip-ad":"&#x62A;&#x62C;&#x627;&#x647;&#x644; &#x627;&#x644;&#x627;&#x639;&#x644;&#x627;&#x646;&#x627;&#x62A;","ba-videorecorder.software-required":"&#x64A;&#x631;&#x62C;&#x649; &#x627;&#x644;&#x646;&#x642;&#x631; &#x623;&#x62F;&#x646;&#x627;&#x647; &#x644;&#x62A;&#x62B;&#x628;&#x64A;&#x62A; / &#x62A;&#x641;&#x639;&#x64A;&#x644; &#x627;&#x644;&#x645;&#x62A;&#x637;&#x644;&#x628;&#x627;&#x62A; &#x627;&#x644;&#x62A;&#x627;&#x644;&#x64A;&#x629; &#x645;&#x646; &#x623;&#x62C;&#x644; &#x627;&#x644;&#x645;&#x636;&#x64A; &#x642;&#x62F;&#x645;&#x627;.","ba-videorecorder.software-waiting":"&#x641;&#x64A; &#x627;&#x646;&#x62A;&#x638;&#x627;&#x631; &#x627;&#x644;&#x645;&#x62A;&#x637;&#x644;&#x628;&#x627;&#x62A; &#x644;&#x64A;&#x62A;&#x645; &#x62A;&#x62B;&#x628;&#x64A;&#x62A;&#x647;&#x627; / &#x62A;&#x641;&#x639;&#x64A;&#x644;&#x647;&#x627;. &#x642;&#x62F; &#x62A;&#x62D;&#x62A;&#x627;&#x62C; &#x625;&#x644;&#x649; &#x62A;&#x62D;&#x62F;&#x64A;&#x62B; &#x627;&#x644;&#x635;&#x641;&#x62D;&#x629; &#x628;&#x639;&#x62F; &#x627;&#x644;&#x627;&#x646;&#x62A;&#x647;&#x627;&#x621;."},"language:az":{"ba-videoplayer-playbutton.tooltip":"Videoya baxmaq &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videoplayer-playbutton.rerecord":"Yenid&#x259;n yazmaq","ba-videoplayer-playbutton.submit-video":"Videonu t&#x259;sdiq et","ba-videoplayer-loader.tooltip":"Video y&#xFC;kl&#x259;nir ...","ba-videoplayer-controlbar.change-resolution":"G&#xF6;r&#xFC;nt&#xFC;n&#xFC;n keyfiyy&#x259;tini d&#x259;yi&#x15F;","ba-videoplayer-controlbar.video-progress":"Videonun davamiyy&#x259;ti","ba-videoplayer-controlbar.rerecord-video":"Video yenid&#x259;n yaz&#x131;ls&#x131;n?","ba-videoplayer-controlbar.submit-video":"Videonu t&#x259;sdiq et","ba-videoplayer-controlbar.play-video":"Videonu g&#xF6;st&#x259;r","ba-videoplayer-controlbar.pause-video":"Videonu dayand&#x131;r","ba-videoplayer-controlbar.elapsed-time":"G&#xF6;st&#x259;rilmi&#x15F; vaxt","ba-videoplayer-controlbar.total-time":"Videonu tam uzunlu&#x11F;u","ba-videoplayer-controlbar.fullscreen-video":"Tam ekran edin","ba-videoplayer-controlbar.volume-button":"S&#x259;s d&#xFC;ym&#x259;si","ba-videoplayer-controlbar.volume-mute":"S&#x259;ssiz et","ba-videoplayer-controlbar.volume-unmute":"S&#x259;sli et","ba-videoplayer.video-error":"X&#x259;ta ba&#x15F; vermi&#x15F;dir. Xahi&#x15F; edirik bir az sonra yenid&#x259;n c&#x259;hd edin. Yenid&#x259;n yoxlamaq &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videorecorder-chooser.record-video":"Videonu yaz","ba-videorecorder-chooser.upload-video":"Videonu y&#xFC;kl&#x259;","ba-videorecorder-controlbar.settings":"Ayarlar","ba-videorecorder-controlbar.camerahealthy":"&#x130;&#x15F;&#x131;qland&#x131;rma yax&#x15F;&#x131;d&#x131;r","ba-videorecorder-controlbar.cameraunhealthy":"&#x130;&#x15F;&#x131;qland&#x131;rma optimal deyil","ba-videorecorder-controlbar.microphonehealthy":"S&#x259;s yax&#x15F;&#x131; e&#x15F;idilir","ba-videorecorder-controlbar.microphoneunhealthy":"Mikrofonun s&#x259;si e&#x15F;idilmir","ba-videorecorder-controlbar.record":"Yazmaq","ba-videorecorder-controlbar.record-tooltip":"Videonu yazmaq &#xFC;&#xE7;&#xFC;n bas&#x131;n","ba-videorecorder-controlbar.rerecord":"Videonu yenid&#x259;n yaz","ba-videorecorder-controlbar.rerecord-tooltip":"Yenid&#x259;n yazmaq &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videorecorder-controlbar.upload-covershot":"Y&#xFC;kl&#x259;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#xDC;zl&#xFC;k &#x15F;&#x259;kli y&#xFC;kl&#x259;m&#x259;k &#xFC;&#xE7;&#xFC;n bas&#x131;n","ba-videorecorder-controlbar.stop":"Dayand&#x131;rmaq","ba-videorecorder-controlbar.stop-tooltip":"Dayand&#x131;rmaq &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videorecorder-controlbar.skip":"N&#x259;z&#x259;r&#x259; alma","ba-videorecorder-controlbar.skip-tooltip":"N&#x259;z&#x259;r&#x259; almadan ke&#xE7;m&#x259;k &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videorecorder.recorder-error":"X&#x259;ta ba&#x15F; verdi. Xahi&#x15F; edirik bir az sonra yenid&#x259;n c&#x259;hd edin. Yenid&#x259;n yoxlamaq &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videorecorder.attach-error":"Kamera g&#xF6;r&#xFC;nt&#xFC;s&#xFC;n&#xFC; &#x259;ld&#x259; etm&#x259;k m&#xFC;mk&#xFC;n olmad&#x131;. Sizin istifad&#x259; etdiyiniz cihazdan v&#x259; brauzerd&#x259;n as&#x131;l&#x131; olaraq siz ya Flash proqram&#x131; y&#xFC;kl&#x259;nm&#x259;li v&#x259; ya veb s&#x259;hif&#x259;y&#x259; SSL il&#x259; daxil olmal&#x131;s&#x131;z.","ba-videorecorder.access-forbidden":"Kamera g&#xF6;r&#xFC;nt&#xFC;s&#xFC;n&#x259; icaz&#x259; verilm&#x259;di. Yenid&#x259;n yoxlamaq &#xFC;&#xE7;&#xFC;n bas&#x131;n.","ba-videorecorder.pick-covershot":"&#xDC;zl&#xFC;k &#x15F;&#x259;klini se&#xE7;in.","ba-videorecorder.uploading":"Y&#xFC;kl&#x259;nir","ba-videorecorder.uploading-failed":"Y&#xFC;kl&#x259;nm&#x259; zaman&#x131; x&#x259;ta ba&#x15F; verdi, t&#x259;krar etm&#x259;k &#xFC;&#xE7;&#xFC;n buraya bas&#x131;n.","ba-videorecorder.verifying":"Yoxlama","ba-videorecorder.verifying-failed":"Yoxlama u&#x11F;ursuzluqla bitdi - t&#x259;krar &#xFC;&#xE7;&#xFC;n buraya bas&#x131;n.","ba-videorecorder.rerecord-confirm":"Siz, h&#x259;qiq&#x259;t&#x259;n, videonu yenid&#x259;n yazmaq ist&#x259;yirsiniz?","ba-videorecorder.video_file_too_large":"Sizin video fayl&#x131;n h&#x259;cmi (%s) &#xE7;ox b&#xF6;y&#xFC;kd&#xFC;r - ki&#xE7;ik h&#x259;cmli video fayl il&#x259; yenid&#x259;n c&#x259;hd &#xFC;&#xE7;&#xFC;n buraya bas&#x131;n.","ba-videorecorder.unsupported_video_type":"Y&#xFC;kl&#x259;yin: %s - yenid&#x259;n yoxlamaq &#xFC;&#xE7;&#xFC;n buraya bas&#x131;n.","ba-videoplayer-controlbar.exit-fullscreen-video":"Tam ekran rejimind&#x259;n &#xE7;&#x131;x&#x131;&#x15F;","ba-videoplayer-share.share":"Videonu payla&#x15F;","ba-videorecorder-chooser.record-screen":"S&#x259;s ekran&#x131;","ba-videoplayer-controlbar.pause-video-disabled":"Pauza d&#x259;st&#x259;kl&#x259;nmir","ba-videorecorder-chooser.record-audio":"Record Audio","ba-videorecorder-controlbar.stop-available-after":"Minimum qeydiyyatdan ke&#xE7;m&#x259; m&#xFC;dd&#x259;ti %d saniy&#x259;dir","ba-videorecorder-controlbar.cancel":"L&#x259;&#x11F;v et","ba-videorecorder-controlbar.cancel-tooltip":"L&#x259;&#x11F;v etm&#x259;k &#xFC;&#xE7;&#xFC;n buraya bas&#x131;n.","ba-videorecorder.cancel-confirm":"Video y&#xFC;kl&#x259;m&#x259;yini h&#x259;qiq&#x259;t&#x259;n l&#x259;&#x11F;v etm&#x259;k ist&#x259;yirsiniz?","ba-videoplayer-adslot.elapsed-time":"Elasped vaxt","ba-videoplayer-adslot.volume-button":"H&#x259;cmi se&#xE7;in","ba-videoplayer-adslot.volume-mute":"S&#x259;s s&#x259;si","ba-videoplayer-adslot.volume-unmute":"S&#x259;sin s&#x259;sl&#x259;ndirilm&#x259;si","ba-videoplayer-adslot.ad-will-end-after":"Reklam %s sonra sona &#xE7;atacaq","ba-videoplayer-adslot.can-skip-after":" %D sonra atlay&#x131;n","ba-videoplayer-adslot.skip-ad":"Reklam&#x131; atlay&#x131;n","ba-videorecorder.software-required":"Davam etm&#x259;k &#xFC;&#xE7;&#xFC;n a&#x15F;a&#x11F;&#x131;dak&#x131; t&#x259;l&#x259;bl&#x259;ri qurmaq / aktivl&#x259;&#x15F;dirm&#x259;k &#xFC;&#xE7;&#xFC;n a&#x15F;a&#x11F;&#x131;ya bas&#x131;n.","ba-videorecorder.software-waiting":"Qurulacaq / aktivl&#x259;&#x15F;diril&#x259;c&#x259;k t&#x259;l&#x259;bl&#x259;ri g&#xF6;zl&#x259;yir&#x259;m. Tamamland&#x131;qdan sonra s&#x259;hif&#x259;ni yenil&#x259;m&#x259;k laz&#x131;md&#x131;r."},"language:bg":{"ba-videoplayer-playbutton.tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435;, &#x437;&#x430; &#x434;&#x430; &#x438;&#x433;&#x440;&#x430;&#x44F;&#x442; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;.","ba-videoplayer-playbutton.rerecord":"&#x440;&#x435;&#x43C;&#x43E;&#x43D;&#x442;&#x438;&#x440;&#x430;&#x43C;","ba-videoplayer-playbutton.submit-video":"&#x41F;&#x43E;&#x442;&#x432;&#x44A;&#x440;&#x436;&#x434;&#x430;&#x432;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-loader.tooltip":"&#x417;&#x430;&#x440;&#x435;&#x436;&#x434;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E; ...","ba-videoplayer-controlbar.change-resolution":"&#x41F;&#x440;&#x43E;&#x43C;&#x44F;&#x43D;&#x430; &#x43D;&#x430; &#x440;&#x430;&#x437;&#x434;&#x435;&#x43B;&#x438;&#x442;&#x435;&#x43B;&#x43D;&#x430;&#x442;&#x430; &#x441;&#x43F;&#x43E;&#x441;&#x43E;&#x431;&#x43D;&#x43E;&#x441;&#x442;","ba-videoplayer-controlbar.video-progress":"&#x43F;&#x440;&#x43E;&#x433;&#x440;&#x435;&#x441; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.rerecord-video":"&#x412;&#x44A;&#x437;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x44F;&#x432;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;?","ba-videoplayer-controlbar.submit-video":"&#x41F;&#x43E;&#x442;&#x432;&#x44A;&#x440;&#x436;&#x434;&#x430;&#x432;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.play-video":"&#x432;&#x44A;&#x437;&#x43F;&#x440;&#x43E;&#x438;&#x437;&#x432;&#x435;&#x436;&#x434;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.pause-video":"Pause &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.elapsed-time":"Elasped &#x432;&#x440;&#x435;&#x43C;&#x435;","ba-videoplayer-controlbar.total-time":"&#x41E;&#x431;&#x449;&#x430; &#x434;&#x44A;&#x43B;&#x436;&#x438;&#x43D;&#x430; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.fullscreen-video":"&#x412;&#x44A;&#x432;&#x435;&#x434;&#x435;&#x442;&#x435; &#x446;&#x44F;&#x43B; &#x435;&#x43A;&#x440;&#x430;&#x43D;","ba-videoplayer-controlbar.volume-button":"Set &#x43E;&#x431;&#x435;&#x43C;","ba-videoplayer-controlbar.volume-mute":"Mute &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer-controlbar.volume-unmute":"&#x438;&#x437;&#x43A;&#x43B;&#x44E;&#x447;&#x432;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x437;&#x432;&#x443;&#x43A;&#x430;","ba-videoplayer.video-error":"&#x412;&#x44A;&#x437;&#x43D;&#x438;&#x43A;&#x43D;&#x430; &#x433;&#x440;&#x435;&#x448;&#x43A;&#x430;. &#x41C;&#x43E;&#x43B;&#x44F;, &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x439;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E; &#x43F;&#x43E;-&#x43A;&#x44A;&#x441;&#x43D;&#x43E;. &#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder-chooser.record-video":"&#x417;&#x430;&#x43F;&#x438;&#x448;&#x435;&#x442;&#x435; &#x432;&#x430;&#x448;&#x438;&#x442;&#x435; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-chooser.upload-video":"&#x41A;&#x430;&#x447;&#x438; &#x412;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-controlbar.settings":"&#x41D;&#x430;&#x441;&#x442;&#x440;&#x43E;&#x439;&#x43A;&#x438;","ba-videorecorder-controlbar.camerahealthy":"&#x41E;&#x441;&#x432;&#x435;&#x442;&#x43B;&#x435;&#x43D;&#x438;&#x435;&#x442;&#x43E; &#x435; &#x434;&#x43E;&#x431;&#x440;&#x43E;","ba-videorecorder-controlbar.cameraunhealthy":"&#x41E;&#x441;&#x432;&#x435;&#x442;&#x43B;&#x435;&#x43D;&#x438;&#x435; &#x43D;&#x435; &#x435; &#x43E;&#x43F;&#x442;&#x438;&#x43C;&#x430;&#x43B;&#x43D;&#x43E;","ba-videorecorder-controlbar.microphonehealthy":"&#x417;&#x432;&#x443;&#x43A;&#x44A;&#x442; &#x435; &#x434;&#x43E;&#x431;&#x44A;&#x440;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x41D;&#x435; &#x43C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x432;&#x437;&#x435;&#x43C;&#x435;&#x442;&#x435; &#x432;&#x441;&#x435;&#x43A;&#x438; &#x437;&#x432;&#x443;&#x43A;","ba-videorecorder-controlbar.record":"&#x440;&#x435;&#x43A;&#x43E;&#x440;&#x434;","ba-videorecorder-controlbar.record-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x437;&#x430;&#x43F;&#x438;&#x448;&#x435;&#x442;&#x435;.","ba-videorecorder-controlbar.rerecord":"&#x440;&#x435;&#x43C;&#x43E;&#x43D;&#x442;&#x438;&#x440;&#x430;&#x43C;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x440;&#x435;&#x43C;&#x43E;&#x43D;&#x442;&#x438;&#x440;&#x430;&#x43C;.","ba-videorecorder-controlbar.upload-covershot":"&#x41A;&#x430;&#x447;&#x438;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43A;&#x430;&#x447;&#x438;&#x442;&#x435; &#x43F;&#x43E;&#x442;&#x440;&#x435;&#x431;&#x438;&#x442;&#x435;&#x43B;&#x441;&#x43A;&#x438; &#x43F;&#x43E;&#x43A;&#x440;&#x438;&#x442;&#x438;&#x435; &#x443;&#x434;&#x430;&#x440;","ba-videorecorder-controlbar.stop":"&#x421;&#x43F;&#x440;&#x438; &#x441;&#x435;","ba-videorecorder-controlbar.stop-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x441;&#x43F;&#x440;&#x435;.","ba-videorecorder-controlbar.skip":"&#x43F;&#x43E;&#x434;&#x441;&#x43A;&#x430;&#x447;&#x430;&#x43C;","ba-videorecorder-controlbar.skip-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x43D;&#x435;&#x442;&#x435;.","ba-videorecorder.recorder-error":"&#x412;&#x44A;&#x437;&#x43D;&#x438;&#x43A;&#x43D;&#x430; &#x433;&#x440;&#x435;&#x448;&#x43A;&#x430;. &#x41C;&#x43E;&#x43B;&#x44F;, &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x439;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E; &#x43F;&#x43E;-&#x43A;&#x44A;&#x441;&#x43D;&#x43E;. &#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder.attach-error":"&#x41D;&#x438;&#x435; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43B;&#x443;&#x447;&#x438;&#x442;&#x435; &#x434;&#x43E;&#x441;&#x442;&#x44A;&#x43F; &#x434;&#x43E; &#x438;&#x43D;&#x442;&#x435;&#x440;&#x444;&#x435;&#x439;&#x441;&#x430; &#x43D;&#x430; &#x43A;&#x430;&#x43C;&#x435;&#x440;&#x430;&#x442;&#x430;. &#x412; &#x437;&#x430;&#x432;&#x438;&#x441;&#x438;&#x43C;&#x43E;&#x441;&#x442; &#x43E;&#x442; &#x443;&#x441;&#x442;&#x440;&#x43E;&#x439;&#x441;&#x442;&#x432;&#x43E;&#x442;&#x43E; &#x438; &#x431;&#x440;&#x430;&#x443;&#x437;&#x44A;&#x440;&#x430;, &#x43C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x441;&#x435; &#x43D;&#x430;&#x43B;&#x43E;&#x436;&#x438; &#x434;&#x430; &#x438;&#x43D;&#x441;&#x442;&#x430;&#x43B;&#x438;&#x440;&#x430;&#x442;&#x435; Flash &#x438;&#x43B;&#x438; &#x434;&#x43E;&#x441;&#x442;&#x44A;&#x43F; &#x434;&#x43E; &#x441;&#x442;&#x440;&#x430;&#x43D;&#x438;&#x446;&#x430;&#x442;&#x430; &#x447;&#x440;&#x435;&#x437; SSL.","ba-videorecorder.access-forbidden":"&#x414;&#x43E;&#x441;&#x442;&#x44A;&#x43F; &#x434;&#x43E; &#x43A;&#x430;&#x43C;&#x435;&#x440;&#x430;&#x442;&#x430; &#x435; &#x437;&#x430;&#x431;&#x440;&#x430;&#x43D;&#x435;&#x43D;&#x43E;. &#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder.pick-covershot":"&#x418;&#x437;&#x431;&#x435;&#x440;&#x435;&#x442;&#x435; covershot.","ba-videorecorder.uploading":"&#x41A;&#x430;&#x447;&#x432;&#x430;&#x43D;&#x435;","ba-videorecorder.uploading-failed":"&#x41A;&#x430;&#x447;&#x432;&#x430; &#x441;&#x435; &#x43F;&#x440;&#x43E;&#x432;&#x430;&#x43B;&#x438; - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder.verifying":"&#x41F;&#x440;&#x43E;&#x432;&#x435;&#x440;&#x43A;&#x430;","ba-videorecorder.verifying-failed":"&#x423;&#x434;&#x43E;&#x441;&#x442;&#x43E;&#x432;&#x435;&#x440;&#x44F;&#x432;&#x430;&#x43D;&#x435;&#x442;&#x43E; &#x441;&#x435; &#x43F;&#x440;&#x43E;&#x432;&#x430;&#x43B;&#x438; - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder.rerecord-confirm":"&#x41D;&#x430;&#x438;&#x441;&#x442;&#x438;&#x43D;&#x430; &#x43B;&#x438; &#x438;&#x441;&#x43A;&#x430;&#x442;&#x435; &#x434;&#x430; &#x440;&#x435;&#x43C;&#x43E;&#x43D;&#x442;&#x438;&#x440;&#x430;&#x43C; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x441;&#x438;?","ba-videorecorder.video_file_too_large":"&#x412;&#x430;&#x448;&#x438;&#x44F;&#x442; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x439;&#x43B; &#x435; &#x442;&#x432;&#x44A;&#x440;&#x434;&#x435; &#x433;&#x43E;&#x43B;&#x44F;&#x43C; (%s) - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E; &#x441; &#x43F;&#x43E;-&#x43C;&#x430;&#x43B;&#x44A;&#x43A; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x439;&#x43B;.","ba-videorecorder.unsupported_video_type":"&#x41C;&#x43E;&#x43B;&#x44F;, &#x43A;&#x430;&#x447;&#x435;&#x442;&#x435;: %s - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x418;&#x437;&#x43B;&#x438;&#x437;&#x430;&#x43D;&#x435; &#x43E;&#x442; &#x446;&#x44F;&#x43B; &#x200B;&#x200B;&#x435;&#x43A;&#x440;&#x430;&#x43D;","ba-videoplayer-share.share":"&#x421;&#x43F;&#x43E;&#x434;&#x435;&#x43B;&#x44F;&#x43D;&#x435; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x43A;&#x43B;&#x438;&#x43F;","ba-videorecorder-chooser.record-screen":"&#x415;&#x43A;&#x440;&#x430;&#x43D; &#x437;&#x430; &#x437;&#x430;&#x43F;&#x438;&#x441;","ba-videoplayer-controlbar.pause-video-disabled":"&#x41F;&#x430;&#x443;&#x437;&#x430;&#x442;&#x430; &#x43D;&#x435; &#x441;&#x435; &#x43F;&#x43E;&#x434;&#x434;&#x44A;&#x440;&#x436;&#x430;","ba-videorecorder-chooser.record-audio":"&#x417;&#x430;&#x43F;&#x438;&#x441;&#x432;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x430;&#x443;&#x434;&#x438;&#x43E;","ba-videorecorder-controlbar.stop-available-after":"&#x41C;&#x438;&#x43D;&#x438;&#x43C;&#x430;&#x43B;&#x43D;&#x43E;&#x442;&#x43E; &#x432;&#x440;&#x435;&#x43C;&#x435; &#x437;&#x430; &#x437;&#x430;&#x43F;&#x438;&#x441; &#x435; %d &#x441;&#x435;&#x43A;&#x443;&#x43D;&#x434;&#x438;","ba-videorecorder-controlbar.cancel":"&#x41E;&#x442;&#x43A;&#x430;&#x437;","ba-videorecorder-controlbar.cancel-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x442;&#x443;&#x43A;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x442;&#x43C;&#x435;&#x43D;&#x438;&#x442;&#x435;.","ba-videorecorder.cancel-confirm":"&#x41D;&#x430;&#x438;&#x441;&#x442;&#x438;&#x43D;&#x430; &#x43B;&#x438; &#x438;&#x441;&#x43A;&#x430;&#x442;&#x435; &#x434;&#x430; &#x430;&#x43D;&#x443;&#x43B;&#x438;&#x440;&#x430;&#x442;&#x435; &#x43A;&#x430;&#x447;&#x432;&#x430;&#x43D;&#x435;&#x442;&#x43E; &#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x43A;&#x43B;&#x438;&#x43F;&#x430; &#x441;&#x438;?","ba-videoplayer-adslot.elapsed-time":"&#x418;&#x437;&#x433;&#x43B;&#x430;&#x434;&#x438; &#x432;&#x440;&#x435;&#x43C;&#x435;&#x442;&#x43E;","ba-videoplayer-adslot.volume-button":"&#x417;&#x430;&#x434;&#x430;&#x439;&#x442;&#x435; &#x441;&#x438;&#x43B;&#x430; &#x43D;&#x430; &#x437;&#x432;&#x443;&#x43A;&#x430;","ba-videoplayer-adslot.volume-mute":"&#x421;&#x43F;&#x438;&#x440;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x437;&#x432;&#x443;&#x43A;&#x430;","ba-videoplayer-adslot.volume-unmute":"&#x417;&#x430;&#x433;&#x43B;&#x443;&#x448;&#x430;&#x432;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x437;&#x432;&#x443;&#x43A;&#x430;","ba-videoplayer-adslot.ad-will-end-after":"&#x420;&#x435;&#x43A;&#x43B;&#x430;&#x43C;&#x430;&#x442;&#x430; &#x449;&#x435; &#x43F;&#x440;&#x438;&#x43A;&#x43B;&#x44E;&#x447;&#x438; &#x441;&#x43B;&#x435;&#x434; %s","ba-videoplayer-adslot.can-skip-after":"&#x41F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x43D;&#x435;&#x442;&#x435; &#x441;&#x43B;&#x435;&#x434; %d","ba-videoplayer-adslot.skip-ad":"&#x41F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x43D;&#x435;&#x442;&#x435; &#x43E;&#x431;&#x44F;&#x432;&#x430;","ba-videorecorder.software-required":"&#x41C;&#x43E;&#x43B;&#x44F;, &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x43F;&#x43E;-&#x434;&#x43E;&#x43B;&#x443;, &#x437;&#x430; &#x434;&#x430; &#x438;&#x43D;&#x441;&#x442;&#x430;&#x43B;&#x438;&#x440;&#x430;&#x442;&#x435; / &#x430;&#x43A;&#x442;&#x438;&#x432;&#x438;&#x440;&#x430;&#x442;&#x435; &#x441;&#x43B;&#x435;&#x434;&#x43D;&#x438;&#x442;&#x435; &#x438;&#x437;&#x438;&#x441;&#x43A;&#x432;&#x430;&#x43D;&#x438;&#x44F;, &#x437;&#x430; &#x434;&#x430; &#x43F;&#x440;&#x43E;&#x434;&#x44A;&#x43B;&#x436;&#x438;&#x442;&#x435;.","ba-videorecorder.software-waiting":"&#x418;&#x437;&#x447;&#x430;&#x43A;&#x432;&#x430;&#x43D;&#x435; &#x437;&#x430; &#x438;&#x43D;&#x441;&#x442;&#x430;&#x43B;&#x438;&#x440;&#x430;&#x43D;&#x435; / &#x430;&#x43A;&#x442;&#x438;&#x432;&#x438;&#x440;&#x430;&#x43D;&#x435; &#x43D;&#x430; &#x438;&#x437;&#x438;&#x441;&#x43A;&#x432;&#x430;&#x43D;&#x438;&#x44F;&#x442;&#x430;. &#x41C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x441;&#x435; &#x43D;&#x430;&#x43B;&#x43E;&#x436;&#x438; &#x434;&#x430; &#x43E;&#x43F;&#x440;&#x435;&#x441;&#x43D;&#x438;&#x442;&#x435; &#x441;&#x442;&#x440;&#x430;&#x43D;&#x438;&#x446;&#x430;&#x442;&#x430; &#x441;&#x43B;&#x435;&#x434; &#x437;&#x430;&#x432;&#x44A;&#x440;&#x448;&#x432;&#x430;&#x43D;&#x435;."},"language:cat":{"ba-videoplayer-playbutton.tooltip":"Feu clic per veure el v&#xED;deo.","ba-videoplayer-playbutton.rerecord":"refer","ba-videoplayer-playbutton.submit-video":"confirmar v&#xED;deo","ba-videoplayer-loader.tooltip":"Carregant v&#xED;deo ...","ba-videoplayer-controlbar.change-resolution":"Canviar la resoluci&#xF3;","ba-videoplayer-controlbar.video-progress":"el progr&#xE9;s de v&#xED;deo","ba-videoplayer-controlbar.rerecord-video":"Torneu a fer el v&#xED;deo?","ba-videoplayer-controlbar.submit-video":"confirmar v&#xED;deo","ba-videoplayer-controlbar.play-video":"reproducci&#xF3; de v&#xED;deo","ba-videoplayer-controlbar.pause-video":"pausa de v&#xED;deo","ba-videoplayer-controlbar.elapsed-time":"temps Elasped","ba-videoplayer-controlbar.total-time":"Durada total de v&#xED;deo","ba-videoplayer-controlbar.fullscreen-video":"Introdu&#xEF;u a pantalla completa","ba-videoplayer-controlbar.volume-button":"volum de s&#xE8;ries","ba-videoplayer-controlbar.volume-mute":"silenciar so","ba-videoplayer-controlbar.volume-unmute":"activar so","ba-videoplayer.video-error":"Hi ha hagut un error. Siusplau, torni a intentar-ho m&#xE9;s tard. Feu clic per tornar a intentar-ho.","ba-videorecorder-chooser.record-video":"Gravar el v&#xED;deo","ba-videorecorder-chooser.upload-video":"Pujar v&#xED;deo","ba-videorecorder-controlbar.settings":"ajustos","ba-videorecorder-controlbar.camerahealthy":"La il&#xB7;luminaci&#xF3; &#xE9;s bona","ba-videorecorder-controlbar.cameraunhealthy":"La il&#xB7;luminaci&#xF3; no &#xE9;s &#xF2;ptima","ba-videorecorder-controlbar.microphonehealthy":"El so &#xE9;s bo","ba-videorecorder-controlbar.microphoneunhealthy":"No es pot recollir qualsevol so","ba-videorecorder-controlbar.record":"registre","ba-videorecorder-controlbar.record-tooltip":"Feu clic aqu&#xED; per gravar.","ba-videorecorder-controlbar.rerecord":"refer","ba-videorecorder-controlbar.rerecord-tooltip":"Cliqueu aqu&#xED; per fer de nou.","ba-videorecorder-controlbar.upload-covershot":"Pujar","ba-videorecorder-controlbar.upload-covershot-tooltip":"Feu clic aqu&#xED; per pujar foto de portada personalitzada","ba-videorecorder-controlbar.stop":"aturar","ba-videorecorder-controlbar.stop-tooltip":"Feu clic aqu&#xED; per aturar.","ba-videorecorder-controlbar.skip":"Omet","ba-videorecorder-controlbar.skip-tooltip":"Feu clic aqu&#xED; per saltar.","ba-videorecorder.recorder-error":"Hi ha hagut un error. Siusplau, torni a intentar-ho m&#xE9;s tard. Feu clic per tornar a intentar-ho.","ba-videorecorder.attach-error":"No hem pogut accedir a la interf&#xED;cie de la c&#xE0;mera. En funci&#xF3; del dispositiu i del navegador, &#xE9;s possible que hagi de instal &#xB7; lar Flash o accedir a la p&#xE0;gina a trav&#xE9;s de SSL.","ba-videorecorder.access-forbidden":"Estava prohibit l&#x27;acc&#xE9;s a la c&#xE0;mera. Feu clic per tornar a intentar-ho.","ba-videorecorder.pick-covershot":"Tria una covershot.","ba-videorecorder.uploading":"pujant","ba-videorecorder.uploading-failed":"C&#xE0;rrega fallat - fer clic aqu&#xED; per tornar a intentar-ho.","ba-videorecorder.verifying":"verificant","ba-videorecorder.verifying-failed":"fallat la verificaci&#xF3; de - fer clic aqu&#xED; per tornar a intentar-ho.","ba-videorecorder.rerecord-confirm":"De veritat vol tornar a fer el v&#xED;deo?","ba-videorecorder.video_file_too_large":"L&#x27;arxiu de v&#xED;deo &#xE9;s massa gran (%s) - fer clic aqu&#xED; per tornar a intentar-ho amb un arxiu de v&#xED;deo m&#xE9;s petita.","ba-videorecorder.unsupported_video_type":"Si us plau, puja: %s - fer clic aqu&#xED; per tornar a intentar-ho.","ba-videoplayer-controlbar.exit-fullscreen-video":"Surt de la pantalla completa","ba-videoplayer-share.share":"compartir v&#xED;deo","ba-videorecorder-chooser.record-screen":"Pantalla de registre","ba-videoplayer-controlbar.pause-video-disabled":"Pausa no &#xE9;s compatible","ba-videorecorder-chooser.record-audio":"Enregistrament d&#x27;&#xE0;udio","ba-videorecorder-controlbar.stop-available-after":"El temps d&#x27;enregistrament m&#xED;nim &#xE9;s %d segons","ba-videorecorder-controlbar.cancel":"Cancel &#xB7; lar","ba-videorecorder-controlbar.cancel-tooltip":"Feu clic aqu&#xED; per cancel&#xB7;lar.","ba-videorecorder.cancel-confirm":"Realment vols cancel&#xB7;lar la c&#xE0;rrega del teu v&#xED;deo?","ba-videoplayer-adslot.elapsed-time":"Elasped temps","ba-videoplayer-adslot.volume-button":"Estableix el volum","ba-videoplayer-adslot.volume-mute":"Silenciar el so","ba-videoplayer-adslot.volume-unmute":"Silenciar el so","ba-videoplayer-adslot.ad-will-end-after":"L&#x27;anunci finalitzar&#xE0; despr&#xE9;s de %s","ba-videoplayer-adslot.can-skip-after":"Passa despr&#xE9;s de %d","ba-videoplayer-adslot.skip-ad":"Saltar anunci","ba-videorecorder.software-required":"Feu clic a sota per instal&#xB7;lar / activar els requisits seg&#xFC;ents per continuar.","ba-videorecorder.software-waiting":"Esperant que s&#x27;instal&#xB7;lin / activin els requisits. &#xC9;s possible que h&#xE0;giu d&#x27;actualitzar la p&#xE0;gina una vegada finalitzada."},"language:da":{"ba-videoplayer-playbutton.tooltip":"Klik for at afspille video.","ba-videoplayer-playbutton.rerecord":"redo","ba-videoplayer-playbutton.submit-video":"Bekr&#xE6;ft video","ba-videoplayer-loader.tooltip":"Indl&#xE6;ser video ...","ba-videoplayer-controlbar.change-resolution":"Skift opl&#xF8;sning","ba-videoplayer-controlbar.video-progress":"fremskridt Video","ba-videoplayer-controlbar.rerecord-video":"Redo video?","ba-videoplayer-controlbar.submit-video":"Bekr&#xE6;ft video","ba-videoplayer-controlbar.play-video":"Afspil video","ba-videoplayer-controlbar.pause-video":"Pause video","ba-videoplayer-controlbar.elapsed-time":"Elasped tid","ba-videoplayer-controlbar.total-time":"Samlet l&#xE6;ngde af video","ba-videoplayer-controlbar.fullscreen-video":"Indtast fullscreen","ba-videoplayer-controlbar.volume-button":"Indstil lydstyrke","ba-videoplayer-controlbar.volume-mute":"Sl&#xE5; lyden","ba-videoplayer-controlbar.volume-unmute":"Sl&#xE5; lyden til","ba-videoplayer.video-error":"Der opstod en fejl. Pr&#xF8;v venligst igen senere. Klik for at pr&#xF8;ve igen.","ba-videorecorder-chooser.record-video":"Optag din video","ba-videorecorder-chooser.upload-video":"Upload video","ba-videorecorder-controlbar.settings":"Indstillinger","ba-videorecorder-controlbar.camerahealthy":"Belysning er god","ba-videorecorder-controlbar.cameraunhealthy":"Belysning er ikke optimal","ba-videorecorder-controlbar.microphonehealthy":"Lyden er god","ba-videorecorder-controlbar.microphoneunhealthy":"Kan ikke afhente nogen lyd","ba-videorecorder-controlbar.record":"Optag","ba-videorecorder-controlbar.record-tooltip":"Klik her for at optage.","ba-videorecorder-controlbar.rerecord":"redo","ba-videorecorder-controlbar.rerecord-tooltip":"Klik her for at gentage.","ba-videorecorder-controlbar.upload-covershot":"Upload","ba-videorecorder-controlbar.upload-covershot-tooltip":"Klik her for at uploade brugerdefinerede d&#xE6;kning shot","ba-videorecorder-controlbar.stop":"Stop","ba-videorecorder-controlbar.stop-tooltip":"Klik her for at stoppe.","ba-videorecorder-controlbar.skip":"Spring over","ba-videorecorder-controlbar.skip-tooltip":"Klik her for at springe.","ba-videorecorder.recorder-error":"Der opstod en fejl. Pr&#xF8;v venligst igen senere. Klik for at pr&#xF8;ve igen.","ba-videorecorder.attach-error":"Vi kunne ikke f&#xE5; adgang til kameraet interface. Afh&#xE6;ngigt af enheden og browseren, skal du muligvis installere Flash eller adgang til siden via SSL.","ba-videorecorder.access-forbidden":"Adgang til kameraet var forbudt. Klik for at pr&#xF8;ve igen.","ba-videorecorder.pick-covershot":"V&#xE6;lg en covershot.","ba-videorecorder.uploading":"Upload","ba-videorecorder.uploading-failed":"Upload mislykkedes - klik her for at pr&#xF8;ve igen.","ba-videorecorder.verifying":"Bekr&#xE6;ftelse","ba-videorecorder.verifying-failed":"mislykkedes verificering - klik her for at pr&#xF8;ve igen.","ba-videorecorder.rerecord-confirm":"&#xD8;nsker du virkelig at optage en ny video?","ba-videorecorder.video_file_too_large":"Din video filen er for stor (%s) - klik her for at pr&#xF8;ve igen med et mindre videofil.","ba-videorecorder.unsupported_video_type":"upload venligst: %s - klik her for at pr&#xF8;ve igen.","ba-videoplayer-controlbar.exit-fullscreen-video":"Afslut fuldsk&#xE6;rm","ba-videoplayer-share.share":"Del video","ba-videorecorder-chooser.record-screen":"Optagelsessk&#xE6;rm","ba-videoplayer-controlbar.pause-video-disabled":"Pause ikke underst&#xF8;ttet","ba-videorecorder-chooser.record-audio":"Optag lyd","ba-videorecorder-controlbar.stop-available-after":"Mindste optagetid er %d sekunder","ba-videorecorder-controlbar.cancel":"Afbestille","ba-videorecorder-controlbar.cancel-tooltip":"Klik her for at annullere.","ba-videorecorder.cancel-confirm":"Vil du virkelig annullere din video upload?","ba-videoplayer-adslot.elapsed-time":"Elasped tid","ba-videoplayer-adslot.volume-button":"Indstil lydstyrke","ba-videoplayer-adslot.volume-mute":"D&#xE6;mp lyd","ba-videoplayer-adslot.volume-unmute":"Sluk lyden","ba-videoplayer-adslot.ad-will-end-after":"Annoncen slutter efter %s","ba-videoplayer-adslot.can-skip-after":"Spring over efter %d","ba-videoplayer-adslot.skip-ad":"Spring annoncen over","ba-videorecorder.software-required":"Klik nedenfor for at installere / aktivere f&#xF8;lgende krav for at forts&#xE6;tte.","ba-videorecorder.software-waiting":"Venter p&#xE5; de krav, der skal installeres / aktiveres. Du skal m&#xE5;ske opdatere siden efter f&#xE6;rdigg&#xF8;relsen."},"language:de":{"ba-videoplayer-playbutton.tooltip":"Hier klicken um Wiedergabe zu starten.","ba-videoplayer-playbutton.rerecord":"Video neu aufnehmen","ba-videoplayer-playbutton.submit-video":"Video akzeptieren","ba-videoplayer-loader.tooltip":"Video wird geladen...","ba-videoplayer-controlbar.change-resolution":"Aufl&#xF6;sung anpassen","ba-videoplayer-controlbar.video-progress":"Videofortschritt","ba-videoplayer-controlbar.rerecord-video":"Video erneut aufnehmen?","ba-videoplayer-controlbar.submit-video":"Video akzeptieren","ba-videoplayer-controlbar.play-video":"Video wiedergeben","ba-videoplayer-controlbar.pause-video":"Video pausieren","ba-videoplayer-controlbar.elapsed-time":"Vergangene Zeit","ba-videoplayer-controlbar.total-time":"L&#xE4;nge des Videos","ba-videoplayer-controlbar.fullscreen-video":"Vollbildmodus","ba-videoplayer-controlbar.volume-button":"Lautst&#xE4;rke regulieren","ba-videoplayer-controlbar.volume-mute":"Ton abstellen","ba-videoplayer-controlbar.volume-unmute":"Ton wieder aktivieren","ba-videoplayer.video-error":"Es ist ein Fehler aufgetreten, bitte versuchen Sie es sp&#xE4;ter noch einmal. Hier klicken, um es noch einmal zu probieren.","ba-videorecorder-chooser.record-video":"Video aufnehmen","ba-videorecorder-chooser.upload-video":"Video hochladen","ba-videorecorder-chooser.record-screen":"Desktop aufnehmen","ba-videorecorder-controlbar.settings":"Einstellungen","ba-videorecorder-controlbar.camerahealthy":"Gute Beleuchtung","ba-videorecorder-controlbar.cameraunhealthy":"Beleuchtung nicht optimal","ba-videorecorder-controlbar.microphonehealthy":"Soundqualit&#xE4;t einwandfrei","ba-videorecorder-controlbar.microphoneunhealthy":"Mikrofon bis jetzt stumm","ba-videorecorder-controlbar.record":"Video aufnehmen","ba-videorecorder-controlbar.record-tooltip":"Hier klicken um Aufnahme zu starten.","ba-videorecorder-controlbar.rerecord":"Video neu aufnehmen","ba-videorecorder-controlbar.rerecord-tooltip":"Hier klicken um Video erneut aufzunehmen.","ba-videorecorder-controlbar.upload-covershot":"Hochladen","ba-videorecorder-controlbar.upload-covershot-tooltip":"Hier klicken um einen Covershot hochzuladen.","ba-videorecorder-controlbar.stop":"Aufnahme stoppen","ba-videorecorder-controlbar.stop-tooltip":"Hier klicken um Aufnahme zu stoppen.","ba-videorecorder-controlbar.skip":"&#xDC;berspringen","ba-videorecorder-controlbar.skip-tooltip":"Hier klicken um zu &#xDC;berspringen.","ba-videorecorder.recorder-error":"Es ist ein Fehler aufgetreten, bitte versuchen Sie es sp&#xE4;ter noch einmal. Hier klicken, um es noch einmal zu probieren.","ba-videorecorder.attach-error":"Wir konnten nicht auf das Medieninterface zugreifen. Je nach Browser und Ger&#xE4;t muss m&#xF6;glicherweise Flash installiert oder die Seite &#xFC;ber SSL geladen werden.","ba-videorecorder.access-forbidden":"Zugriff auf das Medieninterface wurde verweigert. Hier klicken, um es noch einmal zu probieren.","ba-videorecorder.pick-covershot":"Bitte w&#xE4;hlen Sie einen Covershot aus.","ba-videorecorder.uploading":"Hochladen","ba-videorecorder.uploading-failed":"Hochladen fehlgeschlagen. Hier klicken, um es noch einmal zu probieren.","ba-videorecorder.verifying":"Verifizieren","ba-videorecorder.verifying-failed":"Verifizierung fehlgeschlagen. Hier klicken, um es noch einmal zu probieren.","ba-videorecorder.rerecord-confirm":"M&#xF6;chten Sie Ihr Video wirklich noch einmal aufnehmen?","ba-videorecorder.video_file_too_large":"Die angegebene Videodatei ist zu gro&#xDF; (%s). Hier klicken, um eine kleinere Videodatei hochzuladen.","ba-videorecorder.unsupported_video_type":"Bitte laden Sie Dateien des folgenden Typs hoch: %s. Hier klicken, um es noch einmal zu probieren.","ba-videoplayer-controlbar.exit-fullscreen-video":"Den Vollbildmous verlassen","ba-videoplayer-share.share":"Video teilen","ba-videoplayer-controlbar.pause-video-disabled":"Pause wird nicht unterst&#xFC;tzt","ba-videorecorder-chooser.record-audio":"Ton aufnehmen","ba-videorecorder-controlbar.stop-available-after":"Die minimale Aufnahmezeit ist %d Sekunden","ba-videorecorder-controlbar.cancel":"Stornieren","ba-videorecorder-controlbar.cancel-tooltip":"Klicken Sie hier, um abzubrechen.","ba-videorecorder.cancel-confirm":"M&#xF6;chten Sie Ihren Video-Upload wirklich abbrechen?","ba-videoplayer-adslot.elapsed-time":"Elased Zeit","ba-videoplayer-adslot.volume-button":"Lautst&#xE4;rke einstellen","ba-videoplayer-adslot.volume-mute":"Ton stummschalten","ba-videoplayer-adslot.volume-unmute":"Ton nicht h&#xF6;ren","ba-videoplayer-adslot.ad-will-end-after":"Die Anzeige endet nach %s","ba-videoplayer-adslot.can-skip-after":"&#xDC;berspringen nach %d","ba-videoplayer-adslot.skip-ad":"&#xDC;berspringen","ba-videorecorder.software-required":"Bitte klicken Sie hier, um die folgenden Voraussetzungen zu installieren bzw. zu aktivieren.","ba-videorecorder.software-waiting":"Warte auf Abschluss der Installation bzw. der Aktivierung. M&#xF6;glicherweise m&#xFC;ssen Sie die Seite nach dem Abschluss aktualisieren."},"language:es":{"ba-videoplayer-playbutton.tooltip":"Haga clic para ver el video.","ba-videoplayer-playbutton.rerecord":"Regrabar","ba-videoplayer-playbutton.submit-video":"Confirmar v&#xED;deo","ba-videoplayer-loader.tooltip":"Cargando v&#xED;deo ...","ba-videoplayer-controlbar.change-resolution":"Cambiar la resoluci&#xF3;n","ba-videoplayer-controlbar.video-progress":"Progreso de v&#xED;deo","ba-videoplayer-controlbar.rerecord-video":"Regrabar v&#xED;deo?","ba-videoplayer-controlbar.submit-video":"Confirmar v&#xED;deo","ba-videoplayer-controlbar.play-video":"Reproducir video","ba-videoplayer-controlbar.pause-video":"Pausar v&#xED;deo","ba-videoplayer-controlbar.elapsed-time":"Tiempo transcurrido","ba-videoplayer-controlbar.total-time":"Duraci&#xF3;n total de video","ba-videoplayer-controlbar.fullscreen-video":"Ingrese a pantalla completa","ba-videoplayer-controlbar.volume-button":"Boton de volumen","ba-videoplayer-controlbar.volume-mute":"Silenciar sonido","ba-videoplayer-controlbar.volume-unmute":"Activar sonido","ba-videoplayer.video-error":"Se produjo un error, por favor intente de nuevo m&#xE1;s tarde. Haga clic para volver a intentarlo.","ba-videorecorder-chooser.record-video":"Grabar v&#xED;deo","ba-videorecorder-chooser.upload-video":"Subir v&#xED;deo","ba-videorecorder-controlbar.settings":"Ajustes","ba-videorecorder-controlbar.camerahealthy":"La iluminaci&#xF3;n es buena","ba-videorecorder-controlbar.cameraunhealthy":"La iluminaci&#xF3;n no es &#xF3;ptima","ba-videorecorder-controlbar.microphonehealthy":"El sonido es bueno","ba-videorecorder-controlbar.microphoneunhealthy":"Problemas con sonido","ba-videorecorder-controlbar.record":"Grabar","ba-videorecorder-controlbar.record-tooltip":"Haga clic aqu&#xED; para grabar.","ba-videorecorder-controlbar.rerecord":"Rehacer","ba-videorecorder-controlbar.rerecord-tooltip":"Haga clic aqu&#xED; para grabar de nuevo.","ba-videorecorder-controlbar.upload-covershot":"Subir","ba-videorecorder-controlbar.upload-covershot-tooltip":"Haga clic aqu&#xED; para subir foto de portada personalizada","ba-videorecorder-controlbar.stop":"Detener","ba-videorecorder-controlbar.stop-tooltip":"Haga clic aqu&#xED; para detener.","ba-videorecorder-controlbar.skip":"Saltear","ba-videorecorder-controlbar.skip-tooltip":"Haga clic aqu&#xED; para saltear.","ba-videorecorder.recorder-error":"Se produjo un error, por favor intente de nuevo m&#xE1;s tarde. Haga clic para volver a intentarlo.","ba-videorecorder.attach-error":"No hemos podido acceder a la interfaz de la c&#xE1;mara. Dependiendo del dispositivo y del navegador, es posible que tenga que instalar Flash o acceder a la p&#xE1;gina a trav&#xE9;s de SSL.","ba-videorecorder.access-forbidden":"Acceso denegado a la c&#xE1;mara. Haga clic para volver a intentarlo.","ba-videorecorder.pick-covershot":"Elige una foto de portada.","ba-videorecorder.uploading":"Subiendo","ba-videorecorder.uploading-failed":"La subida ha fallado - hacer clic aqu&#xED; para volver a intentarlo.","ba-videorecorder.verifying":"Verificando","ba-videorecorder.verifying-failed":"Fall&#xF3; la verificaci&#xF3;n - hacer clic aqu&#xED; para volver a intentarlo.","ba-videorecorder.rerecord-confirm":"&#xBF;Est&#xE1; seguro quiere volver a hacer el v&#xED;deo?","ba-videorecorder.video_file_too_large":"El archivo de v&#xED;deo es demasiado grande (%s) - hacer clic aqu&#xED; para volver a intentarlo con un archivo de v&#xED;deo m&#xE1;s peque&#xF1;o.","ba-videorecorder.unsupported_video_type":"Por favor, sube: %s - haz clic aqu&#xED; para volver a intentarlo.","ba-videoplayer-controlbar.exit-fullscreen-video":"Salir de pantalla completa","ba-videoplayer-share.share":"Compartir video","ba-videorecorder-chooser.record-screen":"Grabar pantalla","ba-videoplayer-controlbar.pause-video-disabled":"Pausa no admitida","ba-videorecorder-chooser.record-audio":"Grabar audio","ba-videorecorder-controlbar.stop-available-after":"El tiempo de grabaci&#xF3;n m&#xED;nimo es %d segundos","ba-videorecorder-controlbar.cancel":"Cancelar","ba-videorecorder-controlbar.cancel-tooltip":"Haga clic aqu&#xED; para cancelar.","ba-videorecorder.cancel-confirm":"&#xBF;Realmente quieres cancelar tu carga de video?","ba-videoplayer-adslot.elapsed-time":"Tiempo Transcurrido","ba-videoplayer-adslot.volume-button":"Establecer el volumen","ba-videoplayer-adslot.volume-mute":"Sin sonido","ba-videoplayer-adslot.volume-unmute":"Dejar de silenciar el sonido","ba-videoplayer-adslot.ad-will-end-after":"El anuncio finalizar&#xE1; despu&#xE9;s de %s","ba-videoplayer-adslot.can-skip-after":"Omitir despu&#xE9;s de %d","ba-videoplayer-adslot.skip-ad":"Omitir aviso publicitario","ba-videorecorder.software-required":"Haga click a continuaci&#xF3;n para instalar / activar los siguientes requisitos y as&#xED; poder continuar.","ba-videorecorder.software-waiting":"Esperando a que se instalen / activen los requisitos. Es posible que deba actualizar la p&#xE1;gina despu&#xE9;s de finalizar."},"language:fi":{"ba-videoplayer-playbutton.tooltip":"Toista video.","ba-videoplayer-playbutton.rerecord":"tehd&#xE4; uudelleen","ba-videoplayer-playbutton.submit-video":"vahvista video","ba-videoplayer-loader.tooltip":"Ladataan videota ...","ba-videoplayer-controlbar.change-resolution":"Muuta resoluutio","ba-videoplayer-controlbar.video-progress":"video edistyminen","ba-videoplayer-controlbar.rerecord-video":"Tee uudelleen video?","ba-videoplayer-controlbar.submit-video":"vahvista video","ba-videoplayer-controlbar.play-video":"Toista video","ba-videoplayer-controlbar.pause-video":"tauko video","ba-videoplayer-controlbar.elapsed-time":"Elasped aika","ba-videoplayer-controlbar.total-time":"Kokonaispituus video","ba-videoplayer-controlbar.fullscreen-video":"Anna koko n&#xE4;yt&#xF6;n","ba-videoplayer-controlbar.volume-button":"Set tilavuus","ba-videoplayer-controlbar.volume-mute":"&#xE4;&#xE4;nen mykistys","ba-videoplayer-controlbar.volume-unmute":"Poista mykistys","ba-videoplayer.video-error":"Tapahtui virhe, yrit&#xE4; my&#xF6;hemmin uudelleen. Yrit&#xE4; uudelleen klikkaamalla.","ba-videorecorder-chooser.record-video":"Tallenna videon","ba-videorecorder-chooser.upload-video":"Lataa video","ba-videorecorder-controlbar.settings":"Asetukset","ba-videorecorder-controlbar.camerahealthy":"Valaistus on hyv&#xE4;","ba-videorecorder-controlbar.cameraunhealthy":"Valaistus ei ole optimaalinen","ba-videorecorder-controlbar.microphonehealthy":"&#xC4;&#xE4;ni on hyv&#xE4;","ba-videorecorder-controlbar.microphoneunhealthy":"Voi poimia mit&#xE4;&#xE4;n &#xE4;&#xE4;nt&#xE4;","ba-videorecorder-controlbar.record":"Enn&#xE4;tys","ba-videorecorder-controlbar.record-tooltip":"T&#xE4;&#xE4;lt&#xE4; tallentaa.","ba-videorecorder-controlbar.rerecord":"tehd&#xE4; uudelleen","ba-videorecorder-controlbar.rerecord-tooltip":"T&#xE4;&#xE4;lt&#xE4; redo.","ba-videorecorder-controlbar.upload-covershot":"Lataa","ba-videorecorder-controlbar.upload-covershot-tooltip":"T&#xE4;&#xE4;lt&#xE4; ladata mukautettuja kansi ammuttu","ba-videorecorder-controlbar.stop":"Stop","ba-videorecorder-controlbar.stop-tooltip":"T&#xE4;&#xE4;lt&#xE4; lopettaa.","ba-videorecorder-controlbar.skip":"hyppi&#xE4;","ba-videorecorder-controlbar.skip-tooltip":"T&#xE4;&#xE4;lt&#xE4; ohittaa.","ba-videorecorder.recorder-error":"Tapahtui virhe, yrit&#xE4; my&#xF6;hemmin uudelleen. Yrit&#xE4; uudelleen klikkaamalla.","ba-videorecorder.attach-error":"Emme voineet k&#xE4;ytt&#xE4;&#xE4; Kameraliit&#xE4;nn&#xE4;t. Laitteesta riippuen ja selainta, sinun on ehk&#xE4; asennettava Flash tai k&#xE4;ytt&#xE4;&#xE4; sivun kautta SSL.","ba-videorecorder.access-forbidden":"P&#xE4;&#xE4;sy kameraan oli kielletty. Yrit&#xE4; uudelleen klikkaamalla.","ba-videorecorder.pick-covershot":"Valitse covershot.","ba-videorecorder.uploading":"lataaminen","ba-videorecorder.uploading-failed":"Lataaminen ep&#xE4;onnistui - klikkaa t&#xE4;st&#xE4; yrit&#xE4; uudelleen.","ba-videorecorder.verifying":"Tarkistetaan","ba-videorecorder.verifying-failed":"Varmentaa ep&#xE4;onnistui - klikkaa t&#xE4;st&#xE4; yrit&#xE4; uudelleen.","ba-videorecorder.rerecord-confirm":"Haluatko todella redo videon?","ba-videorecorder.video_file_too_large":"Videotiedosto on liian suuri (%s) - klikkaa t&#xE4;st&#xE4; yritt&#xE4;&#xE4; uudelleen pienemm&#xE4;ll&#xE4; videotiedosto.","ba-videorecorder.unsupported_video_type":"Lataa: %s - klikkaa t&#xE4;st&#xE4; yrit&#xE4; uudelleen.","ba-videoplayer-controlbar.exit-fullscreen-video":"exit fullscreen","ba-videoplayer-share.share":"Jaa video","ba-videorecorder-chooser.record-screen":"Tallennusn&#xE4;ytt&#xF6;","ba-videoplayer-controlbar.pause-video-disabled":"Tauko ei ole tuettu","ba-videorecorder-chooser.record-audio":"&#xC4;&#xE4;nit&#xE4; &#xE4;&#xE4;nt&#xE4;","ba-videorecorder-controlbar.stop-available-after":"Minimi tallennusaika on %d sekuntia","ba-videorecorder-controlbar.cancel":"Peruuttaa","ba-videorecorder-controlbar.cancel-tooltip":"Peruuta napsauttamalla t&#xE4;t&#xE4;.","ba-videorecorder.cancel-confirm":"Haluatko todella peruuttaa videon l&#xE4;hett&#xE4;misen?","ba-videoplayer-adslot.elapsed-time":"Elpytty aika","ba-videoplayer-adslot.volume-button":"Aseta &#xE4;&#xE4;nen voimakkuus","ba-videoplayer-adslot.volume-mute":"Mykist&#xE4; &#xE4;&#xE4;ni","ba-videoplayer-adslot.volume-unmute":"Sammuta &#xE4;&#xE4;ni","ba-videoplayer-adslot.ad-will-end-after":"Mainos p&#xE4;&#xE4;ttyy %s: n j&#xE4;lkeen","ba-videoplayer-adslot.can-skip-after":"Ohita %d j&#xE4;lkeen","ba-videoplayer-adslot.skip-ad":"Ohita mainos","ba-videorecorder.software-required":"Napsauta alla olevaa asentaaksesi / aktivoi seuraavat vaatimukset jatkaaksesi.","ba-videorecorder.software-waiting":"Odottaa, ett&#xE4; vaatimukset asennetaan / aktivoidaan. Sinun on ehk&#xE4; p&#xE4;ivitett&#xE4;v&#xE4; sivusi valmiiksi."},"language:fr":{"ba-videoplayer-playbutton.tooltip":"Cliquez ici pour voir la vid&#xE9;o.","ba-videoplayer-playbutton.rerecord":"Revoir","ba-videoplayer-playbutton.submit-video":"Confirmer vid&#xE9;o","ba-videoplayer-loader.tooltip":"T&#xE9;l&#xE9;chargez votre vid&#xE9;o...","ba-videoplayer-controlbar.change-resolution":"Modifiez la r&#xE9;solution d&#x2019;&#xE9;cran","ba-videoplayer-controlbar.video-progress":"Vid&#xE9;o en cours de chargement","ba-videoplayer-controlbar.rerecord-video":"Revoir la vid&#xE9;o?","ba-videoplayer-controlbar.submit-video":"Validez la vid&#xE9;o","ba-videoplayer-controlbar.play-video":"Lire la vid&#xE9;o","ba-videoplayer-controlbar.pause-video":"Pause vid&#xE9;o","ba-videoplayer-controlbar.elapsed-time":"Temps &#xE9;coul&#xE9; ou expir&#xE9;","ba-videoplayer-controlbar.total-time":"Dur&#xE9;e total de la vid&#xE9;o","ba-videoplayer-controlbar.fullscreen-video":"S&#xE9;lectionnez le mode plein &#xE9;cran","ba-videoplayer-controlbar.volume-button":"R&#xE9;glez ou ajustez le volume","ba-videoplayer-controlbar.volume-mute":"Silencieux","ba-videoplayer-controlbar.volume-unmute":"Silencieux d&#xE9;sactiv&#xE9;","ba-videoplayer.video-error":"Une s&#x2019;est produite, r&#xE9;essayez ult&#xE9;rieurement &#x2013; cliquez ici pour r&#xE9;essayer.","ba-videorecorder-chooser.record-video":"Enregistrez votre vid&#xE9;o","ba-videorecorder-chooser.upload-video":"T&#xE9;l&#xE9;chargez votre vid&#xE9;o","ba-videorecorder-controlbar.settings":"R&#xE9;glage ou mise &#xE0; jour","ba-videorecorder-controlbar.camerahealthy":"Bon &#xE9;clairage","ba-videorecorder-controlbar.cameraunhealthy":"L&#x2019;&#xE9;clairage n&#x2019;est pas ideal","ba-videorecorder-controlbar.microphonehealthy":"Bonne acoustique","ba-videorecorder-controlbar.microphoneunhealthy":"Acoustique n&#x27;est pas ideal","ba-videorecorder-controlbar.record":"Enregistrer","ba-videorecorder-controlbar.record-tooltip":"Cliquez ici pour enregistrez.","ba-videorecorder-controlbar.rerecord":"Revoir","ba-videorecorder-controlbar.rerecord-tooltip":"Cliquez ici pour recommencer.","ba-videorecorder-controlbar.upload-covershot":"T&#xE9;l&#xE9;chargez","ba-videorecorder-controlbar.upload-covershot-tooltip":"Cliquez ici pour t&#xE9;l&#xE9;charger une couverture personnalis&#xE9;e.","ba-videorecorder-controlbar.stop":"Arr&#xEA;ter","ba-videorecorder-controlbar.stop-tooltip":"Cliquez ici pour arr&#xEA;ter.","ba-videorecorder-controlbar.skip":"Sauter","ba-videorecorder-controlbar.skip-tooltip":"Cliquez ici pour sauter.","ba-videorecorder.recorder-error":"Une s&#x2019;est produite, r&#xE9;essayez ult&#xE9;rieurement &#x2013; cliquez ici pour r&#xE9;essayer.","ba-videorecorder.attach-error":"Nous ne pouvons pas acc&#xE9;der &#xE0; l&#x2019;interface de l&#x2019;appareil- cela d&#xE9;pend du syst&#xE8;me et de l&#x2019;explorateur. Cela peut n&#xE9;cessiter d&#x2019;installer flash ou une acc&#xE9;dez &#xE0; la page via SSL.","ba-videorecorder.access-forbidden":"L&#x2019;acc&#xE8;s &#xE0; l&#x2019;appareil est interdit. Cliquez pour recommencer.","ba-videorecorder.pick-covershot":"Choisissez une page de couverture.","ba-videorecorder.uploading":"T&#xE9;l&#xE9;chargez","ba-videorecorder.uploading-failed":"T&#xE9;l&#xE9;chargement &#xE9;chou&#xE9;- Cliquez ici pour recommencer ou r&#xE9;essayer.","ba-videorecorder.verifying":"V&#xE9;rification","ba-videorecorder.verifying-failed":"V&#xE9;rification &#xE9;chou&#xE9;e - Cliquez ici pour recommencer ou r&#xE9;essayer.","ba-videorecorder.rerecord-confirm":"Souhaitez vous r&#xE9;ellement recommencer la vid&#xE9;o?","ba-videorecorder.video_file_too_large":"La taille de votre fichier est trop grande (%s). Cliquez ici pour ajuster la taille.","ba-videorecorder.unsupported_video_type":"S&#x27;il vous pla&#xEE;t t&#xE9;l&#xE9;charger: %s - cliquez ici pour r&#xE9;essayer.","ba-videoplayer-controlbar.exit-fullscreen-video":"Quitter le mode plein &#xE9;cran","ba-videoplayer-share.share":"Partager la vid&#xE9;o","ba-videorecorder-chooser.record-screen":"&#xC9;cran d&#x27;enregistrement","ba-videoplayer-controlbar.pause-video-disabled":"Pause non prise en charge","ba-videorecorder-chooser.record-audio":"Enregistrement audio","ba-videorecorder-controlbar.stop-available-after":"La dur&#xE9;e d&#x27;enregistrement minimale est de %d secondes","ba-videorecorder-controlbar.cancel":"Annuler","ba-videorecorder-controlbar.cancel-tooltip":"Cliquez ici pour annuler","ba-videorecorder.cancel-confirm":"Voulez-vous vraiment annuler votre t&#xE9;l&#xE9;chargement de vid&#xE9;o?","ba-videoplayer-adslot.elapsed-time":"Temps &#xE9;lasped","ba-videoplayer-adslot.volume-button":"D&#xE9;finir le volume","ba-videoplayer-adslot.volume-mute":"Son muet","ba-videoplayer-adslot.volume-unmute":"Activer le son","ba-videoplayer-adslot.ad-will-end-after":"L&#x27;annonce se termine apr&#xE8;s %s","ba-videoplayer-adslot.can-skip-after":"Passer apr&#xE8;s %d","ba-videoplayer-adslot.skip-ad":"Passer la pub","ba-videorecorder.software-required":"Veuillez cliquer ci-dessous pour installer / activer les conditions suivantes afin de continuer.","ba-videorecorder.software-waiting":"Attendre que les exigences soient install&#xE9;es / activ&#xE9;es. Vous devrez peut-&#xEA;tre actualiser la page apr&#xE8;s l&#x27;ach&#xE8;vement."},"language:hi":{"ba-videoplayer-playbutton.tooltip":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x91A;&#x932;&#x93E;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-playbutton.rerecord":"&#x92B;&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92A;&#x941;&#x928;&#x903; &#x930;&#x93F;&#x915;&#x949;&#x93F;&#x921; &#x915;&#x93F;","ba-videoplayer-playbutton.submit-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x91C;&#x92E;&#x93E; &#x915;&#x93F;","ba-videoplayer-loader.tooltip":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x932;&#x94B;&#x921; &#x939;&#x94B; &#x930;&#x939;&#x93E; &#x939;&#x948; ...","ba-videoplayer-controlbar.change-resolution":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; - &#x93F;&#x947;&#x938;&#x94B;&#x932;&#x941;&#x936;&#x928; &#x92C;&#x926;&#x932;&#x94B;","ba-videoplayer-controlbar.video-progress":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92C;&#x922;&#x93C; &#x93F;&#x939;&#x93E; &#x939;","ba-videoplayer-controlbar.rerecord-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92A;&#x941;&#x928;&#x903; &#x930;&#x93F;&#x915;&#x949;&#x93F;&#x921; &#x915;&#x93F;","ba-videoplayer-controlbar.submit-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x91C;&#x92E;&#x93E; &#x915;&#x93F;","ba-videoplayer-controlbar.play-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x91A;&#x932;&#x93E;&#x90F;&#x902;","ba-videoplayer-controlbar.pause-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x930;&#x94B;&#x915;&#x947;&#x902;","ba-videoplayer-controlbar.elapsed-time":"&#x92C;&#x940;&#x924;&#x93E;  &#x906; &#x938;&#x92E;&#x92F;","ba-videoplayer-controlbar.total-time":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x915;&#x940; &#x915;&#x941;&#x932; &#x932;&#x902;&#x92C;&#x93E;&#x908;","ba-videoplayer-controlbar.fullscreen-video":"&#x92A;&#x942;&#x930;&#x94D;&#x923; &#x938;&#x94D;&#x915;&#x94D;&#x930;&#x940;&#x928; &#x926;&#x930;&#x94D;&#x91C; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-controlbar.volume-button":"&#x92E;&#x93E;&#x924;&#x94D;&#x930;&#x93E; &#x938;&#x947;&#x91F; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-controlbar.volume-mute":"&#x927;&#x94D;&#x935;&#x928;&#x93F; &#x92E;&#x94D;&#x92F;&#x942;&#x91F; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-controlbar.volume-unmute":"&#x927;&#x94D;&#x935;&#x928;&#x93F; &#x915;&#x94B; &#x905;&#x928;&#x92E;&#x94D;&#x92F;&#x942;&#x91F; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer.video-error":"&#x905; &#x93E;&#x924;  &#x941;&#x921;&#x93F; | &#x92A;&#x941;&#x928;&#x903;  &#x92F;&#x93E;&#x938; &#x915;&#x93F;&#x928;&#x947; &#x915;&#x947; &#x921;&#x932;&#x90F;  &#x93F;&#x915; &#x915;&#x93F;","ba-videorecorder-chooser.record-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x930;&#x93F;&#x915;&#x949;&#x930;&#x94D;&#x921; &#x915;&#x930;&#x94B;","ba-videorecorder-chooser.upload-video":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x905;&#x92A;&#x932;&#x94B;&#x921; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder-controlbar.settings":"&#x938;&#x947;&#x91F;&#x93F;&#x902;&#x917;&#x94D;&#x938;","ba-videorecorder-controlbar.camerahealthy":"&#x92A;&#x94D;&#x930;&#x915;&#x93E;&#x936; &#x905;&#x91A;&#x94D;&#x91B;&#x93E; &#x939;&#x948;","ba-videorecorder-controlbar.cameraunhealthy":"&#x92A;&#x94D;&#x930;&#x915;&#x93E;&#x936; &#x907;&#x937;&#x94D;&#x91F;&#x924;&#x92E; &#x928;&#x939;&#x940;&#x902; &#x939;&#x948;","ba-videorecorder-controlbar.microphonehealthy":"&#x927;&#x94D;&#x935;&#x928;&#x93F; &#x905;&#x91A;&#x94D;&#x91B;&#x940; &#x939;&#x948;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x915;&#x94B;&#x908; &#x92D;&#x940; &#x906;&#x935;&#x93E;&#x91C; &#x928;&#x939;&#x940;&#x902; &#x909;&#x920;&#x93E; &#x938;&#x915;&#x924;&#x93E;","ba-videorecorder-controlbar.record":"&#x930;&#x93F;&#x915;&#x949;&#x93F;&#x921;","ba-videorecorder-controlbar.record-tooltip":"&#x930;&#x93F;&#x915;&#x949;&#x930;&#x94D;&#x921; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videorecorder-controlbar.rerecord":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92A;&#x941;&#x928;&#x903; &#x930;&#x93F;&#x915;&#x949;&#x93F;&#x921; &#x915;&#x93F;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x92B;&#x93F;&#x930; &#x938;&#x947; &#x915;&#x930;&#x947;&#x902; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videorecorder-controlbar.upload-covershot":"&#x905;&#x92A;&#x932;&#x94B;&#x921;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x915;&#x938;&#x94D;&#x91F;&#x92E; &#x915;&#x935;&#x930; &#x936;&#x949;&#x91F; &#x905;&#x92A;&#x932;&#x94B;&#x921; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder-controlbar.stop":"&#x930;&#x941;&#x915;&#x947;&#x902;","ba-videorecorder-controlbar.stop-tooltip":"&#x930;&#x94B;&#x915;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder-controlbar.skip":"&#x91B;&#x94B;&#x921;&#x93C;&#x947;&#x902;","ba-videorecorder-controlbar.skip-tooltip":"&#x91B;&#x94B;&#x921;&#x93C;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videorecorder.recorder-error":"&#x90F;&#x915; &#x924;&#x94D;&#x930;&#x941;&#x91F;&#x93F; &#x918;&#x91F;&#x93F;&#x924; &#x939;&#x941;&#x908; &#x939;&#x948;, &#x915;&#x943;&#x92A;&#x92F;&#x93E; &#x92C;&#x93E;&#x926; &#x92E;&#x947;&#x902; &#x92A;&#x941;&#x928;: &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x947;&#x902;&#x964; &#x92A;&#x941;&#x928;&#x903; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder.attach-error":"&#x939;&#x92E; &#x915;&#x948;&#x92E;&#x930;&#x947; &#x915;&#x947; &#x907;&#x902;&#x91F;&#x930;&#x92B;&#x93C;&#x947;&#x938; &#x924;&#x915; &#x92A;&#x939;&#x941;&#x902;&#x91A; &#x928;&#x939;&#x940;&#x902; &#x938;&#x915;&#x947;&#x964; &#x921;&#x93F;&#x935;&#x93E;&#x907;&#x938; &#x914;&#x930; &#x92C;&#x94D;&#x930;&#x93E;&#x909;&#x91C;&#x93C;&#x930; &#x915;&#x947; &#x906;&#x927;&#x93E;&#x930; &#x92A;&#x930;, &#x906;&#x92A;&#x915;&#x94B; &#x92B;&#x94D;&#x932;&#x948;&#x936; &#x907;&#x902;&#x938;&#x94D;&#x91F;&#x949;&#x932; &#x915;&#x930;&#x928;&#x93E; &#x92F;&#x93E; &#x92A;&#x943;&#x937;&#x94D;&#x920; &#x92A;&#x930; &#x90F;&#x938;&#x90F;&#x938;&#x90F;&#x932; &#x915;&#x947; &#x92E;&#x93E;&#x927;&#x94D;&#x92F;&#x92E; &#x938;&#x947; &#x92A;&#x94D;&#x930;&#x935;&#x947;&#x936; &#x915;&#x930;&#x928;&#x93E; &#x92A;&#x921;&#x93C; &#x938;&#x915;&#x924;&#x93E; &#x939;&#x948;","ba-videorecorder.access-forbidden":"&#x915;&#x948;&#x92E;&#x930;&#x947; &#x924;&#x915; &#x92A;&#x939;&#x941;&#x902;&#x91A; &#x92E;&#x928;&#x93E;&#x908; &#x917;&#x908; &#x925;&#x940; &#x92A;&#x941;&#x928;&#x903; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder.pick-covershot":"&#x936;&#x949;&#x93F;&#x921;&#x915;&#x93F; &#x915;&#x93E; &#x91A;&#x941;&#x928;&#x93E;&#x935; &#x915;&#x940;&#x921;&#x91C;&#x90F;","ba-videorecorder.uploading":"&#x905;&#x92A;&#x932;&#x94B;&#x921; &#x939;&#x94B; &#x930;&#x939;&#x93E; &#x939;&#x948;","ba-videorecorder.uploading-failed":"&#x905;&#x92A;&#x932;&#x94B;&#x921; &#x915;&#x930;&#x928;&#x93E; &#x935;&#x93F;&#x92B;&#x932; - &#x92A;&#x941;&#x928;&#x903; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videorecorder.verifying":"&#x91C;&#x93E; &#x91A; &#x91C;&#x93E;&#x93F;&#x940; &#x939;&#x948;","ba-videorecorder.verifying-failed":"&#x938;&#x924;&#x94D;&#x92F;&#x93E;&#x92A;&#x928; &#x935;&#x93F;&#x92B;&#x932; - &#x92A;&#x941;&#x928;&#x903; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videorecorder.rerecord-confirm":"&#x915;&#x94D;&#x92F;&#x93E; &#x906;&#x92A; &#x935;&#x93E;&#x938;&#x94D;&#x924;&#x935; &#x92E;&#x947;&#x902; &#x905;&#x92A;&#x928;&#x947; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x915;&#x94B; &#x92B;&#x93F;&#x930; &#x938;&#x947; &#x915;&#x930;&#x928;&#x93E; &#x91A;&#x93E;&#x939;&#x924;&#x947; &#x939;&#x948;&#x902;?","ba-videorecorder.video_file_too_large":"&#x906;&#x92A;&#x915;&#x940; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92B;&#x93C;&#x93E;&#x907;&#x932; &#x92C;&#x939;&#x941;&#x924; &#x92C;&#x921;&#x93C;&#x940; &#x939;&#x948; ( %s) - &#x90F;&#x915; &#x91B;&#x94B;&#x91F;&#x947; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92B;&#x93C;&#x93E;&#x907;&#x932; &#x915;&#x947; &#x938;&#x93E;&#x925; &#x92B;&#x93F;&#x930; &#x938;&#x947; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder.unsupported_video_type":"&#x915;&#x943;&#x92A;&#x92F;&#x93E; &#x905;&#x92A;&#x932;&#x94B;&#x921; &#x915;&#x930;&#x947;&#x902;: %s - &#x92A;&#x941;&#x928;&#x903; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x92A;&#x942;&#x930;&#x94D;&#x923; &#x938;&#x94D;&#x915;&#x94D;&#x930;&#x940;&#x928; &#x938;&#x947; &#x92C;&#x93E;&#x939;&#x930; &#x928;&#x93F;&#x915;&#x932;&#x947;&#x902;","ba-videoplayer-share.share":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x936;&#x947;&#x92F;&#x930; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder-chooser.record-screen":"&#x930;&#x93F;&#x915;&#x949;&#x930;&#x94D;&#x921; &#x938;&#x94D;&#x915;&#x94D;&#x930;&#x940;&#x928;","ba-videoplayer-controlbar.pause-video-disabled":"&#x930;&#x94B;&#x915;&#x947;&#x902; &#x938;&#x92E;&#x930;&#x94D;&#x925;&#x93F;&#x924; &#x928;&#x939;&#x940;&#x902; &#x939;&#x948;","ba-videorecorder-chooser.record-audio":"&#x927;&#x94D;&#x935;&#x928;&#x93F; &#x930;&#x93F;&#x915;&#x949;&#x930;&#x94D;&#x921; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder-controlbar.stop-available-after":"&#x928;&#x94D;&#x92F;&#x942;&#x928;&#x924;&#x92E; &#x930;&#x93F;&#x915;&#x949;&#x930;&#x94D;&#x921;&#x93F;&#x902;&#x917; &#x938;&#x92E;&#x92F; %d &#x938;&#x947;&#x915;&#x902;&#x921; &#x939;&#x948;","ba-videorecorder-controlbar.cancel":"&#x930;&#x926;&#x94D;&#x926; &#x915;&#x930;&#x928;&#x93E;","ba-videorecorder-controlbar.cancel-tooltip":"&#x930;&#x926;&#x94D;&#x926; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x92F;&#x939;&#x93E;&#x902; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;","ba-videorecorder.cancel-confirm":"&#x915;&#x94D;&#x92F;&#x93E; &#x906;&#x92A; &#x935;&#x93E;&#x915;&#x908; &#x905;&#x92A;&#x928;&#x93E; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x905;&#x92A;&#x932;&#x94B;&#x921; &#x930;&#x926;&#x94D;&#x926; &#x915;&#x930;&#x928;&#x93E; &#x91A;&#x93E;&#x939;&#x924;&#x947; &#x939;&#x948;&#x902;?","ba-videoplayer-adslot.elapsed-time":"Elasped &#x938;&#x92E;&#x92F;","ba-videoplayer-adslot.volume-button":"&#x92E;&#x93E;&#x924;&#x94D;&#x930;&#x93E; &#x938;&#x947;&#x91F; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-adslot.volume-mute":"&#x927;&#x94D;&#x935;&#x928;&#x93F; &#x92E;&#x94D;&#x92F;&#x942;&#x91F; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-adslot.volume-unmute":"&#x927;&#x94D;&#x935;&#x928;&#x93F; &#x915;&#x94B; &#x905;&#x928;&#x92E;&#x94D;&#x92F;&#x942;&#x91F; &#x915;&#x930;&#x947;&#x902;","ba-videoplayer-adslot.ad-will-end-after":"&#x935;&#x93F;&#x91C;&#x94D;&#x91E;&#x93E;&#x92A;&#x928; %s &#x915;&#x947; &#x92C;&#x93E;&#x926; &#x938;&#x92E;&#x93E;&#x92A;&#x94D;&#x924; &#x939;&#x94B; &#x91C;&#x93E;&#x90F;&#x917;&#x93E;","ba-videoplayer-adslot.can-skip-after":" %D &#x915;&#x947; &#x92C;&#x93E;&#x926; &#x91B;&#x94B;&#x921;&#x93C;&#x947;&#x902;","ba-videoplayer-adslot.skip-ad":"&#x935;&#x93F;&#x91C;&#x94D;&#x91E;&#x93E;&#x92A;&#x928; &#x938;&#x947; &#x906;&#x917;&#x947; &#x92C;&#x922;&#x93C;&#x947;&#x902;","ba-videorecorder.software-required":"&#x906;&#x917;&#x947; &#x92C;&#x922;&#x93C;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x915;&#x943;&#x92A;&#x92F;&#x93E; &#x928;&#x93F;&#x92E;&#x94D;&#x928;&#x932;&#x93F;&#x916;&#x93F;&#x924; &#x906;&#x935;&#x936;&#x94D;&#x92F;&#x915;&#x924;&#x93E;&#x913;&#x902; &#x915;&#x94B; &#x938;&#x94D;&#x925;&#x93E;&#x92A;&#x93F;&#x924; / &#x938;&#x915;&#x94D;&#x930;&#x93F;&#x92F; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x928;&#x940;&#x91A;&#x947; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930;&#x947;&#x902;&#x964;","ba-videorecorder.software-waiting":"&#x906;&#x935;&#x936;&#x94D;&#x92F;&#x915;&#x924;&#x93E;&#x913;&#x902; &#x915;&#x94B; &#x938;&#x94D;&#x925;&#x93E;&#x92A;&#x93F;&#x924; / &#x938;&#x915;&#x94D;&#x930;&#x93F;&#x92F; &#x915;&#x930;&#x928;&#x947; &#x915;&#x940; &#x92A;&#x94D;&#x930;&#x924;&#x940;&#x915;&#x94D;&#x937;&#x93E; &#x915;&#x930; &#x930;&#x939;&#x93E; &#x939;&#x948; &#x906;&#x92A;&#x915;&#x94B; &#x92A;&#x942;&#x930;&#x93E; &#x939;&#x94B;&#x928;&#x947; &#x915;&#x947; &#x92C;&#x93E;&#x926; &#x92A;&#x943;&#x937;&#x94D;&#x920; &#x915;&#x94B; &#x930;&#x940;&#x92B;&#x93C;&#x94D;&#x930;&#x947;&#x936; &#x915;&#x930;&#x928;&#x93E; &#x92A;&#x921;&#x93C; &#x938;&#x915;&#x924;&#x93E; &#x939;&#x948;"},"language:hr":{"ba-videoplayer-playbutton.tooltip":"Kliknite za reprodukciju video zapisa.","ba-videoplayer-playbutton.rerecord":"preurediti","ba-videoplayer-playbutton.submit-video":"Potvrda videa","ba-videoplayer-loader.tooltip":"U&#x10D;itavanje videa ...","ba-videoplayer-controlbar.change-resolution":"Promjena razlu&#x10D;ivosti","ba-videoplayer-controlbar.video-progress":"napredak Video","ba-videoplayer-controlbar.rerecord-video":"Ponovi video?","ba-videoplayer-controlbar.submit-video":"Potvrda videa","ba-videoplayer-controlbar.play-video":"Reprodukcija videozapisa","ba-videoplayer-controlbar.pause-video":"Pauza Video","ba-videoplayer-controlbar.elapsed-time":"Elasped vrijeme","ba-videoplayer-controlbar.total-time":"Ukupna du&#x17E;ina videa","ba-videoplayer-controlbar.fullscreen-video":"Idi na puni zaslon","ba-videoplayer-controlbar.volume-button":"Set volumen","ba-videoplayer-controlbar.volume-mute":"Bez zvuka","ba-videoplayer-controlbar.volume-unmute":"Vrati zvuk","ba-videoplayer.video-error":"Do&#x161;lo je do pogre&#x161;ke. Molimo poku&#x161;ajte ponovno kasnije. Kliknite za ponovni poku&#x161;aj.","ba-videorecorder-chooser.record-video":"Snimanje videa","ba-videorecorder-chooser.upload-video":"Dodaj video","ba-videorecorder-controlbar.settings":"Postavke","ba-videorecorder-controlbar.camerahealthy":"Rasvjeta je dobra","ba-videorecorder-controlbar.cameraunhealthy":"Rasvjeta nije optimalno","ba-videorecorder-controlbar.microphonehealthy":"Zvuk je dobar","ba-videorecorder-controlbar.microphoneunhealthy":"ne mo&#x17E;e podi&#x107;i bilo koji zvuk","ba-videorecorder-controlbar.record":"Snimiti","ba-videorecorder-controlbar.record-tooltip":"Kliknite ovdje za snimanje.","ba-videorecorder-controlbar.rerecord":"preurediti","ba-videorecorder-controlbar.rerecord-tooltip":"Kliknite ovdje ponoviti.","ba-videorecorder-controlbar.upload-covershot":"Postavi","ba-videorecorder-controlbar.upload-covershot-tooltip":"Kliknite ovdje kako biste poslali prilago&#x111;ene cover metak","ba-videorecorder-controlbar.stop":"Stop","ba-videorecorder-controlbar.stop-tooltip":"Kliknite ovdje da se zaustavi.","ba-videorecorder-controlbar.skip":"Presko&#x10D;iti","ba-videorecorder-controlbar.skip-tooltip":"Kliknite ovdje presko&#x10D;iti.","ba-videorecorder.recorder-error":"Do&#x161;lo je do pogre&#x161;ke. Molimo poku&#x161;ajte ponovno kasnije. Kliknite za ponovni poku&#x161;aj.","ba-videorecorder.attach-error":"Nismo mogli pristupiti su&#x10D;elju fotoaparata. Ovisno o ure&#x111;aju i preglednika, mo&#x17E;da &#x107;ete morati instalirati Flash ili pristupiti stranici putem SSL-a.","ba-videorecorder.access-forbidden":"Pristup kameri je zabranjeno. Kliknite za ponovni poku&#x161;aj.","ba-videorecorder.pick-covershot":"Izaberite covershot.","ba-videorecorder.uploading":"Prijenos","ba-videorecorder.uploading-failed":"Prijenos nije uspio - kliknite ovdje za ponovni poku&#x161;aj.","ba-videorecorder.verifying":"Potvr&#x111;ivanje","ba-videorecorder.verifying-failed":"Potvr&#x111;ivanje nije uspjelo - kliknite ovdje za ponovni poku&#x161;aj.","ba-videorecorder.rerecord-confirm":"Da li zaista &#x17E;elite ponoviti svoj video?","ba-videorecorder.video_file_too_large":"Va&#x161; video datoteka je prevelika (%s) - kliknite ovdje kako bi poku&#x161;ali ponovno s manjim video datoteka.","ba-videorecorder.unsupported_video_type":"Prenesite: %s - kliknite ovdje za ponovni poku&#x161;aj.","ba-videoplayer-controlbar.exit-fullscreen-video":"Iza&#x111;ite iz cijelog zaslona","ba-videoplayer-share.share":"Dijeljenje videozapisa","ba-videorecorder-chooser.record-screen":"Zaslon za snimanje","ba-videoplayer-controlbar.pause-video-disabled":"Pauza nije podr&#x17E;ana","ba-videorecorder-chooser.record-audio":"Snimanje zvuka","ba-videorecorder-controlbar.stop-available-after":"Minimalno vrijeme snimanja je %d sekundi","ba-videorecorder-controlbar.cancel":"Otkazati","ba-videorecorder-controlbar.cancel-tooltip":"Kliknite ovdje kako biste odustali.","ba-videorecorder.cancel-confirm":"&#x17D;elite li zaista odustati od prijenosa videozapisa?","ba-videoplayer-adslot.elapsed-time":"Otpremljeno vrijeme","ba-videoplayer-adslot.volume-button":"Postavite glasno&#x107;u","ba-videoplayer-adslot.volume-mute":"Isklju&#x10D;ite zvuk","ba-videoplayer-adslot.volume-unmute":"Uklju&#x10D;i zvuk","ba-videoplayer-adslot.ad-will-end-after":"Oglas zavr&#x161;ava nakon %s","ba-videoplayer-adslot.can-skip-after":"Presko&#x10D;i nakon %d","ba-videoplayer-adslot.skip-ad":"Presko&#x10D;ite oglas","ba-videorecorder.software-required":"Kliknite dolje da biste instalirali / aktivirali sljede&#x107;e uvjete kako biste nastavili.","ba-videorecorder.software-waiting":"&#x10C;eka se postavljanje / aktiviranje zahtjeva. Mo&#x17E;da &#x107;ete morati osvje&#x17E;iti stranicu nakon zavr&#x161;etka."},"language:hu":{"ba-videoplayer-playbutton.tooltip":"Kattintson ide a vide&#xF3; lej&#xE1;tsz&#xE1;s&#xE1;hoz.","ba-videoplayer-playbutton.rerecord":"&#xDA;jra","ba-videoplayer-playbutton.submit-video":"Er&#x151;s&#xED;tse vide&#xF3;","ba-videoplayer-loader.tooltip":"Vide&#xF3; bet&#xF6;lt&#xE9;se ...","ba-videoplayer-controlbar.change-resolution":"a felbont&#xE1;s m&#xF3;dos&#xED;t&#xE1;sa","ba-videoplayer-controlbar.video-progress":"vide&#xF3; halad&#xE1;s","ba-videoplayer-controlbar.rerecord-video":"&#xDA;jra vide&#xF3;t?","ba-videoplayer-controlbar.submit-video":"Er&#x151;s&#xED;tse vide&#xF3;","ba-videoplayer-controlbar.play-video":"vide&#xF3; lej&#xE1;tsz&#xE1;sa","ba-videoplayer-controlbar.pause-video":"sz&#xFC;net vide&#xF3;","ba-videoplayer-controlbar.elapsed-time":"Eltelt id&#x151;","ba-videoplayer-controlbar.total-time":"Teljes hossza vide&#xF3;","ba-videoplayer-controlbar.fullscreen-video":"a teljes k&#xE9;perny&#x151;s","ba-videoplayer-controlbar.volume-button":"&#xC1;ll&#xED;tsa be a hanger&#x151;t","ba-videoplayer-controlbar.volume-mute":"hang eln&#xE9;m&#xED;t&#xE1;sa","ba-videoplayer-controlbar.volume-unmute":"Unmute hang","ba-videoplayer.video-error":"Hiba t&#xF6;rt&#xE9;nt. K&#xE9;rj&#xFC;k, pr&#xF3;b&#xE1;lkozzon k&#xE9;s&#x151;bb. Kattintson ide &#xFA;jra.","ba-videorecorder-chooser.record-video":"A vide&#xF3; r&#xF6;gz&#xED;t&#xE9;s&#xE9;nek","ba-videorecorder-chooser.upload-video":"Vide&#xF3; felt&#xF6;lt&#xE9;se","ba-videorecorder-controlbar.settings":"Be&#xE1;ll&#xED;t&#xE1;sok","ba-videorecorder-controlbar.camerahealthy":"Vil&#xE1;g&#xED;t&#xE1;s j&#xF3;","ba-videorecorder-controlbar.cameraunhealthy":"Vil&#xE1;g&#xED;t&#xE1;s nem optim&#xE1;lis","ba-videorecorder-controlbar.microphonehealthy":"Hang j&#xF3;","ba-videorecorder-controlbar.microphoneunhealthy":"Nem lehet felvenni minden hang","ba-videorecorder-controlbar.record":"Rekord","ba-videorecorder-controlbar.record-tooltip":"Kattintson ide, hogy r&#xF6;gz&#xED;ti.","ba-videorecorder-controlbar.rerecord":"&#xDA;jra","ba-videorecorder-controlbar.rerecord-tooltip":"Kattintson ide, hogy &#xFA;jra.","ba-videorecorder-controlbar.upload-covershot":"Felt&#xF6;lt&#xE9;s","ba-videorecorder-controlbar.upload-covershot-tooltip":"Kattintson ide felt&#xF6;lthet&#x151; egyedi fed&#xE9;l l&#xF6;v&#xE9;s","ba-videorecorder-controlbar.stop":"&#xC1;llj meg","ba-videorecorder-controlbar.stop-tooltip":"Kattintson ide, hogy hagyja abba.","ba-videorecorder-controlbar.skip":"Skip","ba-videorecorder-controlbar.skip-tooltip":"Kattintson ide, hogy kihagyja.","ba-videorecorder.recorder-error":"Hiba t&#xF6;rt&#xE9;nt. K&#xE9;rj&#xFC;k, pr&#xF3;b&#xE1;lkozzon k&#xE9;s&#x151;bb. Kattintson ide &#xFA;jra.","ba-videorecorder.attach-error":"Nem tudtuk el&#xE9;rni a kamera interface. Att&#xF3;l f&#xFC;gg&#x151;en, hogy a k&#xE9;sz&#xFC;l&#xE9;k &#xE9;s a b&#xF6;ng&#xE9;sz&#x151;ben, akkor telep&#xED;tenie kell a Flash vagy el&#xE9;rni az oldalt SSL.","ba-videorecorder.access-forbidden":"Hozz&#xE1;f&#xE9;r&#xE9;s a kamera tilos volt. Kattintson ide &#xFA;jra.","ba-videorecorder.pick-covershot":"V&#xE1;lassz egy covershot.","ba-videorecorder.uploading":"Felt&#xF6;lt&#xE9;s","ba-videorecorder.uploading-failed":"Felt&#xF6;lt&#xE9;s sikertelen - ide kattintva &#xFA;jra.","ba-videorecorder.verifying":"ellen&#x151;rz&#xE9;se","ba-videorecorder.verifying-failed":"Ellen&#x151;rz&#xE9;s&#xE9;&#xE9;rt sikertelen - ide kattintva &#xFA;jra.","ba-videorecorder.rerecord-confirm":"T&#xE9;nyleg azt akarja ism&#xE9;telni a vide&#xF3;?","ba-videorecorder.video_file_too_large":"A vide&#xF3; f&#xE1;jl t&#xFA;l nagy (%s) - ide kattintva pr&#xF3;b&#xE1;lkozzon &#xFA;jra egy kisebb video f&#xE1;jlt.","ba-videorecorder.unsupported_video_type":"K&#xE9;rj&#xFC;k, t&#xF6;lts&#xF6;n fel: %s - ide kattintva &#xFA;jra.","ba-videoplayer-controlbar.exit-fullscreen-video":"Kil&#xE9;p&#xE9;s a teljes k&#xE9;perny&#x151;s","ba-videoplayer-share.share":"Vide&#xF3; megoszt&#xE1;sa","ba-videorecorder-chooser.record-screen":"Felv&#xE9;tel k&#xE9;perny&#x151;","ba-videoplayer-controlbar.pause-video-disabled":"A sz&#xFC;neteltet&#xE9;s nem t&#xE1;mogatott","ba-videorecorder-chooser.record-audio":"Hang r&#xF6;gz&#xED;t&#xE9;se","ba-videorecorder-controlbar.stop-available-after":"A minim&#xE1;lis felv&#xE9;teli id&#x151; %d m&#xE1;sodperc","ba-videorecorder-controlbar.cancel":"Megsz&#xFC;nteti","ba-videorecorder-controlbar.cancel-tooltip":"Kattintson ide a lemond&#xE1;shoz.","ba-videorecorder.cancel-confirm":"T&#xE9;nyleg t&#xF6;r&#xF6;lni szeretn&#xE9; a vide&#xF3; felt&#xF6;lt&#xE9;s&#xE9;t?","ba-videoplayer-adslot.elapsed-time":"Elkelt id&#x151;","ba-videoplayer-adslot.volume-button":"&#xC1;ll&#xED;tsa be a hanger&#x151;t","ba-videoplayer-adslot.volume-mute":"Eln&#xE9;m&#xED;tja a hangot","ba-videoplayer-adslot.volume-unmute":"Csengessen a hang","ba-videoplayer-adslot.ad-will-end-after":"A hirdet&#xE9;s a %s ut&#xE1;n befejez&#x151;dik","ba-videoplayer-adslot.can-skip-after":"Ugr&#xE1;s a %d ut&#xE1;n","ba-videoplayer-adslot.skip-ad":"Hirdet&#xE9;s &#xE1;tugr&#xE1;sa","ba-videorecorder.software-required":"K&#xE9;rj&#xFC;k, kattintson az al&#xE1;bbi gombra a k&#xF6;vetkez&#x151; k&#xF6;vetelm&#xE9;nyek telep&#xED;t&#xE9;s&#xE9;hez / aktiv&#xE1;l&#xE1;s&#xE1;hoz a folytat&#xE1;shoz.","ba-videorecorder.software-waiting":"V&#xE1;rakoz&#xE1;s a telep&#xED;t&#xE9;s / aktiv&#xE1;l&#xE1;s k&#xF6;vetelm&#xE9;nyeire. Lehet, hogy friss&#xED;tenie kell az oldalt befejez&#xE9;se ut&#xE1;n."},"language:id":{"ba-videoplayer-playbutton.tooltip":"Klik untuk memutar video.","ba-videoplayer-playbutton.rerecord":"Mengulangi","ba-videoplayer-playbutton.submit-video":"Konfirmasi video","ba-videoplayer-loader.tooltip":"Memuat video ...","ba-videoplayer-controlbar.change-resolution":"Ubah resolusi","ba-videoplayer-controlbar.video-progress":"Kemajuan video","ba-videoplayer-controlbar.rerecord-video":"Redo video?","ba-videoplayer-controlbar.submit-video":"Konfirmasi video","ba-videoplayer-controlbar.play-video":"Putar video","ba-videoplayer-controlbar.pause-video":"Jeda video","ba-videoplayer-controlbar.elapsed-time":"Elasped waktu","ba-videoplayer-controlbar.total-time":"Panjang video total","ba-videoplayer-controlbar.fullscreen-video":"Memasuki layar penuh","ba-videoplayer-controlbar.volume-button":"Setel volume","ba-videoplayer-controlbar.volume-mute":"Bisu terdengar","ba-videoplayer-controlbar.volume-unmute":"Suarakan suara","ba-videoplayer.video-error":"Terjadi kesalahan, coba lagi nanti. Klik untuk mencoba lagi.","ba-videorecorder-chooser.record-video":"Merekam video","ba-videorecorder-chooser.upload-video":"Upload Video","ba-videorecorder-controlbar.settings":"Pengaturan","ba-videorecorder-controlbar.camerahealthy":"Pencahayaan itu bagus","ba-videorecorder-controlbar.cameraunhealthy":"Pencahayaan tidak optimal","ba-videorecorder-controlbar.microphonehealthy":"Suara bagus","ba-videorecorder-controlbar.microphoneunhealthy":"Tidak bisa mengambil suara apapun","ba-videorecorder-controlbar.record":"Merekam","ba-videorecorder-controlbar.record-tooltip":"Klik di sini untuk merekam.","ba-videorecorder-controlbar.rerecord":"Mengulangi","ba-videorecorder-controlbar.rerecord-tooltip":"Klik di sini untuk mengulang.","ba-videorecorder-controlbar.upload-covershot":"Upload","ba-videorecorder-controlbar.upload-covershot-tooltip":"Klik di sini untuk mengunggah tangkapan sampul khusus","ba-videorecorder-controlbar.stop":"Berhenti","ba-videorecorder-controlbar.stop-tooltip":"Klik di sini untuk berhenti.","ba-videorecorder-controlbar.skip":"Melewatkan","ba-videorecorder-controlbar.skip-tooltip":"Klik di sini untuk melompat.","ba-videorecorder.recorder-error":"Terjadi kesalahan, coba lagi nanti. Klik untuk mencoba lagi.","ba-videorecorder.attach-error":"Kami tidak dapat mengakses antarmuka kamera. Bergantung pada perangkat dan browser, Anda mungkin perlu menginstal Flash atau mengakses halaman melalui SSL.","ba-videorecorder.access-forbidden":"Akses ke kamera dilarang. Klik untuk mencoba lagi.","ba-videorecorder.pick-covershot":"Pilih sebuah coverhot.","ba-videorecorder.uploading":"Mengunggah","ba-videorecorder.uploading-failed":"Mengunggah gagal - klik di sini untuk mencoba lagi.","ba-videorecorder.verifying":"Memverifikasi","ba-videorecorder.verifying-failed":"Verifikasi gagal - klik di sini untuk mencoba lagi.","ba-videorecorder.rerecord-confirm":"Apakah Anda benar-benar ingin mengulang video Anda?","ba-videorecorder.video_file_too_large":"File video Anda terlalu besar ( %s) - klik di sini untuk mencoba lagi dengan file video yang lebih kecil.","ba-videorecorder.unsupported_video_type":"Silakan upload: %s - klik di sini untuk mencoba lagi.","ba-videoplayer-controlbar.exit-fullscreen-video":"Keluar dari layar penuh","ba-videoplayer-share.share":"Berbagi video","ba-videorecorder-chooser.record-screen":"Layar rekam","ba-videoplayer-controlbar.pause-video-disabled":"Jeda tidak didukung","ba-videorecorder-chooser.record-audio":"Suara rekaman","ba-videorecorder-controlbar.stop-available-after":"Waktu perekaman minimum adalah %d detik","ba-videorecorder-controlbar.cancel":"Membatalkan","ba-videorecorder-controlbar.cancel-tooltip":"Klik disini untuk membatalkan","ba-videorecorder.cancel-confirm":"Apakah Anda benar-benar ingin membatalkan upload video Anda?","ba-videoplayer-adslot.elapsed-time":"Elasped waktu","ba-videoplayer-adslot.volume-button":"Setel volume","ba-videoplayer-adslot.volume-mute":"Bisu terdengar","ba-videoplayer-adslot.volume-unmute":"Suarakan suara","ba-videoplayer-adslot.ad-will-end-after":"Iklan akan berakhir setelah %s","ba-videoplayer-adslot.can-skip-after":"Lewati setelah %d","ba-videoplayer-adslot.skip-ad":"Melewatkan iklan","ba-videorecorder.software-required":"Silahkan klik di bawah ini untuk menginstal / mengaktifkan persyaratan berikut agar bisa melanjutkan.","ba-videorecorder.software-waiting":"Menunggu persyaratan untuk dipasang / diaktifkan. Anda mungkin perlu menyegarkan halaman setelah selesai."},"language:it":{"ba-videoplayer-playbutton.tooltip":"Clicca per giocare video.","ba-videoplayer-playbutton.rerecord":"Rifare","ba-videoplayer-playbutton.submit-video":"confermare il video","ba-videoplayer-loader.tooltip":"Caricamento video...","ba-videoplayer-controlbar.change-resolution":"Cambiare la risoluzione","ba-videoplayer-controlbar.video-progress":"progresso Video","ba-videoplayer-controlbar.rerecord-video":"Ripeti video?","ba-videoplayer-controlbar.submit-video":"confermare il video","ba-videoplayer-controlbar.play-video":"Guarda il video","ba-videoplayer-controlbar.pause-video":"il video Pause","ba-videoplayer-controlbar.elapsed-time":"tempo Elasped","ba-videoplayer-controlbar.total-time":"La lunghezza totale di Video","ba-videoplayer-controlbar.fullscreen-video":"Vai a tutto schermo","ba-videoplayer-controlbar.volume-button":"Impostare il volume","ba-videoplayer-controlbar.volume-mute":"suono muto","ba-videoplayer-controlbar.volume-unmute":"disattivare l&#x27;audio","ba-videoplayer.video-error":"&#xC8; verificato un errore, riprova pi&#xF9; tardi. Fare clic per riprovare.","ba-videorecorder-chooser.record-video":"Registra il tuo video","ba-videorecorder-chooser.upload-video":"Carica video","ba-videorecorder-controlbar.settings":"impostazioni","ba-videorecorder-controlbar.camerahealthy":"L&#x27;illuminazione &#xE8; buona","ba-videorecorder-controlbar.cameraunhealthy":"L&#x27;illuminazione non &#xE8; ottimale","ba-videorecorder-controlbar.microphonehealthy":"Il suono &#xE8; buono","ba-videorecorder-controlbar.microphoneunhealthy":"Non &#xE8; possibile udire i suoni","ba-videorecorder-controlbar.record":"Disco","ba-videorecorder-controlbar.record-tooltip":"Clicca qui per registrare.","ba-videorecorder-controlbar.rerecord":"Rifare","ba-videorecorder-controlbar.rerecord-tooltip":"Clicca qui per rifare.","ba-videorecorder-controlbar.upload-covershot":"Caricare","ba-videorecorder-controlbar.upload-covershot-tooltip":"Clicca qui per caricare copertina personalizzata colpo","ba-videorecorder-controlbar.stop":"Stop","ba-videorecorder-controlbar.stop-tooltip":"Clicca qui per fermare.","ba-videorecorder-controlbar.skip":"Salta","ba-videorecorder-controlbar.skip-tooltip":"Clicca qui per saltare.","ba-videorecorder.recorder-error":"&#xC8; verificato un errore, riprova pi&#xF9; tardi. Fare clic per riprovare.","ba-videorecorder.attach-error":"Non abbiamo potuto accedere alla interfaccia della fotocamera. A seconda del dispositivo e del browser, potrebbe essere necessario installare Flash o accedere alla pagina tramite SSL.","ba-videorecorder.access-forbidden":"L&#x27;accesso alla telecamera era proibito. Fare clic per riprovare.","ba-videorecorder.pick-covershot":"Scegli una covershot.","ba-videorecorder.uploading":"Caricamento","ba-videorecorder.uploading-failed":"Caricamento fallito - clicca qui per riprovare.","ba-videorecorder.verifying":"verifica","ba-videorecorder.verifying-failed":"Verifica non riuscita - clicca qui per riprovare.","ba-videorecorder.rerecord-confirm":"Vuoi davvero di rifare il video?","ba-videorecorder.video_file_too_large":"Il file video &#xE8; troppo grande (%s) - clicca qui per provare di nuovo con un file video pi&#xF9; piccolo.","ba-videorecorder.unsupported_video_type":"Si prega di caricare: %s - clicca qui per riprovare.","ba-videoplayer-controlbar.exit-fullscreen-video":"Uscire da schermo intero","ba-videoplayer-share.share":"Condividi il Video","ba-videorecorder-chooser.record-screen":"Registra schermo","ba-videoplayer-controlbar.pause-video-disabled":"Pausa non supportata","ba-videorecorder-chooser.record-audio":"Registra audio","ba-videorecorder-controlbar.stop-available-after":"Il tempo di registrazione minimo &#xE8; %d secondi","ba-videorecorder-controlbar.cancel":"Annulla","ba-videorecorder-controlbar.cancel-tooltip":"Clicca qui per cancellare.","ba-videorecorder.cancel-confirm":"Vuoi veramente cancellare il tuo caricamento video?","ba-videoplayer-adslot.elapsed-time":"Tempo trascorso","ba-videoplayer-adslot.volume-button":"Imposta il volume","ba-videoplayer-adslot.volume-mute":"Suono muto","ba-videoplayer-adslot.volume-unmute":"Riattiva il suono","ba-videoplayer-adslot.ad-will-end-after":"L&#x27;annuncio terminer&#xE0; dopo %s","ba-videoplayer-adslot.can-skip-after":"Salta dopo %d","ba-videoplayer-adslot.skip-ad":"Salta annuncio","ba-videorecorder.software-required":"Clicca qui sotto per installare / attivare i seguenti requisiti per procedere.","ba-videorecorder.software-waiting":"Aspettando che i requisiti siano installati / attivati. Potrebbe essere necessario aggiornare la pagina dopo il completamento."},"language:nl":{"ba-videoplayer-playbutton.tooltip":"Klik om video af te spelen.","ba-videoplayer-playbutton.rerecord":"opnieuw","ba-videoplayer-playbutton.submit-video":"Bevestig video","ba-videoplayer-loader.tooltip":"Loading video ...","ba-videoplayer-controlbar.change-resolution":"resolutie Change","ba-videoplayer-controlbar.video-progress":"video vooruitgang","ba-videoplayer-controlbar.rerecord-video":"Opnieuw video?","ba-videoplayer-controlbar.submit-video":"Bevestig video","ba-videoplayer-controlbar.play-video":"Video afspelen","ba-videoplayer-controlbar.pause-video":"pauze video","ba-videoplayer-controlbar.elapsed-time":"Verstreken tijd","ba-videoplayer-controlbar.total-time":"De totale lengte van de video","ba-videoplayer-controlbar.fullscreen-video":"Voer fullscreen","ba-videoplayer-controlbar.volume-button":"Volume instellen","ba-videoplayer-controlbar.volume-mute":"geluid uitschakelen","ba-videoplayer-controlbar.volume-unmute":"geluid vrijgeven","ba-videoplayer.video-error":"Er is een fout opgetreden, probeer het later opnieuw. Klik hier om opnieuw te proberen.","ba-videorecorder-chooser.record-video":"Neem uw video","ba-videorecorder-chooser.upload-video":"Upload Video","ba-videorecorder-controlbar.settings":"instellingen","ba-videorecorder-controlbar.camerahealthy":"Verlichting is goed","ba-videorecorder-controlbar.cameraunhealthy":"Verlichting is niet optimaal","ba-videorecorder-controlbar.microphonehealthy":"Het geluid is goed","ba-videorecorder-controlbar.microphoneunhealthy":"Kan niet pikken elk geluid","ba-videorecorder-controlbar.record":"Record","ba-videorecorder-controlbar.record-tooltip":"Klik hier om te registreren.","ba-videorecorder-controlbar.rerecord":"opnieuw","ba-videorecorder-controlbar.rerecord-tooltip":"Klik hier om opnieuw te doen.","ba-videorecorder-controlbar.upload-covershot":"Uploaden","ba-videorecorder-controlbar.upload-covershot-tooltip":"Klik hier om te uploaden aangepaste hoes schot","ba-videorecorder-controlbar.stop":"Stop","ba-videorecorder-controlbar.stop-tooltip":"Klik hier om te stoppen.","ba-videorecorder-controlbar.skip":"Overspringen","ba-videorecorder-controlbar.skip-tooltip":"Klik hier om over te slaan.","ba-videorecorder.recorder-error":"Er is een fout opgetreden, probeer het later opnieuw. Klik hier om opnieuw te proberen.","ba-videorecorder.attach-error":"We konden geen toegang tot de camera-interface. Afhankelijk van het apparaat en de browser, moet u misschien Flash installeren of toegang tot de pagina via SSL.","ba-videorecorder.access-forbidden":"De toegang tot de camera was verboden. Klik hier om opnieuw te proberen.","ba-videorecorder.pick-covershot":"Kies een covershot.","ba-videorecorder.uploading":"uploaden","ba-videorecorder.uploading-failed":"Uploaden mislukt - klik hier om opnieuw te proberen.","ba-videorecorder.verifying":"Het verifi&#xEB;ren","ba-videorecorder.verifying-failed":"Verifying mislukt - klik hier om opnieuw te proberen.","ba-videorecorder.rerecord-confirm":"Wil je echt wilt uw video opnieuw te doen?","ba-videorecorder.video_file_too_large":"Uw video bestand is te groot (%s) - klik hier om opnieuw te proberen met een kleinere videobestand.","ba-videorecorder.unsupported_video_type":"Upload: %s - klik hier om opnieuw te proberen.","ba-videoplayer-controlbar.exit-fullscreen-video":"Verlaat volledig scherm","ba-videoplayer-share.share":"Deel Video","ba-videorecorder-chooser.record-screen":"Record scherm","ba-videoplayer-controlbar.pause-video-disabled":"Pauzeren niet ondersteund","ba-videorecorder-chooser.record-audio":"Geluid opnemen","ba-videorecorder-controlbar.stop-available-after":"Minimale opnametijd is %d seconden","ba-videorecorder-controlbar.cancel":"Annuleer","ba-videorecorder-controlbar.cancel-tooltip":"Klik hier om te annuleren.","ba-videorecorder.cancel-confirm":"Wil je je video-upload echt annuleren?","ba-videoplayer-adslot.elapsed-time":"Elasped tijd","ba-videoplayer-adslot.volume-button":"Volume instellen","ba-videoplayer-adslot.volume-mute":"Geluid dempen","ba-videoplayer-adslot.volume-unmute":"Geluid dempen","ba-videoplayer-adslot.ad-will-end-after":"Advertentie eindigt na %s","ba-videoplayer-adslot.can-skip-after":"Skip na %d","ba-videoplayer-adslot.skip-ad":"Advertentie overslaan","ba-videorecorder.software-required":"Klik hieronder om de volgende vereisten te installeren / activeren om door te gaan.","ba-videorecorder.software-waiting":"Wacht tot de vereisten zijn ge&#xEF;nstalleerd / geactiveerd. Mogelijk moet u de pagina na voltooiing vernieuwen."},"language:no":{"ba-videoplayer-playbutton.tooltip":"Klikk for &#xE5; spille video.","ba-videoplayer-playbutton.rerecord":"Gj&#xF8;re om","ba-videoplayer-playbutton.submit-video":"bekreft video","ba-videoplayer-loader.tooltip":"Laster video ...","ba-videoplayer-controlbar.change-resolution":"Endre oppl&#xF8;sning","ba-videoplayer-controlbar.video-progress":"video fremgang","ba-videoplayer-controlbar.rerecord-video":"Gj&#xF8;r om videoen?","ba-videoplayer-controlbar.submit-video":"bekreft video","ba-videoplayer-controlbar.play-video":"spill video","ba-videoplayer-controlbar.pause-video":"pause video","ba-videoplayer-controlbar.elapsed-time":"Elasped tid","ba-videoplayer-controlbar.total-time":"Total lengde p&#xE5; video","ba-videoplayer-controlbar.fullscreen-video":"Skriv fullskjerm","ba-videoplayer-controlbar.volume-button":"Still inn volum","ba-videoplayer-controlbar.volume-mute":"lyd","ba-videoplayer-controlbar.volume-unmute":"lyd","ba-videoplayer.video-error":"En feil oppstod. Vennligst pr&#xF8;v igjen senere. Klikk for &#xE5; pr&#xF8;ve p&#xE5; nytt.","ba-videorecorder-chooser.record-video":"Spill av video","ba-videorecorder-chooser.upload-video":"Last opp video","ba-videorecorder-controlbar.settings":"innstillinger","ba-videorecorder-controlbar.camerahealthy":"Belysning er god","ba-videorecorder-controlbar.cameraunhealthy":"Belysning er ikke optimal","ba-videorecorder-controlbar.microphonehealthy":"Lyden er god","ba-videorecorder-controlbar.microphoneunhealthy":"Kan ikke plukke opp noen lyd","ba-videorecorder-controlbar.record":"Ta opp","ba-videorecorder-controlbar.record-tooltip":"Klikk her for &#xE5; spille inn.","ba-videorecorder-controlbar.rerecord":"Gj&#xF8;re om","ba-videorecorder-controlbar.rerecord-tooltip":"Klikk her for &#xE5; gj&#xF8;re om.","ba-videorecorder-controlbar.upload-covershot":"Laste opp","ba-videorecorder-controlbar.upload-covershot-tooltip":"Klikk her for &#xE5; laste opp egendefinerte dekke skudd","ba-videorecorder-controlbar.stop":"Stoppe","ba-videorecorder-controlbar.stop-tooltip":"Klikk her for &#xE5; stoppe.","ba-videorecorder-controlbar.skip":"Hopp","ba-videorecorder-controlbar.skip-tooltip":"Klikk her for &#xE5; hoppe.","ba-videorecorder.recorder-error":"En feil oppstod. Vennligst pr&#xF8;v igjen senere. Klikk for &#xE5; pr&#xF8;ve p&#xE5; nytt.","ba-videorecorder.attach-error":"Vi kunne ikke f&#xE5; tilgang til kameraet grensesnitt. Avhengig av enheten og nettleser, kan det hende du m&#xE5; installere Flash eller tilgang til siden via SSL.","ba-videorecorder.access-forbidden":"Tilgang til kameraet ble forbudt. Klikk for &#xE5; pr&#xF8;ve p&#xE5; nytt.","ba-videorecorder.pick-covershot":"Plukk en covershot.","ba-videorecorder.uploading":"Laster opp","ba-videorecorder.uploading-failed":"Opplasting mislyktes - klikk her for &#xE5; pr&#xF8;ve p&#xE5; nytt.","ba-videorecorder.verifying":"Bekrefter","ba-videorecorder.verifying-failed":"Bekrefter mislyktes - klikk her for &#xE5; pr&#xF8;ve p&#xE5; nytt.","ba-videorecorder.rerecord-confirm":"Har du virkelig &#xF8;nsker &#xE5; gj&#xF8;re om videoen?","ba-videorecorder.video_file_too_large":"Videofilen er for stor (%s) - klikk her for &#xE5; pr&#xF8;ve p&#xE5; nytt med en mindre videofil.","ba-videorecorder.unsupported_video_type":"Last opp: %s - klikk her for &#xE5; pr&#xF8;ve p&#xE5; nytt.","ba-videoplayer-controlbar.exit-fullscreen-video":"Avslutt fullskjerm","ba-videoplayer-share.share":"Del video","ba-videorecorder-chooser.record-screen":"Opptaksskjerm","ba-videoplayer-controlbar.pause-video-disabled":"Pause ikke st&#xF8;ttet","ba-videorecorder-chooser.record-audio":"Ta opp lyd","ba-videorecorder-controlbar.stop-available-after":"Minimum opptakstid er %d sekunder","ba-videorecorder-controlbar.cancel":"Avbryt","ba-videorecorder-controlbar.cancel-tooltip":"Klikk her for &#xE5; avbryte.","ba-videorecorder.cancel-confirm":"Vil du virkelig slette videoopplasting?","ba-videoplayer-adslot.elapsed-time":"Elasped tid","ba-videoplayer-adslot.volume-button":"Angi volum","ba-videoplayer-adslot.volume-mute":"Dempe lyd","ba-videoplayer-adslot.volume-unmute":"Sl&#xE5; av lyden","ba-videoplayer-adslot.ad-will-end-after":"Annonsen slutter etter %s","ba-videoplayer-adslot.can-skip-after":"Hopp over etter %d","ba-videoplayer-adslot.skip-ad":"Hopp over annonse","ba-videorecorder.software-required":"Vennligst klikk nedenfor for &#xE5; installere / aktivere f&#xF8;lgende krav for &#xE5; fortsette.","ba-videorecorder.software-waiting":"Venter p&#xE5; kravene som skal installeres / aktiveres. Du m&#xE5; kanskje oppdatere siden etter ferdigstillelse."},"language:pl":{"ba-videoplayer-playbutton.tooltip":"Kliknij, aby odtworzy&#x107; film.","ba-videoplayer-playbutton.rerecord":"Przerobi&#x107;","ba-videoplayer-playbutton.submit-video":"Potwierd&#x17A; wideo","ba-videoplayer-loader.tooltip":"&#x141;adowanie wideo ...","ba-videoplayer-controlbar.change-resolution":"zmiana rozdzielczo&#x15B;ci","ba-videoplayer-controlbar.video-progress":"post&#x119;p wideo","ba-videoplayer-controlbar.rerecord-video":"Redo wideo?","ba-videoplayer-controlbar.submit-video":"Potwierd&#x17A; wideo","ba-videoplayer-controlbar.play-video":"play video","ba-videoplayer-controlbar.pause-video":"Pauza wideo","ba-videoplayer-controlbar.elapsed-time":"czas, jaki up&#x142;yn&#x105;&#x142;","ba-videoplayer-controlbar.total-time":"Ca&#x142;kowita d&#x142;ugo&#x15B;&#x107; wideo","ba-videoplayer-controlbar.fullscreen-video":"Otworzy&#x107; w trybie pe&#x142;noekranowym","ba-videoplayer-controlbar.volume-button":"Ustaw g&#x142;o&#x15B;no&#x15B;&#x107;","ba-videoplayer-controlbar.volume-mute":"Wycisz d&#x17A;wi&#x119;k","ba-videoplayer-controlbar.volume-unmute":"W&#x142;&#x105;cz d&#x17A;wi&#x119;k","ba-videoplayer.video-error":"Wyst&#x105;pi&#x142; b&#x142;&#x105;d. Prosz&#x119; spr&#xF3;bowa&#x107; p&#xF3;&#x17A;niej. Kliknij, aby ponowi&#x107; pr&#xF3;b&#x119;.","ba-videorecorder-chooser.record-video":"Nagraj wideo","ba-videorecorder-chooser.upload-video":"Prze&#x15B;lij wideo","ba-videorecorder-controlbar.settings":"Ustawienia","ba-videorecorder-controlbar.camerahealthy":"O&#x15B;wietlenie jest dobre","ba-videorecorder-controlbar.cameraunhealthy":"O&#x15B;wietlenie nie jest optymalna","ba-videorecorder-controlbar.microphonehealthy":"D&#x17A;wi&#x119;k jest dobry","ba-videorecorder-controlbar.microphoneunhealthy":"Nie mog&#x119; odebra&#x107; &#x17C;adnego d&#x17A;wi&#x119;ku","ba-videorecorder-controlbar.record":"Rekord","ba-videorecorder-controlbar.record-tooltip":"Kliknij tutaj, aby nagra&#x107;.","ba-videorecorder-controlbar.rerecord":"Przerobi&#x107;","ba-videorecorder-controlbar.rerecord-tooltip":"Kliknij tutaj, aby ponowi&#x107;.","ba-videorecorder-controlbar.upload-covershot":"Przekaza&#x107; plik","ba-videorecorder-controlbar.upload-covershot-tooltip":"Kliknij tu aby przes&#x142;a&#x107; niestandardowy ok&#x142;adk&#x119; strza&#x142;","ba-videorecorder-controlbar.stop":"Zatrzymaj si&#x119;","ba-videorecorder-controlbar.stop-tooltip":"Kliknij tutaj, aby zatrzyma&#x107;.","ba-videorecorder-controlbar.skip":"Pomin&#x105;&#x107;","ba-videorecorder-controlbar.skip-tooltip":"Kliknij tutaj, aby przej&#x15B;&#x107;.","ba-videorecorder.recorder-error":"Wyst&#x105;pi&#x142; b&#x142;&#x105;d. Prosz&#x119; spr&#xF3;bowa&#x107; p&#xF3;&#x17A;niej. Kliknij, aby ponowi&#x107; pr&#xF3;b&#x119;.","ba-videorecorder.attach-error":"Nie mogli&#x15B;my uzyska&#x107; dost&#x119;p do interfejsu aparatu. W zale&#x17C;no&#x15B;ci od urz&#x105;dzenia i przegl&#x105;darki, mo&#x17C;e by&#x107; konieczne zainstalowanie Flash lub wej&#x15B;&#x107; na stron&#x119; za po&#x15B;rednictwem protoko&#x142;u SSL.","ba-videorecorder.access-forbidden":"Dost&#x119;p do kamery by&#x142;o zabronione. Kliknij, aby ponowi&#x107; pr&#xF3;b&#x119;.","ba-videorecorder.pick-covershot":"Wybierz covershot.","ba-videorecorder.uploading":"Przesy&#x142;anie","ba-videorecorder.uploading-failed":"Przesy&#x142;anie nie powiod&#x142;o si&#x119; - kliknij tutaj, aby ponowi&#x107; pr&#xF3;b&#x119;.","ba-videorecorder.verifying":"Weryfikacja","ba-videorecorder.verifying-failed":"Sprawdzanie poprawno&#x15B;ci nie powiod&#x142;o si&#x119; - kliknij tutaj, aby ponowi&#x107; pr&#xF3;b&#x119;.","ba-videorecorder.rerecord-confirm":"Czy na pewno chcesz przerobi&#x107; sw&#xF3;j film?","ba-videorecorder.video_file_too_large":"Plik wideo jest zbyt du&#x17C;a (%s) - kliknij tutaj, aby spr&#xF3;bowa&#x107; ponownie z mniejszym pliku wideo.","ba-videorecorder.unsupported_video_type":"Prosz&#x119; przes&#x142;a&#x107;: %s - kliknij tutaj, aby ponowi&#x107; pr&#xF3;b&#x119;.","ba-videoplayer-controlbar.exit-fullscreen-video":"Zamknij pe&#x142;ny ekran","ba-videoplayer-share.share":"Udost&#x119;pnij film","ba-videorecorder-chooser.record-screen":"Ekran nagrywania","ba-videoplayer-controlbar.pause-video-disabled":"Wstrzymanie nie jest obs&#x142;ugiwane","ba-videorecorder-chooser.record-audio":"Nagra&#x107; d&#x17A;wi&#x119;k","ba-videorecorder-controlbar.stop-available-after":"Minimalny czas nagrywania to %d sekund","ba-videorecorder-controlbar.cancel":"Anuluj","ba-videorecorder-controlbar.cancel-tooltip":"Kliknij tutaj, aby anulowa&#x107;.","ba-videorecorder.cancel-confirm":"Czy na pewno chcesz anulowa&#x107; przesy&#x142;anie wideo?","ba-videoplayer-adslot.elapsed-time":"Wyd&#x142;u&#x17C;ony czas","ba-videoplayer-adslot.volume-button":"Ustaw g&#x142;o&#x15B;no&#x15B;&#x107;","ba-videoplayer-adslot.volume-mute":"Wycisz d&#x17A;wi&#x119;k","ba-videoplayer-adslot.volume-unmute":"W&#x142;&#x105;cz d&#x17A;wi&#x119;k","ba-videoplayer-adslot.ad-will-end-after":"Reklama zako&#x144;czy si&#x119; po %s","ba-videoplayer-adslot.can-skip-after":"Pomi&#x144; po %d","ba-videoplayer-adslot.skip-ad":"Pomi&#x144; reklam&#x119;","ba-videorecorder.software-required":"Kliknij poni&#x17C;ej, aby zainstalowa&#x107; / aktywowa&#x107; nast&#x119;puj&#x105;ce wymagania, aby kontynuowa&#x107;.","ba-videorecorder.software-waiting":"Oczekiwanie na zainstalowanie / aktywacj&#x119; wymaga&#x144;. Po zako&#x144;czeniu mo&#x17C;e by&#x107; konieczne od&#x15B;wie&#x17C;enie strony."},"language:pt-br":{"ba-videoplayer-playbutton.tooltip":"Clique para reproduzir v&#xED;deo.","ba-videoplayer-playbutton.rerecord":"Refazer","ba-videoplayer-playbutton.submit-video":"confirmar v&#xED;deo","ba-videoplayer-loader.tooltip":"Carregando v&#xED;deo ...","ba-videoplayer-controlbar.change-resolution":"altera&#xE7;&#xE3;o de resolu&#xE7;&#xE3;o","ba-videoplayer-controlbar.video-progress":"o progresso de v&#xED;deo","ba-videoplayer-controlbar.rerecord-video":"Refazer v&#xED;deo?","ba-videoplayer-controlbar.submit-video":"confirmar v&#xED;deo","ba-videoplayer-controlbar.play-video":"reprodu&#xE7;&#xE3;o de v&#xED;deo","ba-videoplayer-controlbar.pause-video":"v&#xED;deo pausa","ba-videoplayer-controlbar.elapsed-time":"tempo elasped","ba-videoplayer-controlbar.total-time":"comprimento total de v&#xED;deo","ba-videoplayer-controlbar.fullscreen-video":"Entrar em tela cheia","ba-videoplayer-controlbar.volume-button":"volume definido","ba-videoplayer-controlbar.volume-mute":"som Mute","ba-videoplayer-controlbar.volume-unmute":"ativar o som","ba-videoplayer.video-error":"Ocorreu um erro. Por favor tente novamente mais tarde. Clique para tentar novamente.","ba-videorecorder-chooser.record-video":"Grave o seu v&#xED;deo","ba-videorecorder-chooser.upload-video":"Upload video","ba-videorecorder-controlbar.settings":"Configura&#xE7;&#xF5;es","ba-videorecorder-controlbar.camerahealthy":"A ilumina&#xE7;&#xE3;o &#xE9; boa","ba-videorecorder-controlbar.cameraunhealthy":"Ilumina&#xE7;&#xE3;o n&#xE3;o &#xE9; o ideal","ba-videorecorder-controlbar.microphonehealthy":"O som &#xE9; bom","ba-videorecorder-controlbar.microphoneunhealthy":"n&#xE3;o pode pegar qualquer som","ba-videorecorder-controlbar.record":"Registro","ba-videorecorder-controlbar.record-tooltip":"Clique aqui para registrar.","ba-videorecorder-controlbar.rerecord":"Refazer","ba-videorecorder-controlbar.rerecord-tooltip":"Clique aqui para refazer.","ba-videorecorder-controlbar.upload-covershot":"Envio","ba-videorecorder-controlbar.upload-covershot-tooltip":"Clique aqui para enviar capa personalizada tiro","ba-videorecorder-controlbar.stop":"Pare","ba-videorecorder-controlbar.stop-tooltip":"Clique aqui para parar.","ba-videorecorder-controlbar.skip":"Pular","ba-videorecorder-controlbar.skip-tooltip":"Clique aqui para pular.","ba-videorecorder.recorder-error":"Ocorreu um erro. Por favor tente novamente mais tarde. Clique para tentar novamente.","ba-videorecorder.attach-error":"N&#xF3;s n&#xE3;o poderia acessar a interface da c&#xE2;mera. Dependendo do dispositivo e navegador, pode ser necess&#xE1;rio instalar o Flash ou acessar a p&#xE1;gina atrav&#xE9;s de SSL.","ba-videorecorder.access-forbidden":"foi proibido o acesso &#xE0; c&#xE2;mera. Clique para tentar novamente.","ba-videorecorder.pick-covershot":"Escolha um covershot.","ba-videorecorder.uploading":"upload","ba-videorecorder.uploading-failed":"Upload falhou - clique aqui para tentar novamente.","ba-videorecorder.verifying":"Verificando","ba-videorecorder.verifying-failed":"Verificando falhou - clique aqui para tentar novamente.","ba-videorecorder.rerecord-confirm":"Voc&#xEA; realmente quer refazer seu v&#xED;deo?","ba-videorecorder.video_file_too_large":"O arquivo de v&#xED;deo &#xE9; muito grande (%s) - clique aqui para tentar novamente com um arquivo de v&#xED;deo menor.","ba-videorecorder.unsupported_video_type":"Fa&#xE7;a o upload: %s - clique aqui para tentar novamente.","ba-videoplayer-controlbar.exit-fullscreen-video":"Sair do ecr&#xE3; inteiro","ba-videoplayer-share.share":"Compartilhar video","ba-videorecorder-chooser.record-screen":"Tela de registro","ba-videoplayer-controlbar.pause-video-disabled":"Pausa n&#xE3;o suportada","ba-videorecorder-chooser.record-audio":"Gravar audio","ba-videorecorder-controlbar.stop-available-after":"O tempo m&#xED;nimo de grava&#xE7;&#xE3;o &#xE9; %d segundos","ba-videorecorder-controlbar.cancel":"Cancelar","ba-videorecorder-controlbar.cancel-tooltip":"Clique aqui para cancelar.","ba-videorecorder.cancel-confirm":"Voc&#xEA; deseja realmente cancelar o upload de seu v&#xED;deo?","ba-videoplayer-adslot.elapsed-time":"Tempo Elasped","ba-videoplayer-adslot.volume-button":"Definir volume","ba-videoplayer-adslot.volume-mute":"Som mudo","ba-videoplayer-adslot.volume-unmute":"Somar som","ba-videoplayer-adslot.ad-will-end-after":"O an&#xFA;ncio terminar&#xE1; ap&#xF3;s %s","ba-videoplayer-adslot.can-skip-after":"Ignorar ap&#xF3;s %d","ba-videoplayer-adslot.skip-ad":"Pular An&#xFA;ncio","ba-videorecorder.software-required":"Clique abaixo para instalar / ativar os seguintes requisitos para prosseguir.","ba-videorecorder.software-waiting":"Esperando que os requisitos sejam instalados / ativados. Talvez seja necess&#xE1;rio atualizar a p&#xE1;gina ap&#xF3;s a conclus&#xE3;o."},"language:pt":{"ba-videoplayer-playbutton.tooltip":"Clique para ver","ba-videoplayer-playbutton.rerecord":"Repetir","ba-videoplayer-playbutton.submit-video":"Enviar v&#xED;deo","ba-videoplayer-loader.tooltip":"A Carregar...","ba-videoplayer-controlbar.change-resolution":"Alterar resolu&#xE7;&#xE3;o","ba-videoplayer-controlbar.video-progress":"Progress&#xE3;o","ba-videoplayer-controlbar.rerecord-video":"Repetir?","ba-videoplayer-controlbar.submit-video":"Confirmar","ba-videoplayer-controlbar.play-video":"Ver V&#xED;deo","ba-videoplayer-controlbar.pause-video":"Pausa","ba-videoplayer-controlbar.elapsed-time":"Tempo decorrido","ba-videoplayer-controlbar.total-time":"Tempo Total","ba-videoplayer-controlbar.fullscreen-video":"Modo ecr&#xE3; inteiro","ba-videoplayer-controlbar.volume-button":"Definir volume","ba-videoplayer-controlbar.volume-mute":"Som silencioso","ba-videoplayer-controlbar.volume-unmute":"Aumentar Som","ba-videoplayer.video-error":"Ocorreu um erro. Por favor tente de novo mais tarde. Clique para tentar novamente.","ba-videorecorder-chooser.record-video":"Gravar V&#xED;deo","ba-videorecorder-chooser.upload-video":"Enviar V&#xED;deo","ba-videorecorder-controlbar.settings":"Configura&#xE7;&#xF5;es","ba-videorecorder-controlbar.camerahealthy":"A ilumina&#xE7;&#xE3;o &#xE9; boa","ba-videorecorder-controlbar.cameraunhealthy":"A ilumina&#xE7;&#xE3;o n&#xE3;o &#xE9; a ideal","ba-videorecorder-controlbar.microphonehealthy":"O som est&#xE1; bom","ba-videorecorder-controlbar.microphoneunhealthy":"N&#xE3;o foi poss&#xED;vel ouvir nenhum som","ba-videorecorder-controlbar.record":"Gravar","ba-videorecorder-controlbar.record-tooltip":"Clique aqui para gravar","ba-videorecorder-controlbar.rerecord":"Repetir","ba-videorecorder-controlbar.rerecord-tooltip":"Clique aqui para repetir","ba-videorecorder-controlbar.upload-covershot":"Enviar","ba-videorecorder-controlbar.upload-covershot-tooltip":"Clique aqui para enviar a captura de capa personalizada","ba-videorecorder-controlbar.stop":"Parar","ba-videorecorder-controlbar.stop-tooltip":"Clique aqui para parar","ba-videorecorder-controlbar.skip":"Ignorar","ba-videorecorder-controlbar.skip-tooltip":"Clique aqui para ignorar","ba-videorecorder.recorder-error":"Ocorreu um erro. Por favor tente novamente mais tarde. Clique para tentar novamente.","ba-videorecorder.attach-error":"N&#xE3;o conseguimos aceder &#xE0; c&#xE2;mara. Dependendo do dispositivo e do navegador, pode ser necess&#xE1;rio instalar o Flash ou aceder &#xE0; p&#xE1;gina via SSL.","ba-videorecorder.access-forbidden":"O acesso &#xE0; c&#xE2;mara foi pro&#xED;bido. Clique para tentar novamente.","ba-videorecorder.pick-covershot":"Escolha uma capa personalizada","ba-videorecorder.uploading":"A enviar","ba-videorecorder.uploading-failed":"O envio falhou - clique para tentar de novo","ba-videorecorder.verifying":"A verificar","ba-videorecorder.verifying-failed":"A verifica&#xE7;&#xE3;o falhou - clique para tentar de novo","ba-videorecorder.rerecord-confirm":"Quer mesmo repetir o seu v&#xED;deo?","ba-videorecorder.video_file_too_large":"O seu v&#xED;deo &#xE9; demasiado grande (%s) - clique para tentar de novo com um v&#xED;deo mais pequeno.","ba-videorecorder.unsupported_video_type":"Please upload: %s - clique para tentar de novo.","ba-videoplayer-controlbar.exit-fullscreen-video":"Sair do modo ecr&#xE3; inteiro","ba-videoplayer-share.share":"Partilhar a grava&#xE7;&#xE3;o","ba-videoplayer-controlbar.pause-video-disabled":"A pausa n&#xE3;o &#xE9; suportada","ba-videorecorder-chooser.record-audio":"Gravar Audio","ba-videorecorder-chooser.record-screen":"Tela de registro","ba-videorecorder-controlbar.stop-available-after":"O tempo m&#xED;nimo de grava&#xE7;&#xE3;o &#xE9; %d segundos","ba-videorecorder-controlbar.cancel":"Cancelar","ba-videorecorder-controlbar.cancel-tooltip":"Clique aqui para cancelar.","ba-videorecorder.cancel-confirm":"Voc&#xEA; deseja realmente cancelar o upload de seu v&#xED;deo?","ba-videoplayer-adslot.elapsed-time":"Tempo Elasped","ba-videoplayer-adslot.volume-button":"Definir volume","ba-videoplayer-adslot.volume-mute":"Som mudo","ba-videoplayer-adslot.volume-unmute":"Somar som","ba-videoplayer-adslot.ad-will-end-after":"O an&#xFA;ncio terminar&#xE1; ap&#xF3;s %s","ba-videoplayer-adslot.can-skip-after":"Ignorar ap&#xF3;s %d","ba-videoplayer-adslot.skip-ad":"Pular An&#xFA;ncio","ba-videorecorder.software-required":"Clique abaixo para instalar / ativar os seguintes requisitos para prosseguir.","ba-videorecorder.software-waiting":"Esperando que os requisitos sejam instalados / ativados. Talvez seja necess&#xE1;rio atualizar a p&#xE1;gina ap&#xF3;s a conclus&#xE3;o."},"language:ro":{"ba-videoplayer-playbutton.tooltip":"Click aici pentru a reda video.","ba-videoplayer-playbutton.rerecord":"Reface","ba-videoplayer-playbutton.submit-video":"confirm&#x103; film","ba-videoplayer-loader.tooltip":"Se &#xEE;ncarc&#x103; videoclipul ...","ba-videoplayer-controlbar.change-resolution":"Schimba&#x21B;i rezolu&#x21B;ia","ba-videoplayer-controlbar.video-progress":"progresul video","ba-videoplayer-controlbar.rerecord-video":"Reface&#x21B;i video?","ba-videoplayer-controlbar.submit-video":"confirm&#x103; film","ba-videoplayer-controlbar.play-video":"Ruleaz&#x103; video","ba-videoplayer-controlbar.pause-video":"video de pauz&#x103;","ba-videoplayer-controlbar.elapsed-time":"timp scurs","ba-videoplayer-controlbar.total-time":"Lungimea total&#x103; a videoclipului","ba-videoplayer-controlbar.fullscreen-video":"intra pe tot ecranul","ba-videoplayer-controlbar.volume-button":"set de volum","ba-videoplayer-controlbar.volume-mute":"sunet mut","ba-videoplayer-controlbar.volume-unmute":"repornirea sunetului","ba-videoplayer.video-error":"A ap&#x103;rut o eroare, v&#x103; rug&#x103;m s&#x103; &#xEE;ncerca&#x21B;i din nou mai t&#xE2;rziu. Click aici pentru a &#xEE;ncerca din nou.","ba-videorecorder-chooser.record-video":"&#xCE;nregistrarea imaginilor video dvs.","ba-videorecorder-chooser.upload-video":"&#xCE;ncarc&#x103; film","ba-videorecorder-controlbar.settings":"set&#x103;rile","ba-videorecorder-controlbar.camerahealthy":"De iluminat este bun","ba-videorecorder-controlbar.cameraunhealthy":"De iluminat nu este optim","ba-videorecorder-controlbar.microphonehealthy":"Sunetul este bun","ba-videorecorder-controlbar.microphoneunhealthy":"Nu se poate ridica nici un sunet","ba-videorecorder-controlbar.record":"Record","ba-videorecorder-controlbar.record-tooltip":"Apasa aici pentru a &#xEE;nregistra.","ba-videorecorder-controlbar.rerecord":"Reface","ba-videorecorder-controlbar.rerecord-tooltip":"Apasa aici pentru a reface.","ba-videorecorder-controlbar.upload-covershot":"&#xCE;nc&#x103;rca&#x21B;i","ba-videorecorder-controlbar.upload-covershot-tooltip":"Apasa aici pentru a &#xEE;nc&#x103;rca capac personalizat lovitur&#x103;","ba-videorecorder-controlbar.stop":"Stop","ba-videorecorder-controlbar.stop-tooltip":"Apasa aici pentru a opri.","ba-videorecorder-controlbar.skip":"s&#x103;ri","ba-videorecorder-controlbar.skip-tooltip":"Apasa aici pentru a s&#x103;ri peste.","ba-videorecorder.recorder-error":"A ap&#x103;rut o eroare, v&#x103; rug&#x103;m s&#x103; &#xEE;ncerca&#x21B;i din nou mai t&#xE2;rziu. Click aici pentru a &#xEE;ncerca din nou.","ba-videorecorder.attach-error":"Nu am putut accesa interfa&#x21B;a camerei. &#xCE;n func&#x21B;ie de dispozitiv &#x219;i browser-ul, poate fi necesar s&#x103; instala&#x21B;i Flash sau accesa pagina prin SSL.","ba-videorecorder.access-forbidden":"Accesul la camera a fost interzis&#x103;. Click aici pentru a &#xEE;ncerca din nou.","ba-videorecorder.pick-covershot":"Alege un covershot.","ba-videorecorder.uploading":"Se &#xEE;ncarc&#x103;","ba-videorecorder.uploading-failed":"Se &#xEE;ncarc&#x103; nu a reu&#x219;it - clic aici pentru a &#xEE;ncerca din nou.","ba-videorecorder.verifying":"Se verific&#x103;","ba-videorecorder.verifying-failed":"Care verific&#x103; dac&#x103; nu a reu&#x219;it - clic aici pentru a &#xEE;ncerca din nou.","ba-videorecorder.rerecord-confirm":"Chiar vrei s&#x103; reface&#x21B;i videoclipul?","ba-videorecorder.video_file_too_large":"Fi&#x219;ierul dvs. video este prea mare (%s) - click aici pentru a &#xEE;ncerca din nou cu un fi&#x219;ier video mai mic.","ba-videorecorder.unsupported_video_type":"V&#x103; rug&#x103;m s&#x103; &#xEE;nc&#x103;rca&#x21B;i: %s - clic aici pentru a &#xEE;ncerca din nou.","ba-videoplayer-controlbar.exit-fullscreen-video":"Ie&#x219;i&#x21B;i din ecranul complet","ba-videoplayer-share.share":"Distribui&#x21B;i videoclipul","ba-videorecorder-chooser.record-screen":"Ecranul de &#xEE;nregistrare","ba-videoplayer-controlbar.pause-video-disabled":"&#xCE;ntreruperea nu este acceptat&#x103;","ba-videorecorder-chooser.record-audio":"&#xCE;nregistreaz&#x103; audio","ba-videorecorder-controlbar.stop-available-after":"Durata minim&#x103; de &#xEE;nregistrare este %d secunde","ba-videorecorder-controlbar.cancel":"Anulare","ba-videorecorder-controlbar.cancel-tooltip":"Face&#x21B;i clic aici pentru a anula.","ba-videorecorder.cancel-confirm":"Chiar vrei s&#x103; anulezi &#xEE;nc&#x103;rcarea videoclipului?","ba-videoplayer-adslot.elapsed-time":"Elased timp","ba-videoplayer-adslot.volume-button":"Seta&#x21B;i volumul","ba-videoplayer-adslot.volume-mute":"Opri&#x21B;i sunetul","ba-videoplayer-adslot.volume-unmute":"Repeta&#x21B;i sunetul","ba-videoplayer-adslot.ad-will-end-after":"Anun&#x21B;ul se va &#xEE;ncheia dup&#x103; %s","ba-videoplayer-adslot.can-skip-after":"S&#x103;ri&#x21B;i dup&#x103; %d","ba-videoplayer-adslot.skip-ad":"&#x218;terge&#x21B;i anun&#x21B;ul","ba-videorecorder.software-required":"Face&#x21B;i clic mai jos pentru a instala / activa urm&#x103;toarele cerin&#x21B;e pentru a continua.","ba-videorecorder.software-waiting":"Se a&#x219;teapt&#x103; ca cerin&#x21B;ele s&#x103; fie instalate / activate. Poate fi necesar s&#x103; actualiza&#x21B;i pagina dup&#x103; finalizare."},"language:ru":{"ba-videoplayer-playbutton.tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x432;&#x43E;&#x441;&#x43F;&#x440;&#x43E;&#x438;&#x437;&#x432;&#x435;&#x441;&#x442;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;.","ba-videoplayer-playbutton.rerecord":"&#x41F;&#x435;&#x440;&#x435;&#x437;&#x430;&#x43F;&#x438;&#x441;&#x430;&#x442;&#x44C;","ba-videoplayer-loader.tooltip":"&#x417;&#x430;&#x433;&#x440;&#x443;&#x437;&#x43A;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E; ...","ba-videoplayer-controlbar.change-resolution":"&#x418;&#x437;&#x43C;&#x435;&#x43D;&#x438;&#x442;&#x44C; &#x440;&#x430;&#x437;&#x440;&#x435;&#x448;&#x435;&#x43D;&#x438;&#x435;","ba-videoplayer-controlbar.video-progress":"&#x425;&#x43E;&#x434; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.rerecord-video":"&#x41F;&#x435;&#x440;&#x435;&#x437;&#x430;&#x43F;&#x438;&#x441;&#x430;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;?","ba-videoplayer-controlbar.play-video":"&#x41F;&#x440;&#x43E;&#x438;&#x433;&#x440;&#x430;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.pause-video":"&#x41F;&#x440;&#x438;&#x43E;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.elapsed-time":"&#x41F;&#x440;&#x43E;&#x439;&#x434;&#x435;&#x43D;&#x43D;&#x43E;&#x435; &#x432;&#x440;&#x435;&#x43C;&#x44F;","ba-videoplayer-controlbar.total-time":"&#x41E;&#x431;&#x449;&#x430;&#x44F; &#x434;&#x43B;&#x438;&#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.fullscreen-video":"&#x41F;&#x43E;&#x43B;&#x43D;&#x43E;&#x44D;&#x43A;&#x440;&#x430;&#x43D;&#x43D;&#x44B;&#x439; &#x440;&#x435;&#x436;&#x438;&#x43C;","ba-videoplayer-controlbar.volume-button":"&#x413;&#x440;&#x43E;&#x43C;&#x43A;&#x43E;&#x441;&#x442;&#x44C;","ba-videoplayer-controlbar.volume-mute":"&#x41E;&#x442;&#x43A;&#x43B;&#x44E;&#x447;&#x438;&#x442;&#x44C; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer-controlbar.volume-unmute":"&#x412;&#x43A;&#x43B;&#x44E;&#x447;&#x438;&#x442;&#x44C; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer.video-error":"&#x41F;&#x440;&#x43E;&#x438;&#x437;&#x43E;&#x448;&#x43B;&#x430; &#x43E;&#x448;&#x438;&#x431;&#x43A;&#x430;. &#x41F;&#x43E;&#x436;&#x430;&#x43B;&#x443;&#x439;&#x441;&#x442;&#x430;, &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x435; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443; &#x43F;&#x43E;&#x437;&#x436;&#x435;. &#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;.","ba-videorecorder-chooser.record-video":"&#x417;&#x430;&#x43F;&#x438;&#x448;&#x438;&#x442;&#x435; &#x441;&#x432;&#x43E;&#x435; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-chooser.upload-video":"&#x417;&#x430;&#x433;&#x440;&#x443;&#x437;&#x438;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-controlbar.settings":"&#x41D;&#x430;&#x441;&#x442;&#x440;&#x43E;&#x439;&#x43A;&#x438;","ba-videorecorder-controlbar.camerahealthy":"&#x41E;&#x441;&#x432;&#x435;&#x449;&#x435;&#x43D;&#x438;&#x435; &#x445;&#x43E;&#x440;&#x43E;&#x448;&#x435;&#x435;","ba-videorecorder-controlbar.cameraunhealthy":"&#x421;&#x43B;&#x430;&#x431;&#x43E;&#x435; &#x43E;&#x441;&#x432;&#x435;&#x449;&#x435;&#x43D;&#x438;&#x435;","ba-videorecorder-controlbar.microphonehealthy":"&#x417;&#x432;&#x443;&#x43A; &#x445;&#x43E;&#x440;&#x43E;&#x448;&#x438;&#x439;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x41D;&#x435;&#x432;&#x43E;&#x437;&#x43C;&#x43E;&#x436;&#x43D;&#x43E; &#x43F;&#x43E;&#x43B;&#x443;&#x447;&#x438;&#x442;&#x44C; &#x437;&#x432;&#x443;&#x43A;","ba-videorecorder-controlbar.record":"&#x417;&#x430;&#x43F;&#x438;&#x441;&#x44C;","ba-videorecorder-controlbar.record-tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x437;&#x430;&#x43F;&#x438;&#x441;&#x430;&#x442;&#x44C;.","ba-videorecorder-controlbar.stop":"&#x421;&#x442;&#x43E;&#x43F;","ba-videorecorder-controlbar.stop-tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43E;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C;.","ba-videorecorder-controlbar.skip":"&#x41F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x442;&#x438;&#x442;&#x44C;","ba-videorecorder-controlbar.skip-tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x442;&#x438;&#x442;&#x44C;.","ba-videorecorder.recorder-error":"&#x41F;&#x440;&#x43E;&#x438;&#x437;&#x43E;&#x448;&#x43B;&#x430; &#x43E;&#x448;&#x438;&#x431;&#x43A;&#x430;. &#x41F;&#x43E;&#x436;&#x430;&#x43B;&#x443;&#x439;&#x441;&#x442;&#x430;, &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x435; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443; &#x43F;&#x43E;&#x437;&#x436;&#x435;. &#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;.","ba-videorecorder.access-forbidden":"&#x414;&#x43E;&#x441;&#x442;&#x443;&#x43F; &#x43A; &#x43A;&#x430;&#x43C;&#x435;&#x440;&#x435; &#x431;&#x44B;&#x43B; &#x437;&#x430;&#x43F;&#x440;&#x435;&#x449;&#x435;&#x43D;. &#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;.","ba-videorecorder.pick-covershot":"&#x412;&#x44B;&#x431;&#x435;&#x440;&#x438;&#x442;&#x435; &#x441;&#x43D;&#x438;&#x43C;&#x43E;&#x43A;.","ba-videorecorder.uploading":"&#x417;&#x430;&#x433;&#x440;&#x443;&#x437;&#x43A;&#x430;","ba-videorecorder.uploading-failed":"&#x41E;&#x448;&#x438;&#x431;&#x43A;&#x430; &#x437;&#x430;&#x433;&#x440;&#x443;&#x437;&#x43A;&#x438;: &#x43D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;.","ba-videorecorder.verifying":"&#x41F;&#x440;&#x43E;&#x432;&#x435;&#x440;&#x43A;&#x430;","ba-videorecorder.verifying-failed":"&#x41E;&#x448;&#x438;&#x431;&#x43A;&#x430; &#x43F;&#x43E;&#x434;&#x442;&#x432;&#x435;&#x440;&#x436;&#x434;&#x435;&#x43D;&#x438;&#x44F;. &#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;.","ba-videorecorder.rerecord-confirm":"&#x412;&#x44B; &#x434;&#x435;&#x439;&#x441;&#x442;&#x432;&#x438;&#x442;&#x435;&#x43B;&#x44C;&#x43D;&#x43E; &#x445;&#x43E;&#x442;&#x438;&#x442;&#x435; &#x43F;&#x435;&#x440;&#x435;&#x437;&#x430;&#x43F;&#x438;&#x441;&#x430;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;?","ba-videorecorder.video_file_too_large":"&#x421;&#x43B;&#x438;&#x448;&#x43A;&#x43E;&#x43C; &#x431;&#x43E;&#x43B;&#x44C;&#x448;&#x43E;&#x439; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x444;&#x430;&#x439;&#x43B;. &#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443; &#x441; &#x43C;&#x435;&#x43D;&#x44C;&#x448;&#x438;&#x43C; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x444;&#x430;&#x439;&#x43B;&#x43E;&#x43C;.","ba-videorecorder.unsupported_video_type":"&#x41F;&#x43E;&#x436;&#x430;&#x43B;&#x443;&#x439;&#x441;&#x442;&#x430; &#x437;&#x430;&#x433;&#x440;&#x443;&#x437;&#x438;&#x442;&#x435;: %s - &#x43D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;.","ba-videoplayer-playbutton.submit-video":"&#x41F;&#x43E;&#x434;&#x442;&#x432;&#x435;&#x440;&#x434;&#x438;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.submit-video":"&#x41F;&#x43E;&#x434;&#x442;&#x432;&#x435;&#x440;&#x434;&#x438;&#x442;&#x44C; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-controlbar.rerecord":"&#x41F;&#x435;&#x440;&#x435;&#x434;&#x435;&#x43B;&#x430;&#x442;&#x44C;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x435;&#x440;&#x435;&#x437;&#x430;&#x43F;&#x438;&#x441;&#x430;&#x442;&#x44C;","ba-videorecorder-controlbar.upload-covershot":"&#x417;&#x430;&#x433;&#x440;&#x443;&#x437;&#x438;&#x442;&#x44C;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x437;&#x430;&#x433;&#x440;&#x443;&#x437;&#x438;&#x442;&#x44C; &#x43B;&#x438;&#x447;&#x43D;&#x443;&#x44E; &#x43E;&#x431;&#x43B;&#x43E;&#x436;&#x43A;&#x443;","ba-videorecorder.attach-error":"&#x22;&#x41D;&#x435; &#x443;&#x434;&#x430;&#x43B;&#x43E;&#x441;&#x44C; &#x43F;&#x43E;&#x43B;&#x443;&#x447;&#x438;&#x442;&#x44C; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F; &#x43A; &#x43A;&#x430;&#x43C;&#x435;&#x440;&#x435;. &#x412; &#x437;&#x430;&#x432;&#x438;&#x441;&#x438;&#x43C;&#x43E;&#x441;&#x442;&#x438; &#x43E;&#x442; &#x443;&#x441;&#x442;&#x440;&#x43E;&#x439;&#x441;&#x442;&#x432;&#x430; &#x438;&#x43B;&#x438; &#x431;&#x440;&#x430;&#x443;&#x437;&#x435;&#x440;&#x430;, &#x432;&#x430;&#x43C; &#x43C;&#x43E;&#x436;&#x435;&#x442; &#x43F;&#x43E;&#x43D;&#x430;&#x434;&#x43E;&#x431;&#x438;&#x442;&#x44C;&#x441;&#x44F; &#x443;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C; Flash &#x438;&#x43B;&#x438; &#x43F;&#x43E;&#x43B;&#x443;&#x447;&#x438;&#x442;&#x44C; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F; &#x43A; &#x441;&#x430;&#x439;&#x442;&#x443; &#x447;&#x435;&#x440;&#x435;&#x437; SSL.&#x22;","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x412;&#x44B;&#x439;&#x442;&#x438; &#x438;&#x437; &#x440;&#x435;&#x436;&#x438;&#x43C;&#x430; &#x43F;&#x43E;&#x43B;&#x43D;&#x43E;&#x433;&#x43E; &#x43E;&#x43A;&#x43D;&#x430;","ba-videoplayer-share.share":"&#x41F;&#x43E;&#x434;&#x435;&#x43B;&#x438;&#x442;&#x44C;&#x441;&#x44F; &#x441; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-chooser.record-screen":"&#x42D;&#x43A;&#x440;&#x430;&#x43D; &#x437;&#x430;&#x43F;&#x438;&#x441;&#x438;","ba-videoplayer-controlbar.pause-video-disabled":"&#x41F;&#x430;&#x443;&#x437;&#x430; &#x43D;&#x435; &#x43F;&#x43E;&#x434;&#x434;&#x435;&#x440;&#x436;&#x438;&#x432;&#x430;&#x435;&#x442;&#x441;&#x44F;","ba-videorecorder-chooser.record-audio":"&#x417;&#x430;&#x43F;&#x438;&#x441;&#x44C; &#x430;&#x443;&#x434;&#x438;&#x43E;","ba-videorecorder-controlbar.stop-available-after":"&#x41C;&#x438;&#x43D;&#x438;&#x43C;&#x430;&#x43B;&#x44C;&#x43D;&#x43E;&#x435; &#x432;&#x440;&#x435;&#x43C;&#x44F; &#x437;&#x430;&#x43F;&#x438;&#x441;&#x438;: %d &#x441;&#x435;&#x43A;&#x443;&#x43D;&#x434;","ba-videorecorder-controlbar.cancel":"&#x41E;&#x442;&#x43C;&#x435;&#x43D;&#x430;","ba-videorecorder-controlbar.cancel-tooltip":"&#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x437;&#x434;&#x435;&#x441;&#x44C;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43E;&#x442;&#x43C;&#x435;&#x43D;&#x438;&#x442;&#x44C;.","ba-videorecorder.cancel-confirm":"&#x412;&#x44B; &#x434;&#x435;&#x439;&#x441;&#x442;&#x432;&#x438;&#x442;&#x435;&#x43B;&#x44C;&#x43D;&#x43E; &#x445;&#x43E;&#x442;&#x438;&#x442;&#x435; &#x43E;&#x442;&#x43C;&#x435;&#x43D;&#x438;&#x442;&#x44C; &#x437;&#x430;&#x433;&#x440;&#x443;&#x437;&#x43A;&#x443; &#x432;&#x438;&#x434;&#x435;&#x43E;?","ba-videoplayer-adslot.elapsed-time":"&#x423;&#x43A;&#x43E;&#x440;&#x43E;&#x447;&#x435;&#x43D;&#x43D;&#x43E;&#x435; &#x432;&#x440;&#x435;&#x43C;&#x44F;","ba-videoplayer-adslot.volume-button":"&#x423;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C; &#x433;&#x440;&#x43E;&#x43C;&#x43A;&#x43E;&#x441;&#x442;&#x44C;","ba-videoplayer-adslot.volume-mute":"&#x41E;&#x442;&#x43A;&#x43B;&#x44E;&#x447;&#x438;&#x442;&#x44C; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer-adslot.volume-unmute":"&#x412;&#x43A;&#x43B;&#x44E;&#x447;&#x438;&#x442;&#x44C; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer-adslot.ad-will-end-after":"&#x41E;&#x431;&#x44A;&#x44F;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x435; &#x431;&#x443;&#x434;&#x435;&#x442; &#x437;&#x430;&#x432;&#x435;&#x440;&#x448;&#x435;&#x43D;&#x43E; &#x43F;&#x43E;&#x441;&#x43B;&#x435; %s","ba-videoplayer-adslot.can-skip-after":"&#x41F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x442;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x441;&#x43B;&#x435; %d","ba-videoplayer-adslot.skip-ad":"&#x41F;&#x440;&#x43E;&#x43F;&#x443;&#x441;&#x442;&#x438;&#x442;&#x44C; &#x440;&#x435;&#x43A;&#x43B;&#x430;&#x43C;&#x443;","ba-videorecorder.software-required":"&#x41F;&#x43E;&#x436;&#x430;&#x43B;&#x443;&#x439;&#x441;&#x442;&#x430;, &#x43D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435; &#x43D;&#x438;&#x436;&#x435;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x443;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C; / &#x430;&#x43A;&#x442;&#x438;&#x432;&#x438;&#x440;&#x43E;&#x432;&#x430;&#x442;&#x44C; &#x441;&#x43B;&#x435;&#x434;&#x443;&#x44E;&#x449;&#x438;&#x435; &#x442;&#x440;&#x435;&#x431;&#x43E;&#x432;&#x430;&#x43D;&#x438;&#x44F;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x440;&#x43E;&#x434;&#x43E;&#x43B;&#x436;&#x438;&#x442;&#x44C;.","ba-videorecorder.software-waiting":"&#x41E;&#x436;&#x438;&#x434;&#x430;&#x43D;&#x438;&#x435; &#x442;&#x440;&#x435;&#x431;&#x43E;&#x432;&#x430;&#x43D;&#x438;&#x439; &#x43A; &#x443;&#x441;&#x442;&#x430;&#x43D;&#x43E;&#x432;&#x43A;&#x435; / &#x430;&#x43A;&#x442;&#x438;&#x432;&#x430;&#x446;&#x438;&#x438;. &#x412;&#x43E;&#x437;&#x43C;&#x43E;&#x436;&#x43D;&#x43E;, &#x432;&#x430;&#x43C; &#x43F;&#x440;&#x438;&#x434;&#x435;&#x442;&#x441;&#x44F; &#x43E;&#x431;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C; &#x441;&#x442;&#x440;&#x430;&#x43D;&#x438;&#x446;&#x443; &#x43F;&#x43E;&#x441;&#x43B;&#x435; &#x437;&#x430;&#x432;&#x435;&#x440;&#x448;&#x435;&#x43D;&#x438;&#x44F;."},"language:sk":{"ba-videoplayer-playbutton.tooltip":"Pre prehratie videa kliknite.","ba-videoplayer-playbutton.rerecord":"Znovu nahra&#x165;","ba-videoplayer-playbutton.submit-video":"Potvr&#x10F;te video","ba-videoplayer-loader.tooltip":"Nahr&#xE1;vanie...","ba-videoplayer-controlbar.change-resolution":"Zme&#x148;te rozl&#xED;&#x161;enie","ba-videoplayer-controlbar.video-progress":"Progres","ba-videoplayer-controlbar.rerecord-video":"Nahra&#x165; znovu?","ba-videoplayer-controlbar.submit-video":"Potvrdi&#x165;","ba-videoplayer-controlbar.play-video":"Prehra&#x165;","ba-videoplayer-controlbar.pause-video":"Pozastavi&#x165;","ba-videoplayer-controlbar.elapsed-time":"Uplynut&#xFD; &#x10D;as","ba-videoplayer-controlbar.total-time":"Celkov&#xE1; d&#x13A;&#x17E;ka","ba-videoplayer-controlbar.fullscreen-video":"Zobrazi&#x165; na cel&#xFA; obrazovku","ba-videoplayer-controlbar.volume-button":"Nastavi&#x165; hlasitos&#x165;","ba-videoplayer-controlbar.volume-mute":"Vypn&#xFA;&#x165; zvuk","ba-videoplayer-controlbar.volume-unmute":"Zapn&#xFA;&#x165; zvuk","ba-videoplayer.video-error":"Vyskytla sa chyba. Sk&#xFA;ste to znova.","ba-videorecorder-chooser.record-video":"Nahra&#x165; nov&#xE9; video","ba-videorecorder-chooser.upload-video":"Prilo&#x17E;i&#x165; existuj&#xFA;ce video","ba-videorecorder-controlbar.settings":"Nastavenia","ba-videorecorder-controlbar.camerahealthy":"Osvetlenie vyzer&#xE1; dobre","ba-videorecorder-controlbar.cameraunhealthy":"Osvetlenie nie je optim&#xE1;lne","ba-videorecorder-controlbar.microphonehealthy":"Zvuk je v poriadku","ba-videorecorder-controlbar.microphoneunhealthy":"Nepodarilo sa zachyti&#x165; &#x17E;iaden zvuk","ba-videorecorder-controlbar.record":"Nahra&#x165;","ba-videorecorder-controlbar.record-tooltip":"Kliknite sem pre nahr&#xE1;vanie.","ba-videorecorder-controlbar.rerecord":"Znovu nahra&#x165;","ba-videorecorder-controlbar.rerecord-tooltip":"Kliknite sem pre zopakovanie nahr&#xE1;vania.","ba-videorecorder-controlbar.upload-covershot":"Prilo&#x17E;i&#x165;","ba-videorecorder-controlbar.upload-covershot-tooltip":"Kliknite sem pre nahratie vlastnej &#xFA;vodnej sn&#xED;mky","ba-videorecorder-controlbar.stop":"Zastavi&#x165;","ba-videorecorder-controlbar.stop-tooltip":"Kliknite sem pre zastavenie.","ba-videorecorder-controlbar.skip":"Presko&#x10D;i&#x165;","ba-videorecorder-controlbar.skip-tooltip":"Kliknite sem pre presko&#x10D;enie.","ba-videorecorder.recorder-error":"Vyskytla sa chyba. Kliknut&#xED;m sk&#xFA;ste znova.","ba-videorecorder.attach-error":"Nepodarilo sa n&#xE1;m z&#xED;ska&#x165; pr&#xED;stup k rozhraniu fotoapar&#xE1;tu. V z&#xE1;vislosti od zariadenia a prehliada&#x10D;a budete mo&#x17E;no musie&#x165; nain&#x161;talova&#x165; Flash alebo pristupova&#x165; na str&#xE1;nku cez protokol SSL.","ba-videorecorder.access-forbidden":"Pr&#xED;stup ku kamere bol zak&#xE1;zan&#xFD;. Kliknut&#xED;m sk&#xFA;ste znova.","ba-videorecorder.pick-covershot":"Vyberte si &#xFA;vodn&#xFA; sn&#xED;mku.","ba-videorecorder.uploading":"Nahr&#xE1;vanie","ba-videorecorder.uploading-failed":"Nahr&#xE1;vanie zlyhalo - kliknite sem pre zopakovanie.","ba-videorecorder.verifying":"Overovanie","ba-videorecorder.verifying-failed":"Overovanie zlyhalo - kliknite sem pre zopakovanie.","ba-videorecorder.rerecord-confirm":"Skuto&#x10D;ne chcete toto video prerobi&#x165;?","ba-videorecorder.video_file_too_large":"Va&#x161;e video je pr&#xED;li&#x161; dlh&#xE9; (%s) - kliknite sem pre zopakovanie s men&#x161;&#xED;m videos&#xFA;borom.","ba-videorecorder.unsupported_video_type":"Pros&#xED;m nahrajte: %s - kliknite sem pre zopakovanie.","ba-videoplayer-controlbar.exit-fullscreen-video":"Zru&#x161;i&#x165; zobrazenie na cel&#xFA; obrazovku","ba-videoplayer-share.share":"Zdie&#x13E;a&#x165;","ba-videoplayer-controlbar.pause-video-disabled":"Pozastavenie nie je mo&#x17E;n&#xE9;","ba-videorecorder-chooser.record-audio":"Nahra&#x165; zvuk","ba-videorecorder-controlbar.stop-available-after":"Minimum nahr&#xE1;vacieho &#x10D;asu je %d sek&#xFA;nd","ba-videorecorder-controlbar.cancel":"Zru&#x161;i&#x165;","ba-videorecorder-controlbar.cancel-tooltip":"Kliknite sem pre zru&#x161;enie.","ba-videorecorder.cancel-confirm":"Naozaj chcete zru&#x161;i&#x165; nahr&#xE1;vanie videa?","ba-videorecorder-chooser.record-screen":"Obrazovka nahr&#xE1;vania","ba-videoplayer-adslot.elapsed-time":"Elasped &#x10D;as","ba-videoplayer-adslot.volume-button":"Nastavte hlasitos&#x165;","ba-videoplayer-adslot.volume-mute":"Stlmenie zvuku","ba-videoplayer-adslot.volume-unmute":"Zru&#x161;i&#x165; zvuk","ba-videoplayer-adslot.ad-will-end-after":"Reklama sa skon&#x10D;&#xED; po %s","ba-videoplayer-adslot.can-skip-after":"Presko&#x10D;i&#x165; za %d","ba-videoplayer-adslot.skip-ad":"Presko&#x10D;i&#x165; reklamu","ba-videorecorder.software-required":"Ak chcete pokra&#x10D;ova&#x165;, kliknite na ni&#x17E;&#x161;ie a nain&#x161;talujte / aktivujte nasleduj&#xFA;ce po&#x17E;iadavky.","ba-videorecorder.software-waiting":"&#x10C;ak&#xE1; sa na po&#x17E;iadavky na in&#x161;tal&#xE1;ciu / aktiv&#xE1;ciu. Po skon&#x10D;en&#xED; str&#xE1;nky mo&#x17E;no budete musie&#x165; obnovi&#x165; str&#xE1;nku."},"language:sr":{"ba-videoplayer-playbutton.tooltip":"&#x426;&#x43B;&#x438;&#x446;&#x43A; &#x442;&#x43E; &#x43F;&#x43B;&#x430;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;.","ba-videoplayer-playbutton.rerecord":"&#x43F;&#x440;&#x435;&#x43F;&#x440;&#x430;&#x432;&#x438;&#x442;&#x438;","ba-videoplayer-playbutton.submit-video":"&#x43F;&#x43E;&#x442;&#x432;&#x440;&#x434;&#x438;&#x442;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-loader.tooltip":"&#x41B;&#x43E;&#x430;&#x434;&#x438;&#x43D;&#x433; &#x432;&#x438;&#x434;&#x435;&#x43E; ...","ba-videoplayer-controlbar.change-resolution":"&#x41F;&#x440;&#x43E;&#x43C;&#x435;&#x43D;&#x430; &#x440;&#x435;&#x437;&#x43E;&#x43B;&#x443;&#x446;&#x438;&#x458;&#x435;","ba-videoplayer-controlbar.video-progress":"&#x432;&#x438;&#x434;&#x435;&#x43E; &#x43D;&#x430;&#x43F;&#x440;&#x435;&#x434;&#x430;&#x43A;","ba-videoplayer-controlbar.rerecord-video":"&#x420;&#x435;&#x434;&#x43E; &#x432;&#x438;&#x434;&#x435;&#x43E;?","ba-videoplayer-controlbar.submit-video":"&#x43F;&#x43E;&#x442;&#x432;&#x440;&#x434;&#x438;&#x442;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.play-video":"&#x43F;&#x43B;&#x430;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.pause-video":"&#x43F;&#x430;&#x443;&#x437;&#x430; video","ba-videoplayer-controlbar.elapsed-time":"&#x415;&#x43B;&#x430;&#x441;&#x43F;&#x435;&#x434; &#x432;&#x440;&#x435;&#x43C;&#x435;","ba-videoplayer-controlbar.total-time":"&#x423;&#x43A;&#x443;&#x43F;&#x43D;&#x430; &#x434;&#x443;&#x436;&#x438;&#x43D;&#x430; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videoplayer-controlbar.fullscreen-video":"&#x415;&#x43D;&#x442;&#x435;&#x440; &#x444;&#x443;&#x43B;&#x43B;&#x441;&#x446;&#x440;&#x435;&#x435;&#x43D;","ba-videoplayer-controlbar.volume-button":"&#x41F;&#x43E;&#x434;&#x435;&#x448;&#x430;&#x432;&#x430;&#x45A;&#x435; &#x458;&#x430;&#x447;&#x438;&#x43D;&#x435; &#x437;&#x432;&#x443;&#x43A;&#x430;","ba-videoplayer-controlbar.volume-mute":"&#x43C;&#x443;&#x442;&#x435; &#x441;&#x43E;&#x443;&#x43D;&#x434;","ba-videoplayer-controlbar.volume-unmute":"&#x423;&#x43A;&#x459;&#x443;&#x447;&#x438; &#x437;&#x432;&#x443;&#x43A; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer.video-error":"&#x414;&#x43E;&#x448;&#x43B;&#x43E; &#x458;&#x435; &#x434;&#x43E; &#x433;&#x440;&#x435;&#x448;&#x43A;&#x435;. &#x41C;&#x43E;&#x43B;&#x438;&#x43C;&#x43E;, &#x43F;&#x43E;&#x43A;&#x443;&#x448;&#x430;&#x458;&#x442;&#x435; &#x43A;&#x430;&#x441;&#x43D;&#x438;&#x458;&#x435;. &#x426;&#x43B;&#x438;&#x446;&#x43A; &#x442;&#x43E; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x438;.","ba-videorecorder-chooser.record-video":"&#x421;&#x43D;&#x438;&#x43C;&#x438;&#x442;&#x435; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-chooser.upload-video":"&#x414;&#x43E;&#x434;&#x430;&#x458; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-controlbar.settings":"&#x41F;&#x43E;&#x434;&#x435;&#x448;&#x430;&#x432;&#x430;&#x45A;&#x430;","ba-videorecorder-controlbar.camerahealthy":"&#x41E;&#x441;&#x432;&#x435;&#x442;&#x459;&#x435;&#x45A;&#x435; &#x458;&#x435; &#x434;&#x43E;&#x431;&#x440;&#x43E;","ba-videorecorder-controlbar.cameraunhealthy":"&#x41E;&#x441;&#x432;&#x435;&#x442;&#x459;&#x435;&#x45A;&#x435; &#x43D;&#x438;&#x458;&#x435; &#x43E;&#x43F;&#x442;&#x438;&#x43C;&#x430;&#x43B;&#x43D;&#x430;","ba-videorecorder-controlbar.microphonehealthy":"&#x417;&#x432;&#x443;&#x43A; &#x458;&#x435; &#x434;&#x43E;&#x431;&#x430;&#x440;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x41D;&#x435; &#x43C;&#x43E;&#x433;&#x443; &#x443;&#x437;&#x435;&#x442;&#x438; &#x431;&#x438;&#x43B;&#x43E; &#x43A;&#x43E;&#x458;&#x438; &#x437;&#x432;&#x443;&#x43A;","ba-videorecorder-controlbar.record":"&#x437;&#x430;&#x43F;&#x438;&#x441;","ba-videorecorder-controlbar.record-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x437;&#x430; &#x441;&#x43D;&#x438;&#x43C;&#x430;&#x45A;&#x435;.","ba-videorecorder-controlbar.rerecord":"&#x43F;&#x440;&#x435;&#x43F;&#x440;&#x430;&#x432;&#x438;&#x442;&#x438;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x437;&#x430; &#x43F;&#x43E;&#x43D;&#x430;&#x432;&#x459;&#x430;&#x45A;&#x435;.","ba-videorecorder-controlbar.upload-covershot":"&#x43E;&#x442;&#x43F;&#x440;&#x435;&#x43C;&#x430;&#x45A;&#x435;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x431;&#x438;&#x441;&#x442;&#x435; &#x43F;&#x440;&#x438;&#x43B;&#x430;&#x433;&#x43E;&#x452;&#x435;&#x43D;&#x443; &#x43D;&#x430;&#x441;&#x43B;&#x43E;&#x432;&#x43D;&#x443; &#x43C;&#x435;&#x442;&#x430;&#x43A;","ba-videorecorder-controlbar.stop":"&#x417;&#x430;&#x443;&#x441;&#x442;&#x430;&#x432;&#x438;&#x442;&#x438;","ba-videorecorder-controlbar.stop-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x441;&#x435; &#x437;&#x430;&#x443;&#x441;&#x442;&#x430;&#x432;&#x438;.","ba-videorecorder-controlbar.skip":"&#x43F;&#x440;&#x435;&#x441;&#x43A;&#x43E;&#x447;&#x438;&#x442;&#x438;","ba-videorecorder-controlbar.skip-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x43F;&#x440;&#x435;&#x441;&#x43A;&#x43E;&#x447;&#x438;&#x442;&#x435;.","ba-videorecorder.recorder-error":"&#x414;&#x43E;&#x448;&#x43B;&#x43E; &#x458;&#x435; &#x434;&#x43E; &#x433;&#x440;&#x435;&#x448;&#x43A;&#x435;. &#x41C;&#x43E;&#x43B;&#x438;&#x43C;&#x43E;, &#x43F;&#x43E;&#x43A;&#x443;&#x448;&#x430;&#x458;&#x442;&#x435; &#x43A;&#x430;&#x441;&#x43D;&#x438;&#x458;&#x435;. &#x426;&#x43B;&#x438;&#x446;&#x43A; &#x442;&#x43E; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x438;.","ba-videorecorder.attach-error":"&#x41C;&#x438; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x43F;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43F;&#x438; &#x438;&#x43D;&#x442;&#x435;&#x440;&#x444;&#x435;&#x458;&#x441; &#x43A;&#x430;&#x43C;&#x435;&#x440;&#x435;. &#x423; &#x437;&#x430;&#x432;&#x438;&#x441;&#x43D;&#x43E;&#x441;&#x442;&#x438; &#x43E;&#x434; &#x443;&#x440;&#x435;&#x452;&#x430;&#x458;&#x430; &#x438; &#x43F;&#x440;&#x435;&#x442;&#x440;&#x430;&#x436;&#x438;&#x432;&#x430;&#x447;&#x430;, &#x43C;&#x43E;&#x436;&#x434;&#x430; &#x45B;&#x435;&#x442;&#x435; &#x43C;&#x43E;&#x440;&#x430;&#x442;&#x438; &#x434;&#x430; &#x438;&#x43D;&#x441;&#x442;&#x430;&#x43B;&#x438;&#x440;&#x430;&#x442;&#x435; &#x424;&#x43B;&#x430;&#x441;&#x445; &#x438;&#x43B;&#x438; &#x43F;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43F;&#x438;&#x43B;&#x438; &#x441;&#x442;&#x440;&#x430;&#x43D;&#x438;&#x446;&#x438; &#x43F;&#x440;&#x435;&#x43A;&#x43E; &#x421;&#x421;&#x41B;.","ba-videorecorder.access-forbidden":"&#x41F;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43F; &#x43A;&#x430;&#x43C;&#x435;&#x440;&#x43E;&#x43C; &#x458;&#x435; &#x437;&#x430;&#x431;&#x440;&#x430;&#x45A;&#x435;&#x43D;&#x43E;. &#x426;&#x43B;&#x438;&#x446;&#x43A; &#x442;&#x43E; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x438;.","ba-videorecorder.pick-covershot":"&#x418;&#x437;&#x430;&#x431;&#x435;&#x440;&#x438;&#x442;&#x435; &#x446;&#x43E;&#x432;&#x435;&#x440;&#x441;&#x445;&#x43E;&#x442;.","ba-videorecorder.uploading":"&#x443;&#x43F;&#x43B;&#x43E;&#x430;&#x434;&#x438;&#x43D;&#x433;","ba-videorecorder.uploading-failed":"&#x423;&#x43F;&#x43B;&#x43E;&#x430;&#x434;&#x438;&#x43D;&#x433; &#x444;&#x430;&#x438;&#x43B;&#x435;&#x434; - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43A;&#x443;&#x448;&#x430; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder.verifying":"&#x432;&#x435;&#x440;&#x438;&#x444;&#x438;&#x43A;&#x430;&#x446;&#x438;&#x458;&#x443;","ba-videorecorder.verifying-failed":"&#x41F;&#x440;&#x43E;&#x432;&#x435;&#x440;&#x430; &#x43D;&#x438;&#x458;&#x435; &#x443;&#x441;&#x43F;&#x435;&#x43B;&#x430; - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43A;&#x443;&#x448;&#x430; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videorecorder.rerecord-confirm":"&#x414;&#x430; &#x43B;&#x438; &#x437;&#x430;&#x438;&#x441;&#x442;&#x430; &#x436;&#x435;&#x43B;&#x438;&#x442;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x435; &#x441;&#x432;&#x43E;&#x458; &#x432;&#x438;&#x434;&#x435;&#x43E;?","ba-videorecorder.video_file_too_large":"&#x412;&#x430;&#x448; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x434;&#x430;&#x442;&#x43E;&#x442;&#x435;&#x43A;&#x430; &#x458;&#x435; &#x43F;&#x440;&#x435;&#x432;&#x435;&#x43B;&#x438;&#x43A;&#x430; (%s) - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x43E; &#x441;&#x430; &#x43C;&#x430;&#x45A;&#x43E;&#x43C; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x458;&#x43B;.","ba-videorecorder.unsupported_video_type":"&#x41C;&#x43E;&#x43B;&#x438;&#x43C;&#x43E; &#x412;&#x430;&#x441; &#x434;&#x430; &#x443;&#x43F;&#x43B;&#x43E;&#x430;&#x434;: %&#x441; - &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43A;&#x443;&#x448;&#x430; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x43E;.","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x418;&#x437;&#x43B;&#x430;&#x437; &#x438;&#x437; &#x446;&#x435;&#x43B;&#x43E;&#x433; &#x435;&#x43A;&#x440;&#x430;&#x43D;&#x430;","ba-videoplayer-share.share":"&#x41F;&#x43E;&#x434;&#x435;&#x43B;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;","ba-videorecorder-chooser.record-screen":"&#x421;&#x43D;&#x438;&#x43C;&#x430;&#x43A; &#x435;&#x43A;&#x440;&#x430;&#x43D;&#x430;","ba-videoplayer-controlbar.pause-video-disabled":"&#x41F;&#x430;&#x443;&#x437;&#x430; &#x43D;&#x438;&#x458;&#x435; &#x43F;&#x43E;&#x434;&#x440;&#x436;&#x430;&#x43D;&#x430;","ba-videorecorder-chooser.record-audio":"&#x421;&#x43D;&#x438;&#x43C;&#x438;&#x442;&#x438; &#x437;&#x432;&#x443;&#x43A;","ba-videorecorder-controlbar.stop-available-after":"&#x41C;&#x438;&#x43D;&#x438;&#x43C;&#x430;&#x43B;&#x43D;&#x43E; &#x432;&#x440;&#x435;&#x43C;&#x435; &#x441;&#x43D;&#x438;&#x43C;&#x430;&#x45A;&#x430; &#x458;&#x435; %&#x434; &#x441;&#x435;&#x43A;&#x443;&#x43D;&#x434;&#x438;","ba-videorecorder-controlbar.cancel":"&#x41F;&#x43E;&#x43D;&#x438;&#x448;&#x442;&#x438;&#x442;&#x438;, &#x43E;&#x442;&#x43A;&#x430;&#x437;&#x430;&#x442;&#x438;","ba-videorecorder-controlbar.cancel-tooltip":"&#x41A;&#x43B;&#x438;&#x43A;&#x43D;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x434;&#x435; &#x434;&#x430; &#x431;&#x438;&#x441;&#x442;&#x435; &#x43E;&#x442;&#x43A;&#x430;&#x437;&#x430;&#x43B;&#x438;.","ba-videorecorder.cancel-confirm":"&#x414;&#x430; &#x43B;&#x438; &#x437;&#x430;&#x438;&#x441;&#x442;&#x430; &#x436;&#x435;&#x43B;&#x438;&#x442;&#x435; &#x434;&#x430; &#x43E;&#x442;&#x43A;&#x430;&#x436;&#x435;&#x442;&#x435; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x43E;&#x442;&#x43F;&#x440;&#x435;&#x43C;&#x430;&#x45A;&#x435;?","ba-videoplayer-adslot.elapsed-time":"&#x415;&#x43B;&#x430;&#x441;&#x43F;&#x435;&#x434; &#x442;&#x438;&#x43C;&#x435;","ba-videoplayer-adslot.volume-button":"&#x41F;&#x43E;&#x434;&#x435;&#x441;&#x438;&#x442;&#x435; &#x458;&#x430;&#x447;&#x438;&#x43D;&#x443; &#x437;&#x432;&#x443;&#x43A;&#x430;","ba-videoplayer-adslot.volume-mute":"&#x418;&#x441;&#x43A;&#x459;&#x443;&#x447;&#x438; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer-adslot.volume-unmute":"&#x423;&#x43A;&#x459;&#x443;&#x447;&#x438; &#x437;&#x432;&#x443;&#x43A;","ba-videoplayer-adslot.ad-will-end-after":"&#x41E;&#x433;&#x43B;&#x430;&#x441; &#x45B;&#x435; &#x441;&#x435; &#x437;&#x430;&#x432;&#x440;&#x448;&#x438;&#x442;&#x438; &#x43D;&#x430;&#x43A;&#x43E;&#x43D; %&#x441;","ba-videoplayer-adslot.can-skip-after":"&#x41F;&#x440;&#x435;&#x441;&#x43A;&#x43E;&#x447;&#x438; &#x43F;&#x43E;&#x441;&#x43B;&#x435; %&#x434;","ba-videoplayer-adslot.skip-ad":"&#x41F;&#x440;&#x435;&#x441;&#x43A;&#x43E;&#x447;&#x438;&#x442;&#x435; &#x43E;&#x433;&#x43B;&#x430;&#x441;","ba-videorecorder.software-required":"&#x41C;&#x43E;&#x43B;&#x438;&#x43C;&#x43E; &#x434;&#x430; &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x438;&#x441;&#x43F;&#x43E;&#x434; &#x434;&#x430; &#x431;&#x438;&#x441;&#x442;&#x435; &#x438;&#x43D;&#x441;&#x442;&#x430;&#x43B;&#x438;&#x440;&#x430;&#x43B;&#x438; / &#x430;&#x43A;&#x442;&#x438;&#x432;&#x438;&#x440;&#x430;&#x43B;&#x438; &#x441;&#x43B;&#x435;&#x434;&#x435;&#x45B;&#x435; &#x437;&#x430;&#x445;&#x442;&#x435;&#x432;&#x435; &#x43A;&#x430;&#x43A;&#x43E; &#x431;&#x438;&#x441;&#x442;&#x435; &#x43D;&#x430;&#x441;&#x442;&#x430;&#x432;&#x438;&#x43B;&#x438;.","ba-videorecorder.software-waiting":"&#x427;&#x435;&#x43A;&#x430; &#x441;&#x435; &#x437;&#x430;&#x445;&#x442;&#x435;&#x432; &#x43A;&#x43E;&#x458;&#x438; &#x442;&#x440;&#x435;&#x431;&#x430; &#x438;&#x43D;&#x441;&#x442;&#x430;&#x43B;&#x438;&#x440;&#x430;&#x442;&#x438; / &#x430;&#x43A;&#x442;&#x438;&#x432;&#x438;&#x440;&#x430;&#x442;&#x438;. &#x41C;&#x43E;&#x436;&#x434;&#x430; &#x45B;&#x435;&#x442;&#x435; &#x43C;&#x43E;&#x440;&#x430;&#x442;&#x438; &#x43E;&#x441;&#x432;&#x435;&#x436;&#x438;&#x442;&#x438; &#x441;&#x442;&#x440;&#x430;&#x43D;&#x438;&#x446;&#x443; &#x43D;&#x430;&#x43A;&#x43E;&#x43D; &#x437;&#x430;&#x432;&#x440;&#x448;&#x435;&#x442;&#x43A;&#x430;."},"language:sv":{"ba-videoplayer-playbutton.tooltip":"Klicka f&#xF6;r att spela upp video.","ba-videoplayer-playbutton.rerecord":"G&#xF6;ra om","ba-videoplayer-playbutton.submit-video":"bekr&#xE4;fta video","ba-videoplayer-loader.tooltip":"Laddar video ...","ba-videoplayer-controlbar.change-resolution":"&#xE4;ndra uppl&#xF6;sning","ba-videoplayer-controlbar.video-progress":"video framsteg","ba-videoplayer-controlbar.rerecord-video":"G&#xF6;r video?","ba-videoplayer-controlbar.submit-video":"bekr&#xE4;fta video","ba-videoplayer-controlbar.play-video":"Spela video","ba-videoplayer-controlbar.pause-video":"pause video","ba-videoplayer-controlbar.elapsed-time":"f&#xF6;rfluten tid","ba-videoplayer-controlbar.total-time":"Totala l&#xE4;ngden av video","ba-videoplayer-controlbar.fullscreen-video":"Ange fullscreen","ba-videoplayer-controlbar.volume-button":"inst&#xE4;llda volymen","ba-videoplayer-controlbar.volume-mute":"st&#xE4;nga av ljudet","ba-videoplayer-controlbar.volume-unmute":"s&#xE4;tta p&#xE5; ljudet","ba-videoplayer.video-error":"Ett fel har intr&#xE4;ffat. V&#xE4;nligen f&#xF6;rs&#xF6;k igen senare. Klicka f&#xF6;r att f&#xF6;rs&#xF6;ka igen.","ba-videorecorder-chooser.record-video":"Spela din video","ba-videorecorder-chooser.upload-video":"Ladda upp video","ba-videorecorder-controlbar.settings":"inst&#xE4;llningar","ba-videorecorder-controlbar.camerahealthy":"Belysning &#xE4;r bra","ba-videorecorder-controlbar.cameraunhealthy":"Belysning &#xE4;r inte optimal","ba-videorecorder-controlbar.microphonehealthy":"Ljudet &#xE4;r bra","ba-videorecorder-controlbar.microphoneunhealthy":"Det g&#xE5;r inte att plocka upp n&#xE5;got ljud","ba-videorecorder-controlbar.record":"Spela in","ba-videorecorder-controlbar.record-tooltip":"Klicka h&#xE4;r f&#xF6;r att spela in.","ba-videorecorder-controlbar.rerecord":"G&#xF6;ra om","ba-videorecorder-controlbar.rerecord-tooltip":"Klicka h&#xE4;r f&#xF6;r att g&#xF6;ra om.","ba-videorecorder-controlbar.upload-covershot":"Ladda upp","ba-videorecorder-controlbar.upload-covershot-tooltip":"Klicka h&#xE4;r f&#xF6;r att ladda upp anpassade t&#xE4;cka skott","ba-videorecorder-controlbar.stop":"Sluta","ba-videorecorder-controlbar.stop-tooltip":"Klicka h&#xE4;r f&#xF6;r att stanna.","ba-videorecorder-controlbar.skip":"Hoppa","ba-videorecorder-controlbar.skip-tooltip":"Klicka h&#xE4;r f&#xF6;r att hoppa.","ba-videorecorder.recorder-error":"Ett fel har intr&#xE4;ffat. V&#xE4;nligen f&#xF6;rs&#xF6;k igen senare. Klicka f&#xF6;r att f&#xF6;rs&#xF6;ka igen.","ba-videorecorder.attach-error":"Vi kunde inte komma &#xE5;t kameragr&#xE4;nssnittet. Beroende p&#xE5; vilken enhet och webbl&#xE4;sare, kan du beh&#xF6;va installera Flash eller &#xF6;ppna sidan via SSL.","ba-videorecorder.access-forbidden":"&#xC5;tkomst till kameran var f&#xF6;rbjudet. Klicka f&#xF6;r att f&#xF6;rs&#xF6;ka igen.","ba-videorecorder.pick-covershot":"V&#xE4;lj en covershot.","ba-videorecorder.uploading":"uppladdning","ba-videorecorder.uploading-failed":"Uppladdning misslyckades - klicka h&#xE4;r f&#xF6;r att f&#xF6;rs&#xF6;ka igen.","ba-videorecorder.verifying":"verifiera","ba-videorecorder.verifying-failed":"Verifiera misslyckades - klicka h&#xE4;r f&#xF6;r att f&#xF6;rs&#xF6;ka igen.","ba-videorecorder.rerecord-confirm":"Vill du verkligen vill g&#xF6;ra om din video?","ba-videorecorder.video_file_too_large":"Videofilen &#xE4;r f&#xF6;r stor (%s) - klicka h&#xE4;r f&#xF6;r att f&#xF6;rs&#xF6;ka igen med en mindre videofil.","ba-videorecorder.unsupported_video_type":"Ladda upp: %s - klicka h&#xE4;r f&#xF6;r att f&#xF6;rs&#xF6;ka igen.","ba-videoplayer-controlbar.exit-fullscreen-video":"Avsluta fullsk&#xE4;rmen","ba-videoplayer-share.share":"Dela video","ba-videorecorder-chooser.record-screen":"Inspelningssk&#xE4;rm","ba-videoplayer-controlbar.pause-video-disabled":"Paus st&#xF6;ds inte","ba-videorecorder-chooser.record-audio":"Spela in ljud","ba-videorecorder-controlbar.stop-available-after":"Minsta inspelningstid &#xE4;r %d sekunder","ba-videorecorder-controlbar.cancel":"Annullera","ba-videorecorder-controlbar.cancel-tooltip":"Klicka h&#xE4;r f&#xF6;r att avbryta.","ba-videorecorder.cancel-confirm":"Vill du verkligen avbryta din videouppladdning?","ba-videoplayer-adslot.elapsed-time":"Elasped tid","ba-videoplayer-adslot.volume-button":"Ange volym","ba-videoplayer-adslot.volume-mute":"St&#xE4;ng ljudet","ba-videoplayer-adslot.volume-unmute":"Sl&#xE5; av ljudet","ba-videoplayer-adslot.ad-will-end-after":"Annonsen slutar efter %s","ba-videoplayer-adslot.can-skip-after":"Hoppa &#xF6;ver efter %d","ba-videoplayer-adslot.skip-ad":"Hoppa &#xF6;ver annonsen","ba-videorecorder.software-required":"V&#xE4;nligen klicka nedan f&#xF6;r att installera / aktivera f&#xF6;ljande krav f&#xF6;r att forts&#xE4;tta.","ba-videorecorder.software-waiting":"V&#xE4;ntar p&#xE5; att kraven ska installeras / aktiveras. Det kan h&#xE4;nda att du beh&#xF6;ver uppdatera sidan efter slutf&#xF6;randet."},"language:tl":{"ba-videoplayer-playbutton.tooltip":"I-click upang i-play ang video.","ba-videoplayer-playbutton.rerecord":"I-redo","ba-videoplayer-playbutton.submit-video":"Kumpirmahin ang video","ba-videoplayer-loader.tooltip":"Nilo-load ang video ...","ba-videoplayer-controlbar.change-resolution":"Baguhin ang resolution","ba-videoplayer-controlbar.video-progress":"pag-usad Video","ba-videoplayer-controlbar.rerecord-video":"Gawing muli ang video?","ba-videoplayer-controlbar.submit-video":"Kumpirmahin ang video","ba-videoplayer-controlbar.play-video":"I-Play ang video","ba-videoplayer-controlbar.pause-video":"I-pause ang video","ba-videoplayer-controlbar.elapsed-time":"Elasped oras","ba-videoplayer-controlbar.total-time":"Kabuuang haba ng video","ba-videoplayer-controlbar.fullscreen-video":"Ipasok fullscreen","ba-videoplayer-controlbar.volume-button":"Itakda ang lakas ng tunog","ba-videoplayer-controlbar.volume-mute":"I-mute ang tunog","ba-videoplayer-controlbar.volume-unmute":"I-unmute ang tunog","ba-videoplayer.video-error":"May naganap na error. Mangyaring subukan muli sa ibang pagkakataon. I-click upang subukang muli.","ba-videorecorder-chooser.record-video":"Kumuha ng video","ba-videorecorder-chooser.upload-video":"Mag-upload ng Video","ba-videorecorder-controlbar.settings":"Mga Setting","ba-videorecorder-controlbar.camerahealthy":"Pag-iilaw ay mabuti","ba-videorecorder-controlbar.cameraunhealthy":"Pag-iilaw ay hindi optimal","ba-videorecorder-controlbar.microphonehealthy":"Sound ay mabuti","ba-videorecorder-controlbar.microphoneunhealthy":"Hindi kunin ang anumang tunog","ba-videorecorder-controlbar.record":"Rekord","ba-videorecorder-controlbar.record-tooltip":"Mag-click dito upang i-record.","ba-videorecorder-controlbar.rerecord":"I-redo","ba-videorecorder-controlbar.rerecord-tooltip":"Mag-click dito upang gawing muli.","ba-videorecorder-controlbar.upload-covershot":"Upload","ba-videorecorder-controlbar.upload-covershot-tooltip":"Mag-click dito upang mag-upload ng mga pasadyang pabalat shot","ba-videorecorder-controlbar.stop":"Itigil","ba-videorecorder-controlbar.stop-tooltip":"Mag-click dito upang itigil.","ba-videorecorder-controlbar.skip":"Laktawan","ba-videorecorder-controlbar.skip-tooltip":"Mag-click dito upang laktawan.","ba-videorecorder.recorder-error":"May naganap na error. Mangyaring subukan muli sa ibang pagkakataon. I-click upang subukang muli.","ba-videorecorder.attach-error":"Hindi namin mai-access ang interface ng camera. Depende sa device at browser, maaaring kailangan mong i-install ng Flash o ma-access ang pahina sa pamamagitan ng SSL.","ba-videorecorder.access-forbidden":"Access sa camera ay ipinagbabawal. I-click upang subukang muli.","ba-videorecorder.pick-covershot":"Pumili ng isang covershot.","ba-videorecorder.uploading":"Pag-upload","ba-videorecorder.uploading-failed":"Ina-upload ang mali - i-click dito upang subukang muli.","ba-videorecorder.verifying":"Bine-verify","ba-videorecorder.verifying-failed":"Ang pag-verify nabigo - i-click dito upang subukang muli.","ba-videorecorder.rerecord-confirm":"Nais mo ba talagang nais na gawing muli ang iyong video?","ba-videorecorder.video_file_too_large":"Ang iyong video file ay masyadong malaki (%s) - i-click dito upang subukang muli gamit ang mas maliit na file na video.","ba-videorecorder.unsupported_video_type":"Mangyaring i-upload: %s - i-click dito upang subukang muli.","ba-videoplayer-controlbar.exit-fullscreen-video":"Lumabas sa fullscreen","ba-videoplayer-share.share":"Ibahagi ang video","ba-videorecorder-chooser.record-screen":"Mag-record ng Screen","ba-videoplayer-controlbar.pause-video-disabled":"I-pause ang hindi suportado","ba-videorecorder-chooser.record-audio":"Mag-record Audio","ba-videorecorder-controlbar.stop-available-after":"Ang minimum na oras ng pag-record ay %d segundo","ba-videorecorder-controlbar.cancel":"Kanselahin","ba-videorecorder-controlbar.cancel-tooltip":"Mag-click dito upang kanselahin.","ba-videorecorder.cancel-confirm":"Nais mo bang kanselahin ang iyong pag-upload ng video?","ba-videoplayer-adslot.elapsed-time":"Tiyak na oras","ba-videoplayer-adslot.volume-button":"Itakda ang lakas ng tunog","ba-videoplayer-adslot.volume-mute":"I-mute ang tunog","ba-videoplayer-adslot.volume-unmute":"I-unmute ang tunog","ba-videoplayer-adslot.ad-will-end-after":"Magwawakas ang ad matapos ang %s","ba-videoplayer-adslot.can-skip-after":"Laktawan pagkatapos %d","ba-videoplayer-adslot.skip-ad":"Laktawan ang ad","ba-videorecorder.software-required":"Mangyaring mag-click sa ibaba upang i-install / i-activate ang mga sumusunod na kinakailangan upang magpatuloy.","ba-videorecorder.software-waiting":"Naghihintay ng mga kinakailangan na mai-install / isinaaktibo. Maaaring kailanganin mong i-refresh ang pahina pagkatapos makumpleto."},"language:tr":{"ba-videoplayer-playbutton.tooltip":"video oynatmak i&#xE7;in t&#x131;klay&#x131;n&#x131;z.","ba-videoplayer-playbutton.rerecord":"yeniden yapmak","ba-videoplayer-playbutton.submit-video":"videoyu onayla","ba-videoplayer-loader.tooltip":"Video y&#xFC;kleniyor ...","ba-videoplayer-controlbar.change-resolution":"De&#x11F;i&#x15F;im &#xE7;&#xF6;z&#xFC;n&#xFC;rl&#xFC;&#x11F;&#xFC;","ba-videoplayer-controlbar.video-progress":"Video ilerleme","ba-videoplayer-controlbar.rerecord-video":"Videoyu Redo?","ba-videoplayer-controlbar.submit-video":"videoyu onayla","ba-videoplayer-controlbar.play-video":"Video oynatmak","ba-videoplayer-controlbar.pause-video":"Pause Video","ba-videoplayer-controlbar.elapsed-time":"Ge&#xE7;en s&#xFC;re","ba-videoplayer-controlbar.total-time":"videonun toplam uzunlu&#x11F;u","ba-videoplayer-controlbar.fullscreen-video":"Tam ekran yap","ba-videoplayer-controlbar.volume-button":"Set hacmi","ba-videoplayer-controlbar.volume-mute":"sesi","ba-videoplayer-controlbar.volume-unmute":"sesi a&#xE7;","ba-videoplayer.video-error":"Bir hata, l&#xFC;tfen tekrar deneyiniz olu&#x15F;tu. Tekrar denemek i&#xE7;in t&#x131;klay&#x131;n.","ba-videorecorder-chooser.record-video":"Ki&#x15F;isel Video kay&#x131;t","ba-videorecorder-chooser.upload-video":"video","ba-videorecorder-controlbar.settings":"Ayarlar","ba-videorecorder-controlbar.camerahealthy":"Ayd&#x131;nlatma iyidir","ba-videorecorder-controlbar.cameraunhealthy":"Ayd&#x131;nlatma optimum de&#x11F;il","ba-videorecorder-controlbar.microphonehealthy":"Ses iyidir","ba-videorecorder-controlbar.microphoneunhealthy":"herhangi bir ses pick up olamaz","ba-videorecorder-controlbar.record":"Kay&#x131;t","ba-videorecorder-controlbar.record-tooltip":"kaydetmek i&#xE7;in buraya t&#x131;klay&#x131;n.","ba-videorecorder-controlbar.rerecord":"yeniden yapmak","ba-videorecorder-controlbar.rerecord-tooltip":"yinelemek i&#xE7;in buraya t&#x131;klay&#x131;n.","ba-videorecorder-controlbar.upload-covershot":"y&#xFC;kleme","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#xF6;zel kapak &#xE7;ekimi y&#xFC;klemek i&#xE7;in buraya t&#x131;klay&#x131;n","ba-videorecorder-controlbar.stop":"Dur","ba-videorecorder-controlbar.stop-tooltip":"durdurmak i&#xE7;in buray&#x131; t&#x131;klay&#x131;n.","ba-videorecorder-controlbar.skip":"atlamak","ba-videorecorder-controlbar.skip-tooltip":"atlamak i&#xE7;in buraya t&#x131;klay&#x131;n.","ba-videorecorder.recorder-error":"Bir hata, l&#xFC;tfen tekrar deneyiniz olu&#x15F;tu. Tekrar denemek i&#xE7;in t&#x131;klay&#x131;n.","ba-videorecorder.attach-error":"Biz kamera aray&#xFC;z&#xFC; eri&#x15F;emedi. cihaz ve taray&#x131;c&#x131;ya ba&#x11F;l&#x131; olarak, Flash y&#xFC;klemek veya SSL ile sayfaya eri&#x15F;mek i&#xE7;in gerekebilir.","ba-videorecorder.access-forbidden":"Kameraya eri&#x15F;im yasakland&#x131;. Tekrar denemek i&#xE7;in t&#x131;klay&#x131;n.","ba-videorecorder.pick-covershot":"Bir covershot se&#xE7;in.","ba-videorecorder.uploading":"Y&#xFC;kleme","ba-videorecorder.uploading-failed":"Y&#xFC;kleme ba&#x15F;ar&#x131;s&#x131;z - yeniden denemek i&#xE7;in buray&#x131; t&#x131;klay&#x131;n.","ba-videorecorder.verifying":"Do&#x11F;rulama","ba-videorecorder.verifying-failed":"Ba&#x15F;ar&#x131;s&#x131;z kullan&#x131;ld&#x131;&#x11F;&#x131;n&#x131; do&#x11F;rulamak - yeniden denemek i&#xE7;in buray&#x131; t&#x131;klay&#x131;n.","ba-videorecorder.rerecord-confirm":"E&#x11F;er ger&#xE7;ekten video yinelemek istiyor musunuz?","ba-videorecorder.video_file_too_large":"Videonuz dosyas&#x131; &#xE7;ok b&#xFC;y&#xFC;k (%s) - k&#xFC;&#xE7;&#xFC;k bir video dosyas&#x131; ile tekrar denemek i&#xE7;in buray&#x131; t&#x131;klay&#x131;n.","ba-videorecorder.unsupported_video_type":"y&#xFC;kleyin: %s - yeniden denemek i&#xE7;in buray&#x131; t&#x131;klay&#x131;n.","ba-videoplayer-controlbar.exit-fullscreen-video":"Tam ekrandan &#xE7;&#x131;k","ba-videoplayer-share.share":"Video payla&#x15F;","ba-videorecorder-chooser.record-screen":"Kay&#x131;t Ekran&#x131;","ba-videoplayer-controlbar.pause-video-disabled":"Duraklat desteklenmiyor","ba-videorecorder-chooser.record-audio":"Ses kayd&#x131;","ba-videorecorder-controlbar.stop-available-after":"Minimum kay&#x131;t s&#xFC;resi %d saniye","ba-videorecorder-controlbar.cancel":"&#x130;ptal etmek","ba-videorecorder-controlbar.cancel-tooltip":"&#x130;ptal etmek i&#xE7;in buraya t&#x131;klay&#x131;n.","ba-videorecorder.cancel-confirm":"Video y&#xFC;klemenizi ger&#xE7;ekten iptal etmek istiyor musunuz?","ba-videoplayer-adslot.elapsed-time":"Kazan&#x131;lan zaman","ba-videoplayer-adslot.volume-button":"Sesi ayarla","ba-videoplayer-adslot.volume-mute":"Sesi kapat","ba-videoplayer-adslot.volume-unmute":"Sesi a&#xE7;ma","ba-videoplayer-adslot.ad-will-end-after":"Reklam, %s sonra sona erecek","ba-videoplayer-adslot.can-skip-after":" %D sonra atla","ba-videoplayer-adslot.skip-ad":"Reklam&#x131; ge&#xE7;","ba-videorecorder.software-required":"Devam etmek i&#xE7;in a&#x15F;a&#x11F;&#x131;daki gereksinimleri y&#xFC;klemek / etkinle&#x15F;tirmek i&#xE7;in l&#xFC;tfen a&#x15F;a&#x11F;&#x131;ya t&#x131;klay&#x131;n.","ba-videorecorder.software-waiting":"Gereksinimlerin kurulmas&#x131; / etkinle&#x15F;tirilmesi i&#xE7;in bekleniyor. Tamamland&#x131;ktan sonra sayfay&#x131; yenilemeniz gerekebilir."},"language:zh-cn":{"ba-videoplayer-playbutton.tooltip":"&#x70B9;&#x51FB;&#x64AD;&#x653E;","ba-videoplayer-playbutton.rerecord":"&#x91CD;&#x8BD5;","ba-videoplayer-playbutton.submit-video":"&#x786E;&#x5B9A;","ba-videoplayer-loader.tooltip":"&#x8BFB;&#x53D6;&#x4E2D;...","ba-videoplayer-controlbar.change-resolution":"&#x53D8;&#x66F4;&#x5206;&#x8FA8;&#x7387;","ba-videoplayer-controlbar.video-progress":"&#x8FDB;&#x5EA6;","ba-videoplayer-controlbar.rerecord-video":"&#x91CD;&#x8BD5;?","ba-videoplayer-controlbar.submit-video":"&#x786E;&#x8BA4;","ba-videoplayer-controlbar.play-video":"&#x64AD;&#x653E;","ba-videoplayer-controlbar.pause-video":"&#x6682;&#x505C;","ba-videoplayer-controlbar.elapsed-time":"&#x7ECF;&#x8FC7;&#x65F6;&#x95F4;","ba-videoplayer-controlbar.total-time":"&#x603B;&#x957F;&#x5EA6;","ba-videoplayer-controlbar.fullscreen-video":"&#x8FDB;&#x5165;&#x5168;&#x5C4F;","ba-videoplayer-controlbar.volume-button":"&#x8C03;&#x6574;&#x97F3;&#x91CF;","ba-videoplayer-controlbar.volume-mute":"&#x9759;&#x97F3;","ba-videoplayer-controlbar.volume-unmute":"&#x89E3;&#x9664;&#x9759;&#x97F3;","ba-videoplayer.video-error":"&#x9519;&#x8BEF;&#x53D1;&#x751F;&#xFF0C;&#x8BF7;&#x7A0D;&#x540E;&#x518D;&#x8BD5;(&#x70B9;&#x6211;)","ba-videorecorder-chooser.record-video":"&#x5F55;&#x5236;&#x5F71;&#x7247;","ba-videorecorder-chooser.upload-video":"&#x4E0A;&#x4F20;&#x5F71;&#x7247;","ba-videorecorder-controlbar.settings":"&#x8BBE;&#x7F6E;","ba-videorecorder-controlbar.camerahealthy":"&#x5149;&#x7EBF;&#x826F;&#x597D;","ba-videorecorder-controlbar.cameraunhealthy":"&#x5149;&#x6E90;&#x4E0D;&#x4F73;","ba-videorecorder-controlbar.microphonehealthy":"&#x6536;&#x97F3;&#x826F;&#x597D;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x6536;&#x97F3;&#x4E0D;&#x826F;","ba-videorecorder-controlbar.record":"&#x5F55;&#x5F71;","ba-videorecorder-controlbar.record-tooltip":"&#x70B9;&#x6211;&#x5F55;&#x5F71;","ba-videorecorder-controlbar.rerecord":"&#x91CD;&#x8BD5;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x70B9;&#x6211;&#x91CD;&#x8BD5;","ba-videorecorder-controlbar.upload-covershot":"&#x4E0A;&#x4F20;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x70B9;&#x6211;&#x4E0A;&#x4F20;&#x81EA;&#x8BA2;&#x7684;&#x5C01;&#x9762;","ba-videorecorder-controlbar.stop":"&#x505C;&#x6B62;","ba-videorecorder-controlbar.stop-tooltip":"&#x70B9;&#x6211;&#x505C;&#x6B62;","ba-videorecorder-controlbar.skip":"&#x7565;&#x8FC7;","ba-videorecorder-controlbar.skip-tooltip":"&#x70B9;&#x6211;&#x7565;&#x8FC7;","ba-videorecorder.recorder-error":"&#x9519;&#x8BEF;&#x53D1;&#x751F;&#xFF0C;&#x8BF7;&#x7A0D;&#x540E;&#x518D;&#x8BD5;(&#x70B9;&#x6211;)","ba-videorecorder.attach-error":"&#x65E0;&#x6CD5;&#x5B58;&#x53D6;&#x6444;&#x50CF;&#x5934;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x6D4F;&#x89C8;&#x5668;&#x6216;&#x662F;&#x8BBE;&#x5907;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x8BF7;&#x5C1D;&#x8BD5;&#x5B89;&#x88C5; Flash &#x5916;&#x6302;&#x7A0B;&#x5E8F;&#x6216;&#x900F;&#x8FC7;&#x5B89;&#x5168;&#x8FDE;&#x7EBF;&#x6765;&#x4F7F;&#x7528;&#x3002;","ba-videorecorder.access-forbidden":"&#x65E0;&#x6CD5;&#x5B58;&#x53D6;&#x6444;&#x50CF;&#x5934;&#xFF0C;&#x8BF7;&#x70B9;&#x6211;&#x91CD;&#x8BD5;&#x3002;","ba-videorecorder.pick-covershot":"&#x8BF7;&#x6311;&#x9009;&#x4E00;&#x5F20;&#x5C01;&#x9762;","ba-videorecorder.uploading":"&#x4E0A;&#x4F20;&#x4E2D;","ba-videorecorder.uploading-failed":"&#x4E0A;&#x4F20;&#x5931;&#x8D25;&#xFF0C;&#x8BF7;&#x70B9;&#x6211;&#x91CD;&#x8BD5;","ba-videorecorder.verifying":"&#x9A8C;&#x8BC1;&#x4E2D;","ba-videorecorder.verifying-failed":"&#x9A8C;&#x8BC1;&#x5931;&#x8D25;&#xFF0C;&#x8BF7;&#x70B9;&#x6211;&#x91CD;&#x8BD5;","ba-videorecorder.rerecord-confirm":"&#x786E;&#x5B9A;&#x8981;&#x91CD;&#x65B0;&#x5F55;&#x5236;&#x60A8;&#x7684;&#x5F71;&#x7247;?","ba-videorecorder.video_file_too_large":"&#x60A8;&#x7684;&#x5F71;&#x7247;&#x8FC7;&#x5927; (%s) &#x8BF7;&#x70B9;&#x6211;&#x91CD;&#x65B0;&#x9009;&#x62E9;&#x5C0F;&#x4E00;&#x70B9;&#x5F71;&#x7247;&#x518D;&#x8BD5;&#x4E00;&#x6B21;&#x3002;","ba-videorecorder.unsupported_video_type":"&#x8BF7;&#x4F7F;&#x7528;&#x5F71;&#x7247;&#x683C;&#x5F0F;: %s - &#x70B9;&#x6211;&#x91CD;&#x8BD5;","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x7ED3;&#x675F;&#x5168;&#x5C4F;&#x64AD;&#x653E;","ba-videoplayer-share.share":"&#x5206;&#x4EAB;","ba-videoplayer-controlbar.pause-video-disabled":"&#x65E0;&#x6CD5;&#x6682;&#x505C;","ba-videorecorder-chooser.record-audio":"&#x5F55;&#x97F3;","ba-videorecorder-chooser.record-screen":"&#x8BB0;&#x5F55;&#x5C4F;&#x5E55;","ba-videorecorder-controlbar.stop-available-after":"&#x6700;&#x77ED;&#x8BB0;&#x5F55;&#x65F6;&#x95F4;&#x662F;&#xFF05;d&#x79D2;","ba-videorecorder-controlbar.cancel":"&#x53D6;&#x6D88;","ba-videorecorder-controlbar.cancel-tooltip":"&#x70B9;&#x51FB;&#x8FD9;&#x91CC;&#x53D6;&#x6D88;&#x3002;","ba-videorecorder.cancel-confirm":"&#x4F60;&#x771F;&#x7684;&#x60F3;&#x53D6;&#x6D88;&#x4F60;&#x7684;&#x89C6;&#x9891;&#x4E0A;&#x4F20;&#xFF1F;","ba-videoplayer-adslot.elapsed-time":"&#x5443;&#x65F6;&#x95F4;","ba-videoplayer-adslot.volume-button":"&#x8BBE;&#x7F6E;&#x97F3;&#x91CF;","ba-videoplayer-adslot.volume-mute":"&#x9759;&#x97F3;","ba-videoplayer-adslot.volume-unmute":"&#x53D6;&#x6D88;&#x9759;&#x97F3;","ba-videoplayer-adslot.ad-will-end-after":"&#x5E7F;&#x544A;&#x5C06;&#x5728;&#xFF05;s&#x4E4B;&#x540E;&#x7ED3;&#x675F;","ba-videoplayer-adslot.can-skip-after":"&#x5728;&#xFF05;d&#x4E4B;&#x540E;&#x8DF3;&#x8FC7;","ba-videoplayer-adslot.skip-ad":"&#x8DF3;&#x8FC7;&#x5E7F;&#x544A;","ba-videorecorder.software-required":"&#x8BF7;&#x70B9;&#x51FB;&#x4E0B;&#x9762;&#x7684;&#x5B89;&#x88C5;/&#x6FC0;&#x6D3B;&#x4EE5;&#x4E0B;&#x8981;&#x6C42;&#x624D;&#x80FD;&#x7EE7;&#x7EED;&#x3002;","ba-videorecorder.software-waiting":"&#x7B49;&#x5F85;&#x8981;&#x6C42;&#x5B89;&#x88C5;/&#x6FC0;&#x6D3B;&#x3002;&#x5B8C;&#x6210;&#x540E;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5237;&#x65B0;&#x9875;&#x9762;&#x3002;"},"language:zh-tw":{"ba-videoplayer-playbutton.tooltip":"&#x9EDE;&#x9078;&#x64AD;&#x653E;","ba-videoplayer-playbutton.rerecord":"&#x91CD;&#x8A66;","ba-videoplayer-playbutton.submit-video":"&#x78BA;&#x8A8D;","ba-videoplayer-loader.tooltip":"&#x8B80;&#x53D6;&#x4E2D;...","ba-videoplayer-controlbar.change-resolution":"&#x8B8A;&#x66F4;&#x89E3;&#x6790;&#x5EA6;","ba-videoplayer-controlbar.video-progress":"&#x9032;&#x5EA6;","ba-videoplayer-controlbar.rerecord-video":"&#x91CD;&#x8A66;?","ba-videoplayer-controlbar.submit-video":"&#x78BA;&#x8A8D;","ba-videoplayer-controlbar.play-video":"&#x64AD;&#x653E;","ba-videoplayer-controlbar.pause-video":"&#x66AB;&#x505C;","ba-videoplayer-controlbar.elapsed-time":"&#x7D93;&#x904E;&#x6642;&#x9593;","ba-videoplayer-controlbar.total-time":"&#x7E3D;&#x9577;&#x5EA6;","ba-videoplayer-controlbar.fullscreen-video":"&#x9032;&#x5165;&#x5168;&#x87A2;&#x5E55;","ba-videoplayer-controlbar.volume-button":"&#x8ABF;&#x6574;&#x97F3;&#x91CF;","ba-videoplayer-controlbar.volume-mute":"&#x975C;&#x97F3;","ba-videoplayer-controlbar.volume-unmute":"&#x89E3;&#x9664;&#x975C;&#x97F3;","ba-videoplayer.video-error":"&#x932F;&#x8AA4;&#x767C;&#x751F;&#xFF0C;&#x8ACB;&#x7A0D;&#x5F8C;&#x518D;&#x8A66;(&#x9EDE;&#x6211;)","ba-videorecorder-chooser.record-video":"&#x9304;&#x88FD;&#x5F71;&#x7247;","ba-videorecorder-chooser.upload-video":"&#x4E0A;&#x50B3;&#x5F71;&#x7247;","ba-videorecorder-controlbar.settings":"&#x8A2D;&#x5B9A;&#x503C;","ba-videorecorder-controlbar.camerahealthy":"&#x5149;&#x7DDA;&#x826F;&#x597D;","ba-videorecorder-controlbar.cameraunhealthy":"&#x5149;&#x6E90;&#x4E0D;&#x4F73;","ba-videorecorder-controlbar.microphonehealthy":"&#x6536;&#x97F3;&#x826F;&#x597D;","ba-videorecorder-controlbar.microphoneunhealthy":"&#x6536;&#x97F3;&#x4E0D;&#x826F;","ba-videorecorder-controlbar.record":"&#x9304;&#x5F71;","ba-videorecorder-controlbar.record-tooltip":"&#x9EDE;&#x6211;&#x9304;&#x5F71;","ba-videorecorder-controlbar.rerecord":"&#x91CD;&#x8A66;","ba-videorecorder-controlbar.rerecord-tooltip":"&#x9EDE;&#x6211;&#x91CD;&#x8A66;","ba-videorecorder-controlbar.upload-covershot":"&#x4E0A;&#x50B3;","ba-videorecorder-controlbar.upload-covershot-tooltip":"&#x9EDE;&#x6211;&#x4E0A;&#x50B3;&#x81EA;&#x8A02;&#x7684;&#x5C01;&#x9762;","ba-videorecorder-controlbar.stop":"&#x505C;&#x6B62;","ba-videorecorder-controlbar.stop-tooltip":"&#x9EDE;&#x6211;&#x505C;&#x6B62;","ba-videorecorder-controlbar.skip":"&#x7565;&#x904E;","ba-videorecorder-controlbar.skip-tooltip":"&#x9EDE;&#x6211;&#x7565;&#x904E;","ba-videorecorder.recorder-error":"&#x932F;&#x8AA4;&#x767C;&#x751F;&#xFF0C;&#x8ACB;&#x7A0D;&#x5F8C;&#x518D;&#x8A66;(&#x9EDE;&#x6211;)","ba-videorecorder.attach-error":"&#x7121;&#x6CD5;&#x5B58;&#x53D6;&#x651D;&#x5F71;&#x6A5F;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x700F;&#x89BD;&#x5668;&#x6216;&#x662F;&#x88DD;&#x7F6E;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x8ACB;&#x5617;&#x8A66;&#x5B89;&#x88DD; Flash &#x5916;&#x639B;&#x7A0B;&#x5F0F;&#x6216;&#x900F;&#x904E;&#x5B89;&#x5168;&#x9023;&#x7DDA;&#x4F86;&#x4F7F;&#x7528;&#x3002;","ba-videorecorder.access-forbidden":"&#x7121;&#x6CD5;&#x5B58;&#x53D6;&#x651D;&#x5F71;&#x6A5F;&#xFF0C;&#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x8A66;&#x3002;","ba-videorecorder.pick-covershot":"&#x8ACB;&#x6311;&#x9078;&#x4E00;&#x5F35;&#x5C01;&#x9762;","ba-videorecorder.uploading":"&#x4E0A;&#x50B3;&#x4E2D;","ba-videorecorder.uploading-failed":"&#x4E0A;&#x50B3;&#x5931;&#x6557;&#xFF0C;&#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x8A66;","ba-videorecorder.verifying":"&#x9A57;&#x8B49;&#x4E2D;","ba-videorecorder.verifying-failed":"&#x9A57;&#x8B49;&#x5931;&#x6557;&#xFF0C;&#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x8A66;","ba-videorecorder.rerecord-confirm":"&#x78BA;&#x5B9A;&#x8981;&#x91CD;&#x65B0;&#x9304;&#x88FD;&#x60A8;&#x7684;&#x5F71;&#x7247;?","ba-videorecorder.video_file_too_large":"&#x60A8;&#x7684;&#x5F71;&#x7247;&#x904E;&#x5927; (%s) &#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x65B0;&#x9078;&#x64C7;&#x5C0F;&#x4E00;&#x9EDE;&#x5F71;&#x7247;&#x518D;&#x8A66;&#x4E00;&#x6B21;&#x3002;","ba-videorecorder.unsupported_video_type":"&#x8ACB;&#x4F7F;&#x7528;&#x5F71;&#x7247;&#x683C;&#x5F0F;: %s - &#x9EDE;&#x6211;&#x91CD;&#x8A66;","ba-videoplayer-controlbar.exit-fullscreen-video":"&#x7D50;&#x675F;&#x5168;&#x87A2;&#x5E55;","ba-videoplayer-share.share":"&#x5206;&#x4EAB;","ba-videoplayer-controlbar.pause-video-disabled":"&#x7121;&#x6CD5;&#x66AB;&#x505C;","ba-videorecorder-chooser.record-audio":"&#x9304;&#x97F3;","ba-videorecorder-chooser.record-screen":"&#x8A18;&#x9304;&#x5C4F;&#x5E55;","ba-videorecorder-controlbar.stop-available-after":"&#x6700;&#x77ED;&#x8A18;&#x9304;&#x6642;&#x9593;&#x662F;&#xFF05;d&#x79D2;","ba-videorecorder-controlbar.cancel":"&#x53D6;&#x6D88;","ba-videorecorder-controlbar.cancel-tooltip":"&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x53D6;&#x6D88;&#x3002;","ba-videorecorder.cancel-confirm":"&#x4F60;&#x771F;&#x7684;&#x60F3;&#x53D6;&#x6D88;&#x4F60;&#x7684;&#x8996;&#x983B;&#x4E0A;&#x50B3;&#xFF1F;","ba-videoplayer-adslot.elapsed-time":"&#x5443;&#x6642;&#x9593;","ba-videoplayer-adslot.volume-button":"&#x8A2D;&#x7F6E;&#x97F3;&#x91CF;","ba-videoplayer-adslot.volume-mute":"&#x975C;&#x97F3;","ba-videoplayer-adslot.volume-unmute":"&#x53D6;&#x6D88;&#x975C;&#x97F3;","ba-videoplayer-adslot.ad-will-end-after":"&#x5EE3;&#x544A;&#x5C07;&#x5728;&#xFF05;s&#x4E4B;&#x5F8C;&#x7D50;&#x675F;","ba-videoplayer-adslot.can-skip-after":"&#x5728;&#xFF05;d&#x4E4B;&#x5F8C;&#x8DF3;&#x904E;","ba-videoplayer-adslot.skip-ad":"&#x8DF3;&#x904E;&#x5EE3;&#x544A;","ba-videorecorder.software-required":"&#x8ACB;&#x9EDE;&#x64CA;&#x4E0B;&#x9762;&#x7684;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x4EE5;&#x4E0B;&#x8981;&#x6C42;&#x624D;&#x80FD;&#x7E7C;&#x7E8C;&#x3002;","ba-videorecorder.software-waiting":"&#x7B49;&#x5F85;&#x8981;&#x6C42;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x3002;&#x5B8C;&#x6210;&#x5F8C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5237;&#x65B0;&#x9801;&#x9762;&#x3002;"}};
    for (var language in languages)
        Assets.strings.register(languages[language], [language]);
    return {};
});

Scoped.define("module:PopupHelper", ["base:Class","base:Events.EventsMixin","browser:Dom","browser:Events"], function (Class, EventsMixin, Dom, DomEvents, scoped) {

    var PopupHelper = Class.extend({
        scoped: scoped
    }, [EventsMixin, function(inherited) {
        return {

            constructor: function(options) {
                inherited.constructor.call(this);

                this.popupContainer = document.createElement("div");
                this.backgroundContainer = document.createElement("div");
                this.backgroundContainer.className = "ba-popup-helper-overlay-background";
                this.popupContainer.appendChild(this.backgroundContainer);
                this.overlayContainer = document.createElement("div");
                this.overlayContainer.className = "ba-popup-helper-overlay";
                this.popupContainer.appendChild(this.overlayContainer);
                this.containerInner = document.createElement("div");
                this.containerInner.className = "ba-popup-helper-overlay-inner";
                this.overlayContainer.appendChild(this.containerInner);

                this.domEvents = this.auto_destroy(new DomEvents());
                this.domEvents.on(this.backgroundContainer, "click touchstart", function() {
                    this.hide();
                }, this);
                this.domEvents.on(this.containerInner, "click touchstart", function(event) {
                    event.stopPropagation();
                });
            },

            show: function() {
                Dom.elementAddClass(document.body, "ba-popup-helper-overlay-body");
                document.body.appendChild(this.popupContainer);
                this.trigger("show");
            },

            hide: function() {
                var popupContainer = this.popupContainer;
                this.trigger("hide");
                document.body.removeChild(popupContainer);
                Dom.elementRemoveClass(document.body, "ba-popup-helper-overlay-body");
            }

        };
    }], {

        mixin: function(inherited) {
            return {

                constructor: function(options) {
                    options = options || {};
                    this.__popup = new PopupHelper(options.popup);
                    this.__popup.on("hide", this.destroy, this);
                    options.element = this.__popup.containerInner;
                    inherited.constructor.call(this, options);
                },

                activate: function() {
                    this.__popup.show();
                    inherited.activate.call(this);
                },

                destroy: function() {
                    this.__popup.destroy();
                    inherited.destroy.call(this);
                }

            };
        }

    });

    return PopupHelper;
});

Scoped.define("module:VideoPlayer.Dynamics.Adplayer", ["dynamics:Dynamic","base:TimeFormat","base:Timers","browser:Dom","media:Player.VideoPlayerWrapper","module:Assets"], function (Class, TimeFormat, Timers, Dom, VideoPlayerWrapper, Assets, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<video class=\"{{css}}-video\" data-video=\"video\"></video>\n<div class=\"{{css}}-ad-dashboard\">\n    <div class=\"{{css}}-ad-click-tracker\" ba-click=\"{{ad_clicked()}}\"></div>\n    <div class=\"{{css}}-skipbutton-container\" ba-click=\"{{skip_linear_ad()}}\"  ba-show=\"{{skipbuttonvisible}}\">\n        <p class=\"{{css}}-skipbutton\">{{lefttillskip > 0 ? string('can-skip-after').replace('%d', lefttillskip) : string('skip-ad')}}</p>\n    </div>\n\n    <div class=\"{{css}}-companion-ad-container\" ba-show=\"{{companionadvisible}}\">\n        <div class=\"{{css}}-close-companion-ad\" ba-click=\"{{skip_companion_ad()}}\">X</div>\n        <img class=\"{{css}}-companion-ad\" src=\"\"/>\n    </div>\n\n    <div class=\"{{css}}-ad-controlbar\">\n\n        <div class=\"{{css}}-ad-time-container\">\n            <div class=\"{{css}}-ad-time-value\" title=\"{{string('elapsed-time')}}\">{{string('ad-will-end-after').replace('%s', formatTime(adduration))}}</div>\n        </div>\n\n        <div class=\"{{css}}-ad-volumebar\">\n            <div data-selector=\"button-volume-bar\" class=\"{{css}}-ad-volumebar-inner\"\n                 onmousedown=\"{{startUpdateAdVolume(domEvent)}}\"\n                 onmouseup=\"{{stopUpdateAdVolume(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdateAdVolume(domEvent)}}\"\n                 onmousemove=\"{{progressUpdateAdVolume(domEvent)}}\">\n                <div class=\"{{css}}-ad-volumebar-position\" ba-styles=\"{{{width: Math.min(100, Math.round(advolume * 100)) + '%'}}}\">\n                    <div class=\"{{css}}-ad-volumebar-button\" title=\"{{string('volume-button')}}\"></div>\n                </div>\n            </div>\n        </div>\n\n        <div data-selector=\"button-icon-volume\" class=\"{{css}}-ad-rightbutton-container\" ba-click=\"{{toggle_ad_volume()}}\" title=\"{{string(advolume > 0 ? 'volume-mute' : 'volume-unmute')}}\">\n            <div class=\"{{css}}-ad-button-inner\">\n                <i class=\"{{css + '-icon-volume-' + (advolume >= 0.5 ? 'up' : (advolume > 0 ? 'down' : 'off')) }}\"></i>\n            </div>\n        </div>\n\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-adplayer",
                    "lefttillskip": -1,
                    "adduration": 0,
                    "duration": 0,
                    "advolume": 1.0,
                    "adplaying": false,
                    "companionadvisible": false,
                    "skipbuttonvisible": false,
                    "canskip": false,
                    "adskiped": false,
                    "disablepause": false
                },

                functions: {

                    formatTime: function(time) {
                        time = Math.max(time || 0, 1);
                        return TimeFormat.format(TimeFormat.ELAPSED_MINUTES_SECONDS, time * 1000);
                    },

                    startUpdateAdVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateAdVolume", true);
                        this.call("progressUpdateAdVolume", event);
                    },

                    progressUpdateAdVolume: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updateAdVolume"))
                            return;
                        var clientX = ev.clientX;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("advolume", (clientX - offset.left) / (dimensions.width || 1));
                        this.trigger("advolume", this.get("advolume"));
                    },

                    stopUpdateAdVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", false);
                    },

                    play_ad: function() {
                        this.trigger("playad");
                    },

                    pause_ad: function() {
                        this.trigger("pausead");
                        this._pauseLinearAd();
                    },

                    toggle_ad_volume: function() {
                        if (this.get("advolume") > 0) {
                            this.__oldVolume = this.get("advolume");
                            this.set("advolume", 0);
                        } else
                            this.set("advolume", this.__oldVolume || 1);
                        this.trigger("advolume", this.get("advolume"));
                    },

                    skip_linear_ad: function() {
                        if (!this.get("canskip") && this._vast)
                            return;
                        this.set("adskiped", true);
                        this._vast.trigger("resumeplayer");
                    },

                    skip_companion_ad: function() {},

                    ad_clicked: function() {
                        if (this._vast.vastTracker) {
                            this._vast.vastTracker.clickAd();
                        }
                    }
                },

                create: function() {
                    this._vast.once("vastready", function() {
                        this._adBehaviour();
                    }, this);
                    this._vast.once("adcanceled", function() {
                        this._preroll._adSkipped();
                    }, this);
                },

                _adBehaviour: function() {
                    var _adElementHolder, _source, _duration, _volume;

                    _adElementHolder = this.activeElement().querySelector("video");
                    _duration = this._vast.vastTracker.assetDuration;
                    _source = this._vast.sources[0];

                    if (this._vast.skipAdAfter && this._vast.skipAdAfter > 0) {
                        this.set("skipbuttonvisible", true);
                        this.set("lefttillskip", this._vast.skipAdAfter);
                    }

                    this._attachLinearAd(_adElementHolder, _source, _duration);

                    this._vast.on("resumeplayer", function() {

                        this._stopLinearAd();

                        this._timer.weakDestroy();

                        if (this.get("adskiped")) {
                            this._vast.vastTracker.skipAd();
                            this._preroll._adSkipped();
                        } else {
                            this._vast.vastTracker.completeAd();
                            this._preroll._adFinished();
                        }

                    }, this);

                    this.on("pausead", function() {
                        if (!this._timer || !this.__adPlayer)
                            return;
                        this._timer.stop();
                        this.__adPlayer.pause();
                        this.set("adplaying", false);
                    });

                    this.on("playad", function() {
                        if (!this._timer || !this.__adPlayer)
                            return;
                        this._timer.start();
                        this.__adPlayer.play();
                        this.set("adplaying", true);
                    });

                    this.on("advolume", function() {
                        if (!this.__adPlayer)
                            return;
                        _volume = Math.min(1.0, this.get("advolume"));
                        this.__adPlayer.setVolume(_volume);
                        this.__adPlayer.setMuted(_volume <= 0.0);
                    });
                },

                _attachLinearAd: function(element, source, duration) {
                    VideoPlayerWrapper.create({
                        element: element,
                        source: source.src,
                        type: source.type
                    }).error(function(err) {
                        // trigger error related to loading video content
                        this._vast.trigger("resumeplayer");
                    }, this).success(function(instance) {
                        this.__adPlayer = instance;
                        duration = isNaN(duration) ? this.get("maxadduration") : duration;
                        this.set("adduration", duration);


                        this._playLinearAd();
                        this._timer = new Timers.Timer({
                            context: this,
                            fire: this._timerFire,
                            delay: 1000,
                            start: true
                        });
                    }, this);
                },

                _timerFire: function() {
                    var _timeLeft, _leftTillSkip;
                    _timeLeft = this.get("adduration");
                    _leftTillSkip = this.get("lefttillskip") || -1;

                    this.set("adduration", --_timeLeft);

                    if (_leftTillSkip >= 0) {
                        this.set("skipbuttonvisible", true);
                        this.set("lefttillskip", --_leftTillSkip);

                        if (_leftTillSkip === 0)
                            this.set("canskip", true);
                    }

                    this._vast.vastTracker.setAdProgress(_timeLeft);

                    if (this.get("adduration") === 0) {
                        this._vast.trigger("resumeplayer");
                    }
                },

                _playLinearAd: function() {
                    this.__adPlayer.play();
                    this.set("adplaying", true);
                    this._vast.trigger("adplaying");
                },

                _pauseLinearAd: function() {
                    if (!this.get("adplaying")) {
                        this.__adPlayer.pause();
                        this.set("adplaying", false);
                        this._vast.vastTracker.setAdPaused(true);
                        this._vast.trigger("adpaused");
                        this._vast.once("playad", function() {
                            this._vast.vastTracker.setAdPaused(false);
                        }, this);
                    }
                },

                _stopLinearAd: function() {
                    if (this.__adPlayer && this.get("adplaying")) {
                        this.__adPlayer.pause();
                        this.set("adplaying", false);
                    }
                },

                skip_ad: function() {
                    if (this.__adPlayer)
                        this.trigger("resumeplayer");
                }
            };
        })
        .register("ba-videoplayer-adslot")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "ad_clicked()": function (obj) { with (obj) { return ad_clicked(); } }, "skip_linear_ad()": function (obj) { with (obj) { return skip_linear_ad(); } }, "skipbuttonvisible": function (obj) { with (obj) { return skipbuttonvisible; } }, "lefttillskip > 0 ? string('can-skip-after').replace('%d', lefttillskip) : string('skip-ad')": function (obj) { with (obj) { return lefttillskip > 0 ? string('can-skip-after').replace('%d', lefttillskip) : string('skip-ad'); } }, "companionadvisible": function (obj) { with (obj) { return companionadvisible; } }, "skip_companion_ad()": function (obj) { with (obj) { return skip_companion_ad(); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "string('ad-will-end-after').replace('%s', formatTime(adduration))": function (obj) { with (obj) { return string('ad-will-end-after').replace('%s', formatTime(adduration)); } }, "startUpdateAdVolume(domEvent)": function (obj) { with (obj) { return startUpdateAdVolume(domEvent); } }, "stopUpdateAdVolume(domEvent)": function (obj) { with (obj) { return stopUpdateAdVolume(domEvent); } }, "progressUpdateAdVolume(domEvent)": function (obj) { with (obj) { return progressUpdateAdVolume(domEvent); } }, "{width: Math.min(100, Math.round(advolume * 100)) + '%'}": function (obj) { with (obj) { return {width: Math.min(100, Math.round(advolume * 100)) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_ad_volume()": function (obj) { with (obj) { return toggle_ad_volume(); } }, "string(advolume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(advolume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (advolume >= 0.5 ? 'up' : (advolume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (advolume >= 0.5 ? 'up' : (advolume > 0 ? 'down' : 'off')); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "elapsed-time": "Elasped time",
            "volume-button": "Set volume",
            "volume-mute": "Mute sound",
            "volume-unmute": "Unmute sound",
            "ad-will-end-after": "Ad will end after %s",
            "can-skip-after": "Skip after %d",
            "skip-ad": "Skip ad"
        });
});

Scoped.define("module:VideoPlayer.Dynamics.Controlbar", ["dynamics:Dynamic","base:TimeFormat","base:Comparators","browser:Dom","module:Assets","browser:Info","media:Player.Support","base:Async"], ["dynamics:Partials.StylesPartial","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.ClickPartial"], function (Class, TimeFormat, Comparators, Dom, Assets, Info, PlayerSupport, Async, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-dashboard {{activitydelta > hidebarafter && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\t<div tabindex=\"{{skipinitial ? 2 : 1}}\" data-selector=\"progress-bar-inner\" class=\"{{css}}-progressbar {{activitydelta < 2500 || ismobile ? '' : (css + '-progressbar-small')}} {{disableseeking ? css + '-disabled' : ''}}\"\n\t\t ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n\t\t ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n         ba-hotkey:alt+right=\"{{seek(position + skipseconds * 3)}}\"\n         ba-hotkey:alt+left=\"{{seek(position - skipseconds * 3)}}\"\n\t\t onmouseout=\"this.blur()\"\n\t     onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n\t     onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n\t     onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n\t     onmousemove=\"{{progressUpdatePosition(domEvent)}}\">\n\t\t<div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n\t\t<div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\">\n\t\t\t<div class=\"{{css}}-progressbar-button\"></div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"{{css}}-backbar\"></div>\n\n\t<div class=\"{{css}}-controlbar\">\n\n        <div tabindex=\"0\" data-selector=\"submit-video-button\"\n\t\t\t ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\"\n\t\t\t ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\">\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-video')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\" ba-if=\"{{rerecordable}}\"\n\t\t\t ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-video')}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 2}}\" data-selector=\"button-icon-play\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_player()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\" title=\"{{string('play-video')}}\"\n\t\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\" ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-play\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 2}}\" data-selector=\"button-icon-pause\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_player()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container {{disablepause ? css + '-disabled' : ''}}\"\n\t\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\" ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\"\n\t\t\t title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-pause\"></i>\n            </div>\n        </div>\n\n\t\t<div class=\"{{css}}-time-container\">\n\t\t\t<div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n\t\t\t<div class=\"{{css}}-time-sep\">/</div>\n\t\t\t<div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n\t\t</div>\n\n\t\t<div data-selector=\"video-title-block\" class=\"{{css}}-video-title-container\" ba-if=\"{{title}}\">\n\t\t\t<p class=\"{{css}}-video-title\">\n\t\t\t\t{{title}}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div tabindex=\"9\" data-selector=\"cc-button-container\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n\t\t\t ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n\t\t\t class=\"{{css}}-rightbutton-container  {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n\t\t\t title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n\t\t\t ba-click=\"{{toggle_tracks()}}\"\n\t\t\t onmouseover=\"{{hover_cc(true)}}\"\n\t\t\t onmouseleave=\"{{hover_cc(false)}}\"\n\t\t>\n\t\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t\t<i class=\"{{css}}-icon-subtitle\"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-rightbutton-container\"\n\t\t\t onkeydown=\"{{tab_index_move(domEvent)}}\" ba-if=\"{{fullscreen}}\"\n\t\t\t ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\">\n\t\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t\t<i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\n        <div tabindex=\"7\" data-selector=\"button-airplay\"\n\t\t\t ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-rightbutton-container\"\n\t\t\t ba-show=\"{{airplaybuttonvisible}}\" ba-click=\"{{show_airplay_devices()}}\">\n            <div class=\"{{css}}-airplay-container\">\n                <svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                    <!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n                    <title>Airplay</title>\n                    <desc>Airplay icon.</desc>\n                    <defs></defs>\n                    <g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n                        <path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n                    </g>\n                </svg>\n            </div>\n        </div>\n\n        <div data-selector=\"button-chromecast\" class=\"{{css}}-rightbutton-container {{css}}-cast-button-container\" ba-show=\"{{castbuttonvisble}}\">\n            <button tabindex=\"0\" class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n        </div>\n\n        <div tabindex=\"6\" data-selector=\"button-stream-label\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-rightbutton-container\"\n\t\t\t ba-if=\"{{streams.length > 1 && currentstream}}\" ba-click=\"{{toggle_stream()}}\"\n\t\t\t title=\"{{string('change-resolution')}}\"\n\t\t>\n\t\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t\t<span class=\"{{css}}-button-text\">{{currentstream_label}}</span>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"{{css}}-volumebar\">\n\t\t\t<div tabindex=\"5\" data-selector=\"button-volume-bar\"\n\t\t\t\t ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\" ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n\t\t\t\t ba-hotkey:up=\"{{set_volume(1)}}\" ba-hotkey:down=\"{{set_volume(0)}}\"\n\t\t\t\t onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-volumebar-inner\"\n\t\t\t     onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                 onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n\t\t\t>\n\t\t\t\t<div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.min(100, Math.round(volume * 100)) + '%'}}}\">\n\t\t\t\t    <div class=\"{{css}}-volumebar-button\" title=\"{{string('volume-button')}}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div tabindex=\"4\" data-selector=\"button-icon-volume\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-rightbutton-container\"\n\t\t\t ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\">\n\t\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t\t<i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-videoplayer",
                    "csscommon": "ba-commoncss",
                    "duration": 0,
                    "position": 0,
                    "cached": 0,
                    "volume": 1.0,
                    "expandedprogress": true,
                    "playing": false,
                    "rerecordable": false,
                    "submittable": false,
                    "streams": [],
                    "currentstream": null,
                    "fullscreen": true,
                    "fullscreened": false,
                    "activitydelta": 0,
                    "hidebarafter": 5000,
                    "preventinteraction": false,
                    "title": "",
                    "allowtexttrackupload": false,
                    "tracktextvisible": false // Are subtitles visible?
                },

                computed: {
                    "currentstream_label:currentstream": function() {
                        var cs = this.get("currentstream");
                        return cs ? (cs.label ? cs.label : PlayerSupport.resolutionToLabel(cs.width, cs.height)) : "";
                    }
                },

                functions: {

                    formatTime: function(time) {
                        time = Math.max(time || 0, 1);
                        return TimeFormat.format(TimeFormat.ELAPSED_MINUTES_SECONDS, time * 1000);
                    },

                    startUpdatePosition: function(event) {
                        if (this.get("disableseeking")) return;
                        event[0].preventDefault();
                        this.set("_updatePosition", true);
                        this.call("progressUpdatePosition", event);
                    },

                    progressUpdatePosition: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updatePosition"))
                            return;
                        var clientX = ev.clientX;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("position", this.get("duration") * (clientX - offset.left) / (dimensions.width || 1));

                        var player = this.__parent.player;
                        if (player._broadcastingState.googleCastConnected) {
                            player.trigger('google-cast-seeking', this.get("position"));
                            return;
                        }

                        this.trigger("position", this.get("position"));
                    },

                    stopUpdatePosition: function(event) {
                        event[0].preventDefault();
                        this.set("_updatePosition", false);
                    },

                    startUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", true);
                        this.call("progressUpdateVolume", event);
                    },

                    progressUpdateVolume: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updateVolume"))
                            return;
                        var clientX = ev.clientX;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("volume", (clientX - offset.left) / (dimensions.width || 1));
                        this.trigger("volume", this.get("volume"));
                    },

                    stopUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", false);
                    },

                    startVerticallyUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", true);
                        this.call("progressVerticallyUpdateVolume", event);
                    },

                    progressVerticallyUpdateVolume: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updateVolume"))
                            return;
                        var pageY = ev.pageY;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("volume", 1 - (pageY - offset.top) / dimensions.height);
                        this.trigger("volume", this.get("volume"));
                    },

                    stopVerticallyUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", false);
                    },


                    play: function() {
                        this.trigger("play");
                    },

                    pause: function() {
                        this.trigger("pause");
                    },

                    toggle_player: function() {
                        this.trigger("toggle_player");
                    },

                    toggle_volume: function() {
                        if (this.get("volume") > 0) {
                            this.__oldVolume = this.get("volume");
                            this.set("volume", 0);
                        } else
                            this.set("volume", this.__oldVolume || 1);
                        this.trigger("volume", this.get("volume"));
                    },

                    toggle_fullscreen: function() {
                        this.trigger("fullscreen");
                    },

                    rerecord: function() {
                        this.trigger("rerecord");
                    },

                    seek: function(position) {
                        this.trigger("seek", position);
                    },

                    set_volume: function(volume) {
                        this.trigger("set_volume", volume);
                    },

                    submit: function() {
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                        this.trigger("submit");
                    },

                    toggle_stream: function() {
                        var streams = this.get("streams");
                        var current = streams.length - 1;
                        streams.forEach(function(stream, i) {
                            if (Comparators.deepEqual(stream, this.get("currentstream")))
                                current = i;
                        }, this);
                        this.set("currentstream", streams[(current + 1) % streams.length]);
                    },

                    show_airplay_devices: function() {
                        var dynamic = this.__parent;
                        if (dynamic.player._broadcastingState.airplayConnected) {
                            dynamic._broadcasting.lookForAirplayDevices(dynamic.player._element);
                        }
                    },

                    toggle_tracks: function() {
                        return this.parent().toggleTrackTags(!this.get('tracktextvisible'));
                    },

                    hover_cc: function(hover) {
                        Async.eventually(function() {
                            this.parent().set("tracksshowselection", hover);
                        }, this, 300);
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        this.trigger("tab_index_move", ev[0], nextSelector, focusingSelector);
                    }
                },

                create: function() {
                    this.set("ismobile", Info.isMobile());
                }
            };
        })
        .register("ba-videoplayer-controlbar")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > hidebarafter && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > hidebarafter && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "skipinitial ? 2 : 1": function (obj) { with (obj) { return skipinitial ? 2 : 1; } }, "activitydelta < 2500 || ismobile ? '' : (css + '-progressbar-small')": function (obj) { with (obj) { return activitydelta < 2500 || ismobile ? '' : (css + '-progressbar-small'); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "seek(position + skipseconds * 3)": function (obj) { with (obj) { return seek(position + skipseconds * 3); } }, "seek(position - skipseconds * 3)": function (obj) { with (obj) { return seek(position - skipseconds * 3); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "skipinitial ? 0 : 2": function (obj) { with (obj) { return skipinitial ? 0 : 2; } }, "toggle_player()": function (obj) { with (obj) { return toggle_player(); } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "play()": function (obj) { with (obj) { return play(); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "playing": function (obj) { with (obj) { return playing; } }, "pause()": function (obj) { with (obj) { return pause(); } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "title": function (obj) { with (obj) { return title; } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "set_volume(1)": function (obj) { with (obj) { return set_volume(1); } }, "set_volume(0)": function (obj) { with (obj) { return set_volume(0); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.min(100, Math.round(volume * 100)) + '%'}": function (obj) { with (obj) { return {width: Math.min(100, Math.round(volume * 100)) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "video-progress": "Progress",
            "rerecord-video": "Redo?",
            "submit-video": "Confirm",
            "play-video": "Play",
            "pause-video": "Pause",
            "pause-video-disabled": "Pause not supported",
            "elapsed-time": "Elasped time",
            "total-time": "Total length of",
            "fullscreen-video": "Enter fullscreen",
            "volume-button": "Set volume",
            "volume-mute": "Mute sound",
            "volume-unmute": "Unmute sound",
            "change-resolution": "Change resolution",
            "exit-fullscreen-video": "Exit fullscreen",
            "close-tracks": "Close CC",
            "show-tracks": "Show CC"
        });
});

Scoped.define("module:VideoPlayer.Dynamics.Loader", ["dynamics:Dynamic","module:Assets"], function (Class, Assets, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-loader-container\">\n    <div data-selector=\"loader-block\" class=\"{{css}}-loader-loader\" title=\"{{string('tooltip')}}\">\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-videoplayer"
                }

            };
        })
        .register("ba-videoplayer-loader")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "string('tooltip')": function (obj) { with (obj) { return string('tooltip'); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "tooltip": "Loading..."
        });
});

Scoped.define("module:VideoPlayer.Dynamics.Message", ["dynamics:Dynamic"], ["dynamics:Partials.ClickPartial"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"message-block\" class='{{css}}-message-message'>\n        {{message}}\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-videoplayer",
                    "message": ''
                },

                functions: {

                    click: function() {
                        this.trigger("click");
                    }

                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message": function (obj) { with (obj) { return message; } }/**/ })
        .register("ba-videoplayer-message");
});

Scoped.define("module:VideoPlayer.Dynamics.Playbutton", ["dynamics:Dynamic","module:Assets"], ["dynamics:Partials.ClickPartial"], function (Class, Assets, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div tabindex=\"0\" data-selector=\"play-button\"\n     ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n     onkeydown=\"{{tab_index_move(domEvent, null, 'player-toggle-overlay')}}\"\n     class=\"{{css}}-playbutton-container\" ba-click=\"{{play()}}\" title=\"{{string('tooltip')}}\"\n>\n\t<div class=\"{{css}}-playbutton-button\"></div>\n</div>\n\n<div class=\"{{css}}-rerecord-bar\" ba-if=\"{{rerecordable || submittable}}\">\n\t<div class=\"{{css}}-rerecord-backbar\"></div>\n\t<div class=\"{{css}}-rerecord-frontbar\">\n        <div class=\"{{css}}-rerecord-button-container\" ba-if=\"{{submittable}}\">\n            <div tabindex=\"0\" data-selector=\"player-submit-button\"\n                 ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-rerecord-button\" onclick=\"{{submit()}}\">\n                {{string('submit-video')}}\n            </div>\n        </div>\n        <div class=\"{{css}}-rerecord-button-container\" ba-if=\"{{rerecordable}}\">\n        \t<div tabindex=\"0\" data-selector=\"player-rerecord-button\"\n                 ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-rerecord-button\" onclick=\"{{rerecord()}}\">\n        \t\t{{string('rerecord')}}\n        \t</div>\n        </div>\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-videoplayer",
                    "rerecordable": false,
                    "submittable": false
                },

                functions: {

                    play: function() {
                        this.trigger("play");
                    },

                    submit: function() {
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                        this.trigger("submit");
                    },

                    rerecord: function() {
                        this.trigger("rerecord");
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        this.trigger("tab_index_move", ev[0], nextSelector, focusingSelector);
                    }
                }
            };
        })
        .register("ba-videoplayer-playbutton")
        .registerFunctions({ /**/"play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'player-toggle-overlay')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'player-toggle-overlay'); } }, "css": function (obj) { with (obj) { return css; } }, "string('tooltip')": function (obj) { with (obj) { return string('tooltip'); } }, "rerecordable || submittable": function (obj) { with (obj) { return rerecordable || submittable; } }, "submittable": function (obj) { with (obj) { return submittable; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "tooltip": "Click to play.",
            "rerecord": "Redo",
            "submit-video": "Confirm video"
        });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.State", ["base:States.State","base:Events.ListenMixin","base:Objs"], function (State, ListenMixin, Objs, scoped) {
    return State.extend({
        scoped: scoped
    }, [ListenMixin, {

        dynamics: [],

        _start: function() {
            this.dyn = this.host.dynamic;
            Objs.iter(Objs.extend({
                "loader": false,
                "message": false,
                "playbutton": false,
                "controlbar": false
            }, Objs.objectify(this.dynamics)), function(value, key) {
                this.dyn.set(key + "_active", value);
            }, this);
            this._started();
        },

        _started: function() {},

        play: function() {
            this.dyn.set("autoplay", true);
        },

        uploadTextTrack: function(file, locale) {
            try {
                this.next('TextTrackUploading', {
                    file: file,
                    locale: locale
                });
            } catch (e) {
                console.warn("Error switch to text track uploading state. Message: ", e);
                this.nextPlayer();
            }
        },

        nextPlayer: function() {
            var _recorder = this.dyn.parent();
            if (typeof _recorder.record === 'function')
                _recorder.host.state().next("Player");
            else
                this.next("LoadPlayer");
        }
    }]);
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.TextTrackUploading", ["module:VideoPlayer.Dynamics.PlayerStates.State","browser:Upload.FileUploader","browser:Upload.MultiUploader","browser:Blobs","base:Async","base:Objs"], function (State, FileUploader, MultiUploader, Blobs, Async, Objs, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        _locals: ["file", "locale"],
        dynamics: ['text-tracks', 'loading'],

        _started: function() {
            this.uploadTextTrackFile(this._file, this._locale);
        },

        uploadTextTrackFile: function(file, locale) {
            var _dynamics, _uploader, _initialTracks, _counter;
            _dynamics = this.dyn.parent();

            // Check either recorder or player dynamics
            if (typeof _dynamics.record !== 'function') {
                _dynamics = this.dyn;
            }
            _initialTracks = _dynamics.get('tracktags');

            // Get file url
            if (_dynamics.get("uploadoptions")) {
                filename = {
                    url: _dynamics.get("uploadoptions").textTracks
                };
            } else {
                filename = {
                    url: "/text-track/" + file.value.split(/(\\|\/)/g).pop() + "/lang/" + locale.lang + "/label/" + locale.label
                };
            }

            try {
                _uploader = FileUploader.create(Objs.extend({
                    source: file,
                    data: {
                        lang: locale.lang,
                        label: locale.label
                    }
                }, filename));
                _uploader.upload();

                _uploader.on("success", function(response) {
                    _counter = 1;
                    _dynamics.set("tracktags", null);
                    Blobs.loadFileIntoString(file).success(function(content) {
                        response = response.length > 0 ? JSON.parse(response) : {
                            lang: locale.lang,
                            label: locale.label
                        };

                        _initialTracks.push({
                            lang: response.lang,
                            label: response.label,
                            kind: "subtitles",
                            enabled: true,
                            content: content
                        });

                        Objs.iter(_initialTracks, function(value) {
                            if (_counter === _initialTracks.length) {
                                _dynamics.set("tracktags", _initialTracks);
                                this.nextPlayer();
                            }
                            _counter++;
                        }, this);

                    }, this);
                }, this);

                _uploader.on("error", function(e) {
                    var bestError = _dynamics.string("uploading-failed");
                    try {
                        e.forEach(function(ee) {
                            for (var key in ee)
                                if (_dynamics.string("upload-error-" + key))
                                    bestError = this.dyn.string("upload-error-" + key);
                        }, this);
                    } catch (err) {}
                    _dynamics.set("player_active", false);
                    this.next("FatalError", {
                        message: bestError,
                        retry: "Player"
                    });
                }, this);

                _uploader.on("progress", function(uploaded, total) {

                }, this);

            } catch (e) {
                console.warn('Error occurred during uploading text track files. Message: ', e);
            }
        }
    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.FatalError", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],
        _locals: ["message"],

        _started: function() {
            this.dyn.set("message", this._message || this.dyn.string("video-error"));
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.Initial", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            if (this.dyn.get("ready"))
                this.next("LoadPlayer");
            else {
                this.listenOn(this.dyn, "change:ready", function() {
                    this.next("LoadPlayer");
                });
            }
        }
    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.LoadPlayer", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            this.listenOn(this.dyn, "error:attach", function() {
                this.next("LoadError");
            }, this);
            this.listenOn(this.dyn, "error:poster", function() {
                if (!this.dyn.get("states").poster_error.ignore)
                    this.next("PosterError");
            }, this);
            this.listenOn(this.dyn, "attached", function() {
                this.next("PosterReady");
            }, this);
            this.dyn.reattachVideo();
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.LoadError", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],

        _started: function() {
            this.dyn.set("message", this.dyn.string("video-error"));
            this.listenOn(this.dyn, "message:click", function() {
                this.next("LoadPlayer");
            }, this);
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.PosterReady", ["module:VideoPlayer.Dynamics.PlayerStates.State","module:PopupHelper","base:Objs"], function (State, PopupHelper, Objs, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["playbutton"],

        _started: function() {
            this.listenOn(this.dyn, "error:poster", function() {
                if (!this.dyn.get("states").poster_error.ignore)
                    this.next("PosterError");
            }, this);
            if (this.dyn.get("autoplay") || this.dyn.get("skipinitial"))
                this.play();
        },

        play: function() {
            if (!this.dyn.get("popup")) {
                this.next("Preroll");
                return;
            }
            var popup = this.auto_destroy(new PopupHelper());
            var dynamic = this.auto_destroy(new this.dyn.cls({
                element: popup.containerInner,
                attrs: Objs.extend(this.dyn.cloneAttrs(), this.dyn.popupAttrs())
            }));
            this._delegatedPlayer = dynamic;
            this.dyn.delegateEvents(null, dynamic);
            popup.on("hide", function() {
                this._delegatedPlayer = null;
                dynamic.destroy();
                popup.destroy();
            }, this);
            popup.show();
            dynamic.activate();
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.Preroll", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: [],

        _started: function() {
            if (this.dyn._prerollAd) {
                this.dyn._prerollAd.once("finished", function() {
                    this.next("LoadVideo");
                }, this);
                this.dyn._prerollAd.once("adskipped", function() {
                    this.next("LoadVideo");
                }, this);
                // TODO: video height and width return NaN before ad start even when ba-width/ba-height are provided
                this.dyn._prerollAd.executeAd({
                    width: this.dyn.videoWidth(),
                    height: this.dyn.videoHeight()
                });
            } else
                this.next("LoadVideo");
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.PosterError", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],

        _started: function() {
            this.dyn.set("message", this.dyn.string("video-error"));
            this.listenOn(this.dyn, "message:click", function() {
                this.next(this.dyn.get("states").poster_error.click_play ? "LoadVideo" : "LoadPlayer");
            }, this);
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.LoadVideo", ["module:VideoPlayer.Dynamics.PlayerStates.State","base:Timers.Timer"], function (State, Timer, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            this.listenOn(this.dyn, "error:video", function() {
                this.next("ErrorVideo");
            }, this);
            this.listenOn(this.dyn, "playing", function() {
                if (this.destroyed() || this.dyn.destroyed())
                    return;
                if (this.dyn.get("autoseek"))
                    this.dyn.execute("seek", this.dyn.get("autoseek"));
                this.next("PlayVideo");
            }, this);
            if (this.dyn.get("skipinitial") && !this.dyn.get("autoplay"))
                this.next("PlayVideo");
            else {
                var counter = 10;
                this.auto_destroy(new Timer({
                    context: this,
                    fire: function() {
                        if (!this.destroyed() && !this.dyn.destroyed() && this.dyn.player)
                            this.dyn.player.play();
                        counter--;
                        if (counter === 0)
                            this.next("PlayVideo");
                    },
                    delay: 200,
                    immediate: true
                }));
            }
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.ErrorVideo", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],

        _started: function() {
            this.dyn.set("message", this.dyn.string("video-error"));
            this.listenOn(this.dyn, "message:click", function() {
                this.next("LoadVideo");
            }, this);
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.PlayVideo", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["controlbar"],

        _started: function() {
            this.dyn.set("autoplay", false);
            this.listenOn(this.dyn, "change:currentstream", function() {
                this.dyn.set("autoplay", true);
                this.dyn.set("autoseek", this.dyn.player.position());
                this.dyn.reattachVideo();
                this.next("LoadPlayer");
            }, this);
            this.listenOn(this.dyn, "ended", function() {
                this.dyn.set("autoseek", null);
                this.next("NextVideo");
            }, this);
            this.listenOn(this.dyn, "change:buffering", function() {
                this.dyn.set("loader_active", this.dyn.get("buffering"));
            }, this);
            this.listenOn(this.dyn, "error:video", function() {
                this.next("ErrorVideo");
            }, this);
        },

        play: function() {
            if (!this.dyn.get("playing"))
                this.dyn.player.play();
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.PlayerStates.NextVideo", ["module:VideoPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        _started: function() {
            if (this.dyn.get("playlist")) {
                var list = this.dyn.get("playlist");
                var head = list.shift();
                if (this.dyn.get("loop"))
                    list.push(head);
                this.dyn.set("playlist", list);
                if (list.length > 0) {
                    var pl0 = list[0];
                    this.dyn.set("poster", pl0.poster);
                    this.dyn.set("source", pl0.source);
                    this.dyn.set("sources", pl0.sources);
                    this.dyn.trigger("playlist-next", pl0);
                    this.dyn.reattachVideo();
                    this.dyn.set("autoplay", true);
                    this.next("LoadPlayer");
                    return;
                }
            }
            this.next("PosterReady");
        }

    });
});

Scoped.define("module:VideoPlayer.Dynamics.Share", ["dynamics:Dynamic","module:Assets"], function (Class, Assets, scoped) {

    var SHARES = {
        facebook: 'https://facebook.com/sharer/sharer.php?u=',
        twitter: 'https://twitter.com/home?status=',
        gplus: 'https://plus.google.com/share?url='
    };

    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div class=\"{{css}}-share-action-container\">\n    <div class=\"{{css}}-toggle-share-container\">\n        <div class=\"{{css}}-button-inner\" onclick=\"{{toggleShare()}}\">\n            <i class=\"{{css}}-icon-share\"></i>\n        </div>\n    </div>\n    <div class=\"{{css}}-social-buttons-container\">\n        <ul class=\"{{css}}-socials-list\" ba-repeat=\"{{share :: shares}}\">\n            <li class=\"{{css}}-single-social\">\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-{{share}}\" onclick=\"{{shareMedia(share)}}\"></i>\n                </div>\n            </li>\n        </ul>\n    </div>\n</div>\n",

                attrs: {
                    css: "ba-videoplayer",
                    url: "",
                    shares: []
                },

                functions: {

                    shareMedia: function(share) {
                        window.open(SHARES[share] + this.get("url"), 'pop', 'width=600 height=400');
                    },

                    toggleShare: function() {
                        /*
                        var container = this.activeElement().querySelector().firstElementChild;
                        container.style.right = container.style.right ? "" : "-45px";
                        */
                    }

                }
            };
        }).register("ba-videoplayer-share")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "toggleShare()": function (obj) { with (obj) { return toggleShare(); } }, "shares": function (obj) { with (obj) { return shares; } }, "share": function (obj) { with (obj) { return share; } }, "shareMedia(share)": function (obj) { with (obj) { return shareMedia(share); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "share": "Share media"
        });
});

Scoped.define("module:VideoPlayer.Dynamics.Topmessage", ["dynamics:Dynamic"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"topmessage-message-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-videoplayer",
                    "topmessage": ''
                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }/**/ })
        .register("ba-videoplayer-topmessage");
});

Scoped.define("module:VideoPlayer.Dynamics.Tracks", ["dynamics:Dynamic","base:Async","module:Assets"], ["dynamics:Partials.ClickPartial","dynamics:Partials.RepeatElementPartial"], function (Class, Async, Assets, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div data-selector=\"text-tracks-overlay\" class=\"{{css}}-text-tracks-overlay\">\n\n    <div data-selector=\"cue-content\" ba-show=\"{{tracktagsstyled && trackcuetext}}\" class=\"{{css}}-cue-content\">\n        {{trackcuetext}}\n    </div>\n    <div class=\"{{csscommon}}-options-popup {{csscommon}}-options-list-{{tracksshowselection || trackselectorhovered ? 'visible' : 'hidden'}}\">\n        <div ba-show=\"{{tracksshowselection || trackselectorhovered}}\" tabindex=\"-1\"\n             onmouseenter=\"{{hover_cc(domEvent, true)}}\" onmouseover=\"{{hover_cc(domEvent, true)}}\" onmouseleave=\"{{hover_cc(domEvent, false)}}\"\n        >\n            <div data-selector=\"tracks-selector-list\"\n                 class=\"{{csscommon}}-initial-options-list {{csscommon}}-tracks-selector-list {{csscommon}}-options-list-visible {{csscommon}}-options-list\"\n                 ba-if=\"{{tracktags}}\"\n            >\n                <div ba-repeat-element=\"{{track :: tracktags}}\"\n                     class=\"{{csscommon}}-tracks-selector {{csscommon}}-options-list-item\"\n                     ba-click=\"{{select_track(track)}}\"\n                >\n                    <div class=\"{{csscommon}}-inner-text\">\n                        {{track.label}}\n                    </div>\n                </div>\n                <div data-selector=\"text-tracks-open-form-button\"\n                     class=\"{{csscommon}}-options-list-item {{csscommon}}-open-next\"\n                     ba-if=\"{{allowtexttrackupload}}\" title=\"{{string('upload-text-tracks')}}\"\n                     onclick=\"{{move_to_option(domEvent, 'text-tracks-uploader-form')}}\"\n                >\n                    <div class=\"{{csscommon}}-inner-text\">{{string('upload-text-tracks')}}</div>\n                    <div class=\"{{csscommon}}-inner-icon\"></div>\n                </div>\n            </div>\n\n            <div data-selector=\"text-tracks-uploader-form\"\n                 class=\"{{csscommon}}-options-list-hidden {{csscommon}}-options-list {{csscommon}}-text-tracks-uploader-form\"\n                 ba-if=\"{{allowtexttrackupload}}\"\n            >\n                <div class=\"{{csscommon}}-full-width {{csscommon}}-options-list-item\">\n                    <div data-selector=\"close-text-tracks-upload-form\"\n                         title=\"{{string('back')}}\"\n                         class=\"{{csscommon}}-open-previous {{csscommon}}-text-left\"\n                         onclick=\"{{move_to_option(domEvent)}}\"\n                    >\n                        <div class=\"{{csscommon}}-inner-icon\"></div>\n                        <div class=\"{{csscommon}}-inner-text\">{{string('back')}}</div>\n                    </div>\n                </div>\n\n                <div class=\"{{csscommon}}-full-width {{csscommon}}-options-list-item\">\n                    <form class=\"{{csscommon}}-form {{csscommon}}-text-tracks-upload-form\">\n                        <div class=\"{{csscommon}}-form-input {{csscommon}}-select-field {{csscommon}}-direction-pointer\">\n                            <select data-selector=\"select-text-tracks-label\" tabindex=\"-1\"\n                                    class=\"{{csscommon}}-form-input {{csscommon}}-text-tracks-label-input\"\n                                    name=\"{{csscommon}}-text-tracks-label-select\"\n                                    onmousedown=\"{{prevent_un_hover(domEvent)}}\"\n                                    onmousemove=\"{{prevent_un_hover(domEvent)}}\"\n                                    onchange=\"{{selected_label_value(domEvent)}}\"\n                            >\n                                <option disabled value selected>\n                                    {{string('select-text-track-language')}}\n                                </option>\n                                <option ba-repeat-element=\"{{locale :: uploadlocales}}\" value=\"{{locale.lang}}\">\n                                    {{locale.label}}\n                                </option>\n                            </select>\n                        </div>\n                        <div class=\"{{csscommon}}-form-input {{csscommon}}-button\" ba-show=\"{{chosenoption}}\">\n                            <input type=\"file\" data-selector=\"select-text-tracks-file\"\n                                   title=\"{{chosenoption ? string('select-text-track-file') : string('info-select-locale-first')}}\"\n                                   onchange=\"{{upload_text_track(domEvent)}}\"\n                                   class=\"{{csscommon}}-text-tracks-file\"\n                                   accept=\"{{acceptedtracktexts}}\"\n                            />\n                            {{chosenoption ? string('select-text-track-file') : string('info-select-locale-first')}}\n                        </div>\n                    </form>\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-videoplayer",
                    "csscommon": "ba-commoncss",
                    "trackcuetext": null,
                    "acceptedtracktexts": "text/vtt,application/ttml+xml,type/subtype",
                    "trackselectorhovered": false,
                    "uploadtexttracksvisible": false,
                    "uploadlocales": [],
                    "chosenoption": null
                },

                functions: {
                    select_track: function(track) {
                        this.parent().set("trackselectorhovered", false);
                        this.parent().trigger("switch-track", track);
                    },

                    hover_cc: function(ev, hover) {
                        // Don't lose focus on clicking move between sliders
                        // After if element has an focus not close it till next mouseover/mouseleave
                        if (!hover && ev[0].target === document.activeElement) {
                            Async.eventually(function() {
                                ev[0].target.blur();
                            }, this, 500);
                            return;
                        }

                        // Show or hide overlay element on mouse out
                        return this.parent().set("trackselectorhovered", hover);
                    },

                    prevent_un_hover: function(ev) {
                        ev[0].target.blur();
                        var _parentSelector, _parentElement;
                        _parentSelector = "." + this.parent().get('csscommon') + '-options-popup';
                        _parentElement = document.querySelector(_parentSelector);
                        if (_parentElement)
                            _parentElement.focus();
                        return this.parent().set("trackselectorhovered", true);
                    },

                    selected_label_value: function(select) {
                        var _options, _chosen;
                        _options = select[0].target.options;
                        _chosen = _options[_options.selectedIndex];

                        if (_chosen.value) {
                            this.set("chosenoption", {
                                lang: _chosen.value,
                                label: _chosen.text
                            });
                        } else {
                            this.set("chosenoption", null);
                        }
                    },

                    upload_text_track: function(domEvent) {
                        if (this.get('chosenoption'))
                            this.trigger("upload-text-tracks", domEvent[0].target, this.get('chosenoption'));
                        else {
                            console.warn('can not send empty label');
                        }
                    },

                    move_to_option: function(domEvent, classSelector) {
                        this.trigger("move_to_option", domEvent[0].target, classSelector);
                    }
                }
            };
        })
        .register("ba-videoplayer-tracks")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "tracktagsstyled && trackcuetext": function (obj) { with (obj) { return tracktagsstyled && trackcuetext; } }, "trackcuetext": function (obj) { with (obj) { return trackcuetext; } }, "csscommon": function (obj) { with (obj) { return csscommon; } }, "tracksshowselection || trackselectorhovered ? 'visible' : 'hidden'": function (obj) { with (obj) { return tracksshowselection || trackselectorhovered ? 'visible' : 'hidden'; } }, "tracksshowselection || trackselectorhovered": function (obj) { with (obj) { return tracksshowselection || trackselectorhovered; } }, "hover_cc(domEvent, true)": function (obj) { with (obj) { return hover_cc(domEvent, true); } }, "hover_cc(domEvent, false)": function (obj) { with (obj) { return hover_cc(domEvent, false); } }, "tracktags": function (obj) { with (obj) { return tracktags; } }, "select_track(track)": function (obj) { with (obj) { return select_track(track); } }, "track.label": function (obj) { with (obj) { return track.label; } }, "allowtexttrackupload": function (obj) { with (obj) { return allowtexttrackupload; } }, "string('upload-text-tracks')": function (obj) { with (obj) { return string('upload-text-tracks'); } }, "move_to_option(domEvent, 'text-tracks-uploader-form')": function (obj) { with (obj) { return move_to_option(domEvent, 'text-tracks-uploader-form'); } }, "string('back')": function (obj) { with (obj) { return string('back'); } }, "move_to_option(domEvent)": function (obj) { with (obj) { return move_to_option(domEvent); } }, "prevent_un_hover(domEvent)": function (obj) { with (obj) { return prevent_un_hover(domEvent); } }, "selected_label_value(domEvent)": function (obj) { with (obj) { return selected_label_value(domEvent); } }, "string('select-text-track-language')": function (obj) { with (obj) { return string('select-text-track-language'); } }, "uploadlocales": function (obj) { with (obj) { return uploadlocales; } }, "locale.lang": function (obj) { with (obj) { return locale.lang; } }, "locale.label": function (obj) { with (obj) { return locale.label; } }, "chosenoption": function (obj) { with (obj) { return chosenoption; } }, "chosenoption ? string('select-text-track-file') : string('info-select-locale-first')": function (obj) { with (obj) { return chosenoption ? string('select-text-track-file') : string('info-select-locale-first'); } }, "upload_text_track(domEvent)": function (obj) { with (obj) { return upload_text_track(domEvent); } }, "acceptedtracktexts": function (obj) { with (obj) { return acceptedtracktexts; } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "upload-text-tracks": "Upload track text files",
            "select-text-track-language": "Subtitle Language",
            "info-select-locale-first": "First select locale",
            "select-text-track-file": "Click to select file",
            "back": "back"
        });
});

Scoped.define("module:VideoPlayer.Dynamics.Player", ["dynamics:Dynamic","module:Assets","browser:Info","browser:Dom","media:Player.VideoPlayerWrapper","media:Player.Broadcasting","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Async","module:VideoPlayer.Dynamics.PlayerStates.Initial","module:VideoPlayer.Dynamics.PlayerStates","module:Ads.AbstractVideoAdProvider","browser:Events"], ["module:VideoPlayer.Dynamics.Playbutton","module:VideoPlayer.Dynamics.Message","module:VideoPlayer.Dynamics.Loader","module:VideoPlayer.Dynamics.Share","module:VideoPlayer.Dynamics.Controlbar","module:VideoPlayer.Dynamics.Tracks","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.TogglePartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"], function (Class, Assets, Info, Dom, VideoPlayerWrapper, Broadcasting, Types, Objs, Strings, Time, Timers, Host, ClassRegistry, Async, InitialState, PlayerStates, AdProvider, DomEvents, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div itemscope itemtype=\"http://schema.org/VideoObject\"\n     class=\"{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? 'ie8' : 'noie8'}} {{csstheme}} {{css}}-{{ fullscreened ? 'fullscreen' : 'normal' }}-view {{css}}-{{ firefox ? 'firefox' : 'common'}}-browser\n    {{css}}-{{themecolor}}-color\"\n     ba-on:mousemove=\"{{user_activity()}}\"\n     ba-on:mousedown=\"{{user_activity(true)}}\"\n     ba-on:touchstart=\"{{user_activity(true)}}\"\n     ba-styles=\"{{widthHeightStyles}}\"\n>\n    <video tabindex=\"-1\" class=\"{{css}}-video\" data-video=\"video\"\n           ba-toggle:playsinline=\"{{!playfullscreenonmobile}}\"\n    ></video>\n    <div class=\"{{css}}-overlay\">\n        <div tabindex=\"-1\" class=\"{{css}}-player-toggle-overlay\" data-selector=\"player-toggle-overlay\"\n             ba-hotkey:right=\"{{seek(position + skipseconds)}}\" ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n             ba-hotkey:alt+right=\"{{seek(position + skipseconds * 3)}}\" ba-hotkey:alt+left=\"{{seek(position - skipseconds * 3)}}\"\n             ba-hotkey:up=\"{{set_volume(volume + 0.1)}}\" ba-hotkey:down=\"{{set_volume(volume - 0.1)}}\"\n             ba-hotkey:space^enter=\"{{toggle_player()}}\"\n             ba-on:click=\"{{toggle_player()}}\"\n        ></div>\n        <ba-{{dyncontrolbar}}\n            ba-css=\"{{csscontrolbar || css}}\"\n            ba-themecolor=\"{{themecolor}}\"\n            ba-template=\"{{tmplcontrolbar}}\"\n            ba-show=\"{{controlbar_active}}\"\n            ba-playing=\"{{playing}}\"\n            ba-playwhenvisible=\"{{playwhenvisible}}\"\n            ba-airplay=\"{{airplay}}\"\n            ba-airplaybuttonvisible=\"{{airplaybuttonvisible}}\"\n            ba-chromecast=\"{{chromecast}}\"\n            ba-castbuttonvisble=\"{{castbuttonvisble}}\"\n            ba-event:rerecord=\"rerecord\"\n            ba-event:submit=\"submit\"\n            ba-event:play=\"play\"\n            ba-event:pause=\"pause\"\n            ba-event:position=\"seek\"\n            ba-event:volume=\"set_volume\"\n            ba-event:fullscreen=\"toggle_fullscreen\"\n            ba-event:toggle_player=\"toggle_player\"\n            ba-event:tab_index_move=\"tab_index_move\"\n            ba-event:seek=\"seek\"\n            ba-event:set_volume=\"set_volume\"\n            ba-tabindex=\"{{tabindex}}\"\n            ba-tracktextvisible=\"{{tracktextvisible}}\"\n            ba-tracktags=\"{{tracktags}}\"\n            ba-tracktagssupport=\"{{tracktagssupport}}\"\n            ba-allowtexttrackupload=\"{{allowtexttrackupload}}\"\n            ba-tracksshowselection=\"{{tracksshowselection}}\"\n            ba-volume=\"{{volume}}\"\n            ba-duration=\"{{duration}}\"\n            ba-cached=\"{{buffered}}\"\n            ba-title=\"{{title}}\"\n            ba-position=\"{{position}}\"\n            ba-activitydelta=\"{{activity_delta}}\"\n            ba-hideoninactivity=\"{{hideoninactivity}}\"\n            ba-hidebarafter=\"{{hidebarafter}}\"\n            ba-rerecordable=\"{{rerecordable}}\"\n            ba-submittable=\"{{submittable}}\"\n            ba-streams=\"{{streams}}\"\n            ba-currentstream=\"{{=currentstream}}\"\n            ba-fullscreen=\"{{fullscreensupport && !nofullscreen}}\"\n            ba-fullscreened=\"{{fullscreened}}\"\n            ba-source=\"{{source}}\"\n            ba-disablepause=\"{{disablepause}}\"\n            ba-disableseeking=\"{{disableseeking}}\"\n            ba-skipseconds=\"{{skipseconds}}\"\n            ba-skipinitial=\"{{skipinitial}}\"\n        ></ba-{{dyncontrolbar}}>\n\n        <ba-{{dyntracks}}\n            ba-css=\"{{csstracks || css}}\"\n            ba-show=\"{{tracktagssupport || allowtexttrackupload}}\"\n            ba-tracksshowselection=\"{{tracksshowselection}}\"\n            ba-trackselectorhovered=\"{{trackselectorhovered}}\"\n            ba-tracktags=\"{{tracktags}}\"\n            ba-tracktagsstyled=\"{{tracktagsstyled}}\"\n            ba-trackcuetext=\"{{trackcuetext}}\"\n            ba-allowtexttrackupload=\"{{allowtexttrackupload}}\"\n            ba-uploadtexttracksvisible=\"{{uploadtexttracksvisible}}\"\n            ba-acceptedtracktexts=\"{{acceptedtracktexts}}\"\n            ba-uploadlocales=\"{{uploadlocales}}\"\n            ba-event:selected_label_value=\"selected_label_value\"\n            ba-event:upload-text-tracks=\"upload_text_tracks\"\n            ba-event:move_to_option=\"move_to_option\"\n        ></ba-{{dyntracks}}>\n\n        <ba-{{dynplaybutton}}\n            ba-css=\"{{cssplaybutton || css}}\"\n            ba-theme-color=\"{{themecolor}}\"\n            ba-template=\"{{tmplplaybutton}}\"\n            ba-show=\"{{playbutton_active}}\"\n            ba-rerecordable=\"{{rerecordable}}\"\n            ba-submittable=\"{{submittable}}\"\n            ba-event:play=\"playbutton_click\"\n            ba-event:rerecord=\"rerecord\"\n            ba-event:submit=\"submit\"\n            ba-event:tab_index_move=\"tab_index_move\"\n        ></ba-{{dynplaybutton}}>\n\n        <ba-{{dynloader}}\n            ba-css=\"{{cssloader || css}}\"\n            ba-theme-color=\"{{themecolor}}\"\n            ba-template=\"{{tmplloader}}\"\n            ba-playwhenvisible=\"{{playwhenvisible}}\"\n            ba-show=\"{{loader_active}}\"\n        ></ba-{{dynloader}}>\n\n        <ba-{{dynshare}}\n            ba-css=\"{{cssshare || css}}\"\n            ba-theme-color=\"{{themecolor}}\"\n            ba-template=\"{{tmplshare}}\"\n            ba-show=\"{{sharevideourl && sharevideo.length > 0}}\"\n            ba-url=\"{{sharevideourl}}\"\n            ba-shares=\"{{sharevideo}}\"\n        ></ba-{{dynshare}}>\n\n        <ba-{{dynmessage}}\n            ba-css=\"{{cssmessage || css}}\"\n            ba-theme-color=\"{{themecolor}}\"\n            ba-template=\"{{tmplmessage}}\"\n            ba-show=\"{{message_active}}\"\n            ba-message=\"{{message}}\"\n            ba-event:click=\"message_click\"\n        ></ba-{{dynmessage}}>\n\n        <ba-{{dyntopmessage}}\n            ba-css=\"{{csstopmessage || css}}\"\n            ba-theme-color=\"{{themecolor}}\"\n            ba-template=\"{{tmpltopmessage}}\"\n            ba-show=\"{{topmessage}}\"\n            ba-topmessage=\"{{topmessage}}\"\n        ></ba-{{dyntopmessage}}>\n\n        <meta itemprop=\"caption\" content=\"{{title}}\" />\n        <meta itemprop=\"thumbnailUrl\" content=\"{{poster}}\"/>\n        <meta itemprop=\"contentUrl\" content=\"{{source}}\"/>\n    </div>\n    <div class=\"{{css}}-overlay\" data-video=\"ad\" style=\"display:none\"></div>\n</div>\n",

                attrs: {
                    /* CSS */
                    "css": "ba-videoplayer",
                    "csscommon": "ba-commoncss",
                    "iecss": "ba-videoplayer",
                    "cssplaybutton": "",
                    "cssloader": "",
                    "cssmessage": "",
                    "csstopmessage": "",
                    "csscontrolbar": "",
                    "csstracks": "",
                    "width": "",
                    "height": "",
                    "popup-width": "",
                    "popup-height": "",
                    /* Themes */
                    "theme": "",
                    "csstheme": "",
                    "themecolor": "",
                    /* Dynamics */
                    "dynplaybutton": "videoplayer-playbutton",
                    "dynloader": "videoplayer-loader",
                    "dynmessage": "videoplayer-message",
                    "dyntopmessage": "videoplayer-topmessage",
                    "dyncontrolbar": "videoplayer-controlbar",
                    "dynshare": "videoplayer-share",
                    "dyntracks": "videoplayer-tracks",
                    /* Templates */
                    "tmplplaybutton": "",
                    "tmplloader": "",
                    "tmplmessage": "",
                    "tmplshare": "",
                    "tmpltopmessage": "",
                    "tmplcontrolbar": "",
                    "tmpltracks": "",
                    /* Attributes */
                    "poster": "",
                    "source": "",
                    "sources": [],
                    "sourcefilter": {},
                    "streams": [],
                    "currentstream": null,
                    "playlist": null,
                    "volume": 1.0,
                    "title": "",
                    "initialseek": null,
                    "fullscreened": false,
                    "sharevideo": [],
                    "sharevideourl": "",
                    "visibilityfraction": 0.8,

                    /* Configuration */
                    "forceflash": false,
                    "noflash": false,
                    "reloadonplay": false,
                    "playonclick": true,
                    /* Ads */
                    "adprovider": null,
                    "preroll": false,
                    /* Options */
                    "rerecordable": false,
                    "submittable": false,
                    "autoplay": false,
                    "preload": false,
                    "loop": false,
                    "popup": false,
                    "nofullscreen": false,
                    "playfullscreenonmobile": false,
                    "ready": true,
                    "stretch": false,
                    "popup-stretch": false,
                    "volumeafterinteraction": false,
                    "hideoninactivity": true,
                    "hidebarafter": 5000,
                    "preventinteraction": false,
                    "preventinteractionstatus": false, // need to prevent `Unexpected token: punc (()` Uglification issue
                    "skipinitial": false,
                    "topmessage": "",
                    "totalduration": null,
                    "playwhenvisible": false,
                    "playedonce": false,
                    "manuallypaused": false,
                    "disablepause": false,
                    "disableseeking": false,
                    "airplay": false,
                    "airplaybuttonvisible": false,
                    "airplaydevicesavailable": false,
                    "chromecast": false,
                    "castbuttonvisble": false,
                    "skipseconds": 5,
                    "tracktags": [],
                    "tracktagssupport": false,
                    "tracktagsstyled": true,
                    "tracktaglang": 'en',
                    "tracksshowselection": false,
                    "initialoptions": {
                        "hideoninactivity": null
                    },
                    "allowtexttrackupload": false,
                    "uploadtexttracksvisible": false,
                    "acceptedtracktexts": null,
                    "uploadlocales": [{
                        lang: 'en',
                        label: 'English'
                    }],
                    "ttuploadervisible": false,

                    /* States */
                    "states": {
                        "poster_error": {
                            "ignore": false,
                            "click_play": true
                        }
                    }
                },

                types: {
                    "forceflash": "boolean",
                    "noflash": "boolean",
                    "rerecordable": "boolean",
                    "loop": "boolean",
                    "autoplay": "boolean",
                    "preload": "boolean",
                    "ready": "boolean",
                    "nofullscreen": "boolean",
                    "stretch": "boolean",
                    "preroll": "boolean",
                    "hideoninactivity": "boolean",
                    "hidebarafter": "integer",
                    "preventinteraction": "boolean",
                    "skipinitial": "boolean",
                    "volume": "float",
                    "popup": "boolean",
                    "popup-stretch": "boolean",
                    "popup-width": "int",
                    "popup-height": "int",
                    "initialseek": "float",
                    "fullscreened": "boolean",
                    "sharevideo": "array",
                    "sharevideourl": "string",
                    "playfullscreenonmobile": "boolean",
                    "themecolor": "string",
                    "totalduration": "float",
                    "playwhenvisible": "boolean",
                    "playedonce": "boolean",
                    "manuallypaused": "boolean",
                    "disablepause": "boolean",
                    "disableseeking": "boolean",
                    "playonclick": "boolean",
                    "airplay": "boolean",
                    "airplaybuttonvisible": "boolean",
                    "chromecast": "boolean",
                    "castbuttonvisble": "boolean",
                    "skipseconds": "integer",
                    "tracktags": "array",
                    "tracktagsstyled": "boolean",
                    "allowtexttrackupload": "boolean",
                    "uploadtexttracksvisible": "boolean",
                    "acceptedtracktexts": "string",
                    "uploadlocales": "array"
                },

                extendables: ["states"],

                computed: {
                    "widthHeightStyles:width,height": function() {
                        var result = {};
                        var width = this.get("width");
                        var height = this.get("height");
                        if (width)
                            result.width = width + ((width + '').match(/^\d+$/g) ? 'px' : '');
                        if (height)
                            result.height = height + ((height + '').match(/^\d+$/g) ? 'px' : '');
                        return result;
                    },
                    "buffering:buffered,position,last_position_change_delta,playing": function() {
                        return this.get("playing") && this.get("buffered") < this.get("position") && this.get("last_position_change_delta") > 1000;
                    }
                },

                remove_on_destroy: true,

                create: function() {
                    if (Info.isMobile() && (this.get("autoplay") || this.get("playwhenvisible"))) {
                        this.set("volume", 0.0);
                        this.set("volumeafterinteraction", true);
                        if (!(Info.isiOS() && Info.iOSversion().major >= 10)) {
                            this.set("autoplay", false);
                            this.set("loop", false);
                        }
                    }

                    if (this.get("theme") in Assets.playerthemes) {
                        Objs.iter(Assets.playerthemes[this.get("theme")], function(value, key) {
                            if (!this.isArgumentAttr(key))
                                this.set(key, value);
                        }, this);
                    }

                    if (!this.get("themecolor"))
                        this.set("themecolor", "default");

                    if (this.get("adprovider")) {
                        this._adProvider = this.get("adprovider");
                        if (Types.is_string(this._adProvider))
                            this._adProvider = AdProvider.registry[this._adProvider];
                    }
                    if (this.get("playlist")) {
                        var pl0 = (this.get("playlist"))[0];
                        this.set("poster", pl0.poster);
                        this.set("source", pl0.source);
                        this.set("sources", pl0.sources);
                    }
                    if (this.get("streams") && !this.get("currentstream"))
                        this.set("currentstream", (this.get("streams"))[0]);

                    if (this.get("preventinteraction") && !this.get("hideoninactivity")) {
                        this.set("hideoninactivity", true);
                        this.set("initialoptions", {
                            hideoninactivity: true
                        });
                    } else {
                        // Set initial options for further help actions
                        this.set("initialoptions", {
                            hideoninactivity: this.get("hideoninactivity")
                        });
                    }

                    this.set("ie8", Info.isInternetExplorer() && Info.internetExplorerVersion() < 9);
                    this.set("firefox", Info.isFirefox());
                    this.set("duration", this.get("totalduration") || 0.0);
                    this.set("position", 0.0);
                    this.set("buffered", 0.0);
                    this.set("message", "");
                    this.set("fullscreensupport", false);
                    this.set("csssize", "normal");

                    this.set("loader_active", false);
                    this.set("playbutton_active", false);
                    this.set("controlbar_active", false);
                    this.set("message_active", false);

                    this.set("last_activity", Time.now());
                    this.set("activity_delta", 0);
                    this.set("passed_after_play", 0);

                    this.set("playing", false);

                    this.__attachRequested = false;
                    this.__activated = false;
                    this.__error = null;
                    this.__currentStretch = null;

                    // Set initial options for further help actions
                    this.set("initialoptions", {
                        hideoninactivity: this.get("hideoninactivity")
                    });
                    if (this.activeElement().onkeydown)
                        this.activeElement().onkeydown = this._keyDownActivity.bind(this, this.activeElement());

                    this.on("change:tracktags", this.__initializeTrackTags);

                    this.on("change:stretch", function() {
                        this._updateStretch();
                    }, this);
                    this.host = new Host({
                        stateRegistry: new ClassRegistry(this.cls.playerStates())
                    });
                    this.host.dynamic = this;
                    this.host.initialize(InitialState);

                    this._timer = new Timers.Timer({
                        context: this,
                        fire: this._timerFire,
                        delay: 100,
                        start: true
                    });
                },

                state: function() {
                    return this.host.state();
                },

                __initializeTrackTags: function() {
                    this.set("tracktagssupport", this.get("tracktags") && this.get("tracktags").length > 0 && ('track' in document.createElement('track')));
                    if (!this.__video || !this.get("tracktags") || this.get("tracktags").length === 0)
                        return;
                    this._loadTrackTags();
                    // To be able play default subtitle in with custom style
                    if (this.get("tracktagsstyled"))
                        this._setDefaultTrackOnPlay();

                    if (this.get("tracktags").length > 1) {
                        this.on("switch-track", function(selectedTrack) {
                            this.set("tracktextvisible", true);
                            this.set("trackcuetext", null);
                            this._setSelectedTag(selectedTrack);
                        });
                    }
                },

                _loadTrackTags: function() {
                    if (!this.get("tracktagssupport")) return;
                    var _flag = true;
                    Objs.iter(this.get("tracktags"), function(subtitle, index) {
                        var _trackTag = document.createElement("track");
                        _trackTag.id = 'tack' + index;
                        _trackTag.kind = subtitle.kind || 'subtitles';
                        _trackTag.label = subtitle.label || 'English';
                        _trackTag.srclang = subtitle.lang || 'en';
                        _trackTag.src = subtitle.src || null;
                        try {
                            if (subtitle.content && !subtitle.src)
                                _trackTag.src = URL.createObjectURL(new Blob([subtitle.content], {
                                    type: 'text/plain'
                                }));
                        } catch (e) {}
                        if (subtitle.enabled && _flag) {
                            _trackTag.setAttribute('default', '');
                            this.set("tracktaglang", subtitle.lang);
                            this.set("tracktextvisible", true);
                        }
                        _trackTag.setAttribute('data-selector', 'track-tag');
                        _trackTag.addEventListener("load", function() {
                            if (subtitle.enabled && _flag) {
                                // 0 (TextTrack.OFF in spec, TextTrack.DISABLED in Chrome), 1 (TextTrack.HIDDEN) or 2 (TextTrack.SHOWING)
                                this.mode = "showing";
                                if (this.__video)
                                    this.__video.textTracks[index].mode = "showing"; // Firefox
                                _flag = false;
                            } else {
                                this.mode = "hidden";
                                if (this.__video)
                                    this.__video.textTracks[index].mode = "hidden"; // Firefox
                            }
                        });
                        this.__video.appendChild(_trackTag);
                    }, this);
                },

                _showTracksInCustomElement: function(track, lang) {
                    var _lang = lang || this.get("tracktaglang");
                    var _self = this;
                    if (track.language === _lang) {
                        var _cues = track.cues;
                        Objs.iter(_cues, function(cue, index) {
                            if (typeof _cues[index] === 'object' && _cues[index]) {
                                cue.onenter = function(ev) {
                                    track.mode = 'hidden';
                                    if (_self.get("tracktextvisible"))
                                        _self.set("trackcuetext", this.text);
                                };
                                cue.onexit = function(ev) {
                                    _self.set("trackcuetext", null);
                                };
                            }
                        }, this);
                    }
                },

                toggleTrackTags: function(status) {
                    var _lang = this.get("tracktaglang");
                    var _customStyled = this.get("tracktagsstyled");
                    var _status = status ? 'showing' : 'disabled';
                    _status = (status && _customStyled) ? 'hidden' : _status;
                    if (!status && this.get("tracktagsstyled"))
                        this.set("trackcuetext", null);

                    Objs.iter(this.__video.textTracks, function(track, index) {
                        if (typeof this.__video.textTracks[index] === 'object' && this.__video.textTracks[index]) {
                            var _track = this.__video.textTracks[index];
                            // If set custom style to true show cue text in our element
                            if (_track.language === _lang) {
                                _track.mode = _status;
                                this.set("tracktextvisible", status);
                                this._triggerTrackChange(this.__video, _track, _status, _lang);
                            }
                        }
                    }, this);
                },

                _setDefaultTrackOnPlay: function() {
                    this.player.once("playing", function() {
                        Objs.iter(this.get("tracktags"), function(track, index) {
                            var _track = this.__video.textTracks[index];
                            if (typeof _track === 'object' && _track) {
                                if (_track.mode === 'showing')
                                    this._showTracksInCustomElement(_track, _track.language);
                            }
                        }, this);
                    }, this);
                },

                _setSelectedTag: function(selectedTrack) {
                    var _status = null;
                    var _track = null;
                    Objs.iter(this.__video.textTracks, function(track, index) {
                        _track = this.__video.textTracks[index];
                        if (typeof _track === 'object' && _track) {
                            _status = _track.language === selectedTrack.lang ? (this.get("tracktagsstyled") ? 'hidden' : 'showing') : 'disabled';
                            if (!this.get("tracktextvisible")) _status = 'disabled';
                            _track.mode = _status;
                            if (_track.language === selectedTrack.lang)
                                this._triggerTrackChange(this.__video, _track, _status, selectedTrack.lang);
                        }
                    }, this);
                },

                // Fixed issue when unable switch directly to showing from disabled
                _triggerTrackChange: function(video, track, status, lang) {
                    var _self = this;
                    var _trackElement = video.querySelector("#" + track.id);
                    var _flag = true;
                    if (track.oncuechange !== undefined && !((Info.isInternetExplorer() || Info.isEdge()) && this.get("tracktagsstyled"))) {
                        track.oncuechange = function(ev) {
                            if (_flag) {
                                if (status.length) track.mode = status;
                                if (_self.get("tracktagsstyled"))
                                    _self._showTracksInCustomElement(track, lang);
                                else if (_trackElement) {
                                    _trackElement.mode = status;
                                    // _trackElement.setAttribute('default', '');
                                }
                                _flag = false;
                            }
                        };
                    } else {
                        video.ontimeupdate = function(ev) {
                            if (status.length) track.mode = status;
                            if (_self.get("tracktagsstyled"))
                                _self._showTracksInCustomElement(track, lang);
                        };
                    }
                },

                videoAttached: function() {
                    return !!this.player;
                },

                videoLoaded: function() {
                    return this.videoAttached() && this.player.loaded();
                },

                videoError: function() {
                    return this.__error;
                },

                _error: function(error_type, error_code) {
                    this.__error = {
                        error_type: error_type,
                        error_code: error_code
                    };
                    this.trigger("error:" + error_type, error_code);
                    this.trigger("error", error_type, error_code);
                },

                _clearError: function() {
                    this.__error = null;
                },

                _detachVideo: function() {
                    this.set("playing", false);
                    if (this.player)
                        this.player.weakDestroy();
                    if (this._prerollAd)
                        this._prerollAd.weakDestroy();
                    this.player = null;
                    this.__video = null;
                },

                _attachVideo: function() {
                    if (this.videoAttached())
                        return;
                    if (!this.__activated) {
                        this.__attachRequested = true;
                        return;
                    }
                    this.__attachRequested = false;
                    var video = this.activeElement().querySelector("[data-video='video']");
                    this._clearError();
                    VideoPlayerWrapper.create(Objs.extend(this._getSources(), {
                        element: video,
                        forceflash: !!this.get("forceflash"),
                        noflash: !!this.get("noflash"),
                        preload: !!this.get("preload"),
                        loop: !!this.get("loop"),
                        reloadonplay: this.get('playlist') ? true : !!this.get("reloadonplay")
                    })).error(function(e) {
                        if (this.destroyed())
                            return;
                        this._error("attach", e);
                    }, this).success(function(instance) {
                        if (this.destroyed())
                            return;
                        if (this._adProvider && this.get("preroll")) {
                            this._prerollAd = this._adProvider.newPrerollAd({
                                videoElement: this.activeElement().querySelector("[data-video='video']"),
                                adElement: this.activeElement().querySelector("[data-video='ad']"),
                                dynamic: this
                            });
                        }

                        this.player = instance;
                        this.__video = video;
                        this.__initializeTrackTags();

                        if (this.get("chromecast")) {
                            if (!this.get("skipinitial")) this.set("skipinitial", true);
                            this._broadcasting = new Broadcasting({
                                player: instance,
                                commonOptions: {
                                    title: this.get("title"),
                                    poster: this.player._element.poster,
                                    currentPosition: this.get("position")
                                },
                                castOptions: {
                                    canControlVolume: true,
                                    canPause: !this.get("disablepause"),
                                    canSeek: !this.get("disableseeking"),
                                    displayName: this.get("title"),
                                    //displayStatus: "Please wait connecting",
                                    duration: this.get("duration"),
                                    imageUrl: this.player._element.poster,
                                    isConnected: this.player._broadcastingState.googleCastConnected,
                                    isMuted: false,
                                    isPaused: !this.get("playing")
                                },
                                airplayOptions: {}
                            });
                            if (Info.isChrome() && this.get("chromecast")) {
                                this._broadcasting.attachGoggleCast();
                                this.player.on("cast-available", function(isCastDeviceAvailable) {
                                    this.set("castbuttonvisble", isCastDeviceAvailable);
                                }, this);
                                this.player.on("cast-loaded", function(castRemotePlayer, castRemotePlayerController) {
                                    //castRemotePlayer.currentMediaDuration = this.player;

                                    // If player already start to play
                                    if (this.get("position") > 0) {
                                        this._broadcasting.options.currentPosition = this.get("position");
                                    }

                                    //If local player playing stop it before
                                    if (this.get('playing')) this.stop();

                                    // Intial play button state
                                    if (!castRemotePlayer.isPaused) this.set('playing', true);

                                }, this);

                                this.player.on("cast-playpause", function(castPaused) {
                                    this.set("playing", !castPaused);
                                }, this);

                                this.player.on("cast-time-changed", function(currentTime, totalMediaDuration) {
                                    var position = Math.round(currentTime / totalMediaDuration * 100);
                                    this.set("buffered", totalMediaDuration);
                                    this.set("cahched", totalMediaDuration);
                                    this.set("duration", totalMediaDuration || 0.0);
                                    this.set("position", currentTime);
                                }, this);

                                this.player.on("proceed-when-ending-googlecast", function(position) {
                                    this.player._broadcastingState.googleCastConnected = false;
                                    this.set('playing', false);
                                }, this);

                            }
                            if (Info.isSafari() && Info.safariVersion() >= 9 && window.WebKitPlaybackTargetAvailabilityEvent && this.get("airplay")) {
                                this.set("airplaybuttonvisible", true);
                                this._broadcasting.attachAirplayEvent.call(this, video);
                            }
                        }

                        if (this.get("playwhenvisible")) {
                            var _self;
                            _self = this;
                            this.set("skipinitial", true);
                            if (Dom.isElementVisible(video, this.get("visibilityfraction"))) {
                                this.player.play();
                            }

                            this._visiblityScrollEvent = this.auto_destroy(new DomEvents());
                            this._visiblityScrollEvent.on(document, "scroll", function() {
                                if (!_self.get('playedonce') && !_self.get("manuallypaused")) {
                                    if (Dom.isElementVisible(video, _self.get("visibilityfraction"))) {
                                        _self.player.play();
                                    } else if (_self.get("playing")) {
                                        _self.player.pause();
                                    }
                                } else if (_self.get("playing") && !Dom.isElementVisible(video, _self.get("visibilityfraction"))) {
                                    _self.player.pause();
                                }
                            });
                        }
                        this.player.on("fullscreen-change", function(inFullscreen) {
                            this.set("fullscreened", inFullscreen);
                            if (!inFullscreen && (this.get('hideoninactivity') !== this.get("initialoptions").hideoninactivity)) {
                                this.set("hideoninactivity", this.get("initialoptions").hideoninactivity);
                            }
                        }, this);
                        this.player.on("postererror", function() {
                            this._error("poster");
                        }, this);
                        this.player.on("playing", function() {
                            this.set("playing", true);
                            this.trigger("playing");
                        }, this);
                        this.player.on("error", function(e) {
                            this._error("video", e);
                        }, this);
                        if (this.player.error())
                            this.player.trigger("error", this.player.error());
                        this.player.on("paused", function() {
                            this.set("playing", false);
                            this.trigger("paused");
                        }, this);
                        this.player.on("ended", function() {
                            this.set("playing", false);
                            this.set('playedonce', true);
                            this.trigger("ended");
                        }, this);
                        this.trigger("attached", instance);
                        this.player.once("loaded", function() {
                            var volume = Math.min(1.0, this.get("volume"));
                            this.player.setVolume(volume);
                            this.player.setMuted(volume <= 0.0);
                            this.trigger("loaded");
                            this.trigger("ready_to_play");
                            if (this.get("totalduration") || this.player.duration() < Infinity)
                                this.set("duration", this.get("totalduration") || this.player.duration());
                            this.set("fullscreensupport", this.player.supportsFullscreen());
                            this._updateStretch();
                            if (this.get("initialseek"))
                                this.player.setPosition(this.get("initialseek"));
                        }, this);
                        if (this.player.loaded())
                            this.player.trigger("loaded");
                        this._updateStretch();
                    }, this);
                },

                _getSources: function() {
                    var filter = this.get("currentstream") ? this.get("currentstream").filter : this.get("sourcefilter");
                    var poster = this.get("poster");
                    var source = this.get("source");
                    var sources = filter ? Objs.filter(this.get("sources"), function(source) {
                        return Objs.subset_of(filter, source);
                    }, this) : this.get("sources");
                    Objs.iter(sources, function(s) {
                        if (s.poster)
                            poster = s.poster;
                    });
                    return {
                        poster: poster,
                        source: source,
                        sources: sources
                    };
                },

                _afterActivate: function(element) {
                    inherited._afterActivate.call(this, element);
                    this.__activated = true;
                    if (this.__attachRequested)
                        this._attachVideo();
                },

                /* In the feature if require to use promise player, Supports >Chrome50, >FireFox53
                _playWithPromise: function(dyn) {
                    var _player, _promise, _autoplayAllowed;
                    _player = dyn.player;
                    _autoplayAllowed = true;
                    if (_player._element)
                        _promise = _player._element.play();
                    else
                        _player.play();

                    if (_promise !== 'undefined' && !Info.isInternetExplorer()) {
                        _promise["catch"](function(err) {
                            // here can add some interaction like inform user to change settings in chrome://flags disable-gesture-requirement-for-media-playback
                            if (err.name === 'NotAllowedError')
                                _autoplayAllowed = false;
                            // Will try to run play anyway
                            _player.play();
                        });
                        _promise.then(function() {
                            if(_autoplayAllowed) {
                                // Inform user with UI that device is not allowed to play without interaction
                            }
                        });
                    } else if (!dyn.get("playing")) {
                        _player.play();
                    }
                }, */

                reattachVideo: function() {
                    this.set("reloadonplay", true);
                    this._detachVideo();
                    this._attachVideo();
                },

                _keyDownActivity: function(element, ev) {
                    if (this.get("preventinteractionstatus")) return;
                    var _keyCode = ev.which || ev.keyCode;
                    // Prevent whitespace browser center scroll and arrow buttons behaviours
                    if (_keyCode === 32 || _keyCode === 37 || _keyCode === 38 || _keyCode === 39 || _keyCode === 40) ev.preventDefault();

                    if (_keyCode === 32 || _keyCode === 13 || _keyCode === 9) {
                        this._resetActivity();
                        if (this.get("fullscreened") && this.get("hideoninactivity")) this.set("hideoninactivity", false);
                    }

                    if (_keyCode === 9 && ev.shiftKey) {
                        this._resetActivity();
                        this._findNextTabStop(element, ev, function(target, index) {
                            target.focus();
                        }, -1);
                    } else if (_keyCode === 9) {
                        this._resetActivity();
                        this._findNextTabStop(element, ev, function(target, index) {
                            target.focus();
                        });
                    }
                },

                _findNextTabStop: function(parentElement, ev, callback, direction) {
                    var _currentIndex, _direction, _tabIndexes, _tabIndexesArray, _maxIndex, _minIndex, _looked, _tabIndex, _delta, _element, _videoPlayersCount;
                    _maxIndex = _minIndex = 0;
                    _direction = direction || 1;
                    _element = ev.target;
                    _currentIndex = _element.tabIndex;
                    _tabIndexes = parentElement.querySelectorAll('[tabindex]');
                    _tabIndexesArray = Array.prototype.slice.call(_tabIndexes, 0);
                    _tabIndexes = _tabIndexesArray
                        .filter(function(element) {
                            if ((element.clientWidth > 0 || element.clientHeight > 0) && (element.tabIndex !== -1)) {
                                if (_maxIndex <= element.tabIndex) _maxIndex = element.tabIndex;
                                if (_minIndex >= element.tabIndex) _minIndex = element.tabIndex;
                                return true;
                            } else return false;
                        });

                    if ((_direction === 1 && _currentIndex === _maxIndex) || (direction === -1 && _currentIndex === _minIndex) || _maxIndex === 0) {
                        _videoPlayersCount = document.querySelectorAll('ba-videoplayer').length;
                        if (_videoPlayersCount > 1) {
                            if (this.get("playing")) this.player.pause();
                            parentElement.tabIndex = -1;
                            parentElement.blur();
                        }
                        return;
                    }

                    for (var i = 0; i < _tabIndexes.length; i++) {
                        if (!_tabIndexes[i])
                            continue;
                        _tabIndex = _tabIndexes[i].tabIndex;
                        _delta = _tabIndex - _currentIndex;
                        if (_tabIndex < _minIndex || _tabIndex > _maxIndex || Math.sign(_delta) !== _direction)
                            continue;

                        if (!_looked || Math.abs(_delta) < Math.abs(_looked.tabIndex - _currentIndex))
                            _looked = _tabIndexes[i];
                    }

                    if (_looked) {
                        ev.preventDefault();
                        callback(_looked, _looked.tabIndex);
                    }
                },

                // Couldn't use for uglification issue `Unexpected token: punc (()`
                // _preventInteraction() {
                //      if(this.get('preventinteraction') && (this.get('hidebarafter') < (Time.now() - this.get("last_activity"))) && this.get('playing'));
                // },

                _resetActivity: function() {
                    if (!this.get('preventinteractionstatus')) {
                        this.set("last_activity", Time.now());
                    }
                    this.set("activity_delta", 0);
                },

                object_functions: ["play", "rerecord", "pause", "stop", "seek", "set_volume"],

                functions: {

                    user_activity: function(strong) {
                        if (strong && this.get("volumeafterinteraction")) {
                            this.set_volume(1.0);
                        }
                        if (this.get('preventinteractionstatus')) return;
                        this._resetActivity();
                    },

                    message_click: function() {
                        this.trigger("message:click");
                    },

                    playbutton_click: function() {
                        this.host.state().play();
                    },

                    play: function() {
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("play");
                            return;
                        }
                        if (this.player && this.player._broadcastingState && this.player._broadcastingState.googleCastConnected) {
                            this._broadcasting.player.trigger("play-google-cast");
                            return;
                        }
                        this.host.state().play();
                    },

                    rerecord: function() {
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("rerecord");
                            return;
                        }
                        if (!this.get("rerecordable"))
                            return;
                        this.trigger("rerecord");
                    },

                    submit: function() {
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("submit");
                            return;
                        }
                        if (!this.get("submittable"))
                            return;
                        this.trigger("submit");
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                    },

                    pause: function() {
                        if (this.get("preventinteractionstatus")) return;
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("pause");
                            return;
                        }

                        if (this.get('disablepause')) return;

                        if (this.get("playing")) {
                            if (this.player && this.player._broadcastingState && this.player._broadcastingState.googleCastConnected) {
                                this._broadcasting.player.trigger("pause-google-cast");
                                return;
                            }
                            this.player.pause();
                        }

                        if (this.get("playwhenvisible"))
                            this.set("manuallypaused", true);
                    },

                    stop: function() {
                        if (this.get("preventinteractionstatus")) return;
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("stop");
                            return;
                        }
                        if (!this.videoLoaded())
                            return;
                        if (this.get("playing"))
                            this.player.pause();
                        this.player.setPosition(0);
                        this.trigger("stopped");
                    },

                    seek: function(position) {
                        if (this.get("preventinteractionstatus")) return;
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("seek", position);
                            return;
                        }
                        if (this.get('disableseeking')) return;
                        if (this.videoLoaded()) {
                            if (position > this.player.duration())
                                this.player.setPosition(this.player.duration() - this.get("skipseconds"));
                            else {
                                this.player.setPosition(position);
                                this.trigger("seek", position);
                            }
                        }
                    },

                    set_volume: function(volume) {
                        if (this.get("preventinteractionstatus")) return;
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("set_volume", volume);
                            return;
                        }
                        volume = Math.min(1.0, volume);
                        volume = volume <= 0 ? 0 : volume; // Don't allow negative value

                        if (this.player && this.player._broadcastingState && this.player._broadcastingState.googleCastConnected) {
                            this._broadcasting.player.trigger("change-google-cast-volume", volume);
                        }

                        this.set("volume", volume);
                        if (this.videoLoaded()) {
                            this.player.setVolume(volume);
                            this.player.setMuted(volume <= 0);
                        }
                    },

                    toggle_fullscreen: function() {
                        if (this.get("preventinteractionstatus")) return;
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("toggle_fullscreen");
                            return;
                        }
                        if (this.get("fullscreened"))
                            this.player.exitFullscreen();
                        else
                            this.player.enterFullscreen();
                        this.set("fullscreened", !this.get("fullscreened"));
                    },

                    toggle_player: function() {
                        if (this.get('playing'))
                            if (this.get("preventinteractionstatus")) return;
                        if (this._delegatedPlayer) {
                            this._delegatedPlayer.execute("toggle_player");
                            return;
                        }
                        if (!this.get("playonclick"))
                            return;
                        if (this.get('playing') && !this.get("disablepause")) {
                            if (!this.get("volumeafterinteraction"))
                                this.pause();
                            else
                                this.set("volumeafterinteraction", false);

                            if (this.get("playwhenvisible"))
                                this.set("manuallypaused", true);
                        } else
                            this.play();
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        if (this.get("preventinteractionstatus")) return;
                        var _targetElement, _activeElement, _selector, _keyCode;
                        _keyCode = ev.which || ev.keyCode;
                        _activeElement = this.activeElement();
                        if (_keyCode === 13 || _keyCode === 32) {
                            if (focusingSelector) {
                                _selector = "[data-selector='" + focusingSelector + "']";
                                _targetElement = _activeElement.querySelector(_selector);
                                if (_targetElement)
                                    Async.eventually(function() {
                                        this.trigger("keyboardusecase", _activeElement);
                                        _targetElement.focus({
                                            preventScroll: false
                                        });
                                    }, this, 100);
                            } else {
                                _selector = '[data-video="video"]';
                                _targetElement = _activeElement.querySelector(_selector);
                                Async.eventually(function() {
                                    this.trigger("keyboardusecase", _activeElement);
                                    _targetElement.focus({
                                        preventScroll: true
                                    });
                                }, this, 100);
                            }
                        } else if (_keyCode === 9 && nextSelector) {
                            _selector = "[data-selector='" + nextSelector + "']";
                            _targetElement = _activeElement.querySelector(_selector);
                            if (_targetElement)
                                Async.eventually(function() {
                                    this.trigger("keyboardusecase", _activeElement);
                                    _targetElement.focus({
                                        preventScroll: false
                                    });
                                }, this, 100);

                        }
                    },

                    upload_text_tracks: function(file, locale) {
                        return this.host.state().uploadTextTrack(file, locale);
                    },

                    move_to_option: function(currentElement, nextSelector) {
                        var _classPrefix, _hiddenOptionsSelector, _visibleOptionsSelector, _moveToSelector,
                            _targetElement, _currentElementParent, _topParent;
                        nextSelector = nextSelector || 'initial-options-list'; // If next element is empty return to main options
                        _classPrefix = this.get('csscommon') + "-";
                        _moveToSelector = "." + _classPrefix + nextSelector;
                        _hiddenOptionsSelector = _classPrefix + 'options-list-hidden';
                        _visibleOptionsSelector = _classPrefix + 'options-list-visible';
                        _targetElement = this.activeElement().querySelector(_moveToSelector);
                        _topParent = this.activeElement().querySelector(_classPrefix + 'text-tracks-overlay');

                        // Look if target element is hidden
                        if (Dom.elementHasClass(_targetElement, _hiddenOptionsSelector)) {
                            // Search for visible closest parent element
                            _currentElementParent = Dom.elementFindClosestParent(currentElement, _visibleOptionsSelector, _classPrefix + 'text-tracks-overlay');
                            // We should have parent element with visible class
                            if (Dom.elementHasClass(_currentElementParent, _visibleOptionsSelector)) {
                                Dom.elementReplaceClasses(_targetElement, _hiddenOptionsSelector, _visibleOptionsSelector);
                                Dom.elementReplaceClasses(_currentElementParent, _visibleOptionsSelector, _hiddenOptionsSelector);
                            }
                            if (_topParent)
                                _topParent.focus({
                                    preventScroll: true
                                });
                            else
                                _currentElementParent.focus({
                                    preventScroll: true
                                });
                        }
                    },

                    toggle_interaction_option: function(turn_switch) {
                        if (typeof turn_switch === 'boolean') {
                            this.set("preventinteractionstatus", turn_switch);
                        } else {
                            this.set("preventinteractionstatus", !this.get("preventinteractionstatus"));
                        }
                    }

                },

                destroy: function() {
                    this._timer.destroy();
                    this.host.destroy();
                    this._detachVideo();
                    inherited.destroy.call(this);
                },

                _timerFire: function() {
                    if (this.destroyed())
                        return;
                    try {
                        if (this.videoLoaded()) {
                            var _now = Time.now();
                            this.set("activity_delta", _now - this.get("last_activity"));
                            var new_position = this.player.position();
                            if (new_position != this.get("position") || this.get("last_position_change"))
                                this.set("last_position_change", _now);
                            // In case if prevent interaction with controller set to true
                            if (this.get('preventinteraction')) {
                                // set timer since player started to play
                                if (this.get("passed_after_play") < 0.001) {
                                    this.set("passed_after_play", _now);
                                } else {
                                    var _passed = _now - this.get("passed_after_play");
                                    if (_passed > _now - 1000) {
                                        this.set("passed_after_play", _passed);
                                    }
                                    if ((this.get('hidebarafter') < _passed) && this.get('playing') && !this.get("preventinteractionstatus")) {
                                        this.set('preventinteractionstatus', true);
                                    }
                                }

                            }
                            this.set("last_position_change_delta", _now - this.get("last_position_change"));
                            this.set("position", new_position);
                            this.set("buffered", this.player.buffered());
                            var pld = this.player.duration();
                            if (0.0 < pld && pld < Infinity)
                                this.set("duration", this.player.duration());
                            else
                                this.set("duration", this.get("totalduration") || new_position);
                            this.set("fullscreened", this.player.isFullscreen());
                        }
                    } catch (e) {}
                    try {
                        this._updateStretch();
                    } catch (e) {}
                    try {
                        this._updateCSSSize();
                    } catch (e) {}
                },

                _updateCSSSize: function() {
                    var width = Dom.elementDimensions(this.activeElement()).width;
                    this.set("csssize", width > 400 ? "normal" : (width > 300 ? "medium" : "small"));
                },

                videoHeight: function() {
                    return this.videoAttached() ? this.player.videoHeight() : NaN;
                },

                videoWidth: function() {
                    return this.videoAttached() ? this.player.videoWidth() : NaN;
                },

                aspectRatio: function() {
                    return this.videoWidth() / this.videoHeight();
                },

                parentWidth: function() {
                    return Dom.elementDimensions(this.activeElement().parentElement).width;
                },

                parentHeight: function() {
                    return Dom.elementDimensions(this.activeElement().parentElement).height;
                },

                parentAspectRatio: function() {
                    return this.parentWidth() / this.parentHeight();
                },

                _updateStretch: function() {
                    var newStretch = null;
                    if (this.get("stretch")) {
                        var ar = this.aspectRatio();
                        if (isFinite(ar)) {
                            var par = this.parentAspectRatio();
                            if (isFinite(par)) {
                                if (par > ar)
                                    newStretch = "height";
                                if (par < ar)
                                    newStretch = "width";
                            } else if (par === Infinity)
                                newStretch = "height";
                        }
                    }
                    if (this.__currentStretch !== newStretch) {
                        if (this.__currentStretch)
                            Dom.elementRemoveClass(this.activeElement(), this.get("css") + "-stretch-" + this.__currentStretch);
                        if (newStretch)
                            Dom.elementAddClass(this.activeElement(), this.get("css") + "-stretch-" + newStretch);
                    }
                    this.__currentStretch = newStretch;
                },

                cloneAttrs: function() {
                    return Objs.map(this.attrs, function(value, key) {
                        return this.get(key);
                    }, this);
                },

                popupAttrs: function() {
                    return {
                        autoplay: true,
                        popup: false,
                        width: this.get("popup-width"),
                        height: this.get("popup-height"),
                        stretch: this.get("popup-stretch")
                    };
                }

            };
        }, {

            playerStates: function() {
                return [PlayerStates];
            }

        }).register("ba-videoplayer")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "csssize": function (obj) { with (obj) { return csssize; } }, "iecss": function (obj) { with (obj) { return iecss; } }, "ie8 ? 'ie8' : 'noie8'": function (obj) { with (obj) { return ie8 ? 'ie8' : 'noie8'; } }, "csstheme": function (obj) { with (obj) { return csstheme; } }, "fullscreened ? 'fullscreen' : 'normal'": function (obj) { with (obj) { return fullscreened ? 'fullscreen' : 'normal'; } }, "firefox ? 'firefox' : 'common'": function (obj) { with (obj) { return firefox ? 'firefox' : 'common'; } }, "themecolor": function (obj) { with (obj) { return themecolor; } }, "user_activity()": function (obj) { with (obj) { return user_activity(); } }, "user_activity(true)": function (obj) { with (obj) { return user_activity(true); } }, "widthHeightStyles": function (obj) { with (obj) { return widthHeightStyles; } }, "!playfullscreenonmobile": function (obj) { with (obj) { return !playfullscreenonmobile; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "seek(position + skipseconds * 3)": function (obj) { with (obj) { return seek(position + skipseconds * 3); } }, "seek(position - skipseconds * 3)": function (obj) { with (obj) { return seek(position - skipseconds * 3); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "toggle_player()": function (obj) { with (obj) { return toggle_player(); } }, "dyncontrolbar": function (obj) { with (obj) { return dyncontrolbar; } }, "csscontrolbar || css": function (obj) { with (obj) { return csscontrolbar || css; } }, "tmplcontrolbar": function (obj) { with (obj) { return tmplcontrolbar; } }, "controlbar_active": function (obj) { with (obj) { return controlbar_active; } }, "playing": function (obj) { with (obj) { return playing; } }, "playwhenvisible": function (obj) { with (obj) { return playwhenvisible; } }, "airplay": function (obj) { with (obj) { return airplay; } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "chromecast": function (obj) { with (obj) { return chromecast; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "tabindex": function (obj) { with (obj) { return tabindex; } }, "tracktextvisible": function (obj) { with (obj) { return tracktextvisible; } }, "tracktags": function (obj) { with (obj) { return tracktags; } }, "tracktagssupport": function (obj) { with (obj) { return tracktagssupport; } }, "allowtexttrackupload": function (obj) { with (obj) { return allowtexttrackupload; } }, "tracksshowselection": function (obj) { with (obj) { return tracksshowselection; } }, "volume": function (obj) { with (obj) { return volume; } }, "duration": function (obj) { with (obj) { return duration; } }, "buffered": function (obj) { with (obj) { return buffered; } }, "title": function (obj) { with (obj) { return title; } }, "position": function (obj) { with (obj) { return position; } }, "activity_delta": function (obj) { with (obj) { return activity_delta; } }, "hideoninactivity": function (obj) { with (obj) { return hideoninactivity; } }, "hidebarafter": function (obj) { with (obj) { return hidebarafter; } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "submittable": function (obj) { with (obj) { return submittable; } }, "streams": function (obj) { with (obj) { return streams; } }, "currentstream": function (obj) { with (obj) { return currentstream; } }, "fullscreensupport && !nofullscreen": function (obj) { with (obj) { return fullscreensupport && !nofullscreen; } }, "fullscreened": function (obj) { with (obj) { return fullscreened; } }, "source": function (obj) { with (obj) { return source; } }, "disablepause": function (obj) { with (obj) { return disablepause; } }, "disableseeking": function (obj) { with (obj) { return disableseeking; } }, "skipseconds": function (obj) { with (obj) { return skipseconds; } }, "skipinitial": function (obj) { with (obj) { return skipinitial; } }, "dyntracks": function (obj) { with (obj) { return dyntracks; } }, "csstracks || css": function (obj) { with (obj) { return csstracks || css; } }, "tracktagssupport || allowtexttrackupload": function (obj) { with (obj) { return tracktagssupport || allowtexttrackupload; } }, "trackselectorhovered": function (obj) { with (obj) { return trackselectorhovered; } }, "tracktagsstyled": function (obj) { with (obj) { return tracktagsstyled; } }, "trackcuetext": function (obj) { with (obj) { return trackcuetext; } }, "uploadtexttracksvisible": function (obj) { with (obj) { return uploadtexttracksvisible; } }, "acceptedtracktexts": function (obj) { with (obj) { return acceptedtracktexts; } }, "uploadlocales": function (obj) { with (obj) { return uploadlocales; } }, "dynplaybutton": function (obj) { with (obj) { return dynplaybutton; } }, "cssplaybutton || css": function (obj) { with (obj) { return cssplaybutton || css; } }, "tmplplaybutton": function (obj) { with (obj) { return tmplplaybutton; } }, "playbutton_active": function (obj) { with (obj) { return playbutton_active; } }, "dynloader": function (obj) { with (obj) { return dynloader; } }, "cssloader || css": function (obj) { with (obj) { return cssloader || css; } }, "tmplloader": function (obj) { with (obj) { return tmplloader; } }, "loader_active": function (obj) { with (obj) { return loader_active; } }, "dynshare": function (obj) { with (obj) { return dynshare; } }, "cssshare || css": function (obj) { with (obj) { return cssshare || css; } }, "tmplshare": function (obj) { with (obj) { return tmplshare; } }, "sharevideourl && sharevideo.length > 0": function (obj) { with (obj) { return sharevideourl && sharevideo.length > 0; } }, "sharevideourl": function (obj) { with (obj) { return sharevideourl; } }, "sharevideo": function (obj) { with (obj) { return sharevideo; } }, "dynmessage": function (obj) { with (obj) { return dynmessage; } }, "cssmessage || css": function (obj) { with (obj) { return cssmessage || css; } }, "tmplmessage": function (obj) { with (obj) { return tmplmessage; } }, "message_active": function (obj) { with (obj) { return message_active; } }, "message": function (obj) { with (obj) { return message; } }, "dyntopmessage": function (obj) { with (obj) { return dyntopmessage; } }, "csstopmessage || css": function (obj) { with (obj) { return csstopmessage || css; } }, "tmpltopmessage": function (obj) { with (obj) { return tmpltopmessage; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }, "poster": function (obj) { with (obj) { return poster; } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "video-error": "An error occurred, please try again later. Click to retry."
        });
});

Scoped.define("module:VideoRecorder.Dynamics.Chooser", ["dynamics:Dynamic","module:Assets","browser:Info"], ["dynamics:Partials.ClickPartial","dynamics:Partials.IfPartial"], function (Class, Assets, Info, scoped) {

    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div class=\"{{css}}-chooser-container\">\n\t<div class=\"{{css}}-chooser-button-container\">\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div ba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t tabindex=\"0\" class=\"{{css}}-chooser-button-{{action.index}}\"\n\t\t\t     ba-click=\"{{click_action(action)}}\"\n\t\t\t>\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   />\n\t\t\t\t<i class=\"{{css}}-icon-{{action.icon}}\"\n\t\t\t\t   ba-if=\"{{action.icon}}\"></i>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-videorecorder",
                    "allowrecord": true,
                    "allowupload": true,
                    "allowscreen": false,

                    "primaryrecord": true,
                    "recordviafilecapture": false,

                    "allowcustomupload": true,
                    "allowedextensions": null,
                    "onlyaudio": false

                },

                types: {
                    "allowedextensions": "array",
                    "recordviafilecapture": "boolean"
                },

                collections: ["actions"],

                create: function() {
                    var custom_accept_string = "";
                    if (this.get("allowedextensions") && this.get("allowedextensions").length > 0) {
                        var browser_support = Info.isEdge() || Info.isChrome() || Info.isOpera() || (Info.isFirefox() && Info.firefoxVersion() >= 42) || (Info.isInternetExplorer() && Info.internetExplorerVersion() >= 10);
                        if (browser_support)
                            custom_accept_string = "." + this.get("allowedextensions").join(",.");
                    } else if (!this.get("allowcustomupload")) {
                        custom_accept_string = "video/*,video/mp4";
                    }

                    var order = [];
                    if (this.get("primaryrecord")) {
                        if (this.get("allowrecord"))
                            order.push("record");
                        if (this.get("allowscreen"))
                            order.push("screen");
                        if (this.get("allowupload"))
                            order.push("upload");
                    } else {
                        if (this.get("allowscreen"))
                            order.push("screen");
                        if (this.get("allowupload"))
                            order.push("upload");
                        if (this.get("allowrecord"))
                            order.push("record");
                    }
                    var actions = this.get("actions");
                    order.forEach(function(act, index) {
                        switch (act) {
                            case "record":
                                actions.add({
                                    type: "record",
                                    index: index,
                                    icon: !this.get("onlyaudio") ? 'videocam' : 'volume-up',
                                    label: this.string(this.get("onlyaudio") ? "record-audio" : "record-video"),
                                    select: Info.isMobile() && !(Info.isAndroid() && Info.isCordova()) && this.get("recordviafilecapture"),
                                    capture: true,
                                    accept: "video/*,video/mp4;capture=camcorder"
                                });
                                break;
                            case "upload":
                                actions.add({
                                    type: "upload",
                                    index: index,
                                    icon: "upload",
                                    label: this.string("upload-video"),
                                    select: !(Info.isiOS() && Info.isCordova()),
                                    accept: Info.isMobile() && !(Info.isAndroid() && Info.isCordova()) ? "video/*,video/mp4" : custom_accept_string
                                });
                                break;
                            case "screen":
                                actions.add({
                                    type: "screen",
                                    index: index,
                                    icon: "television",
                                    label: this.string("record-screen")
                                });
                                break;
                        }
                    }, this);
                },

                functions: {

                    click_action: function(action) {
                        if (action.get("select"))
                            return;
                        if (action.get("type") === "screen") {
                            this.trigger("record-screen");
                            return;
                        }
                        if (Info.isMobile() && Info.isCordova()) {
                            var self = this;
                            if (Info.isAndroid()) {
                                navigator.device.capture.captureVideo(function(mediaFiles) {
                                    self.trigger("upload", mediaFiles[0]);
                                }, function(error) {}, {
                                    limit: 1,
                                    duration: this.get("timelimit")
                                });
                            } else if (Info.isiOS()) {
                                navigator.camera.getPicture(function(url) {
                                    self.trigger("upload", {
                                        localURL: url,
                                        fullPath: url
                                    });
                                }, function(error) {}, {
                                    destinationType: Camera.DestinationType.FILE_URI,
                                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,
                                    mediaType: Camera.MediaType.VIDEO
                                });
                            }
                        } else
                            this.trigger("record");
                    },

                    select_file_action: function(action, domEvent) {
                        if (!action.get("select"))
                            return;
                        this.trigger("upload", domEvent[0].target);
                    }

                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.icon": function (obj) { with (obj) { return action.icon; } }, "action.label": function (obj) { with (obj) { return action.label; } }/**/ })
        .register("ba-videorecorder-chooser")
        .attachStringTable(Assets.strings)
        .addStrings({
            "record-video": "Record Video",
            "record-audio": "Record Audio",
            "record-screen": "Record Screen",
            "upload-video": "Upload Video"
        });
});

Scoped.define("module:VideoRecorder.Dynamics.Controlbar", ["dynamics:Dynamic","module:Assets","base:Timers.Timer"], ["dynamics:Partials.ShowPartial","dynamics:Partials.RepeatPartial"], function (Class, Assets, Timer, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div class=\"{{css}}-dashboard\">\n\t<div class=\"{{css}}-backbar\"></div>\n\t<div data-selector=\"recorder-settings\" class=\"{{css}}-settings\" ba-show=\"{{settingsvisible && settingsopen}}\">\n\t\t<div class=\"{{css}}-settings-backbar\"></div>\n\t\t<div data-selector=\"settings-list-front\" class=\"{{css}}-settings-front\">\n\t\t\t<ul data-selector=\"camera-settings\" ba-repeat=\"{{camera :: cameras}}\" ba-show=\"{{!novideo && !allowscreen}}\">\n\t\t\t\t<li>\n\t\t\t\t\t<input tabindex=\"0\"\n\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t   type='radio' name='camera' value=\"{{selectedcamera == camera.id}}\" onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<label tabindex=\"0\"\n\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t</label>\n\t\t\t\t </li>\n\t\t\t</ul>\n\t\t\t<hr ba-show=\"{{(!noaudio && !novideo) || !allowscreen}}\"/>\n\t\t\t<ul data-selector=\"microphone-settings\" ba-repeat=\"{{microphone :: microphones}}\" ba-show=\"{{!noaudio && !allowscreen}}\">\n\t\t\t\t<li tabindex=\"0\"\n\t\t\t\t\tba-hotkey:space^enter=\"{{selectMicrophone(microphone.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\tonclick=\"{{selectMicrophone(microphone.id)}}\"\n\t\t\t\t>\n\t\t\t\t\t<input type='radio' name='microphone' value=\"{{selectedmicrophone == microphone.id}}\" />\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<label>\n\t\t\t\t\t\t{{microphone.label}}\n\t\t\t\t\t</label>\n\t\t\t\t </li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div data-selector=\"controlbar\" class=\"{{css}}-controlbar\">\n\n        <div class=\"{{css}}-leftbutton-container\" ba-show=\"{{settingsvisible}}\">\n            <div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{settingsopen=!settingsopen}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"record-button-icon-cog\" class=\"{{css}}-button-inner {{css}}-button-{{settingsopen ? 'selected' : 'unselected'}}\"\n                 onclick=\"{{settingsopen=!settingsopen}}\"\n                 onmouseenter=\"{{hover(string('settings'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                <i class=\"{{css}}-icon-cog\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-lefticon-container\" ba-show=\"{{settingsvisible && !novideo && !allowscreen}}\">\n            <div data-selector=\"record-button-icon-videocam\" class=\"{{css}}-icon-inner\"\n                 onmouseenter=\"{{hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                <i class=\"{{css}}-icon-videocam {{css}}-icon-state-{{camerahealthy ? 'good' : 'bad' }}\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-lefticon-container\" ba-show=\"{{settingsvisible && !noaudio && !allowscreen}}\">\n            <div data-selector=\"record-button-icon-mic\" class=\"{{css}}-icon-inner\"\n                 onmouseenter=\"{{hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                <i class=\"{{css}}-icon-mic {{css}}-icon-state-{{microphonehealthy ? 'good' : 'bad' }}\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-lefticon-container\" ba-show=\"{{stopvisible && recordingindication}}\">\n            <div data-selector=\"recording-indicator\" class=\"{{css}}-recording-indication\">\n            </div>\n        </div>\n\n        <div class=\"{{css}}-label-container\" ba-show=\"{{controlbarlabel}}\">\n        \t<div data-selector=\"record-label-block\" class=\"{{css}}-label-label\">\n        \t\t{{controlbarlabel}}\n        \t</div>\n        </div>\n\n        <div class=\"{{css}}-rightbutton-container\" ba-show=\"{{recordvisible}}\">\n        \t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{record()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"record-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{record()}}\"\n                 onmouseenter=\"{{hover(string('record-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n        \t\t{{string('record')}}\n        \t</div>\n        </div>\n\n        <div class=\"{{css}}-rightbutton-container\" ba-if=\"{{uploadcovershotvisible}}\">\n        \t<div data-selector=\"covershot-primary-button\" class=\"{{css}}-button-primary\"\n                 onmouseenter=\"{{hover(string('upload-covershot-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                 <input type=\"file\"\n\t\t\t\t       class=\"{{css}}-chooser-file\"\n\t\t\t\t       style=\"height:100\"\n\t\t\t\t       onchange=\"{{uploadCovershot(domEvent)}}\"\n\t\t\t\t       accept=\"{{covershot_accept_string}}\"\n\t\t\t\t />\n                 <span>\n        \t\t\t{{string('upload-covershot')}}\n        \t\t</span>\n        \t</div>\n        </div>\n\n        <div class=\"{{css}}-rightbutton-container\" ba-show=\"{{rerecordvisible}}\">\n        \t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"rerecord-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{rerecord()}}\"\n                 onmouseenter=\"{{hover(string('rerecord-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n        \t\t{{string('rerecord')}}\n        \t</div>\n        </div>\n\n\t\t<div class=\"{{css}}-rightbutton-container\" ba-show=\"{{cancelvisible}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{cancel()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"cancel-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t onclick=\"{{cancel()}}\"\n\t\t\t\t onmouseenter=\"{{hover(string('cancel-tooltip'))}}\"\n\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n\t\t\t\t{{string('cancel')}}\n\t\t\t</div>\n\t\t</div>\n\n        <div class=\"{{css}}-rightbutton-container\" ba-show=\"{{stopvisible}}\">\n        \t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{stop()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"stop-primary-button\" class=\"{{css}}-button-primary {{mintimeindicator ? css + '-disabled': ''}}\"\n\t\t\t\t title=\"{{mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')}}\"\n                 onclick=\"{{stop()}}\"\n                 onmouseenter=\"{{hover( mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n        \t\t{{string('stop')}}\n        \t</div>\n        </div>\n\n        <div class=\"{{css}}-centerbutton-container\" ba-show=\"{{skipvisible}}\">\n        \t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{skip()}}\"  onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"skip-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{skip()}}\"\n                 onmouseenter=\"{{hover(string('skip-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n        \t\t{{string('skip')}}\n        \t</div>\n        </div>\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-videorecorder",
                    "hovermessage": "",
                    "recordingindication": true,
                    "covershot_accept_string": "image/*,image/png,image/jpg,image/jpeg"
                },

                create: function() {
                    this.auto_destroy(new Timer({
                        context: this,
                        fire: function() {
                            this.set("recordingindication", !this.get("recordingindication"));
                        },
                        delay: 500
                    }));
                },

                functions: {
                    selectCamera: function(cameraId) {
                        this.trigger("select-camera", cameraId);
                    },
                    selectMicrophone: function(microphoneId) {
                        this.trigger("select-microphone", microphoneId);
                    },
                    hover: function(text) {
                        this.set("hovermessage", text);
                    },
                    unhover: function() {
                        this.set("hovermessage", "");
                    },
                    record: function() {
                        this.trigger("invoke-record");
                    },
                    rerecord: function() {
                        this.trigger("invoke-rerecord");
                    },
                    stop: function() {
                        this.trigger("invoke-stop");
                    },
                    skip: function() {
                        this.trigger("invoke-skip");
                    },
                    cancel: function() {
                        this.trigger("invoke-cancel");
                    },
                    uploadCovershot: function(domEvent) {
                        this.trigger("upload-covershot", domEvent[0].target);
                    }
                }

            };
        })
        .register("ba-videorecorder-controlbar")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "settingsvisible && settingsopen": function (obj) { with (obj) { return settingsvisible && settingsopen; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "!novideo && !allowscreen": function (obj) { with (obj) { return !novideo && !allowscreen; } }, "selectCamera(camera.id)": function (obj) { with (obj) { return selectCamera(camera.id); } }, "selectedcamera == camera.id": function (obj) { with (obj) { return selectedcamera == camera.id; } }, "camera.label": function (obj) { with (obj) { return camera.label; } }, "(!noaudio && !novideo) || !allowscreen": function (obj) { with (obj) { return (!noaudio && !novideo) || !allowscreen; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "!noaudio && !allowscreen": function (obj) { with (obj) { return !noaudio && !allowscreen; } }, "selectMicrophone(microphone.id)": function (obj) { with (obj) { return selectMicrophone(microphone.id); } }, "selectedmicrophone == microphone.id": function (obj) { with (obj) { return selectedmicrophone == microphone.id; } }, "microphone.label": function (obj) { with (obj) { return microphone.label; } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "settingsopen=!settingsopen": function (obj) { with (obj) { return settingsopen=!settingsopen; } }, "settingsopen ? 'selected' : 'unselected'": function (obj) { with (obj) { return settingsopen ? 'selected' : 'unselected'; } }, "hover(string('settings'))": function (obj) { with (obj) { return hover(string('settings')); } }, "unhover()": function (obj) { with (obj) { return unhover(); } }, "settingsvisible && !novideo && !allowscreen": function (obj) { with (obj) { return settingsvisible && !novideo && !allowscreen; } }, "hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))": function (obj) { with (obj) { return hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy')); } }, "camerahealthy ? 'good' : 'bad'": function (obj) { with (obj) { return camerahealthy ? 'good' : 'bad'; } }, "settingsvisible && !noaudio && !allowscreen": function (obj) { with (obj) { return settingsvisible && !noaudio && !allowscreen; } }, "hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))": function (obj) { with (obj) { return hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy')); } }, "microphonehealthy ? 'good' : 'bad'": function (obj) { with (obj) { return microphonehealthy ? 'good' : 'bad'; } }, "stopvisible && recordingindication": function (obj) { with (obj) { return stopvisible && recordingindication; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "record()": function (obj) { with (obj) { return record(); } }, "hover(string('record-tooltip'))": function (obj) { with (obj) { return hover(string('record-tooltip')); } }, "string('record')": function (obj) { with (obj) { return string('record'); } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "hover(string('upload-covershot-tooltip'))": function (obj) { with (obj) { return hover(string('upload-covershot-tooltip')); } }, "uploadCovershot(domEvent)": function (obj) { with (obj) { return uploadCovershot(domEvent); } }, "covershot_accept_string": function (obj) { with (obj) { return covershot_accept_string; } }, "string('upload-covershot')": function (obj) { with (obj) { return string('upload-covershot'); } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "hover(string('rerecord-tooltip'))": function (obj) { with (obj) { return hover(string('rerecord-tooltip')); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }, "cancelvisible": function (obj) { with (obj) { return cancelvisible; } }, "cancel()": function (obj) { with (obj) { return cancel(); } }, "hover(string('cancel-tooltip'))": function (obj) { with (obj) { return hover(string('cancel-tooltip')); } }, "string('cancel')": function (obj) { with (obj) { return string('cancel'); } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "stop()": function (obj) { with (obj) { return stop(); } }, "mintimeindicator ? css + '-disabled': ''": function (obj) { with (obj) { return mintimeindicator ? css + '-disabled': ''; } }, "mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')": function (obj) { with (obj) { return mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'); } }, "hover( mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))": function (obj) { with (obj) { return hover( mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')); } }, "string('stop')": function (obj) { with (obj) { return string('stop'); } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "skip()": function (obj) { with (obj) { return skip(); } }, "hover(string('skip-tooltip'))": function (obj) { with (obj) { return hover(string('skip-tooltip')); } }, "string('skip')": function (obj) { with (obj) { return string('skip'); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "settings": "Settings",
            "camerahealthy": "Lighting is good",
            "cameraunhealthy": "Lighting is not optimal",
            "microphonehealthy": "Sound is good",
            "microphoneunhealthy": "Cannot pick up any sound",
            "record": "Record",
            "record-tooltip": "Click here to record.",
            "rerecord": "Redo",
            "rerecord-tooltip": "Click here to redo.",
            "upload-covershot": "Upload Cover",
            "upload-covershot-tooltip": "Click here to upload custom cover shot",
            "stop": "Stop",
            "stop-tooltip": "Click here to stop.",
            "skip": "Skip",
            "skip-tooltip": "Click here to skip.",
            "stop-available-after": "Minimum recording time is %d seconds",
            "cancel": "Cancel",
            "cancel-tooltip": "Click here to cancel."
        });
});

Scoped.define("module:VideoRecorder.Dynamics.Faceoutline", ["dynamics:Dynamic"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<svg viewBox=\"0 0 301 171\" style=\"width:100%; height:100%\">\n    <g>\n        <path fill=\"none\" stroke=\"white\" stroke-width=\"2\" stroke-miterlimit=\"10\" stroke-dasharray=\"3.0228,3.0228\" d=\"M198.5,79.831c0,40.542-22.752,78.579-47.5,78.579c-24.749,0-47.5-38.036-47.5-78.579c0-40.543,17.028-68.24,47.5-68.24C185.057,11.591,198.5,39.288,198.5,79.831z\"></path>\n    </g>\n</svg>"

            };
        })
        .registerFunctions({ /**//**/ })
        .register("ba-recorderfaceoutline");
});

Scoped.define("module:VideoRecorder.Dynamics.Imagegallery", ["dynamics:Dynamic","base:Collections.Collection","base:Properties.Properties","base:Timers.Timer","browser:Dom","browser:Info"], ["dynamics:Partials.StylesPartial"], function (Class, Collection, Properties, Timer, Dom, Info, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div data-selector=\"slider-left-button\" class=\"{{css}}-imagegallery-leftbutton\">\n\t<div tabindex=\"0\" data-selector=\"slider-left-inner-button\"\n\t\t ba-hotkey:space^enter^left=\"{{left()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-imagegallery-button-inner\" onclick=\"{{left()}}\"\n\t>\n\t\t<i class=\"{{css}}-icon-left-open\"></i>\n\t</div>\n</div>\n\n<div data-selector=\"images-imagegallery-container\" ba-repeat=\"{{image::images}}\"\n\t class=\"{{css}}-imagegallery-container\" data-gallery-container>\n     <div tabindex=\"0\" class=\"{{css}}-imagegallery-image\"\n\t\t  ba-hotkey:space^enter=\"{{select(image)}}\" onmouseout=\"this.blur()\"\n          ba-styles=\"{{{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}}}\"\n          onclick=\"{{select(image)}}\"\n\t >\n\t\t <div class=\"{{css}}-imagegallery-image-compat\" ba-show=\"{{ie10below}}\"></div>\n     </div>\n</div>\n\n<div data-selector=\"slider-right-button\" class=\"{{css}}-imagegallery-rightbutton\">\n\t<div tabindex=\"0\" data-selector=\"slider-right-inner-button\"\n\t\t ba-hotkey:space^enter^right=\"{{right()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-imagegallery-button-inner\" onclick=\"{{right()}}\"\n\t>\n\t\t<i class=\"{{css}}-icon-right-open\"></i>\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-videorecorder",
                    "imagecount": 3,
                    "imagenativewidth": 0,
                    "imagenativeheight": 0,
                    "containerwidth": 0,
                    "containerheight": 0,
                    "containeroffset": 0,
                    "deltafrac": 1 / 8
                },

                computed: {
                    "imagewidth:imagecount,containerwidth,deltafrac": function() {
                        if (this.get("imagecount") <= 0)
                            return 0.0;
                        return this.get("containerwidth") * (1 - this.get("deltafrac")) / this.get("imagecount");
                    },
                    "imagedelta:imagecount,containerwidth,deltafrac": function() {
                        if (this.get("imagecount") <= 1)
                            return 0.0;
                        return this.get("containerwidth") * (this.get("deltafrac")) / (this.get("imagecount") - 1);
                    },
                    "imageheight:imagewidth,imagenativewidth,imagenativeheight": function() {
                        return this.get("imagenativeheight") * this.get("imagewidth") / this.get("imagenativewidth");
                    }
                },

                create: function() {
                    this.set("ie10below", Info.isInternetExplorer() && Info.internetExplorerVersion() <= 10);
                    var images = this.auto_destroy(new Collection());
                    this.set("images", images);
                    this.snapshotindex = 0;
                    this._updateImageCount();
                    this.on("change:imagecount", this._updateImageCount, this);
                    this.on("change:imagewidth change:imageheight change:imagedelta", this._recomputeImageBoxes, this);
                    this.auto_destroy(new Timer({
                        context: this,
                        delay: 1000,
                        fire: function() {
                            this.updateContainerSize();
                        }
                    }));
                },

                destroy: function() {
                    this.get("images").iterate(function(image) {
                        if (image.snapshotDisplay && this.parent().recorder)
                            this.parent().recorder.removeSnapshotDisplay(image.snapshotDisplay);
                    }, this);
                    inherited.destroy.call(this);
                },

                _updateImageCount: function() {
                    var images = this.get("images");
                    var n = this.get("imagecount");
                    while (images.count() < n) {
                        var image = new Properties({
                            index: images.count()
                        });
                        this._recomputeImageBox(image);
                        images.add(image);
                    }
                    while (images.count() > n)
                        images.remove(images.getByIndex(images.count() - 1));
                },

                _recomputeImageBoxes: function() {
                    this.get("images").iterate(function(image) {
                        this._recomputeImageBox(image);
                    }, this);
                },

                _recomputeImageBox: function(image) {
                    if (!this.parent().recorder)
                        return;
                    var i = image.get("index");
                    var iw = this.get("imagewidth");
                    var ih = this.get("imageheight");
                    var id = this.get("imagedelta");
                    var h = this.get("containerheight");
                    image.set("left", 1 + Math.round(i * (iw + id)));
                    image.set("top", 1 + Math.round((h - ih) / 2));
                    image.set("width", 1 + Math.round(iw));
                    image.set("height", 1 + Math.round(ih));
                    if (image.snapshot && image.snapshotDisplay) {
                        this.parent().recorder.updateSnapshotDisplay(
                            image.snapshot,
                            image.snapshotDisplay,
                            image.get("left") + this.get("containeroffset"),
                            image.get("top"),
                            image.get("width"),
                            image.get("height")
                        );
                    }
                },

                updateContainerSize: function() {
                    var container = this.activeElement().querySelector("[data-gallery-container]");
                    var offset = Dom.elementOffset(container);
                    var videoOffset = Dom.elementOffset(this.parent().recorder._element);
                    var left = offset.left - videoOffset.left;
                    var dimensions = Dom.elementDimensions(container);
                    this.set("containeroffset", left);
                    this.set("containerheight", dimensions.height);
                    this.set("containerwidth", dimensions.width);
                },

                _afterActivate: function(element) {
                    inherited._afterActivate.apply(this, arguments);
                    this.updateContainerSize();
                },

                loadImageSnapshot: function(image, snapshotindex) {
                    if (image.snapshotDisplay) {
                        this.parent().recorder.removeSnapshotDisplay(image.snapshotDisplay);
                        image.snapshotDisplay = null;
                    }
                    var snapshots = this.parent().snapshots;
                    image.snapshot = snapshots[((snapshotindex % snapshots.length) + snapshots.length) % snapshots.length];
                    image.snapshotDisplay = this.parent().recorder.createSnapshotDisplay(
                        this.activeElement(),
                        image.snapshot,
                        image.get("left") + this.get("containeroffset"),
                        image.get("top"),
                        image.get("width"),
                        image.get("height")
                    );
                },

                loadSnapshots: function() {
                    this.get("images").iterate(function(image) {
                        this.loadImageSnapshot(image, this.snapshotindex + image.get("index"));
                    }, this);
                },

                nextSnapshots: function() {
                    this.snapshotindex += this.get("imagecount");
                    this.loadSnapshots();
                },

                prevSnapshots: function() {
                    this.snapshotindex -= this.get("imagecount");
                    this.loadSnapshots();
                },

                functions: {
                    left: function() {
                        this.prevSnapshots();
                    },
                    right: function() {
                        this.nextSnapshots();
                    },
                    select: function(image) {
                        this.trigger("image-selected", image.snapshot);
                    }
                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "left()": function (obj) { with (obj) { return left(); } }, "images": function (obj) { with (obj) { return images; } }, "select(image)": function (obj) { with (obj) { return select(image); } }, "{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}": function (obj) { with (obj) { return {left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}; } }, "ie10below": function (obj) { with (obj) { return ie10below; } }, "right()": function (obj) { with (obj) { return right(); } }/**/ })
        .register("ba-videorecorder-imagegallery");
});

Scoped.define("module:VideoRecorder.Dynamics.Loader", ["dynamics:Dynamic","module:Assets"], ["dynamics:Partials.ShowPartial"], function (Class, Assets, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-loader-container\">\n    <div data-selector=\"recorder-loader-block\" class=\"{{css}}-loader-loader\" title=\"{{tooltip || ''}}\">\n    </div>\n</div>\n<div data-selector=\"recorder-loader-label-container\" class=\"{{css}}-loader-label\" ba-show=\"{{label}}\">\n\t{{label}}\n</div>\n",

                attrs: {
                    "css": "ba-videorecorder",
                    "tooltip": "",
                    "label": "",
                    "message": "",
                    "hovermessage": ""
                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "tooltip || ''": function (obj) { with (obj) { return tooltip || ''; } }, "label": function (obj) { with (obj) { return label; } }/**/ })
        .register("ba-videorecorder-loader")
        .attachStringTable(Assets.strings)
        .addStrings({});
});

Scoped.define("module:VideoRecorder.Dynamics.Message", ["dynamics:Dynamic"], ["dynamics:Partials.ClickPartial"], function (Class, Templates, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div data-selector=\"recorder-message-container\" class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"recorder-message-block\" class='{{css}}-message-message'>\n        <p>\n            {{message || \"\"}}\n        </p>\n        <ul ba-if=\"{{links && links.length > 0}}\" ba-repeat=\"{{link :: links}}\">\n            <li>\n                <a href=\"javascript:;\" ba-click=\"{{linkClick(link)}}\">\n                    {{link.title}}\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-videorecorder",
                    "message": '',
                    "links": null
                },

                functions: {

                    click: function() {
                        this.trigger("click");
                    },

                    linkClick: function(link) {
                        this.trigger("link", link);
                    }

                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }, "links && links.length > 0": function (obj) { with (obj) { return links && links.length > 0; } }, "links": function (obj) { with (obj) { return links; } }, "linkClick(link)": function (obj) { with (obj) { return linkClick(link); } }, "link.title": function (obj) { with (obj) { return link.title; } }/**/ })
        .register("ba-videorecorder-message");
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.State", ["base:States.State","base:Events.ListenMixin","base:Objs"], function (State, ListenMixin, Objs, scoped) {
    return State.extend({
        scoped: scoped
    }, [ListenMixin, {

        dynamics: [],

        _start: function() {
            this.dyn = this.host.dynamic;
            Objs.iter(Objs.extend({
                "message": false,
                "chooser": false,
                "topmessage": false,
                "controlbar": false,
                "loader": false,
                "imagegallery": false
            }, Objs.objectify(this.dynamics)), function(value, key) {
                this.dyn.set(key + "_active", value);
            }, this);
            this.dyn.set("playertopmessage", "");
            this.dyn.set("message_links", null);
            this.dyn._accessing_camera = false;
            this._started();
        },

        _started: function() {},

        record: function() {
            this.dyn.set("autorecord", true);
        },

        stop: function() {
            this.dyn.scopes.player.execute('stop');
        },

        play: function() {
            this.dyn.scopes.player.execute('play');
        },

        pause: function() {
            this.dyn.scopes.player.execute('pause');
        },

        rerecord: function() {},

        selectRecord: function() {},

        selectRecordScreen: function() {},

        selectUpload: function(file) {},

        uploadCovershot: function(file) {}

    }]);
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.FatalError", ["module:VideoRecorder.Dynamics.RecorderStates.State","browser:Info","base:Timers.Timer"], function (State, Info, Timer, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],
        _locals: ["message", "retry"],

        _started: function() {
            this.dyn.set("message", this._message || this.dyn.string("recorder-error"));
            this.dyn.set("shortMessage", this.dyn.get("message").length < 30);
            this.listenOn(this.dyn, "message-click", function() {
                if (this._retry)
                    this.next(this._retry);
            });
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.Initial", ["module:VideoRecorder.Dynamics.RecorderStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        _started: function() {
            this.dyn.set("is_initial_state", true);
            this.dyn.set("verified", false);
            this.dyn.set("playbacksource", null);
            this.dyn.set("playbackposter", null);
            this.dyn.set("player_active", false);
            this.dyn._videoFileName = null;
            this.dyn._videoFile = null;
            this.dyn._videoFilePlaybackable = false;
            this.dyn._initializeUploader();
            if (!this.dyn.get("recordermode")) {
                if (!this.dyn.get("video")) {
                    console.warn("recordermode:false requires an existing video to be present and provided.");
                    this.dyn.set("recordermode", true);
                } else
                    this.next("Player");
            } else if (this.dyn.get("autorecord") || this.dyn.get("skipinitial"))
                this.eventualNext("RequiredSoftwareCheck");
            else
                this.next("Chooser");
        },

        _end: function() {
            this.dyn.set("is_initial_state", false);
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.Player", ["module:VideoRecorder.Dynamics.RecorderStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        rerecord: function() {
            this.dyn.trigger("rerecord");
            this.dyn.set("recordermode", true);
            this.next("Initial");
        },

        _started: function() {
            this.dyn.set("player_active", true);
            if (this.dyn.get("allowtexttrackupload"))
                this.dyn.set("uploadtexttracksvisible", true);
        },

        _end: function() {
            this.dyn.set("player_active", false);
            this.dyn.set("uploadtexttracksvisible", false);
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.Chooser", ["module:VideoRecorder.Dynamics.RecorderStates.State","base:Strings","browser:Info","media:Player.Support"], function (State, Strings, Info, PlayerSupport, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["chooser"],

        _started: function() {
            this.listenOn(this.dyn, "change:orientation change:currentorientation", function() {
                var orientation = this.dyn.get("orientation");
                var currentorientation = this.dyn.get("currentorientation");
                var result = orientation && orientation !== currentorientation;
                if (result)
                    this.dyn.set("message", this.dyn.string("orientation-" + orientation + "-required"));
                this.dyn.set("message_active", result);
                this.dyn.set("chooser_active", !result);
            }, this, {
                initcall: true
            });
        },

        record: function() {
            this.dyn.set("autorecord", true);
            this.selectRecord();
        },

        selectRecordScreen: function() {
            this.dyn.set("record_media", "screen");
            this.next("RequiredSoftwareCheck");
        },

        selectRecord: function() {
            this.dyn.set("record_media", "camera");
            this.next("RequiredSoftwareCheck");
        },

        selectUpload: function(file) {
            if (!(Info.isMobile() && Info.isAndroid() && Info.isCordova())) {
                if (this.dyn.get("allowedextensions")) {
                    var filename = (file.files[0].name || "").toLowerCase();
                    var found = false;
                    this.dyn.get("allowedextensions").forEach(function(extension) {
                        if (Strings.ends_with(filename, "." + extension.toLowerCase()))
                            found = true;
                    }, this);
                    if (!found) {
                        this.next("FatalError", {
                            message: this.dyn.string("unsupported_video_type").replace("%s", this.dyn.get("allowedextensions").join(" / ")),
                            retry: "Chooser"
                        });
                        return;
                    }
                }
                if (this.dyn.get("filesizelimit") && file.files && file.files.length > 0 && file.files[0].size && file.files[0].size > this.dyn.get("filesizelimit")) {
                    var fact = "KB";
                    var size = Math.round(file.files[0].size / 1000);
                    var limit = Math.round(this.dyn.get("filesizelimit") / 1000);
                    if (size > 999) {
                        fact = "MB";
                        size = Math.round(size / 1000);
                        limit = Math.round(limit / 1000);
                    }
                    this.next("FatalError", {
                        message: this.dyn.string("video_file_too_large").replace("%s", size + fact + " / " + limit + fact),
                        retry: "Chooser"
                    });
                    return;
                }
            }
            try {
                PlayerSupport.videoFileInfo(file.files[0]).success(function(data) {
                    if (data.duration && this.dyn.get("enforce-duration")) {
                        if ((this.dyn.get("timeminlimit") && data.duration < this.dyn.get("timeminlimit")) || (this.dyn.get("timelimit") && data.duration > this.dyn.get("timelimit"))) {
                            this.next("FatalError", {
                                message: this.dyn.string("upload-error-duration"),
                                retry: "Chooser"
                            });
                            return;
                        }
                    }
                    if ((data.width && this.dyn.get("minuploadingwidth") && this.dyn.get("minuploadingwidth") > data.width) ||
                        (data.width && this.dyn.get("maxuploadingwidth") && this.dyn.get("maxuploadingwidth") < data.width) ||
                        (data.height && this.dyn.get("minuploadingheight") && this.dyn.get("minuploadingheight") > data.height) ||
                        (data.height && this.dyn.get("maxuploadingheight") && this.dyn.get("maxuploadingheight") < data.height)) {
                        this.next("FatalError", {
                            message: this.dyn.string("resolution-constraint-error"),
                            retry: "Chooser"
                        });
                        return;
                    }
                    this.dyn._videoFilePlaybackable = true;
                    this._uploadFile(file);
                }, this).error(function() {
                    this._uploadFile(file);
                }, this);
            } catch (e) {
                this._uploadFile(file);
            }
        },

        _uploadFile: function(file) {
            this.dyn.set("creation-type", Info.isMobile() ? "mobile" : "upload");
            try {
                this.dyn._videoFileName = file.files[0].name;
                this.dyn._videoFile = file.files[0];
            } catch (e) {}
            this.dyn._prepareRecording().success(function() {
                this.dyn.trigger("upload_selected", file);
                this.dyn._uploadVideoFile(file);
                this.next("Uploading");
            }, this).error(function(s) {
                this.next("FatalError", {
                    message: s,
                    retry: "Chooser"
                });
            }, this);
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.RequiredSoftwareCheck", ["module:VideoRecorder.Dynamics.RecorderStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            this.dyn.set("settingsvisible", false);
            this.dyn.set("recordvisible", false);
            this.dyn.set("rerecordvisible", false);
            this.dyn.set("stopvisible", false);
            this.dyn.set("skipvisible", false);
            this.dyn.set("controlbarlabel", "");
            this.dyn.set("loaderlabel", "");
            this.listenOn(this.dyn, "error", function(s) {
                this.next("FatalError", {
                    message: this.dyn.string("attach-error"),
                    retry: "Initial"
                });
            }, this);
            this.dyn._attachRecorder();
            if (this.dyn) {
                this.dyn.on("message-link-click", function(link) {
                    link.execute();
                    this.next("RequiredSoftwareWait");
                }, this);
                this.dyn._softwareDependencies().error(function(dependencies) {
                    this.dyn.set("message_links", dependencies);
                    this.dyn.set("loader_active", false);
                    this.dyn.set("message_active", true);
                    this.dyn.set("message", this.dyn.string("software-required"));
                }, this).success(function() {
                    this.next("CameraAccess");
                }, this);
            }
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.RequiredSoftwareWait", ["module:VideoRecorder.Dynamics.RecorderStates.State","base:Promise","browser:Dom"], function (State, Promise, Dom, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],

        _started: function() {
            this.dyn.set("settingsvisible", false);
            this.dyn.set("recordvisible", false);
            this.dyn.set("rerecordvisible", false);
            this.dyn.set("stopvisible", false);
            this.dyn.set("skipvisible", false);
            this.dyn.set("controlbarlabel", "");
            this.dyn.set("loaderlabel", "");
            this.dyn.set("message", this.dyn.string("software-waiting"));
            Promise.resilience(function() {
                if (Dom.isTabHidden())
                    return Promise.error("Not ready");
                return this.dyn._softwareDependencies();
            }, this, 120, [], 1000).success(function() {
                this.next("CameraAccess");
            }, this).error(function() {
                this.next("RequiredSoftwareCheck");
            }, this);
            this.dyn.on("message-click", function() {
                this.next("RequiredSoftwareCheck");
            }, this);
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.CameraAccess", ["module:VideoRecorder.Dynamics.RecorderStates.State","base:Timers.Timer"], function (State, Timer, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            this.dyn.set("settingsvisible", true);
            this.dyn.set("recordvisible", true);
            this.dyn.set("rerecordvisible", false);
            this.dyn.set("stopvisible", false);
            this.dyn.set("skipvisible", false);
            this.dyn.set("controlbarlabel", "");
            this.dyn.set("loaderlabel", "");
            this.listenOn(this.dyn, "bound", function() {
                this.dyn.set("creation-type", this.dyn.isFlash() ? "flash" : "webrtc");
                if (this.dyn.get("onlyaudio") || this.dyn.get("record_media") === "screen") {
                    this.next("CameraHasAccess");
                    return;
                }
                var timer = this.auto_destroy(new Timer({
                    start: true,
                    delay: 100,
                    context: this,
                    fire: function() {
                        if (this.dyn.blankLevel() >= 0.01 && this.dyn.deltaCoefficient() >= 0.01) {
                            timer.stop();
                            this.next("CameraHasAccess");
                        }
                    }
                }));
            }, this);
            this.listenOn(this.dyn, "error", function(s) {
                this.next("FatalError", {
                    message: this.dyn.string("attach-error"),
                    retry: "Initial"
                });
            }, this);
            this.listenOn(this.dyn, "access_forbidden", function() {
                this.next("FatalError", {
                    message: this.dyn.string("access-forbidden"),
                    retry: "Initial"
                });
            }, this);
            this.dyn._bindMedia();
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.CameraHasAccess", ["module:VideoRecorder.Dynamics.RecorderStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["topmessage", "controlbar"],

        _started: function() {
            this.dyn.trigger("ready_to_record");
            this._preparePromise = null;
            if (this.dyn.get("countdown") > 0 && this.dyn.recorder && this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions")) > this.dyn.get("countdown") * 1000)
                this._preparePromise = this.dyn._prepareRecording();
            this.dyn.set("hovermessage", "");
            this.dyn.set("topmessage", "");
            this.dyn.set("settingsvisible", true);
            this.dyn.set("recordvisible", true);
            this.dyn.set("rerecordvisible", false);
            this.dyn.set("stopvisible", false);
            this.dyn.set("skipvisible", false);
            this.dyn.set("controlbarlabel", "");
            if (this.dyn.get("autorecord"))
                this.next("RecordPrepare", {
                    preparePromise: this._preparePromise
                });
        },

        record: function() {
            if (this.dyn.get("autorecord"))
                return;
            if (this.dyn.get("audio-test-mandatory") && !this.dyn.get("microphonehealthy") && !this._preparePromise)
                return;
            this.next("RecordPrepare", {
                preparePromise: this._preparePromise
            });
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.RecordPrepare", ["module:VideoRecorder.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time"], function (State, Timer, Time, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],
        _locals: ["preparePromise"],

        _started: function() {
            this.dyn.set("message", "");
            this.dyn.set("loaderlabel", "");
            var startedRecording = false;
            this.dyn._accessing_camera = true;
            this._preparePromise = this._preparePromise || this.dyn._prepareRecording();
            var countdown = this.dyn.get("countdown") ? this.dyn.get("countdown") * 1000 : 0;
            var delay = this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions")) || 0;
            if (countdown) {
                var displayDenominator = 1000;
                var silentTime = 0;
                var startTime = Time.now();
                var endTime = startTime + Math.max(delay, countdown);
                if (delay > countdown) {
                    silentTime = Math.min(500, delay - countdown);
                    displayDenominator = (delay - silentTime) / countdown * 1000;
                } else
                    this.dyn.set("loaderlabel", this.dyn.get("countdown"));
                var timer = new Timer({
                    context: this,
                    delay: 50,
                    fire: function() {
                        var now = Time.now();
                        var time_left = Math.max(0, endTime - now);
                        if (now > silentTime + startTime) {
                            this.dyn.set("loaderlabel", "" + Math.ceil((time_left - silentTime) / displayDenominator));
                            this.dyn.trigger("countdown", Math.round((time_left - silentTime) / displayDenominator * 1000));
                        }
                        if (endTime <= now) {
                            this.dyn.set("loaderlabel", "");
                            timer.stop();
                        }
                        if ((time_left <= delay) && !startedRecording) {
                            startedRecording = true;
                            this._startRecording();
                        }
                    }
                });
                this.auto_destroy(timer);
            } else
                this._startRecording();
        },

        record: function() {
            this._startRecording();
        },

        _startRecording: function() {
            this._preparePromise.success(function() {
                this.dyn._startRecording().success(function() {
                    this.next("Recording");
                }, this).error(function(s) {
                    this.next("FatalError", {
                        message: s,
                        retry: "RequiredSoftwareCheck"
                    });
                }, this);
            }, this).error(function(s) {
                this.next("FatalError", {
                    message: s,
                    retry: "RequiredSoftwareCheck"
                });
            }, this);
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.Recording", ["module:VideoRecorder.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time","base:TimeFormat","base:Async"], function (State, Timer, Time, TimeFormat, Async, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["topmessage", "controlbar"],

        _started: function() {
            this.dyn.set("hovermessage", "");
            this.dyn.set("topmessage", "");
            this.dyn._accessing_camera = true;
            this.dyn.trigger("recording");
            this.dyn.set("settingsvisible", false);
            this.dyn.set("rerecordvisible", false);
            this.dyn.set("recordvisible", false);
            this.dyn.set("stopvisible", true);
            this.dyn.set("skipvisible", false);
            this._startTime = Time.now();
            this._stopping = false;
            this._timer = this.auto_destroy(new Timer({
                immediate: true,
                delay: 10,
                context: this,
                fire: this._timerFire
            }));
            this._framerateWarning = false;
        },

        _timerFire: function() {
            var limit = this.dyn.get("timelimit");
            var current = Time.now();
            var display = Math.max(0, limit ? (this._startTime + limit * 1000 - current) : (current - this._startTime));
            this.dyn.trigger("recording_progress", current - this._startTime);
            this.dyn.set("controlbarlabel", this.dyn.get("display-timer") ? TimeFormat.format(TimeFormat.ELAPSED_MINUTES_SECONDS, display) : "");

            if (this.dyn.get("timeminlimit"))
                this.dyn.set("mintimeindicator", (Time.now() - this._startTime) / 1000 <= this.dyn.get("timeminlimit"));

            if (limit && this._startTime + limit * 1000 <= current) {
                this._timer.stop();
                this.stop();
            }


            if (this.dyn.get("framerate-warning") && this.dyn.averageFrameRate()) {
                var framerateWarning = this.dyn.averageFrameRate() < this.dyn.get("framerate-warning");
                if (framerateWarning != this._framerateWarning) {
                    this._framerateWarning = framerateWarning;
                    if (framerateWarning)
                        this.dyn.set("hovermessage", this.dyn.string("framerate-warning"));
                    else
                        this.dyn.set("hovermessage", "");
                }
            }
        },

        stop: function() {
            var minlimit = this.dyn.get("timeminlimit");
            if (minlimit) {
                var delta = (Time.now() - this._startTime) / 1000;
                if (delta < minlimit) {
                    var limit = this.dyn.get("timelimit");
                    if (!limit || limit > delta)
                        return;
                }
            }
            if (this._stopping)
                return;
            this.dyn.set("loader_active", true);
            this.dyn.set("controlbar_active", false);
            this.dyn.set("topmessage_active", false);
            this.dyn.set("message_active", true);
            this.dyn.set("message", "");
            this._stopping = true;
            Async.eventually(function() {
                this.dyn._stopRecording().success(function() {
                    this._hasStopped();
                    if (this.dyn.get("picksnapshots") && this.dyn.snapshots.length >= this.dyn.get("gallerysnapshots"))
                        this.next("CovershotSelection");
                    else
                        this.next("Uploading");
                }, this).error(function(s) {
                    this.next("FatalError", {
                        message: s,
                        retry: "RequiredSoftwareCheck"
                    });
                }, this);
            }, this);
        },

        _hasStopped: function() {
            this.dyn.set("duration", Time.now() - this._startTime);
            this.dyn._showBackgroundSnapshot();
            this.dyn._unbindMedia();
            this.dyn.trigger("recording_stopped");
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.CovershotSelection", ["module:VideoRecorder.Dynamics.RecorderStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["imagegallery", "topmessage", "controlbar"],

        _started: function() {
            this.dyn.set("settingsvisible", false);
            this.dyn.set("recordvisible", false);
            this.dyn.set("stopvisible", false);
            this.dyn.set("skipvisible", true);
            this.dyn.set("controlbarlabel", "");
            this.dyn.set("rerecordvisible", this.dyn.get("early-rerecord"));
            this.dyn.set("uploadcovershotvisible", this.dyn.get("custom-covershots"));
            this.dyn.set("hovermessage", "");
            this.dyn.set("topmessage", this.dyn.string('pick-covershot'));
            var imagegallery = this.dyn.scope(">[tagname='ba-videorecorder-imagegallery']").materialize(true);
            imagegallery.loadSnapshots();
            imagegallery.updateContainerSize();
            this.listenOn(this.dyn, "invoke-skip", function() {
                this._nextUploading(true);
            }, this);
            this.listenOn(this.dyn, "select-image", function(image) {
                this.dyn._uploadCovershot(image);
                this._nextUploading(false);
            }, this);
        },

        rerecord: function() {
            this.dyn._hideBackgroundSnapshot();
            this.dyn._detachRecorder();
            this.dyn.trigger("rerecord");
            this.dyn.set("recordermode", true);
            this.next("Initial");
        },

        uploadCovershot: function(file) {
            this.dyn._uploadCovershotFile(file);
            this._nextUploading(false);
        },

        _nextUploading: function(skippedCovershot) {
            this.next("Uploading");
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.Uploading", ["module:VideoRecorder.Dynamics.RecorderStates.State","base:Time","base:Async","base:Objs"], function (State, Time, Async, Objs, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader", "message"],

        _started: function() {
            this.dyn.set("cancancel", true);
            this.dyn.set("skipinitial", this.dyn.get("skipinitial") || this.dyn.get("skipinitialonrerecord"));
            this.dyn.set("settingsvisible", false);
            this.dyn.set("recordvisible", false);
            this.dyn.set("stopvisible", false);
            this.dyn.set("loadlabel", "");
            this.dyn.set("controlbarlabel", "");
            this.dyn.trigger("uploading");
            this.dyn.set("rerecordvisible", this.dyn.get("early-rerecord"));
            if (this.dyn.get("early-rerecord"))
                this.dyn.set("controlbar_active", true);
            this.dyn.set("hovermessage", "");
            this.dyn.set("topmessage", "");
            this.dyn.set("message", this.dyn.string("uploading"));
            this.dyn.set("playertopmessage", this.dyn.get("message"));
            var uploader = this.dyn._dataUploader;
            this.listenOn(uploader, "success", function() {
                Async.eventually(function() {
                    if (this.destroyed())
                        return;
                    this._finished();
                    this.next("Verifying");
                }, this);
            });
            this.listenOn(uploader, "error", function(e) {
                var bestError = this.dyn.string("uploading-failed");
                try {
                    e.forEach(function(ee) {
                        for (var key in ee)
                            if (this.dyn.string("upload-error-" + key))
                                bestError = this.dyn.string("upload-error-" + key);
                    }, this);
                } catch (err) {}
                this.dyn.set("player_active", false);
                this.next("FatalError", {
                    message: bestError,
                    retry: this.dyn.recorderAttached() ? "Uploading" : "Initial"
                });
            });
            this.listenOn(uploader, "progress", function(uploaded, total) {
                this.dyn.trigger("upload_progress", uploaded, total);
                if (total !== 0 && total > 0 && uploaded >= 0) {
                    var up = Math.min(100, Math.round(uploaded / total * 100));
                    if (!isNaN(up)) {
                        this.dyn.set("message", this.dyn.string("uploading") + ": " + up + "%");
                        this.dyn.set("playertopmessage", this.dyn.get("message"));
                    }
                }
            });
            if (this.dyn.get("localplayback") && ((this.dyn.recorder && this.dyn.recorder.supportsLocalPlayback()) || this.dyn._videoFilePlaybackable)) {
                if (this.dyn.recorder && this.dyn.recorder.supportsLocalPlayback())
                    this.dyn.set("playbacksource", this.dyn.recorder.localPlaybackSource());
                else
                    this.dyn.set("playbacksource", (window.URL || window.webkitURL).createObjectURL(this.dyn._videoFile));
                if (this.dyn.__lastCovershotUpload && this.dyn.recorder)
                    this.dyn.set("playbackposter", this.dyn.recorder.snapshotToLocalPoster(this.dyn.__lastCovershotUpload));
                this.dyn.set("loader_active", false);
                this.dyn.set("message_active", false);
                this.dyn._hideBackgroundSnapshot();
                this.dyn.set("player_active", true);
            }
            this.dyn.set("start-upload-time", Time.now());
            uploader.reset();
            uploader.upload();
        },

        rerecord: function() {
            this.dyn._hideBackgroundSnapshot();
            this.dyn._detachRecorder();
            this.dyn.trigger("rerecord");
            this.dyn.set("recordermode", true);
            this.next("Initial");
        },

        _finished: function() {
            this.dyn.set("cancancel", false);
            this.dyn.trigger("uploaded");
            this.dyn.set("end-upload-time", Time.now());
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.RecorderStates.Verifying", ["module:VideoRecorder.Dynamics.RecorderStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader", "message"],

        _started: function() {
            this.dyn.set("loadlabel", "");
            this.dyn.trigger("verifying");
            this.dyn.set("message", this.dyn.string("verifying") + "...");
            this.dyn.set("playertopmessage", this.dyn.get("message"));
            if (this.dyn.get("localplayback") && ((this.dyn.recorder && this.dyn.recorder.supportsLocalPlayback()) || this.dyn._videoFilePlaybackable)) {
                this.dyn.set("loader_active", false);
                this.dyn.set("message_active", false);
            } else {
                this.dyn.set("rerecordvisible", this.dyn.get("early-rerecord"));
                if (this.dyn.get("early-rerecord"))
                    this.dyn.set("controlbar_active", true);
            }
            this.dyn._verifyRecording().success(function() {
                this.dyn.trigger("verified");
                this.dyn._hideBackgroundSnapshot();
                this.dyn._detachRecorder();
                if (this.dyn.get("recordings"))
                    this.dyn.set("recordings", this.dyn.get("recordings") - 1);
                this.dyn.set("message", "");
                this.dyn.set("playertopmessage", "");
                this.dyn.set("verified", true);
                this.next("Player");
            }, this).error(function() {
                this.dyn.set("player_active", false);
                this.next("FatalError", {
                    message: this.dyn.string("verifying-failed"),
                    retry: this.dyn.recorderAttached() ? "Verifying" : "Initial"
                });
            }, this);
        },

        rerecord: function() {
            this.dyn._hideBackgroundSnapshot();
            this.dyn._detachRecorder();
            this.dyn.trigger("rerecord");
            this.dyn.set("recordermode", true);
            this.next("Initial");
        }

    });
});

Scoped.define("module:VideoRecorder.Dynamics.Topmessage", ["dynamics:Dynamic"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"recorder-topmessage-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-videorecorder",
                    "topmessage": ''
                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }/**/ })
        .register("ba-videorecorder-topmessage");
});

Scoped.define("module:VideoRecorder.Dynamics.Recorder", ["dynamics:Dynamic","module:Assets","browser:Info","browser:Dom","browser:Upload.MultiUploader","browser:Upload.FileUploader","media:Recorder.VideoRecorderWrapper","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Collections.Collection","base:Promise","module:VideoRecorder.Dynamics.RecorderStates.Initial","module:VideoRecorder.Dynamics.RecorderStates"], ["module:VideoRecorder.Dynamics.Imagegallery","module:VideoRecorder.Dynamics.Loader","module:VideoRecorder.Dynamics.Controlbar","module:VideoRecorder.Dynamics.Message","module:VideoRecorder.Dynamics.Topmessage","module:VideoRecorder.Dynamics.Chooser","module:VideoRecorder.Dynamics.Faceoutline","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.DataPartial","dynamics:Partials.AttrsPartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"], function (Class, Assets, Info, Dom, MultiUploader, FileUploader, VideoRecorderWrapper, Types, Objs, Strings, Time, Timers, Host, ClassRegistry, Collection, Promise, InitialState, RecorderStates, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div data-selector=\"recorder-container\" ba-show=\"{{!player_active}}\"\n     class=\"{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? 'ie8' : 'noie8'}} {{csstheme}}\n     \t{{css}}-{{ fullscreened ? 'fullscreen' : 'normal' }}-view {{css}}-{{ firefox ? 'firefox' : 'common'}}-browser\n    \t{{css}}-{{themecolor}}-color\"\n     ba-styles=\"{{widthHeightStyles}}\"\n>\n\n    <video tabindex=\"-1\" data-selector=\"recorder-status\" class=\"{{css}}-video {{css}}-{{hasrecorder ? 'hasrecorder' : 'norecorder'}}\" data-video=\"video\" playsinline></video>\n\t<ba-recorderfaceoutline class=\"{{css}}-overlay\" ba-if=\"{{faceoutline && hasrecorder}}\">\n\t</ba-recorderfaceoutline>\n    <div data-selector=\"recorder-overlay\" class='{{css}}-overlay' ba-show=\"{{!hideoverlay}}\" data-overlay=\"overlay\">\n\t\t<ba-{{dynloader}}\n\t\t    ba-css=\"{{cssloader || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplloader}}\"\n\t\t    ba-show=\"{{loader_active}}\"\n\t\t    ba-tooltip=\"{{loadertooltip}}\"\n\t\t\tba-hovermessage=\"{{=hovermessage}}\"\n\t\t    ba-label=\"{{loaderlabel}}\"\n\t\t></ba-{{dynloader}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css=\"{{cssmessage || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplmessage}}\"\n\t\t    ba-show=\"{{message_active}}\"\n\t\t    ba-message=\"{{message}}\"\n\t\t\tba-links=\"{{message_links}}\"\n\t\t    ba-event:click=\"message_click\"\n\t\t\tba-event:link=\"message_link_click\"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dyntopmessage}}\n\t\t    ba-css=\"{{csstopmessage || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmpltopmessage}}\"\n\t\t    ba-show=\"{{topmessage_active && (topmessage || hovermessage)}}\"\n\t\t    ba-topmessage=\"{{hovermessage || topmessage}}\"\n\t\t></ba-{{dyntopmessage}}>\n\n\t\t<ba-{{dynchooser}}\n\t\t\tba-onlyaudio=\"{{onlyaudio}}\"\n\t\t\tba-recordviafilecapture=\"{{recordviafilecapture}}\"\n\t\t    ba-css=\"{{csschooser || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplchooser}}\"\n\t\t\tba-allowscreen=\"{{allowscreen}}\"\n\t\t    ba-if=\"{{chooser_active && !is_initial_state}}\"\n\t\t    ba-allowrecord=\"{{allowrecord}}\"\n\t\t    ba-allowupload=\"{{allowupload}}\"\n\t\t    ba-allowcustomupload=\"{{allowcustomupload}}\"\n\t\t    ba-allowedextensions=\"{{allowedextensions}}\"\n\t\t    ba-primaryrecord=\"{{primaryrecord}}\"\n\t\t    ba-timelimit=\"{{timelimit}}\"\n\t\t    ba-event:record=\"record_video\"\n\t\t\tba-event:record-screen=\"record_screen\"\n\t\t    ba-event:upload=\"video_file_selected\"\n\t\t></ba-{{dynchooser}}>\n\n\t\t<ba-{{dynimagegallery}}\n\t\t    ba-css=\"{{cssimagegallery || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplimagegallery}}\"\n\t\t    ba-if=\"{{imagegallery_active}}\"\n\t\t    ba-imagecount=\"{{gallerysnapshots}}\"\n\t\t    ba-imagenativewidth=\"{{nativeRecordingWidth}}\"\n\t\t    ba-imagenativeheight=\"{{nativeRecordingHeight}}\"\n\t\t    ba-event:image-selected=\"select_image\"\n\t\t></ba-{{dynimagegallery}}>\n\n\t\t<ba-{{dyncontrolbar}}\n\t\t    ba-css=\"{{csscontrolbar || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplcontrolbar}}\"\n\t\t    ba-show=\"{{controlbar_active}}\"\n\t\t    ba-cameras=\"{{cameras}}\"\n\t\t    ba-microphones=\"{{microphones}}\"\n\t\t    ba-noaudio=\"{{noaudio}}\"\n\t\t\tba-novideo=\"{{onlyaudio}}\"\n\t\t\tba-allowscreen=\"{{record_media==='screen'}}\"\n\t\t    ba-selectedcamera=\"{{selectedcamera || 0}}\"\n\t\t    ba-selectedmicrophone=\"{{selectedmicrophone || 0}}\"\n\t\t    ba-camerahealthy=\"{{camerahealthy}}\"\n\t\t    ba-microphonehealthy=\"{{microphonehealthy}}\"\n\t\t    ba-hovermessage=\"{{=hovermessage}}\"\n\t\t    ba-settingsvisible=\"{{settingsvisible}}\"\n\t\t    ba-recordvisible=\"{{recordvisible}}\"\n\t\t\tba-cancelvisible=\"{{allowcancel && cancancel}}\"\n\t\t    ba-uploadcovershotvisible=\"{{uploadcovershotvisible}}\"\n\t\t    ba-rerecordvisible=\"{{rerecordvisible}}\"\n\t\t    ba-stopvisible=\"{{stopvisible}}\"\n\t\t    ba-skipvisible=\"{{skipvisible}}\"\n\t\t    ba-controlbarlabel=\"{{controlbarlabel}}\"\n\t\t\tba-mintimeindicator=\"{{mintimeindicator}}\"\n\t\t\tba-timeminlimit=\"{{timeminlimit}}\"\n\t\t    ba-event:select-camera=\"select_camera\"\n\t\t    ba-event:select-microphone=\"select_microphone\"\n\t\t    ba-event:invoke-record=\"record\"\n\t\t    ba-event:invoke-rerecord=\"rerecord\"\n\t\t    ba-event:invoke-stop=\"stop\"\n\t\t    ba-event:invoke-skip=\"invoke_skip\"\n\t\t    ba-event:upload-covershot=\"upload_covershot\"\n\t\t></ba-{{dyncontrolbar}}>\n    </div>\n</div>\n\n<div data-selector=\"recorder-player\" ba-if=\"{{player_active}}\" ba-styles=\"{{widthHeightStyles}}\">\n\t<span ba-show=\"{{ie8}}\">&nbsp;</span>\n\t<ba-{{dynvideoplayer}}\n\t    ba-theme=\"{{theme || 'default'}}\"\n        ba-themecolor=\"{{themecolor}}\"\n        ba-source=\"{{playbacksource}}\"\n        ba-poster=\"{{playbackposter}}\"\n        ba-hideoninactivity=\"{{false}}\"\n        ba-forceflash=\"{{forceflash}}\"\n        ba-noflash=\"{{noflash}}\"\n        ba-stretch=\"{{stretch}}\"\n\t\tba-onlyaudio=\"{{onlyaudio}}\"\n        ba-attrs=\"{{playerattrs}}\"\n        ba-data:id=\"player\"\n        ba-width=\"{{width}}\"\n        ba-height=\"{{height}}\"\n        ba-totalduration=\"{{duration / 1000}}\"\n        ba-rerecordable=\"{{rerecordable && (recordings === null || recordings > 0)}}\"\n        ba-submittable=\"{{manualsubmit && verified}}\"\n        ba-reloadonplay=\"{{true}}\"\n        ba-autoplay=\"{{autoplay}}\"\n        ba-nofullscreen=\"{{nofullscreen}}\"\n        ba-topmessage=\"{{playertopmessage}}\"\n        ba-allowtexttrackupload=\"{{allowtexttrackupload}}\"\n        ba-uploadtexttracksvisible=\"{{uploadtexttracksvisible}}\"\n        ba-tracktags=\"{{tracktags}}\"\n        ba-tracktagsstyled=\"{{tracktagsstyled}}\"\n        ba-trackcuetext=\"{{trackcuetext}}\"\n        ba-acceptedtracktexts=\"{{acceptedtracktexts}}\"\n\t\tba-event:loaded=\"ready_to_play\"\n        ba-event:rerecord=\"rerecord\"\n        ba-event:playing=\"playing\"\n        ba-event:paused=\"paused\"\n        ba-event:ended=\"ended\"\n        ba-event:submit=\"manual_submit\"\n        ba-event:upload-text-tracks=\"upload_text_tracks\"\n\t\tba-tracksshowselection=\"{{tracksshowselection}}\"\n\t\tba-trackselectorhovered=\"{{trackselectorhovered}}\"\n\t\tba-uploadlocales=\"{{uploadlocales}}\"\n\t\tba-event:selected_label_value=\"selected_label_value\"\n\t\tba-event:move_to_option=\"move_to_option\"\n\t>\n\t</ba-{{dynvideoplayer}}>\n</div>\n",

                attrs: {
                    /* CSS */
                    "css": "ba-videorecorder",
                    "csscommon": "ba-commoncss",
                    "iecss": "ba-videorecorder",
                    "cssimagegallery": "",
                    "cssloader": "",
                    "csscontrolbar": "",
                    "cssmessage": "",
                    "csstopmessage": "",
                    "csschooser": "",
                    "width": "",
                    "height": "",
                    "gallerysnapshots": 3,

                    /* Themes */
                    "theme": "",
                    "csstheme": "",

                    /* Dynamics */
                    "dynimagegallery": "videorecorder-imagegallery",
                    "dynloader": "videorecorder-loader",
                    "dyncontrolbar": "videorecorder-controlbar",
                    "dynmessage": "videorecorder-message",
                    "dyntopmessage": "videorecorder-topmessage",
                    "dynchooser": "videorecorder-chooser",
                    "dynvideoplayer": "videoplayer",

                    /* Templates */
                    "tmplimagegallery": "",
                    "tmplloader": "",
                    "tmplcontrolbar": "",
                    "tmplmessage": "",
                    "tmpltopmessage": "",
                    "tmplchooser": "",

                    /* Attributes */
                    "autorecord": false,
                    "autoplay": false,
                    "allowrecord": true,
                    "allowupload": true,
                    "allowcustomupload": true,
                    "manual-upload": false,
                    "camerafacefront": false,
                    "primaryrecord": true,
                    "allowscreen": false,
                    "nofullscreen": false,
                    "recordingwidth": undefined,
                    "recordingheight": undefined,
                    "minuploadingwidth": undefined,
                    "maxuploadingwidth": undefined,
                    "minuploadingheight": undefined,
                    "maxuploadingheight": undefined,
                    "countdown": 3,
                    "snapshotmax": 15,
                    "framerate-warning": null,
                    "framerate": null,
                    "audiobitrate": null,
                    "videobitrate": null,
                    "snapshottype": "jpg",
                    "picksnapshots": true,
                    "playbacksource": "",
                    "screen": {},
                    "playbackposter": "",
                    "recordermode": true,
                    "skipinitial": false,
                    "skipinitialonrerecord": false,
                    "timelimit": null,
                    "timeminlimit": null,
                    "rtmpstreamtype": "mp4",
                    "rtmpmicrophonecodec": "speex",
                    "webrtcstreaming": false,
                    "webrtconmobile": false,
                    "webrtcstreamingifnecessary": false,
                    "microphone-volume": 1.0,
                    "flip-camera": false,
                    "early-rerecord": false,
                    "custom-covershots": false,
                    "manualsubmit": false,
                    "allowedextensions": null,
                    "filesizelimit": null,
                    "faceoutline": false,
                    "display-timer": true,

                    /* Configuration */
                    "forceflash": false,
                    "simulate": false,
                    "noflash": false,
                    "onlyaudio": false,
                    "noaudio": false,
                    "flashincognitosupport": false,
                    "enforce-duration": null,
                    "localplayback": false,
                    "uploadoptions": {},
                    "playerattrs": {},
                    "shortMessage": true,

                    /* Options */
                    "rerecordable": true,
                    "allowcancel": false,
                    "recordings": null,
                    "ready": true,
                    "orientation": false,
                    "stretch": false,
                    "audio-test-mandatory": false,

                    "allowtexttrackupload": false,
                    "uploadlocales": [{
                        lang: 'en',
                        label: 'English'
                    }]


                },

                computed: {
                    "nativeRecordingWidth:recordingwidth,record_media": function() {
                        return this.get("recordingwidth") || (this.get("record_media") !== "screen" ? 640 : (window.innerWidth || document.body.clientWidth));
                    },
                    "nativeRecordingHeight:recordingheight,record_media": function() {
                        return this.get("recordingheight") || (this.get("record_media") !== "screen" ? 480 : (window.innerHeight || document.body.clientHeight));
                    },
                    "widthHeightStyles:width,height": function() {
                        var result = {};
                        var width = this.get("width");
                        var height = this.get("height");
                        if (width)
                            result.width = width + ((width + '').match(/^\d+$/g) ? 'px' : '');
                        if (height)
                            result.height = height + ((height + '').match(/^\d+$/g) ? 'px' : '');
                        return result;
                    },
                    "canswitchcamera:recordviafilecapture": function() {
                        return !this.get("recordviafilecapture") && Info.isMobile();
                    }
                },

                scopes: {
                    player: ">[id='player']"
                },

                types: {
                    "allowscreen": "boolean",
                    "forceflash": "boolean",
                    "noflash": "boolean",
                    "rerecordable": "boolean",
                    "ready": "boolean",
                    "stretch": "boolean",
                    "autorecord": "boolean",
                    "autoplay": "boolean",
                    "allowrecord": "boolean",
                    "allowupload": "boolean",
                    "allowcustomupload": "boolean",
                    "primaryrecord": "boolean",
                    "flashincognitosupport": "boolean",
                    "recordermode": "boolean",
                    "nofullscreen": "boolean",
                    "skipinitialonrerecord": "boolean",
                    "picksnapshots": "boolean",
                    "localplayback": "boolean",
                    "camerafacefront": "boolean",
                    "noaudio": "boolean",
                    "skipinitial": "boolean",
                    "enforce-duration": "bool",
                    "webrtcstreaming": "boolean",
                    "webrtconmobile": "boolean",
                    "manual-upload": "boolean",
                    "webrtcstreamingifnecessary": "boolean",
                    "microphone-volume": "float",
                    "audiobitrate": "int",
                    "videobitrate": "int",
                    "minuploadingwidth": "int",
                    "maxuploadingwidth": "int",
                    "minuploadingheight": "int",
                    "maxuploadingheight": "int",
                    "framerate-warning": "int",
                    "flip-camera": "boolean",
                    "faceoutline": "boolean",
                    "early-rerecord": "boolean",
                    "custom-covershots": "boolean",
                    "manualsubmit": "boolean",
                    "simulate": "boolean",
                    "allowedextensions": "array",
                    "onlyaudio": "boolean",
                    "allowcancel": "boolean",
                    "display-timer": "boolean",
                    "audio-test-mandatory": "boolean",
                    "allowtexttrackupload": "boolean",
                    "uploadlocales": "array"
                },

                extendables: ["states"],

                remove_on_destroy: true,

                events: {
                    "change:camerahealthy": function(value) {
                        this.trigger("camerahealth", value);
                    },
                    "change:microphonehealthy": function(value) {
                        this.trigger("microphonehealth", value);
                    },
                    "change:webrtconmobile": function() {
                        this.set("recordviafilecapture", Info.isMobile() && (!this.get("webrtconmobile") || !VideoRecorderWrapper.anySupport(this._videoRecorderWrapperOptions())));
                    },
                    "change:recordviafilecapture": function() {
                        if (this.get("recordviafilecapture")) {
                            this.set("skipinitial", false);
                            this.set("skipinitialonrerecord", false);
                            this.set("allowscreen", false);
                            this.set("autorecord", false);
                        }
                    }
                },

                create: function() {
                    if (this.get("theme") in Assets.recorderthemes) {
                        Objs.iter(Assets.recorderthemes[this.get("theme")], function(value, key) {
                            if (!this.isArgumentAttr(key))
                                this.set(key, value);
                        }, this);
                    }
                    this.set("ie8", Info.isInternetExplorer() && Info.internetExplorerVersion() < 9);
                    this.set("hideoverlay", false);

                    this.set("canswitchcamera", false);
                    this.set("recordviafilecapture", Info.isMobile() && (!this.get("webrtconmobile") || !VideoRecorderWrapper.anySupport(this._videoRecorderWrapperOptions())));

                    if (this.get("recordviafilecapture")) {
                        this.set("skipinitial", false);
                        this.set("skipinitialonrerecord", false);
                        this.set("allowscreen", false);
                        this.set("autorecord", false);
                    }

                    this.__attachRequested = false;
                    this.__activated = false;
                    this._bound = false;
                    this.__recording = false;
                    this.__error = null;
                    this.__currentStretch = null;

                    this.on("change:stretch", function() {
                        this._updateStretch();
                    }, this);
                    this.host = new Host({
                        stateRegistry: new ClassRegistry(this.cls.recorderStates())
                    });
                    this.host.dynamic = this;
                    this.host.initialize(InitialState);

                    this._timer = new Timers.Timer({
                        context: this,
                        fire: this._timerFire,
                        delay: 250,
                        start: true
                    });

                    this.__cameraResponsive = true;
                    this.__cameraSignal = true;

                    if (this.get("onlyaudio")) {
                        this.set("picksnapshots", false);
                        this.set("allowupload", false);
                        this.set("orientation", false);
                    }
                    if (!Info.isMobile())
                        this.set("orientation", false);
                    this.set("currentorientation", window.innerHeight > window.innerWidth ? "portrait" : "landscape");
                },

                state: function() {
                    return this.host.state();
                },

                recorderAttached: function() {
                    return !!this.recorder;
                },

                videoError: function() {
                    return this.__error;
                },

                _error: function(error_type, error_code) {
                    this.__error = {
                        error_type: error_type,
                        error_code: error_code
                    };
                    this.trigger("error:" + error_type, error_code);
                    this.trigger("error", error_type, error_code);
                },

                _clearError: function() {
                    this.__error = null;
                },

                _detachRecorder: function() {
                    if (this.recorder)
                        this.recorder.weakDestroy();
                    this.recorder = null;
                    this.set("hasrecorder", false);
                },

                _videoRecorderWrapperOptions: function() {
                    return {
                        simulate: this.get("simulate"),
                        forceflash: this.get("forceflash"),
                        noflash: this.get("noflash"),
                        recordVideo: !this.get("onlyaudio"),
                        recordAudio: !this.get("noaudio"),
                        recordingWidth: this.get("nativeRecordingWidth"),
                        recordingHeight: this.get("nativeRecordingHeight"),
                        audioBitrate: this.get("audiobitrate"),
                        videoBitrate: this.get("videobitrate"),
                        flashFullSecurityDialog: !this.get("flashincognitosupport"),
                        rtmpStreamType: this.get("rtmpstreamtype"),
                        rtmpMicrophoneCodec: this.get("rtmpmicrophonecodec"),
                        webrtcStreaming: !!this.get("webrtcstreaming"),
                        webrtcStreamingIfNecessary: !!this.get("webrtcstreamingifnecessary"),
                        // webrtcOnMobile: !!this.get("webrtconmobile"),
                        localPlaybackRequested: this.get("localplayback"),
                        screen: this.get("allowscreen") && this.get("record_media") === "screen" ? this.get("screen") : null,
                        framerate: this.get("framerate"),
                        flip: this.get("flip-camera")
                    };
                },

                _attachRecorder: function() {
                    if (this.recorderAttached())
                        return;
                    if (!this.__activated) {
                        this.__attachRequested = true;
                        return;
                    }
                    this.set("hasrecorder", true);
                    this.snapshots = [];
                    this.__attachRequested = false;
                    var video = this.activeElement().querySelector("[data-video='video']");
                    this._clearError();
                    this.recorder = VideoRecorderWrapper.create(Objs.extend({
                        element: video
                    }, this._videoRecorderWrapperOptions()));
                    if (this.recorder)
                        this.trigger("attached");
                    else
                        this._error("attach");
                },

                _softwareDependencies: function() {
                    if (!this.recorderAttached() || !this.recorder)
                        return Promise.error("No recorder attached.");
                    return this.recorder.softwareDependencies();
                },

                _bindMedia: function() {
                    if (this._bound || !this.recorderAttached() || !this.recorder)
                        return;
                    this.recorder.ready.success(function() {
                        this.recorder.on("require_display", function() {
                            this.set("hideoverlay", true);
                        }, this);
                        this.recorder.bindMedia().error(function(e) {
                            this.trigger("access_forbidden", e);
                            this.set("hideoverlay", false);
                            this.off("require_display", null, this);
                            this._error("bind", e);
                        }, this).success(function() {
                            this.trigger("access_granted");
                            this.recorder.setVolumeGain(this.get("microphone-volume"));
                            this.set("hideoverlay", false);
                            this.off("require_display", null, this);
                            this.recorder.enumerateDevices().success(function(devices) {
                                var selected = this.recorder.currentDevices();
                                this.set("selectedcamera", selected.video);
                                this.set("selectedmicrophone", selected.audio);
                                this.set("cameras", new Collection(Objs.values(devices.video)));
                                this.set("microphones", new Collection(Objs.values(devices.audio)));
                                this.trigger(Types.is_empty(devices.video) ? "no_camera" : "has_camera");
                                this.trigger(Types.is_empty(devices.audio) ? "no_microphone" : "has_microphone");
                            }, this);
                            if (!this.get("noaudio"))
                                this.recorder.testSoundLevel(true);
                            this.set("devicetesting", true);
                            this._updateStretch();
                            while (this.snapshots.length > 0) {
                                var snapshot = this.snapshots.unshift();
                                this.recorder.removeSnapshot(snapshot);
                            }
                            this._bound = true;
                            this.trigger("bound");
                        }, this);
                    }, this);
                },

                isFlash: function() {
                    return this.recorder && this.recorder.isFlash();
                },

                _initializeUploader: function() {
                    if (this._dataUploader)
                        this._dataUploader.weakDestroy();
                    this._dataUploader = new MultiUploader();
                },

                _unbindMedia: function() {
                    if (!this._bound)
                        return;
                    this.recorder.unbindMedia();
                    this._bound = false;
                },

                _uploadCovershot: function(image) {
                    if (this.get("simulate"))
                        return;
                    this.__lastCovershotUpload = image;
                    var uploader = this.recorder.createSnapshotUploader(image, this.get("snapshottype"), this.get("uploadoptions").image);
                    uploader.upload();
                    this._dataUploader.addUploader(uploader);
                },

                _uploadCovershotFile: function(file) {
                    if (this.get("simulate"))
                        return;
                    this.__lastCovershotUpload = file;
                    var uploader = FileUploader.create(Objs.extend({
                        source: file
                    }, this.get("uploadoptions").image));
                    uploader.upload();
                    this._dataUploader.addUploader(uploader);
                },

                _uploadVideoFile: function(file) {
                    if (this.get("simulate"))
                        return;
                    var uploader = FileUploader.create(Objs.extend({
                        source: file
                    }, this.get("uploadoptions").video));
                    uploader.upload();
                    this._dataUploader.addUploader(uploader);
                },

                _prepareRecording: function() {
                    return Promise.create(true);
                },

                _startRecording: function() {
                    if (this.__recording)
                        return Promise.error(true);
                    if (!this.get("noaudio"))
                        this.recorder.testSoundLevel(false);
                    this.set("devicetesting", false);
                    return this.recorder.startRecord({
                        rtmp: this.get("uploadoptions").rtmp,
                        video: this.get("uploadoptions").video,
                        audio: this.get("uploadoptions").audio,
                        webrtcStreaming: this.get("uploadoptions").webrtcStreaming
                    }).success(function() {
                        this.__recording = true;
                        this.__recording_start_time = Time.now();
                    }, this);
                },

                _stopRecording: function() {
                    if (!this.__recording)
                        return Promise.error(true);
                    return this.recorder.stopRecord({
                        rtmp: this.get("uploadoptions").rtmp,
                        video: this.get("uploadoptions").video,
                        audio: this.get("uploadoptions").audio,
                        webrtcStreaming: this.get("uploadoptions").webrtcStreaming
                    }).success(function(uploader) {
                        this.__recording = false;
                        uploader.upload();
                        this._dataUploader.addUploader(uploader);
                    }, this);
                },

                isRecording: function() {
                    return this.__recording;
                },

                _verifyRecording: function() {
                    return Promise.create(true);
                },

                _afterActivate: function(element) {
                    inherited._afterActivate.call(this, element);
                    this.__activated = true;
                    if (this.__attachRequested)
                        this._attachRecorder();
                },

                _showBackgroundSnapshot: function() {
                    if (this.get("onlyaudio"))
                        return;
                    this._hideBackgroundSnapshot();
                    this.__backgroundSnapshot = this.recorder.createSnapshot(this.get("snapshottype"));
                    var el = this.activeElement().querySelector("[data-video]");
                    var dimensions = Dom.elementDimensions(el);
                    this.__backgroundSnapshotDisplay = this.recorder.createSnapshotDisplay(el, this.__backgroundSnapshot, 0, 0, dimensions.width, dimensions.height);
                },

                _hideBackgroundSnapshot: function() {
                    if (this.get("onlyaudio"))
                        return;
                    if (this.__backgroundSnapshotDisplay)
                        this.recorder.removeSnapshotDisplay(this.__backgroundSnapshotDisplay);
                    delete this.__backgroundSnapshotDisplay;
                    if (this.__backgroundSnapshot)
                        this.recorder.removeSnapshot(this.__backgroundSnapshot);
                    delete this.__backgroundSnapshot;
                },

                object_functions: ["record", "rerecord", "stop", "play", "pause", "reset"],

                functions: {

                    cancel: function() {
                        if (confirm(this.stringUnicode("cancel-confirm")))
                            this.execute("reset");
                    },

                    record: function() {
                        this.host.state().record();
                    },

                    record_video: function() {
                        this.host.state().selectRecord();
                    },

                    record_screen: function() {
                        this.host.state().selectRecordScreen();
                    },

                    video_file_selected: function(file) {
                        this.__selected_video_file = file;
                        if (!this.get("manual-upload"))
                            this.execute("upload_video");
                    },

                    upload_video: function(file) {
                        this.host.state().selectUpload(file || this.__selected_video_file);
                    },

                    upload_covershot: function(file) {
                        this.host.state().uploadCovershot(file);
                    },

                    select_camera: function(camera_id) {
                        if (this.recorder) {
                            this.recorder.setCurrentDevices({
                                video: camera_id
                            });
                            this.set("selectedcamera", camera_id);
                        }
                    },

                    select_microphone: function(microphone_id) {
                        if (this.recorder) {
                            this.recorder.setCurrentDevices({
                                audio: microphone_id
                            });
                            this.recorder.testSoundLevel(true);
                            this.set("selectedmicrophone", microphone_id);
                        }
                        this.set("microphonehealthy", false);
                    },

                    select_camera_face: function(faceFront) {
                        if (this.recorder) {
                            this.recorder.setCameraFace(faceFront);
                            this.set("camerafacefront", faceFront);
                        }
                    },

                    invoke_skip: function() {
                        this.trigger("invoke-skip");
                    },

                    select_image: function(image) {
                        this.trigger("select-image", image);
                    },

                    rerecord: function() {
                        if (confirm(this.stringUnicode("rerecord-confirm")))
                            this.host.state().rerecord();
                    },

                    stop: function() {
                        this.host.state().stop();
                    },

                    play: function() {
                        this.host.state().play();
                    },

                    pause: function() {
                        this.host.state().pause();
                    },

                    message_click: function() {
                        this.trigger("message-click");
                    },

                    message_link_click: function(link) {
                        this.trigger("message-link-click", link);
                    },

                    playing: function() {
                        this.trigger("playing");
                    },

                    paused: function() {
                        this.trigger("paused");
                    },

                    ended: function() {
                        this.trigger("ended");
                    },

                    reset: function() {
                        this._stopRecording().callback(function() {
                            this._unbindMedia();
                            this._hideBackgroundSnapshot();
                            this._detachRecorder();
                            this.host.state().next("Initial");
                        }, this);
                    },

                    manual_submit: function() {
                        this.set("rerecordable", false);
                        this.set("manualsubmit", false);
                        this.trigger("manually_submitted");
                    },

                    ready_to_play: function() {
                        this.trigger("ready_to_play");
                    }

                },

                destroy: function() {
                    this._timer.destroy();
                    this.host.destroy();
                    this._detachRecorder();
                    inherited.destroy.call(this);
                },

                deltaCoefficient: function() {
                    return this.recorderAttached() ? this.recorder.deltaCoefficient() : null;
                },

                blankLevel: function() {
                    return this.recorderAttached() ? this.recorder.blankLevel() : null;
                },

                lightLevel: function() {
                    return this.recorderAttached() ? this.recorder.lightLevel() : null;
                },

                soundLevel: function() {
                    return this.recorderAttached() ? this.recorder.soundLevel() : null;
                },

                _timerFire: function() {
                    if (this.destroyed())
                        return;
                    this.set("currentorientation", window.innerHeight > window.innerWidth ? "portrait" : "landscape");
                    try {
                        if (this.recorderAttached() && this.get("devicetesting")) {
                            var lightLevel = this.lightLevel();
                            this.set("camerahealthy", lightLevel >= 100 && lightLevel <= 200);
                            if (!this.get("noaudio") && !this.get("microphonehealthy") && this.soundLevel() >= 1.01) {
                                this.set("microphonehealthy", true);
                                this.recorder.testSoundLevel(false);
                            }
                        }
                    } catch (e) {}

                    if (!this.get("onlyaudio")) {
                        if (this.__recording && this.__recording_start_time + 500 < Time.now()) {
                            var p = this.snapshots.length < this.get("snapshotmax") ? 0.25 : 0.05;
                            if (Math.random() <= p) {
                                var snap = this.recorder.createSnapshot(this.get("snapshottype"));
                                if (snap) {
                                    if (this.snapshots.length < this.get("snapshotmax")) {
                                        this.snapshots.push(snap);
                                    } else {
                                        var i = Math.floor(Math.random() * this.get("snapshotmax"));
                                        this.recorder.removeSnapshot(this.snapshots[i]);
                                        this.snapshots[i] = snap;
                                    }
                                }
                            }
                        }
                    }

                    try {
                        if (this.recorderAttached() && this._timer.fire_count() % 20 === 0 && this._accessing_camera) {
                            var signal = this.blankLevel() >= 0.01;
                            if (signal !== this.__cameraSignal) {
                                this.__cameraSignal = signal;
                                this.trigger(signal ? "camera_signal" : "camera_nosignal");
                            }
                        }
                        if (this.recorderAttached() && this._timer.fire_count() % 20 === 10 && this._accessing_camera) {
                            var delta = this.recorder.deltaCoefficient();
                            var responsive = delta === null || delta >= 0.5;
                            if (responsive !== this.__cameraResponsive) {
                                this.__cameraResponsive = responsive;
                                this.trigger(responsive ? "camera_responsive" : "camera_unresponsive");
                            }
                        }
                    } catch (e) {}

                    this._updateStretch();
                    this._updateCSSSize();
                },

                _updateCSSSize: function() {
                    var width = Dom.elementDimensions(this.activeElement()).width;
                    this.set("csssize", width > 400 ? "normal" : (width > 300 ? "medium" : "small"));
                },

                videoHeight: function() {
                    return this.recorderAttached() ? this.recorder.cameraHeight() : NaN;
                },

                videoWidth: function() {
                    return this.recorderAttached() ? this.recorder.cameraWidth() : NaN;
                },

                aspectRatio: function() {
                    return this.videoWidth() / this.videoHeight();
                },

                parentWidth: function() {
                    return this.get("width") || Dom.elementDimensions(this.activeElement()).width;
                },

                parentHeight: function() {
                    return this.get("height") || Dom.elementDimensions(this.activeElement()).height;
                },

                parentAspectRatio: function() {
                    return this.parentWidth() / this.parentHeight();
                },

                averageFrameRate: function() {
                    return this.recorderAttached() ? this.recorder.averageFrameRate() : null;
                },

                _updateStretch: function() {
                    var newStretch = null;
                    if (this.get("stretch")) {
                        var ar = this.aspectRatio();
                        if (isFinite(ar)) {
                            var par = this.parentAspectRatio();
                            if (isFinite(par)) {
                                if (par > ar)
                                    newStretch = "height";
                                if (par < ar)
                                    newStretch = "width";
                            } else if (par === Infinity)
                                newStretch = "height";
                        }
                    }
                    if (this.__currentStretch !== newStretch) {
                        if (this.__currentStretch)
                            Dom.elementRemoveClass(this.activeElement(), this.get("css") + "-stretch-" + this.__currentStretch);
                        if (newStretch)
                            Dom.elementAddClass(this.activeElement(), this.get("css") + "-stretch-" + newStretch);
                    }
                    this.__currentStretch = newStretch;
                }

            };
        }, {

            recorderStates: function() {
                return [RecorderStates];
            }

        })
        .register("ba-videorecorder")
        .registerFunctions({ /**/"!player_active": function (obj) { with (obj) { return !player_active; } }, "css": function (obj) { with (obj) { return css; } }, "csssize": function (obj) { with (obj) { return csssize; } }, "iecss": function (obj) { with (obj) { return iecss; } }, "ie8 ? 'ie8' : 'noie8'": function (obj) { with (obj) { return ie8 ? 'ie8' : 'noie8'; } }, "csstheme": function (obj) { with (obj) { return csstheme; } }, "fullscreened ? 'fullscreen' : 'normal'": function (obj) { with (obj) { return fullscreened ? 'fullscreen' : 'normal'; } }, "firefox ? 'firefox' : 'common'": function (obj) { with (obj) { return firefox ? 'firefox' : 'common'; } }, "themecolor": function (obj) { with (obj) { return themecolor; } }, "widthHeightStyles": function (obj) { with (obj) { return widthHeightStyles; } }, "hasrecorder ? 'hasrecorder' : 'norecorder'": function (obj) { with (obj) { return hasrecorder ? 'hasrecorder' : 'norecorder'; } }, "faceoutline && hasrecorder": function (obj) { with (obj) { return faceoutline && hasrecorder; } }, "!hideoverlay": function (obj) { with (obj) { return !hideoverlay; } }, "dynloader": function (obj) { with (obj) { return dynloader; } }, "cssloader || css": function (obj) { with (obj) { return cssloader || css; } }, "tmplloader": function (obj) { with (obj) { return tmplloader; } }, "loader_active": function (obj) { with (obj) { return loader_active; } }, "loadertooltip": function (obj) { with (obj) { return loadertooltip; } }, "hovermessage": function (obj) { with (obj) { return hovermessage; } }, "loaderlabel": function (obj) { with (obj) { return loaderlabel; } }, "dynmessage": function (obj) { with (obj) { return dynmessage; } }, "cssmessage || css": function (obj) { with (obj) { return cssmessage || css; } }, "tmplmessage": function (obj) { with (obj) { return tmplmessage; } }, "message_active": function (obj) { with (obj) { return message_active; } }, "message": function (obj) { with (obj) { return message; } }, "message_links": function (obj) { with (obj) { return message_links; } }, "dyntopmessage": function (obj) { with (obj) { return dyntopmessage; } }, "csstopmessage || css": function (obj) { with (obj) { return csstopmessage || css; } }, "tmpltopmessage": function (obj) { with (obj) { return tmpltopmessage; } }, "topmessage_active && (topmessage || hovermessage)": function (obj) { with (obj) { return topmessage_active && (topmessage || hovermessage); } }, "hovermessage || topmessage": function (obj) { with (obj) { return hovermessage || topmessage; } }, "dynchooser": function (obj) { with (obj) { return dynchooser; } }, "onlyaudio": function (obj) { with (obj) { return onlyaudio; } }, "recordviafilecapture": function (obj) { with (obj) { return recordviafilecapture; } }, "csschooser || css": function (obj) { with (obj) { return csschooser || css; } }, "tmplchooser": function (obj) { with (obj) { return tmplchooser; } }, "allowscreen": function (obj) { with (obj) { return allowscreen; } }, "chooser_active && !is_initial_state": function (obj) { with (obj) { return chooser_active && !is_initial_state; } }, "allowrecord": function (obj) { with (obj) { return allowrecord; } }, "allowupload": function (obj) { with (obj) { return allowupload; } }, "allowcustomupload": function (obj) { with (obj) { return allowcustomupload; } }, "allowedextensions": function (obj) { with (obj) { return allowedextensions; } }, "primaryrecord": function (obj) { with (obj) { return primaryrecord; } }, "timelimit": function (obj) { with (obj) { return timelimit; } }, "dynimagegallery": function (obj) { with (obj) { return dynimagegallery; } }, "cssimagegallery || css": function (obj) { with (obj) { return cssimagegallery || css; } }, "tmplimagegallery": function (obj) { with (obj) { return tmplimagegallery; } }, "imagegallery_active": function (obj) { with (obj) { return imagegallery_active; } }, "gallerysnapshots": function (obj) { with (obj) { return gallerysnapshots; } }, "nativeRecordingWidth": function (obj) { with (obj) { return nativeRecordingWidth; } }, "nativeRecordingHeight": function (obj) { with (obj) { return nativeRecordingHeight; } }, "dyncontrolbar": function (obj) { with (obj) { return dyncontrolbar; } }, "csscontrolbar || css": function (obj) { with (obj) { return csscontrolbar || css; } }, "tmplcontrolbar": function (obj) { with (obj) { return tmplcontrolbar; } }, "controlbar_active": function (obj) { with (obj) { return controlbar_active; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "noaudio": function (obj) { with (obj) { return noaudio; } }, "record_media==='screen'": function (obj) { with (obj) { return record_media==='screen'; } }, "selectedcamera || 0": function (obj) { with (obj) { return selectedcamera || 0; } }, "selectedmicrophone || 0": function (obj) { with (obj) { return selectedmicrophone || 0; } }, "camerahealthy": function (obj) { with (obj) { return camerahealthy; } }, "microphonehealthy": function (obj) { with (obj) { return microphonehealthy; } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "allowcancel && cancancel": function (obj) { with (obj) { return allowcancel && cancancel; } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "mintimeindicator": function (obj) { with (obj) { return mintimeindicator; } }, "timeminlimit": function (obj) { with (obj) { return timeminlimit; } }, "player_active": function (obj) { with (obj) { return player_active; } }, "ie8": function (obj) { with (obj) { return ie8; } }, "dynvideoplayer": function (obj) { with (obj) { return dynvideoplayer; } }, "theme || 'default'": function (obj) { with (obj) { return theme || 'default'; } }, "playbacksource": function (obj) { with (obj) { return playbacksource; } }, "playbackposter": function (obj) { with (obj) { return playbackposter; } }, "false": function (obj) { with (obj) { return false; } }, "forceflash": function (obj) { with (obj) { return forceflash; } }, "noflash": function (obj) { with (obj) { return noflash; } }, "stretch": function (obj) { with (obj) { return stretch; } }, "playerattrs": function (obj) { with (obj) { return playerattrs; } }, "width": function (obj) { with (obj) { return width; } }, "height": function (obj) { with (obj) { return height; } }, "duration / 1000": function (obj) { with (obj) { return duration / 1000; } }, "rerecordable && (recordings === null || recordings > 0)": function (obj) { with (obj) { return rerecordable && (recordings === null || recordings > 0); } }, "manualsubmit && verified": function (obj) { with (obj) { return manualsubmit && verified; } }, "true": function (obj) { with (obj) { return true; } }, "autoplay": function (obj) { with (obj) { return autoplay; } }, "nofullscreen": function (obj) { with (obj) { return nofullscreen; } }, "playertopmessage": function (obj) { with (obj) { return playertopmessage; } }, "allowtexttrackupload": function (obj) { with (obj) { return allowtexttrackupload; } }, "uploadtexttracksvisible": function (obj) { with (obj) { return uploadtexttracksvisible; } }, "tracktags": function (obj) { with (obj) { return tracktags; } }, "tracktagsstyled": function (obj) { with (obj) { return tracktagsstyled; } }, "trackcuetext": function (obj) { with (obj) { return trackcuetext; } }, "acceptedtracktexts": function (obj) { with (obj) { return acceptedtracktexts; } }, "tracksshowselection": function (obj) { with (obj) { return tracksshowselection; } }, "trackselectorhovered": function (obj) { with (obj) { return trackselectorhovered; } }, "uploadlocales": function (obj) { with (obj) { return uploadlocales; } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "recorder-error": "An error occurred, please try again later. Click to retry.",
            "attach-error": "We could not access the media interface. Depending on the device and browser, you might need to install Flash or access the page via SSL.",
            "software-required": "Please click below to install / activate the following requirements in order to proceed.",
            "software-waiting": "Waiting for the requirements to be installed / activated. You might need to refresh the page after completion.",
            "access-forbidden": "Access to the media was forbidden. Click to retry.",
            "pick-covershot": "Pick a covershot.",
            "framerate-warning": "The video frame rate is very low. We recommend closing all other programs and browser tabs or to use a faster computer.",
            "uploading": "Uploading",
            "uploading-failed": "Uploading failed - click here to retry.",
            "upload-error-duration": "Length of the uploaded video does not meet the requirements - click here to retry.",
            "resolution-constraint-error": "The file you've selected does not match the required resolution - click here to retry.",
            "verifying": "Verifying",
            "verifying-failed": "Verifying failed - click here to retry.",
            "rerecord-confirm": "Do you really want to redo your video?",
            "cancel-confirm": "Do you really want to cancel your video upload?",
            "video_file_too_large": "Your video file is too large (%s) - click here to try again with a smaller video file.",
            "unsupported_video_type": "Please upload: %s - click here to retry.",
            "orientation-portrait-required": "Please rotate your device to record in portrait mode.",
            "orientation-landscape-required": "Please rotate your device to record in landscape mode."
        });
});

Scoped.define("module:ImageViewer.Dynamics.Controlbar", ["dynamics:Dynamic","module:Assets","browser:Info"], ["dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.ClickPartial"], function (Class, Assets, Info, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\t<div class=\"{{css}}-backbar\"></div>\n\n\t<div class=\"{{css}}-controlbar\">\n\n        <div tabindex=\"0\" data-selector=\"submit-image-button\"\n\t\t\t ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\"\n\t\t\t ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\">\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-image')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\" ba-if=\"{{rerecordable}}\"\n\t\t\t ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-image')}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n\t\t<div data-selector=\"image-title-block\" class=\"{{css}}-image-title-container\" ba-if=\"{{title}}\">\n\t\t\t<p class=\"{{css}}-image-title\">\n\t\t\t\t{{title}}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-rightbutton-container\"\n\t\t\t onkeydown=\"{{tab_index_move(domEvent)}}\" ba-if=\"{{fullscreen}}\"\n\t\t\t ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\">\n\t\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t\t<i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-imageviewer",
                    "rerecordable": false,
                    "submittable": false,
                    "fullscreen": true,
                    "fullscreened": false,
                    "activitydelta": 0,
                    "title": ""
                },

                functions: {

                    toggle_fullscreen: function() {
                        this.trigger("fullscreen");
                    },

                    rerecord: function() {
                        this.trigger("rerecord");
                    },

                    submit: function() {
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                        this.trigger("submit");
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        this.trigger("tab_index_move", ev[0], nextSelector, focusingSelector);
                    }
                },

                create: function() {
                    this.set("ismobile", Info.isMobile());
                }
            };
        })
        .register("ba-imageviewer-controlbar")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }, "title": function (obj) { with (obj) { return title; } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "rerecord-image": "Redo?",
            "submit-image": "Confirm",
            "fullscreen-image": "Enter fullscreen",
            "exit-fullscreen-image": "Exit fullscreen"
        });
});

Scoped.define("module:ImageViewer.Dynamics.Message", ["dynamics:Dynamic"], ["dynamics:Partials.ClickPartial"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"message-block\" class='{{css}}-message-message'>\n        {{message}}\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-imageviewer",
                    "message": ''
                },

                functions: {

                    click: function() {
                        this.trigger("click");
                    }

                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message": function (obj) { with (obj) { return message; } }/**/ })
        .register("ba-imageviewer-message");
});

Scoped.define("module:ImageViewer.Dynamics.Topmessage", ["dynamics:Dynamic"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"topmessage-message-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-imageviewer",
                    "topmessage": ''
                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }/**/ })
        .register("ba-imageviewer-topmessage");
});

Scoped.define("module:ImageViewer.Dynamics.ImageViewer", ["dynamics:Dynamic","module:Assets","browser:Info","browser:Dom","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:Classes.ClassRegistry","base:Async","browser:Events"], ["module:ImageViewer.Dynamics.Message","module:ImageViewer.Dynamics.Controlbar","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"], function (Class, Assets, Info, Dom, Types, Objs, Strings, Time, Timers, ClassRegistry, Async, DomEvents, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div itemscope itemtype=\"http://schema.org/ImageObject\"\n    class=\"{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? 'ie8' : 'noie8'}} {{csstheme}} {{css}}-{{ fullscreened ? 'fullscreen' : 'normal' }}-view {{css}}-{{ firefox ? 'firefox' : 'common'}}-browser\n    {{css}}-{{themecolor}}-color\"\n    ba-on:mousemove=\"{{user_activity()}}\"\n    ba-on:mousedown=\"{{user_activity(true)}}\"\n    ba-on:touchstart=\"{{user_activity(true)}}\"\n\tba-styles=\"{{widthHeightStyles}}\"\n>\n    <img tabindex=\"-1\" class=\"{{css}}-image\" data-image=\"image\" />\n    <div class=\"{{css}}-overlay\">\n\t    <ba-{{dyncontrolbar}}\n\t\t    ba-css=\"{{csscontrolbar || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplcontrolbar}}\"\n\t\t    ba-show=\"{{controlbar_active}}\"\n\t\t    ba-event:rerecord=\"rerecord\"\n\t\t    ba-event:submit=\"submit\"\n\t\t    ba-event:fullscreen=\"toggle_fullscreen\"\n\t\t\tba-event:tab_index_move=\"tab_index_move\"\n\t\t\tba-tabindex=\"{{tabindex}}\"\n\t\t    ba-title=\"{{title}}\"\n\t\t    ba-activitydelta=\"{{activity_delta}}\"\n\t\t    ba-hideoninactivity=\"{{hideoninactivity}}\"\n\t\t    ba-rerecordable=\"{{rerecordable}}\"\n\t\t    ba-submittable=\"{{submittable}}\"\n\t\t    ba-fullscreen=\"{{fullscreensupport && !nofullscreen}}\"\n            ba-fullscreened=\"{{fullscreened}}\"\n            ba-source=\"{{source}}\"\n\t\t></ba-{{dyncontrolbar}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css=\"{{cssmessage || css}}\"\n\t\t\tba-theme-color=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplmessage}}\"\n\t\t    ba-show=\"{{message_active}}\"\n\t\t    ba-message=\"{{message}}\"\n\t\t    ba-event:click=\"message_click\"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dyntopmessage}}\n\t\t    ba-css=\"{{csstopmessage || css}}\"\n\t\t\tba-theme-color=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmpltopmessage}}\"\n\t\t    ba-show=\"{{topmessage}}\"\n\t\t    ba-topmessage=\"{{topmessage}}\"\n\t\t></ba-{{dyntopmessage}}>\n\t\t\n\t\t<meta itemprop=\"caption\" content=\"{{title}}\" />\n\t\t<meta itemprop=\"thumbnailUrl\" content=\"{{poster}}\"/>\n\t\t<meta itemprop=\"contentUrl\" content=\"{{source}}\"/>\n    </div>\n</div>\n",

                attrs: {
                    /* CSS */
                    "css": "ba-imageviewer",
                    "iecss": "ba-imageviewer",
                    "cssmessage": "",
                    "csstopmessage": "",
                    "csscontrolbar": "",
                    "width": "",
                    "height": "",
                    "popup-width": "",
                    "popup-height": "",
                    /* Themes */
                    "theme": "",
                    "csstheme": "",
                    "themecolor": "",
                    /* Dynamics */
                    "dynmessage": "imageviewer-message",
                    "dyntopmessage": "imageviewer-topmessage",
                    "dyncontrolbar": "imageviewer-controlbar",
                    /* Templates */
                    "tmplmessage": "",
                    "tmpltopmessage": "",
                    "tmplcontrolbar": "",
                    /* Attributes */
                    "source": "",
                    "title": "",
                    "fullscreened": false,
                    "visibilityfraction": 0.8,

                    /* Options */
                    "rerecordable": false,
                    "submittable": false,
                    "popup": false,
                    "nofullscreen": false,
                    "ready": true,
                    "stretch": false,
                    "popup-stretch": false,
                    "hideoninactivity": true,
                    "topmessage": "",
                    "initialoptions": {
                        "hideoninactivity": null
                    }
                },

                types: {
                    "rerecordable": "boolean",
                    "ready": "boolean",
                    "nofullscreen": "boolean",
                    "stretch": "boolean",
                    "hideoninactivity": "boolean",
                    "popup": "boolean",
                    "popup-stretch": "boolean",
                    "popup-width": "int",
                    "popup-height": "int",
                    "fullscreened": "boolean",
                    "themecolor": "string"
                },

                computed: {
                    "widthHeightStyles:width,height": function() {
                        var result = {};
                        var width = this.get("width");
                        var height = this.get("height");
                        if (width)
                            result.width = width + ((width + '').match(/^\d+$/g) ? 'px' : '');
                        if (height)
                            result.height = height + ((height + '').match(/^\d+$/g) ? 'px' : '');
                        return result;
                    }
                },

                events: {
                    "change:source": function() {
                        var img = this.image();
                        if (img)
                            img.src = this.get("source");
                    }
                },

                remove_on_destroy: true,

                create: function() {
                    if (this.get("theme") in Assets.imageviewerthemes) {
                        Objs.iter(Assets.imageviewerthemes[this.get("theme")], function(value, key) {
                            if (!this.isArgumentAttr(key))
                                this.set(key, value);
                        }, this);
                    }

                    if (!this.get("themecolor"))
                        this.set("themecolor", "default");

                    this.set("ie8", Info.isInternetExplorer() && Info.internetExplorerVersion() < 9);
                    this.set("firefox", Info.isFirefox());
                    this.set("message", "");
                    this.set("fullscreensupport", Dom.elementSupportsFullscreen(this.activeElement()));
                    this.set("csssize", "normal");

                    this.set("controlbar_active", this.get("fullscreensupport") || this.get("submittable") || this.get("rerecordable"));
                    this.set("message_active", false);

                    this.set("last_activity", Time.now());
                    this.set("activity_delta", 0);

                    this.__currentStretch = null;

                    // Set initial options for further help actions
                    this.set("initialoptions", {
                        hideoninactivity: this.get("hideoninactivity")
                    });
                    this.activeElement().onkeydown = this._keyDownActivity.bind(this, this.activeElement());

                    this.on("change:stretch", function() {
                        this._updateStretch();
                    }, this);

                    this._timer = new Timers.Timer({
                        context: this,
                        fire: this._timerFire,
                        delay: 100,
                        start: true
                    });
                },

                _keyDownActivity: function(element, ev) {
                    var _keyCode = ev.which || ev.keyCode;
                    // Prevent whitespace browser center scroll and arrow buttons behaviours
                    if (_keyCode === 32 || _keyCode === 37 || _keyCode === 38 || _keyCode === 39 || _keyCode === 40) ev.preventDefault();

                    if (_keyCode === 32 || _keyCode === 13 || _keyCode === 9) {
                        this._resetActivity();
                        if (this.get("fullscreened") && this.get("hideoninactivity")) this.set("hideoninactivity", false);
                    }

                    if (_keyCode === 9 && ev.shiftKey) {
                        this._resetActivity();
                        this._findNextTabStop(element, ev, function(target, index) {
                            target.focus();
                        }, -1);
                    } else if (_keyCode === 9) {
                        this._resetActivity();
                        this._findNextTabStop(element, ev, function(target, index) {
                            target.focus();
                        });
                    }
                },

                _findNextTabStop: function(parentElement, ev, callback, direction) {
                    var _currentIndex, _direction, _tabIndexes, _tabIndexesArray, _maxIndex, _minIndex, _looked, _tabIndex, _delta, _element, _imagePlayersCount;
                    _maxIndex = _minIndex = 0;
                    _direction = direction || 1;
                    _element = ev.target;
                    _currentIndex = _element.tabIndex;
                    _tabIndexes = parentElement.querySelectorAll('[tabindex]');
                    _tabIndexesArray = Array.prototype.slice.call(_tabIndexes, 0);
                    _tabIndexes = _tabIndexesArray
                        .filter(function(element) {
                            if ((element.clientWidth > 0 || element.clientHeight > 0) && (element.tabIndex !== -1)) {
                                if (_maxIndex <= element.tabIndex) _maxIndex = element.tabIndex;
                                if (_minIndex >= element.tabIndex) _minIndex = element.tabIndex;
                                return true;
                            } else return false;
                        });

                    if ((_direction === 1 && _currentIndex === _maxIndex) || (direction === -1 && _currentIndex === _minIndex) || _maxIndex === 0) {
                        _imagePlayersCount = document.querySelectorAll('ba-imageviewer').length;
                        if (_imagePlayersCount > 1) {
                            parentElement.tabIndex = -1;
                            parentElement.blur();
                        }
                        return;
                    }

                    for (var i = 0; i < _tabIndexes.length; i++) {
                        if (!_tabIndexes[i])
                            continue;
                        _tabIndex = _tabIndexes[i].tabIndex;
                        _delta = _tabIndex - _currentIndex;
                        if (_tabIndex < _minIndex || _tabIndex > _maxIndex || Math.sign(_delta) !== _direction)
                            continue;

                        if (!_looked || Math.abs(_delta) < Math.abs(_looked.tabIndex - _currentIndex))
                            _looked = _tabIndexes[i];
                    }

                    if (_looked) {
                        ev.preventDefault();
                        callback(_looked, _looked.tabIndex);
                    }
                },

                _afterActivate: function(element) {
                    inherited._afterActivate.call(this, element);
                    this.image().src = this.get("source");
                },

                _resetActivity: function() {
                    this.set("last_activity", Time.now());
                    this.set("activity_delta", 0);
                },

                object_functions: ["rerecord"],

                functions: {

                    user_activity: function(strong) {
                        this.set("last_activity", Time.now());
                        this.set("activity_delta", 0);
                    },

                    message_click: function() {
                        this.trigger("message:click");
                    },

                    rerecord: function() {
                        if (!this.get("rerecordable"))
                            return;
                        this.trigger("rerecord");
                    },

                    submit: function() {
                        if (!this.get("submittable"))
                            return;
                        this.trigger("submit");
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                    },

                    toggle_fullscreen: function() {
                        if (this.get("fullscreened"))
                            Dom.elementExitFullscreen(this.activeElement());
                        else
                            Dom.elementEnterFullscreen(this.activeElement());
                        this.set("fullscreened", !this.get("fullscreened"));
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        var _targetElement, _activeElement, _selector, _keyCode;
                        _keyCode = ev.which || ev.keyCode;
                        _activeElement = this.activeElement();
                        if (_keyCode === 13 || _keyCode === 32) {
                            if (focusingSelector) {
                                _selector = "[data-selector='" + focusingSelector + "']";
                                _targetElement = _activeElement.querySelector(_selector);
                                if (_targetElement)
                                    Async.eventually(function() {
                                        this.trigger("keyboardusecase", _activeElement);
                                        _targetElement.focus({
                                            preventScroll: false
                                        });
                                    }, this, 100);
                            } else {
                                _selector = '[data-image="image"]';
                                _targetElement = _activeElement.querySelector(_selector);
                                Async.eventually(function() {
                                    this.trigger("keyboardusecase", _activeElement);
                                    _targetElement.focus({
                                        preventScroll: true
                                    });
                                }, this, 100);
                            }
                        } else if (_keyCode === 9 && nextSelector) {
                            _selector = "[data-selector='" + nextSelector + "']";
                            _targetElement = _activeElement.querySelector(_selector);
                            if (_targetElement)
                                Async.eventually(function() {
                                    this.trigger("keyboardusecase", _activeElement);
                                    _targetElement.focus({
                                        preventScroll: false
                                    });
                                }, this, 100);

                        }
                    }
                },

                destroy: function() {
                    this._timer.destroy();
                    this.host.destroy();
                    inherited.destroy.call(this);
                },

                _timerFire: function() {
                    if (this.destroyed())
                        return;
                    try {
                        this.set("activity_delta", Time.now() - this.get("last_activity"));
                    } catch (e) {}
                    try {
                        this._updateStretch();
                    } catch (e) {}
                    try {
                        this._updateCSSSize();
                    } catch (e) {}
                },

                _updateCSSSize: function() {
                    var width = Dom.elementDimensions(this.activeElement()).width;
                    this.set("csssize", width > 400 ? "normal" : (width > 300 ? "medium" : "small"));
                },

                image: function() {
                    return this.activeElement().querySelector("img");
                },

                imageHeight: function() {
                    return this.image().height;
                },

                imageWidth: function() {
                    return this.image().width;
                },

                aspectRatio: function() {
                    return this.imageWidth() / this.imageHeight();
                },

                parentWidth: function() {
                    return Dom.elementDimensions(this.activeElement().parentElement).width;
                },

                parentHeight: function() {
                    return Dom.elementDimensions(this.activeElement().parentElement).height;
                },

                parentAspectRatio: function() {
                    return this.parentWidth() / this.parentHeight();
                },

                _updateStretch: function() {
                    var newStretch = null;
                    if (this.get("stretch")) {
                        var ar = this.aspectRatio();
                        if (isFinite(ar)) {
                            var par = this.parentAspectRatio();
                            if (isFinite(par)) {
                                if (par > ar)
                                    newStretch = "height";
                                if (par < ar)
                                    newStretch = "width";
                            } else if (par === Infinity)
                                newStretch = "height";
                        }
                    }
                    if (this.__currentStretch !== newStretch) {
                        if (this.__currentStretch)
                            Dom.elementRemoveClass(this.activeElement(), this.get("css") + "-stretch-" + this.__currentStretch);
                        if (newStretch)
                            Dom.elementAddClass(this.activeElement(), this.get("css") + "-stretch-" + newStretch);
                    }
                    this.__currentStretch = newStretch;
                },

                cloneAttrs: function() {
                    return Objs.map(this.attrs, function(value, key) {
                        return this.get(key);
                    }, this);
                },

                popupAttrs: function() {
                    return {
                        popup: false,
                        width: this.get("popup-width"),
                        height: this.get("popup-height"),
                        stretch: this.get("popup-stretch")
                    };
                }

            };
        }, {

        }).register("ba-imageviewer")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "csssize": function (obj) { with (obj) { return csssize; } }, "iecss": function (obj) { with (obj) { return iecss; } }, "ie8 ? 'ie8' : 'noie8'": function (obj) { with (obj) { return ie8 ? 'ie8' : 'noie8'; } }, "csstheme": function (obj) { with (obj) { return csstheme; } }, "fullscreened ? 'fullscreen' : 'normal'": function (obj) { with (obj) { return fullscreened ? 'fullscreen' : 'normal'; } }, "firefox ? 'firefox' : 'common'": function (obj) { with (obj) { return firefox ? 'firefox' : 'common'; } }, "themecolor": function (obj) { with (obj) { return themecolor; } }, "user_activity()": function (obj) { with (obj) { return user_activity(); } }, "user_activity(true)": function (obj) { with (obj) { return user_activity(true); } }, "widthHeightStyles": function (obj) { with (obj) { return widthHeightStyles; } }, "dyncontrolbar": function (obj) { with (obj) { return dyncontrolbar; } }, "csscontrolbar || css": function (obj) { with (obj) { return csscontrolbar || css; } }, "tmplcontrolbar": function (obj) { with (obj) { return tmplcontrolbar; } }, "controlbar_active": function (obj) { with (obj) { return controlbar_active; } }, "tabindex": function (obj) { with (obj) { return tabindex; } }, "title": function (obj) { with (obj) { return title; } }, "activity_delta": function (obj) { with (obj) { return activity_delta; } }, "hideoninactivity": function (obj) { with (obj) { return hideoninactivity; } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "submittable": function (obj) { with (obj) { return submittable; } }, "fullscreensupport && !nofullscreen": function (obj) { with (obj) { return fullscreensupport && !nofullscreen; } }, "fullscreened": function (obj) { with (obj) { return fullscreened; } }, "source": function (obj) { with (obj) { return source; } }, "dynmessage": function (obj) { with (obj) { return dynmessage; } }, "cssmessage || css": function (obj) { with (obj) { return cssmessage || css; } }, "tmplmessage": function (obj) { with (obj) { return tmplmessage; } }, "message_active": function (obj) { with (obj) { return message_active; } }, "message": function (obj) { with (obj) { return message; } }, "dyntopmessage": function (obj) { with (obj) { return dyntopmessage; } }, "csstopmessage || css": function (obj) { with (obj) { return csstopmessage || css; } }, "tmpltopmessage": function (obj) { with (obj) { return tmpltopmessage; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }, "poster": function (obj) { with (obj) { return poster; } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "image-error": "An error occurred, please try again later. Click to retry."
        });
});

Scoped.define("module:AudioPlayer.Dynamics.Controlbar", ["dynamics:Dynamic","base:TimeFormat","browser:Dom","module:Assets","browser:Info"], ["dynamics:Partials.StylesPartial","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.ClickPartial"], function (Class, TimeFormat, Dom, Assets, Info, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-dashboard\">\n\t<div tabindex=\"2\" data-selector=\"progress-bar-inner\" class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\"\n\t\t ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n\t\t ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n         ba-hotkey:alt+right=\"{{seek(position + skipseconds * 3)}}\"\n         ba-hotkey:alt+left=\"{{seek(position - skipseconds * 3)}}\"\n\t\t onmouseout=\"this.blur()\"\n\t     onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n\t     onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n\t     onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n\t     onmousemove=\"{{progressUpdatePosition(domEvent)}}\">\n\t\t<div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n\t\t<div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\">\n\t\t\t<div class=\"{{css}}-progressbar-button\"></div>\n\t\t</div>\n\t</div>\n\n\t<div class=\"{{css}}-backbar\"></div>\n\n\t<div class=\"{{css}}-controlbar\">\n\n        <div tabindex=\"0\" data-selector=\"submit-audio-button\"\n\t\t\t ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\"\n\t\t\t ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\">\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-audio')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\" ba-if=\"{{rerecordable}}\"\n\t\t\t ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-audio')}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-play\"\n\t\t\t onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container\" title=\"{{string('play-audio')}}\"\n\t\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\" ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-play\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-pause\"\n\t\t\t onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-leftbutton-container {{disablepause ? css + '-disabled' : ''}}\"\n\t\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\" ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\"\n\t\t\t title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n\t\t>\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-pause\"></i>\n            </div>\n        </div>\n\n\t\t<div class=\"{{css}}-time-container\">\n\t\t\t<div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n\t\t\t<div class=\"{{css}}-time-sep\">/</div>\n\t\t\t<div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n\t\t</div>\n\n\t\t<div data-selector=\"audio-title-block\" class=\"{{css}}-audio-title-container\" ba-if=\"{{title}}\">\n\t\t\t<p class=\"{{css}}-audio-title\">\n\t\t\t\t{{title}}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class=\"{{css}}-volumebar\">\n\t\t\t<div tabindex=\"5\" data-selector=\"button-volume-bar\"\n\t\t\t\t ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\" ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n\t\t\t\t ba-hotkey:up=\"{{set_volume(1)}}\" ba-hotkey:down=\"{{set_volume(0)}}\"\n\t\t\t\t onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-volumebar-inner\"\n\t\t\t     onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                 onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n\t\t\t>\n\t\t\t\t<div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.min(100, Math.round(volume * 100)) + '%'}}}\">\n\t\t\t\t    <div class=\"{{css}}-volumebar-button\" title=\"{{string('volume-button')}}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div tabindex=\"4\" data-selector=\"button-icon-volume\"\n\t\t\t ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-rightbutton-container\"\n\t\t\t ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\">\n\t\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t\t<i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n",

                attrs: {
                    "css": "ba-audioplayer",
                    "duration": 0,
                    "position": 0,
                    "cached": 0,
                    "volume": 1.0,
                    "expandedprogress": true,
                    "playing": false,
                    "rerecordable": false,
                    "submittable": false,
                    "title": ""
                },

                functions: {

                    formatTime: function(time) {
                        time = Math.max(time || 0, 1);
                        return TimeFormat.format(TimeFormat.ELAPSED_MINUTES_SECONDS, time * 1000);
                    },

                    startUpdatePosition: function(event) {
                        if (this.get("disableseeking")) return;
                        event[0].preventDefault();
                        this.set("_updatePosition", true);
                        this.call("progressUpdatePosition", event);
                    },

                    progressUpdatePosition: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updatePosition"))
                            return;
                        var clientX = ev.clientX;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("position", this.get("duration") * (clientX - offset.left) / (dimensions.width || 1));

                        var player = this.__parent.player;

                        this.trigger("position", this.get("position"));
                    },

                    stopUpdatePosition: function(event) {
                        event[0].preventDefault();
                        this.set("_updatePosition", false);
                    },

                    startUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", true);
                        this.call("progressUpdateVolume", event);
                    },

                    progressUpdateVolume: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updateVolume"))
                            return;
                        var clientX = ev.clientX;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("volume", (clientX - offset.left) / (dimensions.width || 1));
                        this.trigger("volume", this.get("volume"));
                    },

                    stopUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", false);
                    },

                    startVerticallyUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", true);
                        this.call("progressVerticallyUpdateVolume", event);
                    },

                    progressVerticallyUpdateVolume: function(event) {
                        var ev = event[0];
                        ev.preventDefault();
                        if (!this.get("_updateVolume"))
                            return;
                        var pageY = ev.pageY;
                        var target = ev.currentTarget;
                        var offset = Dom.elementOffset(target);
                        var dimensions = Dom.elementDimensions(target);
                        this.set("volume", 1 - (pageY - offset.top) / dimensions.height);
                        this.trigger("volume", this.get("volume"));
                    },

                    stopVerticallyUpdateVolume: function(event) {
                        event[0].preventDefault();
                        this.set("_updateVolume", false);
                    },


                    play: function() {
                        this.trigger("play");
                    },

                    pause: function() {
                        this.trigger("pause");
                    },

                    toggle_volume: function() {
                        if (this.get("volume") > 0) {
                            this.__oldVolume = this.get("volume");
                            this.set("volume", 0);
                        } else
                            this.set("volume", this.__oldVolume || 1);
                        this.trigger("volume", this.get("volume"));
                    },

                    rerecord: function() {
                        this.trigger("rerecord");
                    },

                    seek: function(position) {
                        this.trigger("seek", position);
                    },

                    set_volume: function(volume) {
                        this.trigger("set_volume", volume);
                    },

                    submit: function() {
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                        this.trigger("submit");
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        this.trigger("tab_index_move", ev[0], nextSelector, focusingSelector);
                    }
                },

                create: function() {
                    this.set("ismobile", Info.isMobile());
                }
            };
        })
        .register("ba-audioplayer-controlbar")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "seek(position + skipseconds * 3)": function (obj) { with (obj) { return seek(position + skipseconds * 3); } }, "seek(position - skipseconds * 3)": function (obj) { with (obj) { return seek(position - skipseconds * 3); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "play()": function (obj) { with (obj) { return play(); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "playing": function (obj) { with (obj) { return playing; } }, "pause()": function (obj) { with (obj) { return pause(); } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "title": function (obj) { with (obj) { return title; } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "set_volume(1)": function (obj) { with (obj) { return set_volume(1); } }, "set_volume(0)": function (obj) { with (obj) { return set_volume(0); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.min(100, Math.round(volume * 100)) + '%'}": function (obj) { with (obj) { return {width: Math.min(100, Math.round(volume * 100)) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "audio-progress": "Progress",
            "rerecord-audio": "Redo?",
            "submit-audio": "Confirm",
            "play-audio": "Play",
            "pause-audio": "Pause",
            "pause-audio-disabled": "Pause not supported",
            "elapsed-time": "Elasped time",
            "total-time": "Total length of",
            "volume-button": "Set volume",
            "volume-mute": "Mute sound",
            "volume-unmute": "Unmute sound"
        });
});

Scoped.define("module:AudioPlayer.Dynamics.Loader", ["dynamics:Dynamic","module:Assets"], function (Class, Assets, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-loader-container\">\n    <div data-selector=\"loader-block\" class=\"{{css}}-loader-loader\" title=\"{{string('tooltip')}}\">\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-audioplayer"
                }

            };
        })
        .register("ba-audioplayer-loader")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "string('tooltip')": function (obj) { with (obj) { return string('tooltip'); } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "tooltip": "Loading..."
        });
});

Scoped.define("module:AudioPlayer.Dynamics.Message", ["dynamics:Dynamic"], ["dynamics:Partials.ClickPartial"], function (Class, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "\n<div class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"message-block\" class='{{css}}-message-message'>\n        {{message}}\n    </div>\n</div>\n",

                attrs: {
                    "css": "ba-audioplayer",
                    "message": ''
                },

                functions: {

                    click: function() {
                        this.trigger("click");
                    }

                }

            };
        })
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message": function (obj) { with (obj) { return message; } }/**/ })
        .register("ba-audioplayer-message");
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.State", ["base:States.State","base:Events.ListenMixin","base:Objs"], function (State, ListenMixin, Objs, scoped) {
    return State.extend({
        scoped: scoped
    }, [ListenMixin, {

        dynamics: [],

        _start: function() {
            this.dyn = this.host.dynamic;
            Objs.iter(Objs.extend({
                "loader": false,
                "message": false,
                "controlbar": false
            }, Objs.objectify(this.dynamics)), function(value, key) {
                this.dyn.set(key + "_active", value);
            }, this);
            this._started();
        },

        _started: function() {},

        play: function() {
            this.dyn.set("autoplay", true);
        }

    }]);
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.FatalError", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],
        _locals: ["message"],

        _started: function() {
            this.dyn.set("message", this._message || this.dyn.string("audio-error"));
        }

    });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.Initial", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            if (this.dyn.get("ready"))
                this.next("LoadPlayer");
            else {
                this.listenOn(this.dyn, "change:ready", function() {
                    this.next("LoadPlayer");
                });
            }
        }
    });
});

Scoped.define("module:AudioPlayer.Dynamics.Player", ["dynamics:Dynamic","module:Assets","browser:Info","browser:Dom","media:AudioPlayer.AudioPlayerWrapper","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Async","module:AudioPlayer.Dynamics.PlayerStates.Initial","module:AudioPlayer.Dynamics.PlayerStates","browser:Events"], ["module:AudioPlayer.Dynamics.Message","module:AudioPlayer.Dynamics.Loader","module:AudioPlayer.Dynamics.Controlbar","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.TogglePartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"], function (Class, Assets, Info, Dom, AudioPlayerWrapper, Types, Objs, Strings, Time, Timers, Host, ClassRegistry, Async, InitialState, PlayerStates, DomEvents, scoped) {
    return Class.extend({
            scoped: scoped
        }, function(inherited) {
            return {

                template: "<div itemscope itemtype=\"http://schema.org/AudioObject\"\n    class=\"{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? 'ie8' : 'noie8'}} {{csstheme}} {{css}}-normal-view {{css}}-common-browser\n    {{css}}-{{themecolor}}-color {{stretch ? css + '-stretch' : ''}}\"\n\tba-styles=\"{{widthHeightStyles}}\"\n>\n    <audio tabindex=\"-1\" class=\"{{css}}-audio\" data-audio=\"audio\"></audio>\n    <div class=\"{{css}}-overlay\">\n\t\t<div tabindex=\"-1\" class=\"{{css}}-player-toggle-overlay\" data-selector=\"player-toggle-overlay\"\n\t\t\t ba-hotkey:right=\"{{seek(position + skipseconds)}}\" ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n\t\t\t ba-hotkey:alt+right=\"{{seek(position + skipseconds * 3)}}\" ba-hotkey:alt+left=\"{{seek(position - skipseconds * 3)}}\"\n\t\t\t ba-hotkey:up=\"{{set_volume(volume + 0.1)}}\" ba-hotkey:down=\"{{set_volume(volume - 0.1)}}\"\n\t\t\t >\n\t\t</div>\n\t    <ba-{{dyncontrolbar}}\n\t\t    ba-css=\"{{csscontrolbar || css}}\"\n\t\t\tba-themecolor=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplcontrolbar}}\"\n\t\t    ba-show=\"{{controlbar_active}}\"\n\t\t    ba-playing=\"{{playing}}\"\n\t\t\tba-playwhenvisible=\"{{playwhenvisible}}\"\n\t\t    ba-event:rerecord=\"rerecord\"\n\t\t    ba-event:submit=\"submit\"\n\t\t    ba-event:play=\"play\"\n\t\t    ba-event:pause=\"pause\"\n\t\t    ba-event:position=\"seek\"\n\t\t    ba-event:volume=\"set_volume\"\n\t\t\tba-event:tab_index_move=\"tab_index_move\"\n\t\t\tba-event:seek=\"seek\"\n\t\t\tba-event:set_volume=\"set_volume\"\n\t\t\tba-tabindex=\"{{tabindex}}\"\n\t\t    ba-volume=\"{{volume}}\"\n\t\t    ba-duration=\"{{duration}}\"\n\t\t    ba-cached=\"{{buffered}}\"\n\t\t    ba-title=\"{{title}}\"\n\t\t    ba-position=\"{{position}}\"\n\t\t    ba-rerecordable=\"{{rerecordable}}\"\n\t\t    ba-submittable=\"{{submittable}}\"\n            ba-source=\"{{source}}\"\n\t\t\tba-disablepause=\"{{disablepause}}\"\n\t\t\tba-disableseeking=\"{{disableseeking}}\"\n\t\t\tba-skipseconds=\"{{skipseconds}}\"\n\t\t></ba-{{dyncontrolbar}}>\n\n\t\t<ba-{{dynloader}}\n\t\t    ba-css=\"{{cssloader || css}}\"\n\t\t\tba-theme-color=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplloader}}\"\n\t\t\tba-playwhenvisible=\"{{playwhenvisible}}\"\n\t\t    ba-show=\"{{loader_active}}\"\n\t\t></ba-{{dynloader}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css=\"{{cssmessage || css}}\"\n\t\t\tba-theme-color=\"{{themecolor}}\"\n\t\t    ba-template=\"{{tmplmessage}}\"\n\t\t    ba-show=\"{{message_active}}\"\n\t\t    ba-message=\"{{message}}\"\n\t\t    ba-event:click=\"message_click\"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<meta itemprop=\"caption\" content=\"{{title}}\" />\n\t\t<meta itemprop=\"contentUrl\" content=\"{{source}}\"/>\n    </div>\n</div>\n",

                attrs: {
                    /* CSS */
                    "css": "ba-audioplayer",
                    "iecss": "ba-audioplayer",
                    "cssloader": "",
                    "cssmessage": "",
                    "csscontrolbar": "",
                    "width": "",
                    "height": "",
                    /* Themes */
                    "theme": "",
                    "csstheme": "",
                    "themecolor": "",
                    /* Dynamics */
                    "dynloader": "audioplayer-loader",
                    "dynmessage": "audioplayer-message",
                    "dyncontrolbar": "audioplayer-controlbar",
                    /* Templates */
                    "tmplloader": "",
                    "tmplmessage": "",
                    "tmplcontrolbar": "",
                    /* Attributes */
                    "source": "",
                    "sources": [],
                    "sourcefilter": {},
                    "playlist": null,
                    "volume": 1.0,
                    "title": "",
                    "initialseek": null,
                    "visibilityfraction": 0.8,

                    /* Configuration */
                    "forceflash": false,
                    "noflash": false,
                    "reloadonplay": false,
                    "playonclick": true,
                    /* Options */
                    "rerecordable": false,
                    "submittable": false,
                    "autoplay": false,
                    "preload": false,
                    "loop": false,
                    "ready": true,
                    "stretch": false,
                    "totalduration": null,
                    "playwhenvisible": false,
                    "playedonce": false,
                    "manuallypaused": false,
                    "disablepause": false,
                    "disableseeking": false,
                    "skipseconds": 5
                },

                types: {
                    "forceflash": "boolean",
                    "noflash": "boolean",
                    "rerecordable": "boolean",
                    "loop": "boolean",
                    "autoplay": "boolean",
                    "preload": "boolean",
                    "ready": "boolean",
                    "stretch": "boolean",
                    "volume": "float",
                    "initialseek": "float",
                    "themecolor": "string",
                    "totalduration": "float",
                    "playwhenvisible": "boolean",
                    "playedonce": "boolean",
                    "manuallypaused": "boolean",
                    "disablepause": "boolean",
                    "disableseeking": "boolean",
                    "playonclick": "boolean",
                    "skipseconds": "integer"
                },

                extendables: ["states"],

                computed: {
                    "widthHeightStyles:width,height": function() {
                        var result = {};
                        var width = this.get("width");
                        var height = this.get("height");
                        if (width)
                            result.width = width + ((width + '').match(/^\d+$/g) ? 'px' : '');
                        if (height)
                            result.height = height + ((height + '').match(/^\d+$/g) ? 'px' : '');
                        return result;
                    },
                    "buffering:buffered,position,last_position_change_delta,playing": function() {
                        return this.get("playing") && this.get("buffered") < this.get("position") && this.get("last_position_change_delta") > 1000;
                    }
                },

                remove_on_destroy: true,

                create: function() {
                    if (Info.isMobile() && (this.get("autoplay") || this.get("playwhenvisible"))) {
                        this.set("volume", 0.0);
                        if (!(Info.isiOS() && Info.iOSversion().major >= 10)) {
                            this.set("autoplay", false);
                            this.set("loop", false);
                        }
                    }

                    if (this.get("theme") in Assets.audioplayerthemes) {
                        Objs.iter(Assets.audioplayerthemes[this.get("theme")], function(value, key) {
                            if (!this.isArgumentAttr(key))
                                this.set(key, value);
                        }, this);
                    }

                    if (!this.get("themecolor"))
                        this.set("themecolor", "default");

                    if (this.get("playlist")) {
                        var pl0 = (this.get("playlist"))[0];
                        this.set("source", pl0.source);
                        this.set("sources", pl0.sources);
                    }

                    this.set("ie8", Info.isInternetExplorer() && Info.internetExplorerVersion() < 9);
                    this.set("duration", this.get("totalduration") || 0.0);
                    this.set("position", 0.0);
                    this.set("buffered", 0.0);
                    this.set("message", "");
                    this.set("csssize", "normal");

                    this.set("loader_active", false);
                    this.set("controlbar_active", false);
                    this.set("message_active", false);

                    this.set("playing", false);

                    this.__attachRequested = false;
                    this.__activated = false;
                    this.__error = null;

                    this.activeElement().onkeydown = this._keyDownActivity.bind(this, this.activeElement());

                    this.host = new Host({
                        stateRegistry: new ClassRegistry(this.cls.playerStates())
                    });
                    this.host.dynamic = this;
                    this.host.initialize(InitialState);

                    this._timer = new Timers.Timer({
                        context: this,
                        fire: this._timerFire,
                        delay: 100,
                        start: true
                    });
                },

                state: function() {
                    return this.host.state();
                },

                audioAttached: function() {
                    return !!this.player;
                },

                audioLoaded: function() {
                    return this.audioAttached() && this.player.loaded();
                },

                audioError: function() {
                    return this.__error;
                },

                _error: function(error_type, error_code) {
                    this.__error = {
                        error_type: error_type,
                        error_code: error_code
                    };
                    this.trigger("error:" + error_type, error_code);
                    this.trigger("error", error_type, error_code);
                },

                _clearError: function() {
                    this.__error = null;
                },

                _detachAudio: function() {
                    this.set("playing", false);
                    if (this.player)
                        this.player.weakDestroy();
                    this.player = null;
                    this.__audio = null;
                },

                _attachAudio: function() {
                    if (this.audioAttached())
                        return;
                    if (!this.__activated) {
                        this.__attachRequested = true;
                        return;
                    }
                    this.__attachRequested = false;
                    var audio = this.activeElement().querySelector("[data-audio='audio']");
                    this._clearError();
                    AudioPlayerWrapper.create(Objs.extend(this._getSources(), {
                        element: audio,
                        forceflash: !!this.get("forceflash"),
                        noflash: !!this.get("noflash"),
                        preload: !!this.get("preload"),
                        loop: !!this.get("loop"),
                        reloadonplay: this.get('playlist') ? true : !!this.get("reloadonplay")
                    })).error(function(e) {
                        if (this.destroyed())
                            return;
                        this._error("attach", e);
                    }, this).success(function(instance) {
                        if (this.destroyed())
                            return;

                        this.player = instance;
                        this.__audio = audio;

                        if (this.get("playwhenvisible")) {
                            var _self;
                            _self = this;
                            if (Dom.isElementVisible(audio, this.get("visibilityfraction"))) {
                                this.player.play();
                            }

                            this._visiblityScrollEvent = this.auto_destroy(new DomEvents());
                            this._visiblityScrollEvent.on(document, "scroll", function() {
                                if (!_self.get('playedonce') && !_self.get("manuallypaused")) {
                                    if (Dom.isElementVisible(audio, _self.get("visibilityfraction"))) {
                                        _self.player.play();
                                    } else if (_self.get("playing")) {
                                        _self.player.pause();
                                    }
                                } else if (_self.get("playing") && !Dom.isElementVisible(audio, _self.get("visibilityfraction"))) {
                                    _self.player.pause();
                                }
                            });
                        }
                        this.player.on("playing", function() {
                            this.set("playing", true);
                            this.trigger("playing");
                        }, this);
                        this.player.on("error", function(e) {
                            this._error("audio", e);
                        }, this);
                        if (this.player.error())
                            this.player.trigger("error", this.player.error());
                        this.player.on("paused", function() {
                            this.set("playing", false);
                            this.trigger("paused");
                        }, this);
                        this.player.on("ended", function() {
                            this.set("playing", false);
                            this.set('playedonce', true);
                            this.trigger("ended");
                        }, this);
                        this.trigger("attached", instance);
                        this.player.once("loaded", function() {
                            var volume = Math.min(1.0, this.get("volume"));
                            this.player.setVolume(volume);
                            this.player.setMuted(volume <= 0.0);
                            this.trigger("loaded");
                            this.trigger("ready_to_play");
                            if (this.get("totalduration") || this.player.duration() < Infinity)
                                this.set("duration", this.get("totalduration") || this.player.duration());
                            if (this.get("initialseek"))
                                this.player.setPosition(this.get("initialseek"));
                        }, this);
                        if (this.player.loaded())
                            this.player.trigger("loaded");
                    }, this);
                },

                _getSources: function() {
                    var filter = this.get("sourcefilter");
                    var source = this.get("source");
                    var sources = filter ? Objs.filter(this.get("sources"), function(source) {
                        return Objs.subset_of(filter, source);
                    }, this) : this.get("sources");
                    return {
                        source: source,
                        sources: sources
                    };
                },

                _afterActivate: function(element) {
                    inherited._afterActivate.call(this, element);
                    this.__activated = true;
                    if (this.__attachRequested)
                        this._attachAudio();
                },

                reattachAudio: function() {
                    this.set("reloadonplay", true);
                    this._detachAudio();
                    this._attachAudio();
                },

                _keyDownActivity: function(element, ev) {
                    var _keyCode = ev.which || ev.keyCode;
                    // Prevent whitespace browser center scroll and arrow buttons behaviours
                    if (_keyCode === 32 || _keyCode === 37 || _keyCode === 38 || _keyCode === 39 || _keyCode === 40) ev.preventDefault();

                    if (_keyCode === 32 || _keyCode === 13 || _keyCode === 9) {
                        this._resetActivity();
                    }

                    if (_keyCode === 9 && ev.shiftKey) {
                        this._resetActivity();
                        this._findNextTabStop(element, ev, function(target, index) {
                            target.focus();
                        }, -1);
                    } else if (_keyCode === 9) {
                        this._resetActivity();
                        this._findNextTabStop(element, ev, function(target, index) {
                            target.focus();
                        });
                    }
                },

                _findNextTabStop: function(parentElement, ev, callback, direction) {
                    var _currentIndex, _direction, _tabIndexes, _tabIndexesArray, _maxIndex, _minIndex, _looked, _tabIndex, _delta, _element, _audioPlayersCount;
                    _maxIndex = _minIndex = 0;
                    _direction = direction || 1;
                    _element = ev.target;
                    _currentIndex = _element.tabIndex;
                    _tabIndexes = parentElement.querySelectorAll('[tabindex]');
                    _tabIndexesArray = Array.prototype.slice.call(_tabIndexes, 0);
                    _tabIndexes = _tabIndexesArray
                        .filter(function(element) {
                            if ((element.clientWidth > 0 || element.clientHeight > 0) && (element.tabIndex !== -1)) {
                                if (_maxIndex <= element.tabIndex) _maxIndex = element.tabIndex;
                                if (_minIndex >= element.tabIndex) _minIndex = element.tabIndex;
                                return true;
                            } else return false;
                        });

                    if ((_direction === 1 && _currentIndex === _maxIndex) || (direction === -1 && _currentIndex === _minIndex) || _maxIndex === 0) {
                        _audioPlayersCount = document.querySelectorAll('ba-audioplayer').length;
                        if (_audioPlayersCount > 1) {
                            if (this.get("playing")) this.player.pause();
                            parentElement.tabIndex = -1;
                            parentElement.blur();
                        }
                        return;
                    }

                    for (var i = 0; i < _tabIndexes.length; i++) {
                        if (!_tabIndexes[i])
                            continue;
                        _tabIndex = _tabIndexes[i].tabIndex;
                        _delta = _tabIndex - _currentIndex;
                        if (_tabIndex < _minIndex || _tabIndex > _maxIndex || Math.sign(_delta) !== _direction)
                            continue;

                        if (!_looked || Math.abs(_delta) < Math.abs(_looked.tabIndex - _currentIndex))
                            _looked = _tabIndexes[i];
                    }

                    if (_looked) {
                        ev.preventDefault();
                        callback(_looked, _looked.tabIndex);
                    }
                },

                object_functions: ["play", "rerecord", "pause", "stop", "seek", "set_volume"],

                functions: {

                    message_click: function() {
                        this.trigger("message:click");
                    },

                    play: function() {
                        this.host.state().play();
                    },

                    rerecord: function() {
                        if (!this.get("rerecordable"))
                            return;
                        this.trigger("rerecord");
                    },

                    submit: function() {
                        if (!this.get("submittable"))
                            return;
                        this.trigger("submit");
                        this.set("submittable", false);
                        this.set("rerecordable", false);
                    },

                    pause: function() {
                        if (this.get('disablepause')) return;

                        if (this.get("playing")) {
                            this.player.pause();
                        }

                        if (this.get("playwhenvisible"))
                            this.set("manuallypaused", true);
                    },

                    stop: function() {
                        if (!this.audioLoaded())
                            return;
                        if (this.get("playing"))
                            this.player.pause();
                        this.player.setPosition(0);
                        this.trigger("stopped");
                    },

                    seek: function(position) {
                        if (this.get('disableseeking')) return;
                        if (this.audioLoaded()) {
                            if (position > this.player.duration())
                                this.player.setPosition(this.player.duration() - this.get("skipseconds"));
                            else {
                                this.player.setPosition(position);
                                this.trigger("seek", position);
                            }
                        }
                    },

                    set_volume: function(volume) {
                        volume = Math.min(1.0, volume);
                        volume = volume <= 0 ? 0 : volume; // Don't allow negative value

                        this.set("volume", volume);
                        if (this.audioLoaded()) {
                            this.player.setVolume(volume);
                            this.player.setMuted(volume <= 0);
                        }
                    },

                    tab_index_move: function(ev, nextSelector, focusingSelector) {
                        var _targetElement, _activeElement, _selector, _keyCode;
                        _keyCode = ev.which || ev.keyCode;
                        _activeElement = this.activeElement();
                        if (_keyCode === 13 || _keyCode === 32) {
                            if (focusingSelector) {
                                _selector = "[data-selector='" + focusingSelector + "']";
                                _targetElement = _activeElement.querySelector(_selector);
                                if (_targetElement)
                                    Async.eventually(function() {
                                        this.trigger("keyboardusecase", _activeElement);
                                        _targetElement.focus({
                                            preventScroll: false
                                        });
                                    }, this, 100);
                            } else {
                                _selector = '[data-audio="audio"]';
                                _targetElement = _activeElement.querySelector(_selector);
                                Async.eventually(function() {
                                    this.trigger("keyboardusecase", _activeElement);
                                    _targetElement.focus({
                                        preventScroll: true
                                    });
                                }, this, 100);
                            }
                        } else if (_keyCode === 9 && nextSelector) {
                            _selector = "[data-selector='" + nextSelector + "']";
                            _targetElement = _activeElement.querySelector(_selector);
                            if (_targetElement)
                                Async.eventually(function() {
                                    this.trigger("keyboardusecase", _activeElement);
                                    _targetElement.focus({
                                        preventScroll: false
                                    });
                                }, this, 100);

                        }
                    }
                },

                destroy: function() {
                    this._timer.destroy();
                    this.host.destroy();
                    this._detachAudio();
                    inherited.destroy.call(this);
                },

                _timerFire: function() {
                    if (this.destroyed())
                        return;
                    try {
                        if (this.audioLoaded()) {
                            var new_position = this.player.position();
                            if (new_position != this.get("position") || this.get("last_position_change"))
                                this.set("last_position_change", Time.now());
                            this.set("last_position_change_delta", Time.now() - this.get("last_position_change"));
                            this.set("position", new_position);
                            this.set("buffered", this.player.buffered());
                            var pld = this.player.duration();
                            if (0.0 < pld && pld < Infinity)
                                this.set("duration", this.player.duration());
                            else
                                this.set("duration", this.get("totalduration") || new_position);
                        }
                    } catch (e) {}
                    try {
                        this._updateCSSSize();
                    } catch (e) {}
                },

                _updateCSSSize: function() {
                    var width = Dom.elementDimensions(this.activeElement()).width;
                    this.set("csssize", width > 400 ? "normal" : (width > 300 ? "medium" : "small"));
                },

                cloneAttrs: function() {
                    return Objs.map(this.attrs, function(value, key) {
                        return this.get(key);
                    }, this);
                }

            };
        }, {

            playerStates: function() {
                return [PlayerStates];
            }

        }).register("ba-audioplayer")
        .registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "csssize": function (obj) { with (obj) { return csssize; } }, "iecss": function (obj) { with (obj) { return iecss; } }, "ie8 ? 'ie8' : 'noie8'": function (obj) { with (obj) { return ie8 ? 'ie8' : 'noie8'; } }, "csstheme": function (obj) { with (obj) { return csstheme; } }, "themecolor": function (obj) { with (obj) { return themecolor; } }, "stretch ? css + '-stretch' : ''": function (obj) { with (obj) { return stretch ? css + '-stretch' : ''; } }, "widthHeightStyles": function (obj) { with (obj) { return widthHeightStyles; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "seek(position + skipseconds * 3)": function (obj) { with (obj) { return seek(position + skipseconds * 3); } }, "seek(position - skipseconds * 3)": function (obj) { with (obj) { return seek(position - skipseconds * 3); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "dyncontrolbar": function (obj) { with (obj) { return dyncontrolbar; } }, "csscontrolbar || css": function (obj) { with (obj) { return csscontrolbar || css; } }, "tmplcontrolbar": function (obj) { with (obj) { return tmplcontrolbar; } }, "controlbar_active": function (obj) { with (obj) { return controlbar_active; } }, "playing": function (obj) { with (obj) { return playing; } }, "playwhenvisible": function (obj) { with (obj) { return playwhenvisible; } }, "tabindex": function (obj) { with (obj) { return tabindex; } }, "volume": function (obj) { with (obj) { return volume; } }, "duration": function (obj) { with (obj) { return duration; } }, "buffered": function (obj) { with (obj) { return buffered; } }, "title": function (obj) { with (obj) { return title; } }, "position": function (obj) { with (obj) { return position; } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "submittable": function (obj) { with (obj) { return submittable; } }, "source": function (obj) { with (obj) { return source; } }, "disablepause": function (obj) { with (obj) { return disablepause; } }, "disableseeking": function (obj) { with (obj) { return disableseeking; } }, "skipseconds": function (obj) { with (obj) { return skipseconds; } }, "dynloader": function (obj) { with (obj) { return dynloader; } }, "cssloader || css": function (obj) { with (obj) { return cssloader || css; } }, "tmplloader": function (obj) { with (obj) { return tmplloader; } }, "loader_active": function (obj) { with (obj) { return loader_active; } }, "dynmessage": function (obj) { with (obj) { return dynmessage; } }, "cssmessage || css": function (obj) { with (obj) { return cssmessage || css; } }, "tmplmessage": function (obj) { with (obj) { return tmplmessage; } }, "message_active": function (obj) { with (obj) { return message_active; } }, "message": function (obj) { with (obj) { return message; } }/**/ })
        .attachStringTable(Assets.strings)
        .addStrings({
            "audio-error": "An error occurred, please try again later. Click to retry."
        });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.LoadPlayer", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            this.listenOn(this.dyn, "error:attach", function() {
                this.next("LoadError");
            }, this);
            this.listenOn(this.dyn, "attached", function() {
                this.next("LoadAudio");
            }, this);
            this.dyn.reattachAudio();
        }

    });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.LoadError", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],

        _started: function() {
            this.dyn.set("message", this.dyn.string("audio-error"));
            this.listenOn(this.dyn, "message:click", function() {
                this.next("LoadPlayer");
            }, this);
        }

    });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.LoadAudio", ["module:AudioPlayer.Dynamics.PlayerStates.State","base:Timers.Timer"], function (State, Timer, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["loader"],

        _started: function() {
            this.listenOn(this.dyn, "error:audio", function() {
                this.next("ErrorAudio");
            }, this);
            this.listenOn(this.dyn, "playing", function() {
                if (this.destroyed() || this.dyn.destroyed())
                    return;
                if (this.dyn.get("autoseek"))
                    this.dyn.execute("seek", this.dyn.get("autoseek"));
                this.next("PlayAudio");
            }, this);
            if (!this.dyn.get("autoplay"))
                this.next("PlayAudio");
            else {
                var counter = 10;
                this.auto_destroy(new Timer({
                    context: this,
                    fire: function() {
                        if (!this.destroyed() && !this.dyn.destroyed() && this.dyn.player)
                            this.dyn.player.play();
                        counter--;
                        if (counter === 0)
                            this.next("PlayAudio");
                    },
                    delay: 200,
                    immediate: true
                }));
            }
        }

    });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.ErrorAudio", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["message"],

        _started: function() {
            this.dyn.set("message", this.dyn.string("audio-error"));
            this.listenOn(this.dyn, "message:click", function() {
                this.next("LoadAudio");
            }, this);
        }

    });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.PlayAudio", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        dynamics: ["controlbar"],

        _started: function() {
            this.dyn.set("autoplay", false);
            this.listenOn(this.dyn, "ended", function() {
                this.dyn.set("autoseek", null);
                this.next("NextAudio");
            }, this);
            this.listenOn(this.dyn, "change:buffering", function() {
                this.dyn.set("loader_active", this.dyn.get("buffering"));
            }, this);
            this.listenOn(this.dyn, "error:audio", function() {
                this.next("ErrorAudio");
            }, this);
        },

        play: function() {
            if (!this.dyn.get("playing"))
                this.dyn.player.play();
        }

    });
});

Scoped.define("module:AudioPlayer.Dynamics.PlayerStates.NextAudio", ["module:AudioPlayer.Dynamics.PlayerStates.State"], function (State, scoped) {
    return State.extend({
        scoped: scoped
    }, {

        _started: function() {
            if (this.dyn.get("playlist")) {
                var list = this.dyn.get("playlist");
                var head = list.shift();
                if (this.dyn.get("loop"))
                    list.push(head);
                this.dyn.set("playlist", list);
                if (list.length > 0) {
                    var pl0 = list[0];
                    this.dyn.set("source", pl0.source);
                    this.dyn.set("sources", pl0.sources);
                    this.dyn.trigger("playlist-next", pl0);
                    this.dyn.reattachAudio();
                    this.dyn.set("autoplay", true);
                    this.next("LoadPlayer");
                    return;
                }
            }
            this.next("LoadPlayer");
        }

    });
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.extend("module:Assets.playerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "skipinitial ? 0 : 1": function (obj) { with (obj) { return skipinitial ? 0 : 1; } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }/**/ });
    return {
        "modern": {
            css: "ba-videoplayer-theme-modern",
            tmplcontrolbar: "<div data-selector=\"video-title-block\" class=\"{{css}}-video-title-container {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\" ba-if=\"{{title}}\">\n\t<p class=\"{{css}}-video-title\">\n\t\t{{title}}\n\t</p>\n</div>\n\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div tabindex=\"0\" data-selector=\"submit-video-button\"\n\t\t ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\"\n\t>\n        <div class=\"{{css}}-button-inner\">\n        \t{{string('submit-video')}}\n        </div>\n    </div>\n\n    <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-video')}}\"\n\t>\n    \t<div class=\"{{css}}-button-inner\">\n    \t\t<i class=\"{{css}}-icon-ccw\"></i>\n    \t</div>\n    </div>\n\n\t<div tabindex=\"{{skipinitial ? 0 : 1}}\" data-selector=\"button-icon-play\"\n\t\t ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-video')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<i class=\"{{css}}-icon-play\"></i>\n\t\t</div>\n\t</div>\n\n\t<div tabindex=\"{{skipinitial ? 0 : 1}}\" data-selector=\"button-icon-pause\"\n\t\t ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n\t\t class=\"{{css}}-leftbutton-container {{disablepause ? css + '-disabled' : ''}}\"\n\t\t ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<i class=\"{{css}}-icon-pause\"></i>\n\t\t</div>\n\t</div>\n\t<div class=\"{{css}}-time-container\">\n\t\t<div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}/{{formatTime(duration || position)}}</div>\n\t</div>\n\n\t<div tabindex=\"9\" data-selector=\"cc-button-container\"\n\t\t ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n\t\t ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n\t\t class=\"{{css}}-rightbutton-container  {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n\t\t title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n\t\t ba-click=\"{{toggle_tracks()}}\"\n\t\t onmouseover=\"{{hover_cc(true)}}\"\n\t\t onmouseleave=\"{{hover_cc(false)}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner {{css}}-subtitle-button-inner\">\n\t\t\t<i class=\"{{css}}-icon-subtitle\"></i>\n\t\t</div>\n\t</div>\n\n\n\t<div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n\t\t ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n\t\t onkeydown=\"{{tab_index_move(domEvent)}}\"\n\t\t class=\"{{css}}-rightbutton-container\"\n\t\tba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n\t\t\t<i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n\t\t</div>\n\t</div>\n\n\t<div tabindex=\"7\" data-selector=\"button-airplay\"\n\t\t ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-rightbutton-container {{css}}-airplay-container\" ba-show=\"{{airplaybuttonvisible}}\"\n\t\t ba-click=\"{{show_airplay_devices()}}\"\n\t>\n\t\t<svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t<!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n\t\t\t<title>Airplay</title>\n\t\t\t<desc>Airplay icon.</desc>\n\t\t\t<defs></defs>\n\t\t\t<g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n\t\t\t\t<path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n\t\t\t</g>\n\t\t</svg>\n\t</div>\n\n\t<div data-selector=\"button-chromecast\" class=\"{{css}}-rightbutton-container {{css}}-cast-button-container\" ba-show=\"{{castbuttonvisble}}\">\n\t\t<button tabindex=\"6\" class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n\t</div>\n\n\t<div tabindex=\"5\" data-selector=\"button-stream-label\"\n\t\t ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-rightbutton-container\" ba-if=\"{{streams.length > 1 && currentstream}}\"\n\t\t ba-click=\"{{toggle_stream()}}\" title=\"{{string('change-resolution')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<span class=\"{{css}}-button-text\">{{currentstream_label}}</span>\n\t\t</div>\n\t</div>\n\n\t<div class=\"{{css}}-volumebar\">\n\t\t<div tabindex=\"4\" data-selector=\"button-volume-bar\"\n\t\t\t ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n\t\t\t ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n\t\t\t onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-volumebar-inner\"\n\t\t\t onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n\t\t\t onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n\t\t\t onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n\t\t\t onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n\t\t>\n\t\t\t<div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n\t\t</div>\n\t</div>\n\n\t<div tabindex=\"3\" data-selector=\"button-icon-volume\"\n\t\t ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-rightbutton-container {{css}}-volume-button-container\"\n\t\t ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n\t\t</div>\n\t</div>\n\n\t<div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n\t\t<div tabindex=\"2\" data-selector=\"progress-bar-inner\"\n\t\t\t ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n\t\t\t ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n\t\t\t onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-progressbar-inner\"\n\t\t     onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n\t\t     onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n\t\t     onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n\t\t     onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n\t\t>\n\t\t<div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n\t\t<div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\"></div>\n\t</div>\n</div>\n",
            cssloader: ie8 ? "ba-videoplayer" : "",
            cssmessage: "ba-videoplayer",
            cssplaybutton: ie8 ? "ba-videoplayer" : ""
        }
    };
});

Scoped.extend("module:Assets.recorderthemes", ["dynamics:Parser"], function (Parser) {
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions.first().get('icon')": function (obj) { with (obj) { return actions.first().get('icon'); } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.label": function (obj) { with (obj) { return action.label; } }/**/ });
    return {
        "modern": {
            css: "ba-videorecorder-theme-modern",
            //            cssmessage: "ba-videorecorder",
            cssloader: "ba-videorecorder",
            tmplchooser: "<div class=\"{{css}}-chooser-container\">\n\n\t<div class=\"{{css}}-chooser-button-container\">\n\n\t\t<div class=\"{{css}}-chooser-icon-container\">\n\t\t\t<i class=\"{{css}}-icon-{{actions.first().get('icon')}}\"></i>\n\t\t</div>\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\tba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-chooser-button-{{action.index}}\"\n\t\t\t\t ba-click=\"{{click_action(action)}}\"\n\t\t\t>\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t/>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n"
        }
    };
});

Scoped.extend("module:Assets.imageviewerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }/**/ });
    return {
        "modern": {
            css: "ba-imageviewer-theme-modern",
            tmplcontrolbar: "<div data-selector=\"image-title-block\" class=\"{{css}}-image-title-container {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\" ba-if=\"{{title}}\">\n\t<p class=\"{{css}}-image-title\">\n\t\t{{title}}\n\t</p>\n</div>\n\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div tabindex=\"0\" data-selector=\"submit-image-button\"\n\t\t ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\"\n\t>\n        <div class=\"{{css}}-button-inner\">\n        \t{{string('submit-image')}}\n        </div>\n    </div>\n\n    <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-image')}}\"\n\t>\n    \t<div class=\"{{css}}-button-inner\">\n    \t\t<i class=\"{{css}}-icon-ccw\"></i>\n    \t</div>\n    </div>\n\n\t<div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n\t\t ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n\t\t onkeydown=\"{{tab_index_move(domEvent)}}\"\n\t\t class=\"{{css}}-rightbutton-container\"\n\t\tba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n\t\t\t<i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n\t\t</div>\n\t</div>\n\n\n</div>\n",
            cssloader: ie8 ? "ba-imageviewer" : "",
            cssmessage: "ba-imageviewer"
        }
    };
});

Scoped.extend("module:Assets.audioplayerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }/**/ });
    return {
        "modern": {
            css: "ba-audioplayer-theme-modern",
            tmplcontrolbar: "<div data-selector=\"audio-title-block\" class=\"{{css}}-audio-title-container \" ba-if=\"{{title}}\">\n\t<p class=\"{{css}}-audio-title\">\n\t\t{{title}}\n\t</p>\n</div>\n\n<div class=\"{{css}}-dashboard \">\n\n    <div tabindex=\"0\" data-selector=\"submit-audio-button\"\n\t\t ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\"\n\t>\n        <div class=\"{{css}}-button-inner\">\n        \t{{string('submit-audio')}}\n        </div>\n    </div>\n\n    <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-audio')}}\"\n\t>\n    \t<div class=\"{{css}}-button-inner\">\n    \t\t<i class=\"{{css}}-icon-ccw\"></i>\n    \t</div>\n    </div>\n\n\t<div tabindex=\"0\" data-selector=\"button-icon-play\"\n\t\t ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n\t\t class=\"{{css}}-leftbutton-container\"\n\t\t ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-audio')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<i class=\"{{css}}-icon-play\"></i>\n\t\t</div>\n\t</div>\n\n\t<div tabindex=\"0\" data-selector=\"button-icon-pause\"\n\t\t ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n\t\t onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n\t\t class=\"{{css}}-leftbutton-container {{disablepause ? css + '-disabled' : ''}}\"\n\t\t ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<i class=\"{{css}}-icon-pause\"></i>\n\t\t</div>\n\t</div>\n\t<div class=\"{{css}}-time-container\">\n\t\t<div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}/{{formatTime(duration || position)}}</div>\n\t</div>\n\n\n\t<div class=\"{{css}}-volumebar\">\n\t\t<div tabindex=\"4\" data-selector=\"button-volume-bar\"\n\t\t\t ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n\t\t\t ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n\t\t\t onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-volumebar-inner\"\n\t\t\t onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n\t\t\t onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n\t\t\t onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n\t\t\t onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n\t\t>\n\t\t\t<div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n\t\t</div>\n\t</div>\n\n\t<div tabindex=\"3\" data-selector=\"button-icon-volume\"\n\t\t ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n\t\t class=\"{{css}}-rightbutton-container {{css}}-volume-button-container\"\n\t\t ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n\t>\n\t\t<div class=\"{{css}}-button-inner\">\n\t\t\t<i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n\t\t</div>\n\t</div>\n\n\t<div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n\t\t<div tabindex=\"2\" data-selector=\"progress-bar-inner\"\n\t\t\t ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n\t\t\t ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n\t\t\t onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-progressbar-inner\"\n\t\t     onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n\t\t     onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n\t\t     onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n\t\t     onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n\t\t>\n\t\t<div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n\t\t<div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\"></div>\n\t</div>\n</div>\n",
            cssloader: ie8 ? "ba-audioplayer" : "",
            cssmessage: "ba-audioplayer",
            cssplaybutton: ie8 ? "ba-audioplayer" : ""
        }
    };
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.extend("module:Assets.playerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "skipinitial ? 0 : 1": function (obj) { with (obj) { return skipinitial ? 0 : 1; } }, "play()": function (obj) { with (obj) { return play(); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "seek(position + skipseconds * 3)": function (obj) { with (obj) { return seek(position + skipseconds * 3); } }, "seek(position - skipseconds * 3)": function (obj) { with (obj) { return seek(position - skipseconds * 3); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }/**/ });
    return {
        "cube": {
            css: "ba-videoplayer-cube-theme",
            csstheme: "ba-videoplayer-cube-theme",
            tmplcontrolbar: "\n<div data-selector=\"video-title-block\" class=\"{{css}}-video-title-block {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\" ba-if=\"{{title}}\">\n    <p class=\"{{css}}-video-title\">\n        {{title}}\n    </p>\n</div>\n\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-left-block\">\n\n        <div tabindex=\"0\" data-selector=\"submit-video-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-video')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{rerecordable}}\"\n             ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-video')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 1}}\" data-selector=\"button-icon-play\"\n             ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\"\n             ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-video')}}\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-play\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 1 }}\" data-selector=\"button-icon-pause\"\n             ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n             ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-pause\"></i>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-right-block\">\n        <div class=\"{{css}}-button-container {{css}}-timer-container\">\n            <div class=\"{{css}}-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n            </div>\n            <p> / </p>\n            <div class=\"{{css}}-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n            </div>\n        </div>\n\n        <div tabindex=\"3\" data-selector=\"button-icon-volume\"\n             ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\"\n             ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\">\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-volumebar\">\n            <div tabindex=\"4\" data-selector=\"button-volume-bar\"\n                 ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n                 ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n                 onmouseout=\"this.blur()\"\n                 class=\"{{css}}-volumebar-inner\"\n                 onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                 onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmousemove=\"{{progressUpdateVolume(domEvent)}}\">\n                <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n            </div>\n        </div>\n\n        <div tabindex=\"5\" data-selector=\"button-stream-label\"\n             ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{streams.length > 1 && currentstream}}\"\n             ba-click=\"{{toggle_stream()}}\" title=\"{{string('change-resolution')}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-stream-label-container\">\n                <div class=\"{{css}}-button-text {{css}}-stream-label\">\n                    <span>{{currentstream_label}}</span>\n                </div>\n            </div>\n        </div>\n\n        <div tabindex=\"6\" data-selector=\"button-airplay\"\n             ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container {{css}}-airplay-container\"\n             ba-show=\"{{airplaybuttonvisible}}\" ba-click=\"{{show_airplay_devices()}}\">\n            <svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                <!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n                <title>Airplay</title>\n                <desc>Airplay icon.</desc>\n                <defs></defs>\n                <g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n                    <path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n                </g>\n            </svg>\n        </div>\n\n        <div tabindex=\"7\" data-selector=\"button-chromecast\" onmouseout=\"this.blur()\" class=\"{{css}}-button-container {{css}}-cast-button-container\" ba-show=\"{{castbuttonvisble}}\">\n            <button class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n        </div>\n\n        <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n             ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if={{fullscreen}}\n             ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\"\n             onkeydown=\"{{tab_index_move(domEvent)}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"9\" data-selector=\"cc-button-container\"\n             ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n             ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n             class=\"{{css}}-button-container  {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n             title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n             ba-click=\"{{toggle_tracks()}}\"\n             onmouseover=\"{{hover_cc(true)}}\"\n             onmouseleave=\"{{hover_cc(false)}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-subtitle-button-inner\">\n                <i class=\"{{css}}-icon-subtitle\"></i>\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n        <div tabindex=\"2\" data-selector=\"progress-bar-inner\"\n             ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n             ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n             ba-hotkey:alt+right=\"{{seek(position + skipseconds * 3)}}\"\n             ba-hotkey:alt+left=\"{{seek(position - skipseconds * 3)}}\"\n             onmouseout=\"this.blur()\"\n             class=\"{{css}}-progressbar-inner\"\n             onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n             onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n             onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n             onmousemove=\"{{progressUpdatePosition(domEvent)}}\">\n\n            <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n            <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\"></div>\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-videoplayer" : "",
            cssmessage: "ba-videoplayer",
            cssplaybutton: ie8 ? "ba-videoplayer" : ""
        }
    };
});

Scoped.extend("module:Assets.recorderthemes", ["dynamics:Parser"], function (Parser) {
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "settingsvisible && settingsopen": function (obj) { with (obj) { return settingsvisible && settingsopen; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "selectCamera(camera.id)": function (obj) { with (obj) { return selectCamera(camera.id); } }, "selectedcamera == camera.id": function (obj) { with (obj) { return selectedcamera == camera.id; } }, "camera.label": function (obj) { with (obj) { return camera.label; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "audio": function (obj) { with (obj) { return audio; } }, "selectMicrophone(microphone.id)": function (obj) { with (obj) { return selectMicrophone(microphone.id); } }, "selectedmicrophone == microphone.id": function (obj) { with (obj) { return selectedmicrophone == microphone.id; } }, "microphone.label": function (obj) { with (obj) { return microphone.label; } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "hover(string('rerecord-tooltip'))": function (obj) { with (obj) { return hover(string('rerecord-tooltip')); } }, "unhover()": function (obj) { with (obj) { return unhover(); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }, "cancelvisible": function (obj) { with (obj) { return cancelvisible; } }, "cancel()": function (obj) { with (obj) { return cancel(); } }, "hover(string('cancel-tooltip'))": function (obj) { with (obj) { return hover(string('cancel-tooltip')); } }, "string('cancel')": function (obj) { with (obj) { return string('cancel'); } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "settingsopen=!settingsopen": function (obj) { with (obj) { return settingsopen=!settingsopen; } }, "settingsopen ? 'selected' : 'unselected'": function (obj) { with (obj) { return settingsopen ? 'selected' : 'unselected'; } }, "hover(string('settings'))": function (obj) { with (obj) { return hover(string('settings')); } }, "!noaudio && !allowscreen": function (obj) { with (obj) { return !noaudio && !allowscreen; } }, "hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))": function (obj) { with (obj) { return hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy')); } }, "microphonehealthy ? 'good' : 'bad'": function (obj) { with (obj) { return microphonehealthy ? 'good' : 'bad'; } }, "!novideo && !allowscreen": function (obj) { with (obj) { return !novideo && !allowscreen; } }, "hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))": function (obj) { with (obj) { return hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy')); } }, "camerahealthy ? 'good' : 'bad'": function (obj) { with (obj) { return camerahealthy ? 'good' : 'bad'; } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "record()": function (obj) { with (obj) { return record(); } }, "hover(string('record-tooltip'))": function (obj) { with (obj) { return hover(string('record-tooltip')); } }, "string('record')": function (obj) { with (obj) { return string('record'); } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "controlbarlabel && !rerecordvisible": function (obj) { with (obj) { return controlbarlabel && !rerecordvisible; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "stop()": function (obj) { with (obj) { return stop(); } }, "mintimeindicator ? css + '-disabled': ''": function (obj) { with (obj) { return mintimeindicator ? css + '-disabled': ''; } }, "mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')": function (obj) { with (obj) { return mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'); } }, "hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))": function (obj) { with (obj) { return hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')); } }, "string('stop')": function (obj) { with (obj) { return string('stop'); } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "skip()": function (obj) { with (obj) { return skip(); } }, "hover(string('skip-tooltip'))": function (obj) { with (obj) { return hover(string('skip-tooltip')); } }, "string('skip')": function (obj) { with (obj) { return string('skip'); } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "hover(string('upload-covershot-tooltip'))": function (obj) { with (obj) { return hover(string('upload-covershot-tooltip')); } }, "uploadCovershot(domEvent)": function (obj) { with (obj) { return uploadCovershot(domEvent); } }, "covershot_accept_string": function (obj) { with (obj) { return covershot_accept_string; } }, "string('upload-covershot')": function (obj) { with (obj) { return string('upload-covershot'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "left()": function (obj) { with (obj) { return left(); } }, "images": function (obj) { with (obj) { return images; } }, "select(image)": function (obj) { with (obj) { return select(image); } }, "{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}": function (obj) { with (obj) { return {left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}; } }, "right()": function (obj) { with (obj) { return right(); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.label": function (obj) { with (obj) { return action.label; } }, "action.icon": function (obj) { with (obj) { return action.icon; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "shortMessage ? 'short-message' : 'long-message'": function (obj) { with (obj) { return shortMessage ? 'short-message' : 'long-message'; } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }, "links && links.length > 0": function (obj) { with (obj) { return links && links.length > 0; } }, "links": function (obj) { with (obj) { return links; } }, "linkClick(link)": function (obj) { with (obj) { return linkClick(link); } }, "link.title": function (obj) { with (obj) { return link.title; } }/**/ });
    return {
        "cube": {
            css: "ba-videorecorder-theme-cube",
            cssmessage: "ba-videorecorder-theme-cube",
            cssloader: "ba-videorecorder",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard\">\n\n\t<div class=\"{{css}}-settings-front\">\n\n\t\t<!-- Popup Settings Selections, initially hidden, appear when click button for settings -->\n\t\t<div data-selector=\"recorder-settings\" class=\"{{css}}-settings\" ba-show=\"{{settingsvisible && settingsopen}}\">\n\t\t\t<div data-selector=\"settings-list-front\" class=\"{{css}}-bubble-info\">\n\t\t\t\t<ul data-selector=\"camera-settings\" ba-repeat=\"{{camera :: cameras}}\">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<input tabindex=\"0\"\n\t\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n                               type='radio'\n\t\t\t\t\t\t\t   name='camera' value=\"{{selectedcamera == camera.id}}\" onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<label tabindex=\"0\" ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<ul data-selector=\"microphone-settings\" ba-repeat=\"{{microphone :: microphones}}\" ba-show=\"{{audio}}\">\n\t\t\t\t\t<li tabindex=\"0\"\n\t\t\t\t\t\tba-hotkey:space^enter=\"{{selectMicrophone(microphone.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\tonclick=\"{{selectMicrophone(microphone.id)}}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input type='radio' name='microphone' value=\"{{selectedmicrophone == microphone.id}}\" />\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t{{microphone.label}}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<!-- Control bar, footer part which holds all buttons -->\n\t<div data-selector=\"controlbar\" class=\"{{css}}-controlbar\">\n\n\t\t<div class=\"{{css}}-controlbar-center-section\">\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{rerecordvisible}}\">\n\t\t\t\t<div tabindex=\"0\" data-selector=\"rerecord-primary-button\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{rerecord()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('rerecord-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('rerecord')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{cancelvisible}}\">\n\t\t\t\t<div tabindex=\"0\" data-selector=\"cancel-primary-button\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{cancel()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{cancel()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('cancel-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\">\n\t\t\t\t\t{{string('cancel')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-controlbar-left-section\" ba-show=\"{{settingsvisible}}\">\n\n            <div class=\"{{css}}-button\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t\t<div tabindex=\"0\" ba-hotkey:space^enter=\"{{settingsopen=!settingsopen}}\"\n\t\t\t\t\t data-selector=\"record-button-icon-cog\" class=\"{{css}}-button-inner {{css}}-button-{{settingsopen ? 'selected' : 'unselected' }}\"\n\t\t\t\t\t onclick=\"{{settingsopen=!settingsopen}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('settings'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\" >\n\t\t\t\t\t<i class=\"{{css}}-icon-cog\"></i>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button\" ba-show=\"{{!noaudio && !allowscreen}}\">\n\t\t\t\t<div data-selector=\"record-button-icon-mic\" class=\"{{css}}-button-inner\"\n\t\t\t\t\tonmouseenter=\"{{hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))}}\"\n\t\t\t\t\tonmouseleave=\"{{unhover()}}\">\n\t\t\t\t\t<i class=\"{{css}}-icon-mic {{css}}-icon-state-{{microphonehealthy ? 'good' : 'bad' }}\"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button\" ba-show=\"{{!novideo && !allowscreen}}\">\n\t\t\t\t<div data-selector=\"record-button-icon-videocam\" class=\"{{css}}-button-inner\"\n\t\t\t\t\tonmouseenter=\"{{hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))}}\"\n\t\t\t\t\tonmouseleave=\"{{unhover()}}\">\n                    <i class=\"{{css}}-icon-videocam {{css}}-icon-state-{{ camerahealthy ? 'good' : 'bad' }}\"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"{{css}}-controlbar-right-section\">\n\n\t\t\t<div class=\"{{css}}-rightbutton-container\" ba-show=\"{{recordvisible}}\">\n\t\t\t\t<div tabindex=\"0\" data-selector=\"record-primary-button\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{record()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{record()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('record-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\">\n\t\t\t\t\t{{string('record')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-stop-container\" ba-show=\"{{stopvisible}}\">\n\t\t\t<div class=\"{{css}}-timer-container\">\n\t\t\t\t<div class=\"{{css}}-label-container\" ba-show=\"{{controlbarlabel && !rerecordvisible}}\">\n\t\t\t\t\t<div data-selector=\"record-label-block\" class=\"{{css}}-label {{css}}-button-primary\">\n\t\t\t\t\t\t{{controlbarlabel}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-stop-button-container\">\n\t\t\t\t<div tabindex=\"0\" data-selector=\"stop-primary-button\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{stop()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"stop-primary-button\" class=\"{{css}}-button-primary {{mintimeindicator ? css + '-disabled': ''}}\"\n\t\t\t\t\t title=\"{{mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')}}\"\n\t\t\t\t\t onclick=\"{{stop()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\">\n\t\t\t\t\t{{string('stop')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n        <div class=\"{{css}}-centerbutton-container\" ba-show=\"{{skipvisible}}\">\n            <div tabindex=\"0\" data-selector=\"skip-primary-button\"\n\t\t\t\t ba-hotkey:space^enter=\"{{skip()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-button-primary\"\n                 onclick=\"{{skip()}}\"\n                 onmouseenter=\"{{hover(string('skip-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                {{string('skip')}}\n            </div>\n        </div>\n\n\n        <div class=\"{{css}}-rightbutton-container\" ba-if=\"{{uploadcovershotvisible}}\">\n            <div data-selector=\"covershot-primary-button\" class=\"{{css}}-button-primary\"\n                 onmouseenter=\"{{hover(string('upload-covershot-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                <input type=\"file\"\n                       class=\"{{css}}-chooser-file\"\n                       style=\"height:100px\"\n                       onchange=\"{{uploadCovershot(domEvent)}}\"\n                       accept=\"{{covershot_accept_string}}\" />\n                <span>\n                    {{string('upload-covershot')}}\n                </span>\n            </div>\n        </div>\n\n\t</div>\n\n</div>\n",
            tmplimagegallery: "<div data-selector=\"image-gallery\" class=\"{{css}}-image-gallery-container\">\n\n\t<div data-selector=\"slider-left-button\" class=\"{{css}}-imagegallery-leftbutton\">\n\t\t<div tabindex=\"0\" data-selector=\"slider-left-inner-button\"\n\t\t\t ba-hotkey:space^enter^left=\"{{left()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-button-inner\" onclick=\"{{left()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-left-open\"></i>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"images-imagegallery-container\" ba-repeat=\"{{image::images}}\" class=\"{{css}}-imagegallery-container\" data-gallery-container>\n\t\t<div tabindex=\"0\" data-selector=\"imagegallery-selected-image\"\n\t\t\t ba-hotkey:space^enter=\"{{select(image)}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-image\"\n\t\t\t ba-styles=\"{{{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}}}\"\n\t\t\t onclick=\"{{select(image)}}\"\n\t\t>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"slider-right-button\" class=\"{{css}}-imagegallery-rightbutton\">\n\t\t<div tabindex=\"0\" data-selector=\"slider-right-inner-button\"\n\t\t\t ba-hotkey:space^enter^right=\"{{right()}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{right()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-right-open\"></i>\n\t\t</div>\n\t</div>\n\n</div>\n",
            tmplchooser: "<div class=\"{{css}}-chooser-container\">\n\n\t<div class=\"{{css}}-chooser-button-container\">\n\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-chooser-button-{{action.index}}\"\n\t\t\t\t ba-click=\"{{click_action(action)}}\">\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t/>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t\t<i class=\"{{css}}-icon-{{action.icon}}\"\n\t\t\t\t   ba-if=\"{{action.icon}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>",
            tmplmessage: "<div data-selector=\"recorder-message-container\" class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div class=\"{{css}}-top-inner-message-container {{css}}-{{shortMessage ? 'short-message' : 'long-message'}}\">\n        <div class=\"{{css}}-first-inner-message-container\">\n            <div class=\"{{css}}-second-inner-message-container\">\n                <div class=\"{{css}}-third-inner-message-container\">\n                    <div class=\"{{css}}-fourth-inner-message-container\">\n                        <div data-selector=\"recorder-message-block\" class='{{css}}-message-message'>\n                            <p>\n                                {{message || \"\"}}\n                            </p>\n                            <ul ba-if=\"{{links && links.length > 0}}\" ba-repeat=\"{{link :: links}}\">\n                                <li>\n                                    <a href=\"javascript:;\" ba-click=\"{{linkClick(link)}}\">\n                                        {{link.title}}\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"
        }
    };
});

Scoped.extend("module:Assets.imageviewerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }/**/ });
    return {
        "cube": {
            css: "ba-imageviewer-cube-theme",
            csstheme: "ba-imageviewer-cube-theme",
            tmplcontrolbar: "\n<div data-selector=\"image-title-block\" class=\"{{css}}-image-title-block {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\" ba-if=\"{{title}}\">\n    <p class=\"{{css}}-image-title\">\n        {{title}}\n    </p>\n</div>\n\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-left-block\">\n\n        <div tabindex=\"0\" data-selector=\"submit-image-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-image')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{rerecordable}}\"\n             ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-image')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-right-block\">\n        <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n             ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if={{fullscreen}}\n             ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\"\n             onkeydown=\"{{tab_index_move(domEvent)}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n            </div>\n        </div>\n\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-imageviewer" : "",
            cssmessage: "ba-imageviewer"
        }
    };
});

Scoped.extend("module:Assets.audioplayerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "play()": function (obj) { with (obj) { return play(); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "seek(position + skipseconds * 3)": function (obj) { with (obj) { return seek(position + skipseconds * 3); } }, "seek(position - skipseconds * 3)": function (obj) { with (obj) { return seek(position - skipseconds * 3); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }/**/ });
    return {
        "cube": {
            css: "ba-audioplayer-cube-theme",
            csstheme: "ba-audioplayer-cube-theme",
            tmplcontrolbar: "\n<div data-selector=\"audio-title-block\" class=\"{{css}}-audio-title-block \" ba-if=\"{{title}}\">\n    <p class=\"{{css}}-audio-title\">\n        {{title}}\n    </p>\n</div>\n\n<div class=\"{{css}}-dashboard \">\n\n    <div class=\"{{css}}-left-block\">\n\n        <div tabindex=\"0\" data-selector=\"submit-audio-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{submittable}}\" ba-click=\"{{submit()}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-audio')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\" ba-if=\"{{rerecordable}}\"\n             ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-audio')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-play\"\n             ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\"\n             ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-audio')}}\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-play\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-pause\"\n             ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n             ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-pause\"></i>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-right-block\">\n        <div class=\"{{css}}-button-container {{css}}-timer-container\">\n            <div class=\"{{css}}-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n            </div>\n            <p> / </p>\n            <div class=\"{{css}}-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n            </div>\n        </div>\n\n        <div tabindex=\"3\" data-selector=\"button-icon-volume\"\n             ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container\"\n             ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\">\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-volumebar\">\n            <div tabindex=\"4\" data-selector=\"button-volume-bar\"\n                 ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n                 ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n                 onmouseout=\"this.blur()\"\n                 class=\"{{css}}-volumebar-inner\"\n                 onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                 onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                 onmousemove=\"{{progressUpdateVolume(domEvent)}}\">\n                <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n        <div tabindex=\"2\" data-selector=\"progress-bar-inner\"\n             ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n             ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n             ba-hotkey:alt+right=\"{{seek(position + skipseconds * 3)}}\"\n             ba-hotkey:alt+left=\"{{seek(position - skipseconds * 3)}}\"\n             onmouseout=\"this.blur()\"\n             class=\"{{css}}-progressbar-inner\"\n             onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n             onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n             onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n             onmousemove=\"{{progressUpdatePosition(domEvent)}}\">\n\n            <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n            <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\"></div>\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-audioplayer" : "",
            cssmessage: "ba-audioplayer",
            cssplaybutton: ie8 ? "ba-audioplayer" : ""
        }
    };
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.extend("module:Assets.playerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "skipinitial ? 0 : 1": function (obj) { with (obj) { return skipinitial ? 0 : 1; } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "skipinitial ? 0 : 3": function (obj) { with (obj) { return skipinitial ? 0 : 3; } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "fullscreened ? 'resize-minimize' : 'resize-full'": function (obj) { with (obj) { return fullscreened ? 'resize-minimize' : 'resize-full'; } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }/**/ });
    Parser.registerFunctions({ /**/"play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'player-toggle-overlay')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'player-toggle-overlay'); } }, "css": function (obj) { with (obj) { return css; } }, "string('tooltip')": function (obj) { with (obj) { return string('tooltip'); } }, "rerecordable || submittable": function (obj) { with (obj) { return rerecordable || submittable; } }, "submittable": function (obj) { with (obj) { return submittable; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }/**/ });
    return {
        "space": {
            css: "ba-videoplayer-space-theme",
            csstheme: "ba-videoplayer-space-theme",
            tmplcontrolbar: "<div class=\"{{css}}-video-title-container {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n    <div class=\"{{css}}-title\" ba-if=\"{{title}}\">\n        <p>{{title}}</p>\n    </div>\n\n    <div class=\"{{css}}-volumebar\">\n        <div tabindex=\"2\" data-selector=\"button-volume-bar\"\n             ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n             ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n             onmouseout=\"this.blur()\"\n             class=\"{{css}}-volumebar-inner\"\n             onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n             onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n             onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n             onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n        >\n            <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n        </div>\n    </div>\n\n    <div tabindex=\"{{skipinitial ? 0 : 1}}\" data-selector=\"button-icon-volume\"\n         ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n         class=\"{{css}}-rightbutton-container\"\n         ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n    >\n        <div class=\"{{css}}-button-inner\">\n            <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n        </div>\n    </div>\n</div>\n\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-controlbar-footer\">\n        <div tabindex=\"0\" data-selector=\"submit-video-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               {{string('submit-video')}}\n           </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{rerecordable}}\"\n             ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-video')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-ccw\"></i>\n           </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 3}}\" data-selector=\"button-icon-play\"\n             ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-video')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-play\"></i>\n           </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 3}}\" data-selector=\"button-icon-pause\"\n             ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n             class=\"{{css}}-leftbutton-container {{disablepause ? css + '-disabled' : ''}}\"\n             ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-pause\"></i>\n           </div>\n        </div>\n\n        <div class=\"{{css}}-time-container\">\n           <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n        </div>\n\n        <div tabindex=\"9\" data-selector=\"cc-button-container\"\n             ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n             ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n             class=\"{{css}}-rightbutton-container {{css}}-cc-button-container {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n             title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n             ba-click=\"{{toggle_tracks()}}\"\n             onmouseover=\"{{hover_cc(true)}}\"\n             onmouseleave=\"{{hover_cc(false)}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-subtitle-button-inner\">\n                <i class=\"{{css}}-icon-subtitle\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n             ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent)}}\"\n             class=\"{{css}}-rightbutton-container\"\n             ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                <i class=\"{{css}}-icon-{{fullscreened ? 'resize-minimize' : 'resize-full'}}\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"7\" data-selector=\"button-airplay\"\n             ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-rightbutton-container {{css}}-airplay-container\"\n             ba-show=\"{{airplaybuttonvisible}}\" ba-click=\"{{show_airplay_devices()}}\"\n        >\n            <svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                <!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n                <title>Airplay</title>\n                <desc>Airplay icon.</desc>\n                <defs></defs>\n                <g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n                    <path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n                </g>\n            </svg>\n        </div>\n\n        <div data-selector=\"button-chromecast\" class=\"{{css}}-rightbutton-container {{css}}-cast-button-container\" ba-show=\"{{castbuttonvisble}}\">\n            <button tabindex=\"6\" class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n        </div>\n\n        <div tabindex=\"5\" data-selector=\"button-stream-label\"\n             ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-rightbutton-container\"\n             ba-if=\"{{streams.length > 1 && currentstream}}\" ba-click=\"{{toggle_stream()}}\" title=\"{{string('change-resolution')}}\"\n        >\n           <div class=\"{{css}}-button-inner {{css}}-stream-label-container\">\n               <span class=\"{{css}}-button-text {{css}}-stream-label\">{{currentstream_label}}</span>\n           </div>\n        </div>\n\n        <div class=\"{{css}}-time-container {{css}}-rightbutton-container {{css}}-right-time-container\">\n           <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n        </div>\n\n        <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n           <div tabindex=\"4\" data-selector=\"progress-bar-inner\"\n                ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n                ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n                onmouseout=\"this.blur()\"\n                class=\"{{css}}-progressbar-inner\"\n                onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n                onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n                onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n                onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n           >\n\n               <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n               <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\">\n                   <div class=\"{{css}}-progressbar-button\"></div>\n               </div>\n           </div>\n        </div>\n\n    </div>\n\n</div>\n",
            tmplplaybutton: "\n<div tabindex=\"0\" data-selector=\"play-button\"\n     ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n     onkeydown=\"{{tab_index_move(domEvent, null, 'player-toggle-overlay')}}\"\n     class=\"{{css}}-playbutton-container\" ba-click=\"{{play()}}\" title=\"{{string('tooltip')}}\"\n>\n\t<div class=\"{{css}}-playbutton-button\"></div>\n</div>\n\n<div class=\"{{css}}-rerecord-bar\" ba-if=\"{{rerecordable || submittable}}\">\n\t<div class=\"{{css}}-rerecord-frontbar\">\n        <div class=\"{{css}}-rerecord-button-container\" ba-if=\"{{submittable}}\">\n            <div tabindex=\"0\" data-selector=\"player-submit-button\"\n                 ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-rerecord-button\" onclick=\"{{submit()}}\">\n                {{string('submit-video')}}\n            </div>\n        </div>\n        <div class=\"{{css}}-rerecord-button-container\" ba-if=\"{{rerecordable}}\">\n        \t<div tabindex=\"0\" data-selector=\"player-rerecord-button\"\n                 ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-rerecord-button\" onclick=\"{{rerecord()}}\">\n        \t\t{{string('rerecord')}}\n        \t</div>\n        </div>\n\t</div>\n</div>\n",
            tmplmessage: "<div class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"message-block\" class=\"{{css}}-first-inner-message-container\">\n        <div class=\"{{css}}-second-inner-message-container\">\n            <div class=\"{{css}}-third-inner-message-container\">\n                <div class=\"{{css}}-fourth-inner-message-container\">\n                    <div class='{{css}}-message-message'>\n                        {{message || \"\"}}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n",
            cssloader: ie8 ? "ba-videoplayer" : "",
            cssmessage: "ba-videoplayer",
            cssplaybutton: ie8 ? "ba-videoplayer" : ""
        }
    };
});

Scoped.extend("module:Assets.recorderthemes", ["dynamics:Parser"], function (Parser) {
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "settingsvisible && settingsopen": function (obj) { with (obj) { return settingsvisible && settingsopen; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "selectCamera(camera.id)": function (obj) { with (obj) { return selectCamera(camera.id); } }, "selectedcamera == camera.id": function (obj) { with (obj) { return selectedcamera == camera.id; } }, "camera.label": function (obj) { with (obj) { return camera.label; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "audio": function (obj) { with (obj) { return audio; } }, "selectMicrophone(microphone.id)": function (obj) { with (obj) { return selectMicrophone(microphone.id); } }, "selectedmicrophone == microphone.id": function (obj) { with (obj) { return selectedmicrophone == microphone.id; } }, "microphone.label": function (obj) { with (obj) { return microphone.label; } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "hover(string('rerecord-tooltip'))": function (obj) { with (obj) { return hover(string('rerecord-tooltip')); } }, "unhover()": function (obj) { with (obj) { return unhover(); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }, "cancelvisible": function (obj) { with (obj) { return cancelvisible; } }, "cancel()": function (obj) { with (obj) { return cancel(); } }, "hover(string('cancel-tooltip'))": function (obj) { with (obj) { return hover(string('cancel-tooltip')); } }, "string('cancel')": function (obj) { with (obj) { return string('cancel'); } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "settingsopen=!settingsopen": function (obj) { with (obj) { return settingsopen=!settingsopen; } }, "settingsopen ? 'selected' : 'unselected'": function (obj) { with (obj) { return settingsopen ? 'selected' : 'unselected'; } }, "hover(string('settings'))": function (obj) { with (obj) { return hover(string('settings')); } }, "!noaudio && !allowscreen": function (obj) { with (obj) { return !noaudio && !allowscreen; } }, "hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))": function (obj) { with (obj) { return hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy')); } }, "microphonehealthy ? 'good' : 'bad'": function (obj) { with (obj) { return microphonehealthy ? 'good' : 'bad'; } }, "!novideo && !allowscreen": function (obj) { with (obj) { return !novideo && !allowscreen; } }, "hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))": function (obj) { with (obj) { return hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy')); } }, "camerahealthy ? 'good' : 'bad'": function (obj) { with (obj) { return camerahealthy ? 'good' : 'bad'; } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "record()": function (obj) { with (obj) { return record(); } }, "hover(string('record-tooltip'))": function (obj) { with (obj) { return hover(string('record-tooltip')); } }, "string('record')": function (obj) { with (obj) { return string('record'); } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "controlbarlabel && !rerecordvisible": function (obj) { with (obj) { return controlbarlabel && !rerecordvisible; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "stop()": function (obj) { with (obj) { return stop(); } }, "mintimeindicator ? css + '-disabled': ''": function (obj) { with (obj) { return mintimeindicator ? css + '-disabled': ''; } }, "mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')": function (obj) { with (obj) { return mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'); } }, "hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))": function (obj) { with (obj) { return hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')); } }, "string('stop')": function (obj) { with (obj) { return string('stop'); } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "skip()": function (obj) { with (obj) { return skip(); } }, "hover(string('skip-tooltip'))": function (obj) { with (obj) { return hover(string('skip-tooltip')); } }, "string('skip')": function (obj) { with (obj) { return string('skip'); } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "hover(string('upload-covershot-tooltip'))": function (obj) { with (obj) { return hover(string('upload-covershot-tooltip')); } }, "uploadCovershot(domEvent)": function (obj) { with (obj) { return uploadCovershot(domEvent); } }, "covershot_accept_string": function (obj) { with (obj) { return covershot_accept_string; } }, "string('upload-covershot')": function (obj) { with (obj) { return string('upload-covershot'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "left()": function (obj) { with (obj) { return left(); } }, "images": function (obj) { with (obj) { return images; } }, "select(image)": function (obj) { with (obj) { return select(image); } }, "{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}": function (obj) { with (obj) { return {left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}; } }, "right()": function (obj) { with (obj) { return right(); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.label": function (obj) { with (obj) { return action.label; } }, "action.icon": function (obj) { with (obj) { return action.icon; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "shortMessage ? 'short-message' : 'long-message'": function (obj) { with (obj) { return shortMessage ? 'short-message' : 'long-message'; } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }, "links && links.length > 0": function (obj) { with (obj) { return links && links.length > 0; } }, "links": function (obj) { with (obj) { return links; } }, "linkClick(link)": function (obj) { with (obj) { return linkClick(link); } }, "link.title": function (obj) { with (obj) { return link.title; } }/**/ });
    return {
        "space": {
            css: "ba-videorecorder-theme-space",
            cssmessage: "ba-videorecorder",
            cssloader: "ba-videorecorder",
            tmpltopmessage: "<div class=\"{{css}}-topmessage-container\">\n    <div data-selector=\"recorder-topmessage-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard\">\n\n\t<div class=\"{{css}}-settings-front\">\n\n\t\t<!-- Popup Settings Selections, initially hidden, appear when click button for settings -->\n\t\t<div data-selector=\"recorder-settings\" class=\"{{css}}-settings\" ba-show=\"{{settingsvisible && settingsopen}}\">\n\t\t\t<div class=\"{{css}}-bubble-info\">\n\t\t\t\t<ul data-selector=\"camera-settings\" ba-repeat=\"{{camera :: cameras}}\">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<input tabindex=\"0\"\n\t\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t   type='radio' name='camera' value=\"{{selectedcamera == camera.id}}\"\n\t\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<label onclick=\"{{selectCamera(camera.id)}}\" ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\">\n\t\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<ul data-selector=\"record-button-icon-cog\" ba-repeat=\"{{microphone :: microphones}}\" ba-show=\"{{audio}}\">\n\t\t\t\t\t<li tabindex=\"0\"\n\t\t\t\t\t\tba-hotkey:space^enter=\"{{selectMicrophone(microphone.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\tonclick=\"{{selectMicrophone(microphone.id)}}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input type='radio' name='microphone' value=\"{{selectedmicrophone == microphone.id}}\" />\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t{{microphone.label}}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<!-- Control bar, footer part which holds all buttons -->\n\t<div data-selector=\"controlbar\" class=\"{{css}}-controlbar\">\n\n\t\t<div class=\"{{css}}-controlbar-center-section\">\n\n\t\t\t<div data-selector=\"rerecord-primary-button\" class=\"{{css}}-button-container\" ba-show=\"{{rerecordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{rerecord()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('rerecord-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('rerecord')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div data-selector=\"cancel-primary-button\" class=\"{{css}}-button-container\" ba-show=\"{{cancelvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{cancel()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t class=\"{{css}}-button-primary\" onclick=\"{{cancel()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('cancel-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('cancel')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-controlbar-left-section\" ba-show=\"{{settingsvisible}}\">\n\n            <div class=\"{{css}}-circle-button\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{settingsopen=!settingsopen}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"record-button-icon-cog\" class=\"{{css}}-button-inner {{css}}-button-circle-{{settingsopen ? 'selected' : 'unselected' }}\"\n\t\t\t\t\t onclick=\"{{settingsopen=!settingsopen}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('settings'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"{{css}}-icon-cog\"></i>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-circle-button\" ba-show=\"{{!noaudio && !allowscreen}}\">\n\t\t\t\t<div data-selector=\"record-button-icon-mic\" class=\"{{css}}-button-inner\"\n\t\t\t\t\tonmouseenter=\"{{hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))}}\"\n\t\t\t\t\tonmouseleave=\"{{unhover()}}\">\n\t\t\t\t\t<i class=\"{{css}}-icon-mic {{css}}-icon-state-{{microphonehealthy ? 'good' : 'bad' }}\"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-circle-button\" ba-show=\"{{!novideo && !allowscreen}}\">\n\t\t\t\t<div data-selector=\"record-button-icon-videocam\" class=\"{{css}}-button-inner\"\n\t\t\t\t\tonmouseenter=\"{{hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))}}\"\n\t\t\t\t\tonmouseleave=\"{{unhover()}}\">\n                    <i class=\"{{css}}-icon-videocam {{css}}-icon-state-{{ camerahealthy ? 'good' : 'bad' }}\"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"{{css}}-controlbar-right-section\">\n\n\t\t\t<div class=\"{{css}}-rightbutton-container\" ba-show=\"{{recordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{record()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"record-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{record()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('record-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('record')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-stop-container\" ba-show=\"{{stopvisible}}\">\n\n\t\t\t<div class=\"{{css}}-timer-container\">\n\t\t\t\t<div class=\"{{css}}-label-container\" ba-show=\"{{controlbarlabel && !rerecordvisible}}\">\n\t\t\t\t\t<div data-selector=\"record-label-block\" class=\"{{css}}-label {{css}}-button-primary\">\n\t\t\t\t\t\t{{controlbarlabel}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-stop-button-container\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{stop()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"stop-primary-button\"\n\t\t\t\t\t class=\"{{css}}-button-primary {{mintimeindicator ? css + '-disabled': ''}}\"\n\t\t\t\t\t title=\"{{mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')}}\"\n\t\t\t\t\t onclick=\"{{stop()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('stop')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n        <div class=\"{{css}}-centerbutton-container\" ba-show=\"{{skipvisible}}\">\n            <div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{skip()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"skip-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{skip()}}\"\n                 onmouseenter=\"{{hover(string('skip-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                {{string('skip')}}\n            </divi>\n        </div>\n\n\n        <div class=\"{{css}}-rightbutton-container\" ba-if=\"{{uploadcovershotvisible}}\">\n            <div data-selector=\"covershot-primary-button\" class=\"{{css}}-button-primary\"\n                 onmouseenter=\"{{hover(string('upload-covershot-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                <input type=\"file\"\n                       class=\"{{css}}-chooser-file\"\n                       style=\"height:100px\"\n                       onchange=\"{{uploadCovershot(domEvent)}}\"\n                       accept=\"{{covershot_accept_string}}\" />\n                <span>\n                    {{string('upload-covershot')}}\n                </span>\n            </div>\n        </div>\n\n\t</div>\n\n</div>\n",
            tmplimagegallery: "<div data-selector=\"image-gallery\" class=\"{{css}}-image-gallery-container\">\n\n\t<div data-selector=\"slider-left-button\" class=\"{{css}}-imagegallery-leftbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^left=\"{{left()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-left-inner-button\" class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{left()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-left-open\"></i>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"images-imagegallery-container\" ba-repeat=\"{{image::images}}\" class=\"{{css}}-imagegallery-container\" data-gallery-container>\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter=\"{{select(image)}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-image\"\n\t\t\t ba-styles=\"{{{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}}}\"\n\t\t\t onclick=\"{{select(image)}}\"\n\t\t>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"slider-right-button\" class=\"{{css}}-imagegallery-rightbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^right=\"{{right()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-right-inner-button\" class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{right()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-right-open\"></i>\n\t\t</div>\n\t</div>\n\n</div>\n",
            tmplchooser: "<div class=\"{{css}}-chooser-container\">\n\n\t<div class=\"{{css}}-chooser-button-container\">\n\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-chooser-button-{{action.index}}\"\n\t\t\t\t ba-click=\"{{click_action(action)}}\"\n\t\t\t>\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t/>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t\t<i class=\"{{css}}-icon-{{action.icon}}\"\n\t\t\t\t   ba-if=\"{{action.icon}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>",
            tmplmessage: "<div data-selector=\"recorder-message-container\" class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div class=\"{{css}}-top-inner-message-container {{css}}-{{shortMessage ? 'short-message' : 'long-message'}}\">\n        <div class=\"{{css}}-first-inner-message-container\">\n            <div class=\"{{css}}-second-inner-message-container\">\n                <div class=\"{{css}}-third-inner-message-container\">\n                    <div class=\"{{css}}-fourth-inner-message-container\">\n                        <div data-selector=\"recorder-message-block\" class='{{css}}-message-message'>\n                            <p>\n                                {{message || \"\"}}\n                            </p>\n                            <ul ba-if=\"{{links && links.length > 0}}\" ba-repeat=\"{{link :: links}}\">\n                                <li>\n                                    <a href=\"javascript:;\" ba-click=\"{{linkClick(link)}}\">\n                                        {{link.title}}\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"
        }
    };
});

Scoped.extend("module:Assets.imageviewerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "fullscreened ? 'resize-minimize' : 'resize-full'": function (obj) { with (obj) { return fullscreened ? 'resize-minimize' : 'resize-full'; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }/**/ });
    return {
        "space": {
            css: "ba-imageviewer-space-theme",
            csstheme: "ba-imageviewer-space-theme",
            tmplcontrolbar: "<div class=\"{{css}}-image-title-container {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n    <div class=\"{{css}}-title\" ba-if=\"{{title}}\">\n        <p>{{title}}</p>\n    </div>\n\n</div>\n\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-controlbar-footer\">\n        <div tabindex=\"0\" data-selector=\"submit-image-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               {{string('submit-image')}}\n           </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{rerecordable}}\"\n             ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-image')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-ccw\"></i>\n           </div>\n        </div>\n\n        <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n             ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent)}}\"\n             class=\"{{css}}-rightbutton-container\"\n             ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                <i class=\"{{css}}-icon-{{fullscreened ? 'resize-minimize' : 'resize-full'}}\"></i>\n            </div>\n        </div>\n\n    </div>\n\n</div>\n",
            tmplmessage: "<div class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"message-block\" class=\"{{css}}-first-inner-message-container\">\n        <div class=\"{{css}}-second-inner-message-container\">\n            <div class=\"{{css}}-third-inner-message-container\">\n                <div class=\"{{css}}-fourth-inner-message-container\">\n                    <div class='{{css}}-message-message'>\n                        {{message || \"\"}}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n",
            cssloader: ie8 ? "ba-imageviewer" : "",
            cssmessage: "ba-imageviewer"
        }
    };
});

Scoped.extend("module:Assets.audioplayerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "title": function (obj) { with (obj) { return title; } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }/**/ });
    return {
        "space": {
            css: "ba-audioplayer-space-theme",
            csstheme: "ba-audioplayer-space-theme",
            tmplcontrolbar: "<div class=\"{{css}}-audio-title-container \">\n    <div class=\"{{css}}-title\" ba-if=\"{{title}}\">\n        <p>{{title}}</p>\n    </div>\n\n    <div class=\"{{css}}-volumebar\">\n        <div tabindex=\"2\" data-selector=\"button-volume-bar\"\n             ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n             ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n             onmouseout=\"this.blur()\"\n             class=\"{{css}}-volumebar-inner\"\n             onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n             onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n             onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n             onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n        >\n            <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n        </div>\n    </div>\n\n    <div tabindex=\"0\" data-selector=\"button-icon-volume\"\n         ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n         class=\"{{css}}-rightbutton-container\"\n         ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n    >\n        <div class=\"{{css}}-button-inner\">\n            <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n        </div>\n    </div>\n</div>\n\n<div class=\"{{css}}-dashboard \">\n\n    <div class=\"{{css}}-controlbar-footer\">\n        <div tabindex=\"0\" data-selector=\"submit-audio-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               {{string('submit-audio')}}\n           </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{rerecordable}}\"\n             ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-audio')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-ccw\"></i>\n           </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-play\"\n             ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n             class=\"{{css}}-leftbutton-container\" ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-audio')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-play\"></i>\n           </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-pause\"\n             ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n             class=\"{{css}}-leftbutton-container {{disablepause ? css + '-disabled' : ''}}\"\n             ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n        >\n           <div class=\"{{css}}-button-inner\">\n               <i class=\"{{css}}-icon-pause\"></i>\n           </div>\n        </div>\n\n        <div class=\"{{css}}-time-container\">\n           <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n        </div>\n\n        <div class=\"{{css}}-time-container {{css}}-rightbutton-container {{css}}-right-time-container\">\n           <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n        </div>\n\n        <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n           <div tabindex=\"4\" data-selector=\"progress-bar-inner\"\n                ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n                ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n                onmouseout=\"this.blur()\"\n                class=\"{{css}}-progressbar-inner\"\n                onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n                onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n                onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n                onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n           >\n\n               <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n               <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\">\n                   <div class=\"{{css}}-progressbar-button\"></div>\n               </div>\n           </div>\n        </div>\n\n    </div>\n\n</div>\n",
            tmplmessage: "<div class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div data-selector=\"message-block\" class=\"{{css}}-first-inner-message-container\">\n        <div class=\"{{css}}-second-inner-message-container\">\n            <div class=\"{{css}}-third-inner-message-container\">\n                <div class=\"{{css}}-fourth-inner-message-container\">\n                    <div class='{{css}}-message-message'>\n                        {{message || \"\"}}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n",
            cssloader: ie8 ? "ba-audioplayer" : "",
            cssmessage: "ba-audioplayer"
        }
    };
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.extend("module:Assets.playerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "skipinitial ? 0 : -1": function (obj) { with (obj) { return skipinitial ? 0 : -1; } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }/**/ });
    return {
        "minimalist": {
            css: "ba-videoplayer-minimalist-theme",
            csstheme: "ba-videoplayer-minimalist-theme",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class='{{css}}-controlbar-header'>\n        <div class=\"{{css}}-controlbar-header-icons-block\">\n\n            <div class=\"{{css}}-right-block\">\n\n                <div tabindex=\"1\" data-selector=\"button-icon-resize-full\"\n                     ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n                     onkeydown=\"{{tab_index_move(domEvent)}}\"\n                     class=\"{{css}}-button-container\"\n                     ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\"\n                >\n                    <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                        <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n                    </div>\n                </div>\n\n                <div tabindex=\"2\" data-selector=\"button-icon-volume\"\n                     ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n                     class=\"{{css}}-button-container\" ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n                >\n                    <div class=\"{{css}}-button-inner\">\n                        <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n                    </div>\n                </div>\n\n                <div class=\"{{css}}-volumebar\">\n                    <div tabindex=\"3\" data-selector=\"button-volume-bar\"\n                         ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n                         ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n                         onmouseout=\"this.blur()\"\n                         class=\"{{css}}-volumebar-inner\"\n                         onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                         onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                         onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                         onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n                    >\n                        <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n\n\n        <div class=\"{{css}}-controlbar-header-title-block\" ba-if=\"{{title}}\">\n            <div class=\"{{css}}-title\"><p>{{title}}</p></div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-controlbar-footer\">\n\n        <div class=\"{{css}}-controlbar-top-block\">\n\n            <div tabindex=\"0\" data-selector=\"submit-video-button\"\n                 ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\" ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    {{string('submit-video')}}\n                </div>\n            </div>\n\n            <div tabindex=\"{{skipinitial ? 0 : -1}}\" data-selector=\"button-icon-play\"\n                 ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n                 class=\"{{css}}-button-container\" ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-video')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-play\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"{{skipinitial ? 0 : -1}}\" data-selector=\"button-icon-pause\"\n                 ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n                 class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n                 ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i tabindex=\"0\" class=\"{{css}}-icon-pause\"></i>\n                </div>\n            </div>\n\n        </div>\n        <div class=\"{{css}}-controlbar-middle-block\">\n\n            <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n                <div tabindex=\"4\" data-selector=\"progress-bar-inner\"\n                     ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n                     ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n                     onmouseout=\"this.blur()\"\n                     class=\"{{css}}-progressbar-inner\"\n                     onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n                     onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n                     onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n                     onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n                >\n\n                    <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n                    <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\">\n                        <div class=\"{{css}}-progressbar-button\"></div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n        <div class=\"{{css}}-controlbar-bottom-block\">\n            <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n                 ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container {{css}}-player-rerecord\"\n                 ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-video')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-ccw\"></i>\n                </div>\n            </div>\n\n            <div class=\"{{css}}-button-container {{css}}-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n                <p> / </p>\n                <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n            </div>\n\n            <div tabindex=\"5\" data-selector=\"button-stream-label\"\n                 ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\" ba-if=\"{{streams.length > 1 && currentstream}}\"\n                 ba-click=\"{{toggle_stream()}}\" title=\"{{string('change-resolution')}}\"\n            >\n                <div class=\"{{css}}-button-inner {{css}}-stream-label-container\">\n                    <span class=\"{{css}}-button-text {{css}}-stream-label\">{{currentstream_label}}</span>\n                </div>\n            </div>\n            <div tabindex=\"6\" data-selector=\"button-airplay\"\n                 ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container {{css}}-airplay-container\"\n                 ba-show=\"{{airplaybuttonvisible}}\" ba-click=\"{{show_airplay_devices()}}\"\n            >\n                <svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                    <!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n                    <title>Airplay</title>\n                    <desc>Airplay icon.</desc>\n                    <defs></defs>\n                    <g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n                        <path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n                    </g>\n                </svg>\n            </div>\n\n            <div tabindex=\"7\" data-selector=\"button-chromecast\" onmouseout=\"this.blur()\" class=\"{{css}}-button-container {{css}}-cast-button-container\" ba-show=\"{{castbuttonvisble}}\">\n                <button class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n            </div>\n\n            <div tabindex=\"8\" data-selector=\"cc-button-container\"\n                 ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n                 ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n                 ba-click=\"{{toggle_tracks()}}\"\n                 class=\"{{css}}-cc-button-container {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n                 title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n                 onmouseover=\"{{hover_cc(true)}}\" onmouseleave=\"{{hover_cc(false)}}\"\n            >\n                <div class=\"{{css}}-subtitle-button-inner\">\n                    <i class=\"{{css}}-icon-subtitle\"></i>\n                </div>\n            </div>\n\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-videoplayer" : "",
            cssmessage: "ba-videoplayer",
            cssplaybutton: ie8 ? "ba-videoplayer" : ""
        }
    };
});

Scoped.extend("module:Assets.recorderthemes", ["dynamics:Parser"], function (Parser) {
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "settingsopen": function (obj) { with (obj) { return settingsopen; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "selectedcamera == camera.id": function (obj) { with (obj) { return selectedcamera == camera.id; } }, "selectCamera(camera.id)": function (obj) { with (obj) { return selectCamera(camera.id); } }, "camera.label": function (obj) { with (obj) { return camera.label; } }, "settingsopen=!settingsopen": function (obj) { with (obj) { return settingsopen=!settingsopen; } }, "settingsopen ? 'selected' : 'unselected'": function (obj) { with (obj) { return settingsopen ? 'selected' : 'unselected'; } }, "hover(string('settings'))": function (obj) { with (obj) { return hover(string('settings')); } }, "unhover()": function (obj) { with (obj) { return unhover(); } }, "!noaudio && !allowscreen": function (obj) { with (obj) { return !noaudio && !allowscreen; } }, "settingsvisible && settingsopen && audio": function (obj) { with (obj) { return settingsvisible && settingsopen && audio; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "audio": function (obj) { with (obj) { return audio; } }, "selectMicrophone(microphone.id)": function (obj) { with (obj) { return selectMicrophone(microphone.id); } }, "selectedmicrophone == microphone.id": function (obj) { with (obj) { return selectedmicrophone == microphone.id; } }, "microphone.label": function (obj) { with (obj) { return microphone.label; } }, "hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))": function (obj) { with (obj) { return hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy')); } }, "microphonehealthy ? 'good' : 'bad'": function (obj) { with (obj) { return microphonehealthy ? 'good' : 'bad'; } }, "!novideo && !allowscreen": function (obj) { with (obj) { return !novideo && !allowscreen; } }, "hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))": function (obj) { with (obj) { return hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy')); } }, "camerahealthy ? 'good' : 'bad'": function (obj) { with (obj) { return camerahealthy ? 'good' : 'bad'; } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "hover(string('rerecord-tooltip'))": function (obj) { with (obj) { return hover(string('rerecord-tooltip')); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }, "cancelvisible": function (obj) { with (obj) { return cancelvisible; } }, "cancel()": function (obj) { with (obj) { return cancel(); } }, "hover(string('cancel-tooltip'))": function (obj) { with (obj) { return hover(string('cancel-tooltip')); } }, "string('cancel')": function (obj) { with (obj) { return string('cancel'); } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "record()": function (obj) { with (obj) { return record(); } }, "hover(string('record-tooltip'))": function (obj) { with (obj) { return hover(string('record-tooltip')); } }, "string('record')": function (obj) { with (obj) { return string('record'); } }, "stop()": function (obj) { with (obj) { return stop(); } }, "mintimeindicator ? css + '-disabled': ''": function (obj) { with (obj) { return mintimeindicator ? css + '-disabled': ''; } }, "mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')": function (obj) { with (obj) { return mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'); } }, "hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))": function (obj) { with (obj) { return hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')); } }, "string('stop')": function (obj) { with (obj) { return string('stop'); } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "skip()": function (obj) { with (obj) { return skip(); } }, "hover(string('skip-tooltip'))": function (obj) { with (obj) { return hover(string('skip-tooltip')); } }, "string('skip')": function (obj) { with (obj) { return string('skip'); } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "hover(string('upload-covershot-tooltip'))": function (obj) { with (obj) { return hover(string('upload-covershot-tooltip')); } }, "uploadCovershot(domEvent)": function (obj) { with (obj) { return uploadCovershot(domEvent); } }, "covershot_accept_string": function (obj) { with (obj) { return covershot_accept_string; } }, "string('upload-covershot')": function (obj) { with (obj) { return string('upload-covershot'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "left()": function (obj) { with (obj) { return left(); } }, "images": function (obj) { with (obj) { return images; } }, "select(image)": function (obj) { with (obj) { return select(image); } }, "{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}": function (obj) { with (obj) { return {left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}; } }, "right()": function (obj) { with (obj) { return right(); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.label": function (obj) { with (obj) { return action.label; } }, "action.icon": function (obj) { with (obj) { return action.icon; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "shortMessage ? 'short-message' : 'long-message'": function (obj) { with (obj) { return shortMessage ? 'short-message' : 'long-message'; } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }, "links && links.length > 0": function (obj) { with (obj) { return links && links.length > 0; } }, "links": function (obj) { with (obj) { return links; } }, "linkClick(link)": function (obj) { with (obj) { return linkClick(link); } }, "link.title": function (obj) { with (obj) { return link.title; } }/**/ });
    return {
        "minimalist": {
            css: "ba-videorecorder-theme-minimalist",
            cssmessage: "ba-videorecorder",
            cssloader: "ba-videorecorder",
            tmpltopmessage: "<div data-selector=\"recorder-topmessage-block\" class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard\">\n\n\t<!-- Sidebar Settings -->\n\t<div class=\"{{css}}-settings-left-sidebar\">\n\n\t\t<div class=\"{{css}}-controlbar-left-section\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t<!-- Popup Settings Selections, initially hidden, appear when click button for settings -->\n\t\t\t<div data-selector=\"recorder-settings\" class=\"{{css}}-settings {{css}}-settings-button-container\">\n\n\t\t\t\t<div data-selector=\"settings-list-front\" class=\"{{css}}-circle-button\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t\t\t<div class=\"{{css}}-bubble-info\" ba-show=\"{{settingsopen}}\" >\n\t\t\t\t\t\t<ul data-selector=\"camera-settings\" ba-repeat=\"{{camera :: cameras}}\">\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<input tabindex=\"0\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t\t\t   type='radio' name='camera' value=\"{{selectedcamera == camera.id}}\" onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t<label tabindex=\"0\" onmouseout=\"this.blur()\" onclick=\"{{selectCamera(camera.id)}}\">\n\t\t\t\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t\t ba-hotkey:space^enter=\"{{settingsopen=!settingsopen}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t data-selector=\"record-button-icon-cog\"\n\t\t\t\t\t\t class=\"{{css}}-button-inner {{css}}-button-circle-{{settingsopen ? 'selected' : 'unselected' }}\"\n\t\t\t\t\t\t onclick=\"{{settingsopen=!settingsopen}}\"\n\t\t\t\t\t\t onmouseenter=\"{{hover(string('settings'))}}\"\n\t\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<i class=\"{{css}}-icon-cog\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\n                <div class=\"{{css}}-circle-button\" ba-show=\"{{!noaudio && !allowscreen}}\">\n\n                    <div class=\"{{css}}-bubble-info\" ba-show=\"{{settingsvisible && settingsopen && audio }}\">\n                        <ul data-selector=\"microphone-settings\" ba-repeat=\"{{microphone :: microphones}}\" ba-show=\"{{audio}}\">\n                            <li tabindex=\"0\"\n\t\t\t\t\t\t\t\tba-hotkey:space^enter=\"{{selectMicrophone(microphone.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t\tonclick=\"{{selectMicrophone(microphone.id)}}\"\n\t\t\t\t\t\t\t>\n                                <input type='radio' name='microphone' value=\"{{selectedmicrophone == microphone.id}}\" />\n                                <span></span>\n                                <label>\n                                    {{microphone.label}}\n                                </label>\n                            </li>\n                        </ul>\n                    </div>\n\n                    <div data-selector=\"record-button-icon-mic\" class=\"{{css}}-button-inner\"\n                         onmouseenter=\"{{hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))}}\"\n                         onmouseleave=\"{{unhover()}}\">\n                        <i class=\"{{css}}-icon-mic {{css}}-icon-state-{{microphonehealthy ? 'good' : 'bad' }}\"></i>\n                    </div>\n                </div>\n\n                <div class=\"{{css}}-circle-button\" ba-show=\"{{!novideo && !allowscreen}}\">\n                    <div data-selector=\"record-button-icon-videocam\" class=\"{{css}}-button-inner\"\n                         onmouseenter=\"{{hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))}}\"\n                         onmouseleave=\"{{unhover()}}\">\n                        <i class=\"{{css}}-icon-videocam {{css}}-icon-state-{{ camerahealthy ? 'good' : 'bad' }}\"></i>\n                    </div>\n                </div>\n\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<div class=\"{{css}}-controlbar-middle-section\">\n\n\t\t<div class=\"{{css}}-timer-container\" ba-show=\"{{stopvisible}}\">\n\t\t\t<div class=\"{{css}}-label-container\" ba-show=\"{{controlbarlabel}}\">\n\t\t\t\t<div data-selector=\"record-label-block\" class=\"{{css}}-label {{css}}-button-primary\">\n\t\t\t\t\t{{controlbarlabel}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<!-- Control bar, footer part which holds all buttons -->\n\t<div data-selector=\"controlbar\" class=\"{{css}}-controlbar\">\n\n\t\t<div class=\"{{css}}-controlbar-center-section\">\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{rerecordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"rerecord-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{rerecord()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('rerecord-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('rerecord')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{cancelvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{cancel()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"cancel-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{cancel()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('cancel-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('cancel')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-primary-button-container\" ba-show=\"{{recordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{record()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"record-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{record()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('record-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('record')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-stop-container\" ba-show=\"{{stopvisible}}\">\n\n\t\t\t<div class=\"{{css}}-stop-button-container\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{stop()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"stop-primary-button\" class=\"{{css}}-button-primary {{mintimeindicator ? css + '-disabled': ''}}\"\n\t\t\t\t\t title=\"{{mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')}}\"\n\t\t\t\t\t onclick=\"{{stop()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('stop')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n        <div class=\"{{css}}-centerbutton-container\" ba-show=\"{{skipvisible}}\">\n            <div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{skip()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"skip-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{skip()}}\"\n                 onmouseenter=\"{{hover(string('skip-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                {{string('skip')}}\n            </div>\n        </div>\n\n\n        <div class=\"{{css}}-rightbutton-container\" ba-if=\"{{uploadcovershotvisible}}\">\n            <div data-selector=\"covershot-primary-button\" class=\"{{css}}-button-primary\"\n                 onmouseenter=\"{{hover(string('upload-covershot-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                <input type=\"file\"\n                       class=\"{{css}}-chooser-file\"\n                       style=\"height:100px\"\n                       onchange=\"{{uploadCovershot(domEvent)}}\"\n                       accept=\"{{covershot_accept_string}}\" />\n                <span>\n                    {{string('upload-covershot')}}\n                </span>\n            </div>\n        </div>\n\n\t</div>\n\n</div>\n",
            tmplimagegallery: "<div data-selector=\"image-gallery\" class=\"{{css}}-image-gallery-container\">\n\n\t<div data-selector=\"slider-left-button\" class=\"{{css}}-imagegallery-leftbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^left=\"{{left()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-left-inner-button\" class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{left()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-left-open\"></i>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"images-imagegallery-container\" ba-repeat=\"{{image::images}}\" class=\"{{css}}-imagegallery-container\" data-gallery-container>\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter=\"{{select(image)}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-image\"\n\t\t\t ba-styles=\"{{{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}}}\"\n\t\t\t onclick=\"{{select(image)}}\"\n\t\t>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"slider-right-button\" class=\"{{css}}-imagegallery-rightbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^right=\"{{right()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-right-inner-button\" class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{right()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-right-open\"></i>\n\t\t</div>\n\t</div>\n\n</div>\n",
            tmplchooser: "<div class=\"{{css}}-chooser-container\">\n\n\t<div class=\"{{css}}-chooser-button-container\">\n\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-chooser-button-{{action.index}}\"\n\t\t\t\t ba-click=\"{{click_action(action)}}\"\n\t\t\t>\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t/>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t\t<i class=\"{{css}}-icon-{{action.icon}}\"\n\t\t\t\t   ba-if=\"{{action.icon}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>",
            tmplmessage: "<div data-selector=\"recorder-message-container\" class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div class=\"{{css}}-top-inner-message-container {{css}}-{{shortMessage ? 'short-message' : 'long-message'}}\">\n        <div class=\"{{css}}-first-inner-message-container\">\n            <div class=\"{{css}}-second-inner-message-container\">\n                <div class=\"{{css}}-third-inner-message-container\">\n                    <div class=\"{{css}}-fourth-inner-message-container\">\n                        <div data-selector=\"recorder-message-block\" class='{{css}}-message-message'>\n                            <p>\n                                {{message || \"\"}}\n                            </p>\n                            <ul ba-if=\"{{links && links.length > 0}}\" ba-repeat=\"{{link :: links}}\">\n                                <li>\n                                    <a href=\"javascript:;\" ba-click=\"{{linkClick(link)}}\">\n                                        {{link.title}}\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"
        }
    };
});

Scoped.extend("module:Assets.imageviewerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }/**/ });
    return {
        "minimalist": {
            css: "ba-imageviewer-minimalist-theme",
            csstheme: "ba-imageviewer-minimalist-theme",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class='{{css}}-controlbar-header'>\n        <div class=\"{{css}}-controlbar-header-icons-block\">\n\n            <div class=\"{{css}}-right-block\">\n\n                <div tabindex=\"1\" data-selector=\"button-icon-resize-full\"\n                     ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n                     onkeydown=\"{{tab_index_move(domEvent)}}\"\n                     class=\"{{css}}-button-container\"\n                     ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\"\n                >\n                    <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                        <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n\n\n        <div class=\"{{css}}-controlbar-header-title-block\" ba-if=\"{{title}}\">\n            <div class=\"{{css}}-title\"><p>{{title}}</p></div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-controlbar-footer\">\n\n        <div class=\"{{css}}-controlbar-top-block\">\n\n            <div tabindex=\"0\" data-selector=\"submit-image-button\"\n                 ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\" ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    {{string('submit-image')}}\n                </div>\n            </div>\n\n        </div>\n        <div class=\"{{css}}-controlbar-bottom-block\">\n            <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n                 ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container {{css}}-player-rerecord\"\n                 ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-image')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-ccw\"></i>\n                </div>\n            </div>\n\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-imageviewer" : "",
            cssmessage: "ba-imageviewer"
        }
    };
});

Scoped.extend("module:Assets.audioplayerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }/**/ });
    return {
        "minimalist": {
            css: "ba-audioplayer-minimalist-theme",
            csstheme: "ba-audioplayer-minimalist-theme",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard \">\n\n    <div class='{{css}}-controlbar-header'>\n        <div class=\"{{css}}-controlbar-header-icons-block\">\n\n            <div class=\"{{css}}-right-block\">\n\n                <div tabindex=\"2\" data-selector=\"button-icon-volume\"\n                     ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n                     class=\"{{css}}-button-container\" ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n                >\n                    <div class=\"{{css}}-button-inner\">\n                        <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n                    </div>\n                </div>\n\n                <div class=\"{{css}}-volumebar\">\n                    <div tabindex=\"3\" data-selector=\"button-volume-bar\"\n                         ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n                         ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n                         onmouseout=\"this.blur()\"\n                         class=\"{{css}}-volumebar-inner\"\n                         onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                         onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                         onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                         onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n                    >\n                        <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n\n\n        <div class=\"{{css}}-controlbar-header-title-block\" ba-if=\"{{title}}\">\n            <div class=\"{{css}}-title\"><p>{{title}}</p></div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-controlbar-footer\">\n\n        <div class=\"{{css}}-controlbar-top-block\">\n\n            <div tabindex=\"0\" data-selector=\"submit-audio-button\"\n                 ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\" ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    {{string('submit-audio')}}\n                </div>\n            </div>\n\n            <div tabindex=\"0\" data-selector=\"button-icon-play\"\n                 ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n                 class=\"{{css}}-button-container\" ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-audio')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-play\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"0\" data-selector=\"button-icon-pause\"\n                 ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n                 class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n                 ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i tabindex=\"0\" class=\"{{css}}-icon-pause\"></i>\n                </div>\n            </div>\n\n        </div>\n        <div class=\"{{css}}-controlbar-middle-block\">\n\n            <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n                <div tabindex=\"4\" data-selector=\"progress-bar-inner\"\n                     ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n                     ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n                     onmouseout=\"this.blur()\"\n                     class=\"{{css}}-progressbar-inner\"\n                     onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n                     onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n                     onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n                     onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n                >\n\n                    <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n                    <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\">\n                        <div class=\"{{css}}-progressbar-button\"></div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n        <div class=\"{{css}}-controlbar-bottom-block\">\n            <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n                 ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container {{css}}-player-rerecord\"\n                 ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-audio')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-ccw\"></i>\n                </div>\n            </div>\n\n            <div class=\"{{css}}-button-container {{css}}-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n                <p> / </p>\n                <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n            </div>\n\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-audioplayer" : "",
            cssmessage: "ba-audioplayer",
            cssplaybutton: ie8 ? "ba-audioplayer" : ""
        }
    };
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.extend("module:Assets.playerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "skipinitial ? 0 : 1": function (obj) { with (obj) { return skipinitial ? 0 : 1; } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startVerticallyUpdateVolume(domEvent)": function (obj) { with (obj) { return startVerticallyUpdateVolume(domEvent); } }, "stopVerticallyUpdateVolume(domEvent)": function (obj) { with (obj) { return stopVerticallyUpdateVolume(domEvent); } }, "progressVerticallyUpdateVolume(domEvent)": function (obj) { with (obj) { return progressVerticallyUpdateVolume(domEvent); } }, "{height: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {height: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }/**/ });
    return {
        "theatre": {
            css: "ba-videoplayer-theatre-theme",
            csstheme: "ba-videoplayer-theatre-theme",
            tmplcontrolbar: "<div data-selector=\"video-title-block\" class=\"{{css}}-video-title-container {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\"  ba-if=\"{{title}}\">\n    <p class=\"{{css}}-video-title\">\n        {{title}}\n    </p>\n</div>\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-left-block\">\n\n        <div tabindex=\"0\" data-selector=\"submit-video-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\"\n             ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-video')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\"\n             ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\"\n             title=\"{{string('rerecord-video')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 1}}\" data-selector=\"button-icon-play\"\n             ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n             class=\"{{css}}-button-container\"\n             ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-video')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-play\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"{{skipinitial ? 0 : 1}}\" data-selector=\"button-icon-pause\"\n             ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n             class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n             ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-pause\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-volume-icon-container\">\n\n            <div tabindex=\"2\" data-selector=\"button-icon-volume\"\n                 ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\"\n                 ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n                </div>\n            </div>\n\n            <div class=\"{{css}}-volumebar\">\n                <div tabindex=\"-1\" data-selector=\"button-volume-bar\"\n                     ba-hotkey:up=\"{{set_volume(volume + 0.1)}}\"\n                     ba-hotkey:down=\"{{set_volume(volume - 0.1)}}\"\n                     onmouseout=\"this.blur()\"\n                     class=\"{{css}}-volumebar-inner\"\n                     onmousedown=\"{{startVerticallyUpdateVolume(domEvent)}}\"\n                     onmouseup=\"{{stopVerticallyUpdateVolume(domEvent)}}\"\n                     onmouseleave=\"{{stopVerticallyUpdateVolume(domEvent)}}\"\n                     onmousemove=\"{{progressVerticallyUpdateVolume(domEvent)}}\"\n                >\n                    <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{height: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-time-container\">\n            <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-right-block\">\n\n        <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n             ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent)}}\"\n             class=\"{{css}}-button-container {{css}}-fullscreen-icon-container\"\n             ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"7\" data-selector=\"cc-button-container\"\n             ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n             ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n             class=\"{{css}}-rightbutton-container {{css}}-cc-button-container {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n             title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n             ba-click=\"{{toggle_tracks()}}\"\n             onmouseover=\"{{hover_cc(true)}}\"\n             onmouseleave=\"{{hover_cc(false)}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-subtitle-button-inner\">\n                <i class=\"{{css}}-icon-subtitle\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"6\" data-selector=\"button-airplay\"\n             ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container {{css}}-airplay-container\"\n             ba-show=\"{{airplaybuttonvisible}}\" ba-click=\"{{show_airplay_devices()}}\"\n        >\n            <svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                <!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n                <title>Airplay</title>\n                <desc>Airplay icon.</desc>\n                <defs></defs>\n                <g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n                    <path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n                </g>\n            </svg>\n        </div>\n\n        <div data-selector=\"button-chromecast\" class=\"{{css}}-button-container {{css}}-cast-button-container\" ba-show=\"{{castbuttonvisble}}\">\n            <button tabindex=\"0\" class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n        </div>\n\n        <div tabindex=\"5\" data-selector=\"button-stream-label\"\n             ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-button-container {{css}}-stream-label-container\"\n             ba-if=\"{{streams.length > 1 && currentstream}}\" ba-click=\"{{toggle_stream()}}\" title=\"{{string('change-resolution')}}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-stream-label-container\">\n                <span class=\"{{css}}-button-text {{css}}-stream-label\">{{currentstream_label}}</span>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-time-container {{css}}-right-time-container\">\n            <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n        <div tabindex=\"4\" data-selector=\"progress-bar-inner\"\n             ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n             ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n             onmouseout=\"this.blur()\"\n             class=\"{{css}}-progressbar-inner\"\n             onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n             onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n             onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n             onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n        >\n\n            <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n            <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\">\n                <div class=\"{{css}}-progressbar-button\"></div>\n            </div>\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-videoplayer" : "",
            cssmessage: "ba-videoplayer",
            cssplaybutton: ie8 ? "ba-videoplayer" : ""
        }
    };
});

Scoped.extend("module:Assets.recorderthemes", ["dynamics:Parser"], function (Parser) {
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "settingsvisible && settingsopen": function (obj) { with (obj) { return settingsvisible && settingsopen; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "selectCamera(camera.id)": function (obj) { with (obj) { return selectCamera(camera.id); } }, "selectedcamera == camera.id": function (obj) { with (obj) { return selectedcamera == camera.id; } }, "camera.label": function (obj) { with (obj) { return camera.label; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "audio": function (obj) { with (obj) { return audio; } }, "selectMicrophone(microphone.id)": function (obj) { with (obj) { return selectMicrophone(microphone.id); } }, "selectedmicrophone == microphone.id": function (obj) { with (obj) { return selectedmicrophone == microphone.id; } }, "microphone.label": function (obj) { with (obj) { return microphone.label; } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "hover(string('rerecord-tooltip'))": function (obj) { with (obj) { return hover(string('rerecord-tooltip')); } }, "unhover()": function (obj) { with (obj) { return unhover(); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }, "cancelvisible": function (obj) { with (obj) { return cancelvisible; } }, "cancel()": function (obj) { with (obj) { return cancel(); } }, "hover(string('cancel-tooltip'))": function (obj) { with (obj) { return hover(string('cancel-tooltip')); } }, "string('cancel')": function (obj) { with (obj) { return string('cancel'); } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "settingsopen=!settingsopen": function (obj) { with (obj) { return settingsopen=!settingsopen; } }, "settingsopen ? 'selected' : 'unselected'": function (obj) { with (obj) { return settingsopen ? 'selected' : 'unselected'; } }, "hover(string('settings'))": function (obj) { with (obj) { return hover(string('settings')); } }, "!noaudio && !allowscreen": function (obj) { with (obj) { return !noaudio && !allowscreen; } }, "hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))": function (obj) { with (obj) { return hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy')); } }, "microphonehealthy ? 'good' : 'bad'": function (obj) { with (obj) { return microphonehealthy ? 'good' : 'bad'; } }, "!novideo && !allowscreen": function (obj) { with (obj) { return !novideo && !allowscreen; } }, "hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))": function (obj) { with (obj) { return hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy')); } }, "camerahealthy ? 'good' : 'bad'": function (obj) { with (obj) { return camerahealthy ? 'good' : 'bad'; } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "record()": function (obj) { with (obj) { return record(); } }, "hover(string('record-tooltip'))": function (obj) { with (obj) { return hover(string('record-tooltip')); } }, "string('record')": function (obj) { with (obj) { return string('record'); } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "controlbarlabel && !rerecordvisible": function (obj) { with (obj) { return controlbarlabel && !rerecordvisible; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "stop()": function (obj) { with (obj) { return stop(); } }, "mintimeindicator ? css + '-disabled': ''": function (obj) { with (obj) { return mintimeindicator ? css + '-disabled': ''; } }, "mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')": function (obj) { with (obj) { return mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'); } }, "hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))": function (obj) { with (obj) { return hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')); } }, "string('stop')": function (obj) { with (obj) { return string('stop'); } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "skip()": function (obj) { with (obj) { return skip(); } }, "hover(string('skip-tooltip'))": function (obj) { with (obj) { return hover(string('skip-tooltip')); } }, "string('skip')": function (obj) { with (obj) { return string('skip'); } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "hover(string('upload-covershot-tooltip'))": function (obj) { with (obj) { return hover(string('upload-covershot-tooltip')); } }, "uploadCovershot(domEvent)": function (obj) { with (obj) { return uploadCovershot(domEvent); } }, "covershot_accept_string": function (obj) { with (obj) { return covershot_accept_string; } }, "string('upload-covershot')": function (obj) { with (obj) { return string('upload-covershot'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "left()": function (obj) { with (obj) { return left(); } }, "images": function (obj) { with (obj) { return images; } }, "select(image)": function (obj) { with (obj) { return select(image); } }, "{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}": function (obj) { with (obj) { return {left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}; } }, "right()": function (obj) { with (obj) { return right(); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.label": function (obj) { with (obj) { return action.label; } }, "action.icon": function (obj) { with (obj) { return action.icon; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "shortMessage ? 'short-message' : 'long-message'": function (obj) { with (obj) { return shortMessage ? 'short-message' : 'long-message'; } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }, "links && links.length > 0": function (obj) { with (obj) { return links && links.length > 0; } }, "links": function (obj) { with (obj) { return links; } }, "linkClick(link)": function (obj) { with (obj) { return linkClick(link); } }, "link.title": function (obj) { with (obj) { return link.title; } }/**/ });
    return {
        "theatre": {
            css: "ba-videorecorder-theme-theatre",
            cssmessage: "ba-videorecorder",
            cssloader: "ba-videorecorder",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard\">\n\n\t<div class=\"{{css}}-settings-front\">\n\n\t\t<!-- Popup Settings Selections, initially hidden, appear when click button for settings -->\n\t\t<div data-selector=\"recorder-settings\" class=\"{{css}}-settings\" ba-show=\"{{settingsvisible && settingsopen}}\">\n\t\t\t<div class=\"{{css}}-bubble-info\">\n\t\t\t\t<ul data-selector=\"camera-settings\" ba-repeat=\"{{camera :: cameras}}\">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<input tabindex=\"0\"\n\t\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t   type='radio' name='camera'\n\t\t\t\t\t\t\t   value=\"{{selectedcamera == camera.id}}\"\n\t\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<label tabindex=\"0\"\n\t\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<ul data-selector=\"microphone-settings\" ba-repeat=\"{{microphone :: microphones}}\" ba-show=\"{{audio}}\">\n\t\t\t\t\t<li tabindex=\"0\"\n\t\t\t\t\t\tba-hotkey:space^enter=\"{{selectMicrophone(microphone.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\tonclick=\"{{selectMicrophone(microphone.id)}}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input type='radio' name='microphone' value=\"{{selectedmicrophone == microphone.id}}\" />\n\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t{{microphone.label}}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<!-- Control bar, footer part which holds all buttons -->\n\t<div data-selector=\"controlbar\" class=\"{{css}}-controlbar\">\n\n\t\t<div class=\"{{css}}-controlbar-center-section\">\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{rerecordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"rerecord-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{rerecord()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('rerecord-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('rerecord')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{cancelvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{cancel()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"cancel-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{cancel()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('cancel-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('cancel')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-controlbar-left-section\" ba-show=\"{{settingsvisible}}\">\n\n            <div class=\"{{css}}-button\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{settingsopen=!settingsopen}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"record-button-icon-cog\"\n\t\t\t\t\t class=\"{{css}}-button-inner {{css}}-button-{{settingsopen ? 'selected' : 'unselected' }}\"\n\t\t\t\t\t onclick=\"{{settingsopen=!settingsopen}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('settings'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"{{css}}-icon-cog\"></i>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button\" ba-show=\"{{!noaudio && !allowscreen}}\">\n\t\t\t\t<div data-selector=\"record-button-icon-mic\" class=\"{{css}}-button-inner\"\n\t\t\t\t\tonmouseenter=\"{{hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))}}\"\n\t\t\t\t\tonmouseleave=\"{{unhover()}}\">\n\t\t\t\t\t<i class=\"{{css}}-icon-mic {{css}}-icon-state-{{microphonehealthy ? 'good' : 'bad' }}\"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button\" ba-show=\"{{!novideo && !allowscreen}}\">\n\t\t\t\t<div data-selector=\"record-button-icon-videocam\" class=\"{{css}}-button-inner\"\n\t\t\t\t\tonmouseenter=\"{{hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))}}\"\n\t\t\t\t\tonmouseleave=\"{{unhover()}}\">\n                    <i class=\"{{css}}-icon-videocam {{css}}-icon-state-{{ camerahealthy ? 'good' : 'bad' }}\"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"{{css}}-controlbar-right-section\">\n\n\t\t\t<div class=\"{{css}}-rightbutton-container\" ba-show=\"{{recordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{record()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"record-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{record()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('record-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('record')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-stop-container\" ba-show=\"{{stopvisible}}\">\n\n\t\t\t<div class=\"{{css}}-timer-container\">\n\t\t\t\t<div class=\"{{css}}-label-container\" ba-show=\"{{controlbarlabel && !rerecordvisible}}\">\n\t\t\t\t\t<div data-selector=\"record-label-block\" class=\"{{css}}-label {{css}}-button-primary\">\n\t\t\t\t\t\t{{controlbarlabel}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-stop-button-container\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{stop()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"stop-primary-button\"\n\t\t\t\t\t class=\"{{css}}-button-primary {{mintimeindicator ? css + '-disabled': ''}}\"\n\t\t\t\t\t title=\"{{mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')}}\"\n\t\t\t\t\t onclick=\"{{stop()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('stop')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n        <div class=\"{{css}}-centerbutton-container\" ba-show=\"{{skipvisible}}\">\n            <div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{skip()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"skip-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{skip()}}\"\n                 onmouseenter=\"{{hover(string('skip-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                {{string('skip')}}\n            </div>\n        </div>\n\n\n        <div class=\"{{css}}-rightbutton-container\" ba-if=\"{{uploadcovershotvisible}}\">\n            <div data-selector=\"covershot-primary-button\" class=\"{{css}}-button-primary\"\n                 onmouseenter=\"{{hover(string('upload-covershot-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                <input type=\"file\"\n                       class=\"{{css}}-chooser-file\"\n                       style=\"height:100px\"\n                       onchange=\"{{uploadCovershot(domEvent)}}\"\n                       accept=\"{{covershot_accept_string}}\" />\n                <span>\n                    {{string('upload-covershot')}}\n                </span>\n            </div>\n        </div>\n\n\t</div>\n\n</div>\n",
            tmplimagegallery: "<div data-selector=\"image-gallery\" class=\"{{css}}-image-gallery-container\">\n\n\t<div data-selector=\"slider-left-button\" class=\"{{css}}-imagegallery-leftbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^left=\"{{left()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-left-inner-button\" class=\"{{css}}-imagegallery-button-inner\" onclick=\"{{left()}}\">\n\t\t\t<i class=\"{{css}}-icon-left-open\"></i>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"images-imagegallery-container\" ba-repeat=\"{{image::images}}\" class=\"{{css}}-imagegallery-container\" data-gallery-container>\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter=\"{{select(image)}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-image\"\n\t\t\t ba-styles=\"{{{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}}}\"\n\t\t\t onclick=\"{{select(image)}}\">\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"slider-right-button\" class=\"{{css}}-imagegallery-rightbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^right=\"{{right()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-right-inner-button\" class=\"{{css}}-imagegallery-button-inner\" onclick=\"{{right()}}\">\n\t\t\t<i class=\"{{css}}-icon-right-open\"></i>\n\t\t</div>\n\t</div>\n\n</div>\n",
            tmplchooser: "<div class=\"{{css}}-chooser-container\">\n\n\t<div class=\"{{css}}-chooser-button-container\">\n\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-chooser-button-{{action.index}}\"\n\t\t\t\t ba-click=\"{{click_action(action)}}\"\n\t\t\t>\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t/>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t\t<i class=\"{{css}}-icon-{{action.icon}}\" ba-if=\"{{action.icon}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>",
            tmplmessage: "<div data-selector=\"recorder-message-container\" class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div class=\"{{css}}-top-inner-message-container {{css}}-{{shortMessage ? 'short-message' : 'long-message'}}\">\n        <div class=\"{{css}}-first-inner-message-container\">\n            <div class=\"{{css}}-second-inner-message-container\">\n                <div class=\"{{css}}-third-inner-message-container\">\n                    <div class=\"{{css}}-fourth-inner-message-container\">\n                        <div data-selector=\"recorder-message-block\" class='{{css}}-message-message'>\n                            <p>\n                                {{message || \"\"}}\n                            </p>\n                            <ul ba-if=\"{{links && links.length > 0}}\" ba-repeat=\"{{link :: links}}\">\n                                <li>\n                                    <a href=\"javascript:;\" ba-click=\"{{linkClick(link)}}\">\n                                        {{link.title}}\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"
        }
    };
});

Scoped.extend("module:Assets.imageviewerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "tab_index_move(domEvent)": function (obj) { with (obj) { return tab_index_move(domEvent); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }/**/ });
    return {
        "theatre": {
            css: "ba-imageviewer-theatre-theme",
            csstheme: "ba-imageviewer-theatre-theme",
            tmplcontrolbar: "<div data-selector=\"image-title-block\" class=\"{{css}}-image-title-container {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\"  ba-if=\"{{title}}\">\n    <p class=\"{{css}}-image-title\">\n        {{title}}\n    </p>\n</div>\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-left-block\">\n\n        <div tabindex=\"0\" data-selector=\"submit-image-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\"\n             ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-image')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\"\n             ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\"\n             title=\"{{string('rerecord-image')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-right-block\">\n\n        <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n             ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent)}}\"\n             class=\"{{css}}-button-container {{css}}-fullscreen-icon-container\"\n             ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\"\n        >\n            <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n            </div>\n        </div>\n\n\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-imageviewer" : "",
            cssmessage: "ba-imageviewer"
        }
    };
});

Scoped.extend("module:Assets.audioplayerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "title": function (obj) { with (obj) { return title; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startVerticallyUpdateVolume(domEvent)": function (obj) { with (obj) { return startVerticallyUpdateVolume(domEvent); } }, "stopVerticallyUpdateVolume(domEvent)": function (obj) { with (obj) { return stopVerticallyUpdateVolume(domEvent); } }, "progressVerticallyUpdateVolume(domEvent)": function (obj) { with (obj) { return progressVerticallyUpdateVolume(domEvent); } }, "{height: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {height: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }/**/ });
    return {
        "theatre": {
            css: "ba-audioplayer-theatre-theme",
            csstheme: "ba-audioplayer-theatre-theme",
            tmplcontrolbar: "<div data-selector=\"audio-title-block\" class=\"{{css}}-audio-title-container \"  ba-if=\"{{title}}\">\n    <p class=\"{{css}}-audio-title\">\n        {{title}}\n    </p>\n</div>\n<div class=\"{{css}}-dashboard \">\n\n    <div class=\"{{css}}-left-block\">\n\n        <div tabindex=\"0\" data-selector=\"submit-audio-button\"\n             ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\"\n             ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                {{string('submit-audio')}}\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-ccw\"\n             ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n             class=\"{{css}}-leftbutton-container\"\n             ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\"\n             title=\"{{string('rerecord-audio')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-ccw\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-play\"\n             ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n             class=\"{{css}}-button-container\"\n             ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-audio')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-play\"></i>\n            </div>\n        </div>\n\n        <div tabindex=\"0\" data-selector=\"button-icon-pause\"\n             ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n             onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n             class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n             ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n        >\n            <div class=\"{{css}}-button-inner\">\n                <i class=\"{{css}}-icon-pause\"></i>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-volume-icon-container\">\n\n            <div tabindex=\"2\" data-selector=\"button-icon-volume\"\n                 ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\"\n                 ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n                </div>\n            </div>\n\n            <div class=\"{{css}}-volumebar\">\n                <div tabindex=\"-1\" data-selector=\"button-volume-bar\"\n                     ba-hotkey:up=\"{{set_volume(volume + 0.1)}}\"\n                     ba-hotkey:down=\"{{set_volume(volume - 0.1)}}\"\n                     onmouseout=\"this.blur()\"\n                     class=\"{{css}}-volumebar-inner\"\n                     onmousedown=\"{{startVerticallyUpdateVolume(domEvent)}}\"\n                     onmouseup=\"{{stopVerticallyUpdateVolume(domEvent)}}\"\n                     onmouseleave=\"{{stopVerticallyUpdateVolume(domEvent)}}\"\n                     onmousemove=\"{{progressVerticallyUpdateVolume(domEvent)}}\"\n                >\n                    <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{height: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-time-container\">\n            <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n        </div>\n    </div>\n\n    <div class=\"{{css}}-right-block\">\n\n        <div class=\"{{css}}-time-container {{css}}-right-time-container\">\n            <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n        <div tabindex=\"4\" data-selector=\"progress-bar-inner\"\n             ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n             ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n             onmouseout=\"this.blur()\"\n             class=\"{{css}}-progressbar-inner\"\n             onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n             onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n             onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n             onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n        >\n\n            <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n            <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\">\n                <div class=\"{{css}}-progressbar-button\"></div>\n            </div>\n        </div>\n    </div>\n\n</div>\n",
            cssloader: ie8 ? "ba-audioplayer" : "",
            cssmessage: "ba-audioplayer",
            cssplaybutton: ie8 ? "ba-audioplayer" : ""
        }
    };
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('module', 'root:BetaJS.MediaComponents');
Scoped.extend("module:Assets.playerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "skipinitial ? 2 : 1": function (obj) { with (obj) { return skipinitial ? 2 : 1; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('video-progress')": function (obj) { with (obj) { return string('video-progress'); } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-video')": function (obj) { with (obj) { return string('submit-video'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-video')": function (obj) { with (obj) { return string('rerecord-video'); } }, "skipinitial ? 0 : 2": function (obj) { with (obj) { return skipinitial ? 0 : 2; } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-video')": function (obj) { with (obj) { return string('play-video'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-video-disabled') : string('pause-video')": function (obj) { with (obj) { return disablepause ? string('pause-video-disabled') : string('pause-video'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "title": function (obj) { with (obj) { return title; } }, "toggle_stream()": function (obj) { with (obj) { return toggle_stream(); } }, "streams.length > 1 && currentstream": function (obj) { with (obj) { return streams.length > 1 && currentstream; } }, "string('change-resolution')": function (obj) { with (obj) { return string('change-resolution'); } }, "currentstream_label": function (obj) { with (obj) { return currentstream_label; } }, "show_airplay_devices()": function (obj) { with (obj) { return show_airplay_devices(); } }, "airplaybuttonvisible": function (obj) { with (obj) { return airplaybuttonvisible; } }, "castbuttonvisble": function (obj) { with (obj) { return castbuttonvisble; } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }, "toggle_tracks()": function (obj) { with (obj) { return toggle_tracks(); } }, "(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload": function (obj) { with (obj) { return (tracktags.length > 0 && tracktagssupport) || allowtexttrackupload; } }, "tracktextvisible ? 'active' : 'inactive'": function (obj) { with (obj) { return tracktextvisible ? 'active' : 'inactive'; } }, "tracktextvisible ? string('close-tracks') : string('show-tracks')": function (obj) { with (obj) { return tracktextvisible ? string('close-tracks') : string('show-tracks'); } }, "hover_cc(true)": function (obj) { with (obj) { return hover_cc(true); } }, "hover_cc(false)": function (obj) { with (obj) { return hover_cc(false); } }/**/ });
    return {
        "elevate": {
            css: "ba-videoplayer-elevate-theme",
            csstheme: "ba-videoplayer-elevate-theme",
            tmplcontrolbar: "\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-top-block\">\n\n        <div class=\"{{css}}-top-left-block\">\n            <div class=\"{{css}}-time-container {{css}}-left-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-top-right-block\">\n\n            <div class=\"{{css}}-time-container {{css}}-right-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n            </div>\n\n        </div>\n\n        <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n            <div tabindex=\"{{skipinitial ? 2 : 1}}\"\n                 ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n                 ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n                 onmouseout=\"this.blur()\"\n                 data-selector=\"progress-bar-inner\" class=\"{{css}}-progressbar-inner\"\n                 onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n                 onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n                 onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n            >\n\n                <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n                <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('video-progress')}}\">\n                    <div class=\"{{css}}-progressbar-button-description\" style=\"display: none\">\n                        <div class=\"{{css}}-current-stream-screen-shot\">\n                            <img src=\"\"/>\n                        </div>\n                        <div class=\"{{css}}-time-container\">\n                            <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n                        </div>\n                    </div>\n                    <div class=\"{{css}}-progressbar-button\"></div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-bottom-block\">\n\n        <div class=\"{{css}}-left-block\">\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"submit-video-button\" class=\"{{css}}-leftbutton-container\"\n                 ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    {{string('submit-video')}}\n                </div>\n            </div>\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-icon-ccw\" class=\"{{css}}-leftbutton-container\"\n                 ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-video')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-ccw\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"{{skipinitial ? 0 : 2}}\" ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n                 data-selector=\"button-icon-play\" class=\"{{css}}-button-container\"\n                 ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-video')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-play\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"{{skipinitial ? 0 : 2}}\" ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n                 data-selector=\"button-icon-pause\" class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n                 ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-video-disabled') : string('pause-video')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-pause\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"3\" ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-icon-volume\" class=\"{{css}}-button-container\"\n                 ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n                </div>\n            </div>\n\n            <div class=\"{{css}}-volumebar\">\n                <div tabindex=\"4\"\n                     ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n                     ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n                     onmouseout=\"this.blur()\"\n                     data-selector=\"button-volume-bar\" class=\"{{css}}-volumebar-inner\"\n                     onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                     onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                     onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                     onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n                >\n                    <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n                </div>\n            </div>\n\n        </div>\n\n        <div class=\"{{css}}-center-block\">\n            <div data-selector=\"video-title-block\" class=\"{{css}}-video-title-block\" ba-if=\"{{title}}\">\n                <p class=\"{{css}}-video-title\">\n                    {{title}}\n                </p>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-right-block\">\n\n            <div tabindex=\"5\" ba-hotkey:space^enter=\"{{toggle_stream()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-stream-label\" class=\"{{css}}-button-container\"\n                 ba-if=\"{{streams.length > 1 && currentstream}}\" ba-click=\"{{toggle_stream()}}\" title=\"{{string('change-resolution')}}\"\n            >\n                <div class=\"{{css}}-button-inner {{css}}-stream-label-container\">\n                    <span class=\"{{css}}-button-text {{css}}-stream-label\">{{currentstream_label}}</span>\n                </div>\n            </div>\n\n            <div tabindex=\"6\" ba-hotkey:space^enter=\"{{show_airplay_devices()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-airplay\" class=\"{{css}}-button-container {{css}}-airplay-container\"\n                 ba-show=\"{{airplaybuttonvisible}}\" ba-click=\"{{show_airplay_devices()}}\"\n            >\n                <svg width=\"16px\" height=\"11px\" viewBox=\"0 0 16 11\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                    <!-- Generator: Sketch 3.3.2 (12043) - http://www.bohemiancoding.com/sketch -->\n                    <title>Airplay</title>\n                    <desc>Airplay icon.</desc>\n                    <defs></defs>\n                    <g stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" sketch:type=\"MSPage\">\n                        <path d=\"M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z\" sketch:type=\"MSShapeGroup\"></path>\n                    </g>\n                </svg>\n            </div>\n\n            <div data-selector=\"button-chromecast\" class=\"{{css}}-button-container {{css}}-cast-button-container\"\n                 ba-show=\"{{castbuttonvisble}}\">\n                <button tabindex=\"7\" class=\"{{css}}-gcast-button\" is=\"google-cast-button\"></button>\n            </div>\n\n            <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n                 ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\"\n                 ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video') }}\"\n            >\n                <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                    <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"9\" data-selector=\"cc-button-container\"\n                 ba-hotkey:space^enter=\"{{toggle_tracks()}}\" onmouseout=\"this.blur()\"\n                 ba-if=\"{{(tracktags.length > 0 && tracktagssupport) || allowtexttrackupload}}\"\n                 class=\"{{css}}-button-container  {{css}}-cc-{{tracktextvisible ? 'active' : 'inactive'}}\"\n                 title=\"{{ tracktextvisible ? string('close-tracks') : string('show-tracks')}}\"\n                 ba-click=\"{{toggle_tracks()}}\"\n                 onmouseover=\"{{hover_cc(true)}}\"\n                 onmouseleave=\"{{hover_cc(false)}}\"\n            >\n                <div class=\"{{css}}-button-inner {{css}}-subtitle-button-inner\">\n                    <i class=\"{{css}}-icon-subtitle\"></i>\n                </div>\n            </div>\n\n        </div>\n\n    </div>\n</div>\n",
            cssloader: ie8 ? "ba-videoplayer" : "",
            cssmessage: "ba-videoplayer",
            cssplaybutton: ie8 ? "ba-videoplayer" : ""
        }
    };
});

Scoped.extend("module:Assets.recorderthemes", ["dynamics:Parser"], function (Parser) {
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "topmessage": function (obj) { with (obj) { return topmessage; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "settingsvisible": function (obj) { with (obj) { return settingsvisible; } }, "settingsopen": function (obj) { with (obj) { return settingsopen; } }, "cameras": function (obj) { with (obj) { return cameras; } }, "selectCamera(camera.id)": function (obj) { with (obj) { return selectCamera(camera.id); } }, "selectedcamera == camera.id": function (obj) { with (obj) { return selectedcamera == camera.id; } }, "camera.label": function (obj) { with (obj) { return camera.label; } }, "settingsopen=!settingsopen": function (obj) { with (obj) { return settingsopen=!settingsopen; } }, "settingsopen ? 'selected' : 'unselected'": function (obj) { with (obj) { return settingsopen ? 'selected' : 'unselected'; } }, "hover(string('settings'))": function (obj) { with (obj) { return hover(string('settings')); } }, "unhover()": function (obj) { with (obj) { return unhover(); } }, "!noaudio && !allowscreen": function (obj) { with (obj) { return !noaudio && !allowscreen; } }, "settingsvisible && settingsopen && audio": function (obj) { with (obj) { return settingsvisible && settingsopen && audio; } }, "microphones": function (obj) { with (obj) { return microphones; } }, "audio": function (obj) { with (obj) { return audio; } }, "selectMicrophone(microphone.id)": function (obj) { with (obj) { return selectMicrophone(microphone.id); } }, "selectedmicrophone == microphone.id": function (obj) { with (obj) { return selectedmicrophone == microphone.id; } }, "microphone.label": function (obj) { with (obj) { return microphone.label; } }, "hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))": function (obj) { with (obj) { return hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy')); } }, "microphonehealthy ? 'good' : 'bad'": function (obj) { with (obj) { return microphonehealthy ? 'good' : 'bad'; } }, "!novideo && !allowscreen": function (obj) { with (obj) { return !novideo && !allowscreen; } }, "hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))": function (obj) { with (obj) { return hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy')); } }, "camerahealthy ? 'good' : 'bad'": function (obj) { with (obj) { return camerahealthy ? 'good' : 'bad'; } }, "stopvisible": function (obj) { with (obj) { return stopvisible; } }, "controlbarlabel": function (obj) { with (obj) { return controlbarlabel; } }, "rerecordvisible": function (obj) { with (obj) { return rerecordvisible; } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "hover(string('rerecord-tooltip'))": function (obj) { with (obj) { return hover(string('rerecord-tooltip')); } }, "string('rerecord')": function (obj) { with (obj) { return string('rerecord'); } }, "cancelvisible": function (obj) { with (obj) { return cancelvisible; } }, "cancel()": function (obj) { with (obj) { return cancel(); } }, "hover(string('cancel-tooltip'))": function (obj) { with (obj) { return hover(string('cancel-tooltip')); } }, "string('cancel')": function (obj) { with (obj) { return string('cancel'); } }, "recordvisible": function (obj) { with (obj) { return recordvisible; } }, "record()": function (obj) { with (obj) { return record(); } }, "hover(string('record-tooltip'))": function (obj) { with (obj) { return hover(string('record-tooltip')); } }, "string('record')": function (obj) { with (obj) { return string('record'); } }, "stop()": function (obj) { with (obj) { return stop(); } }, "mintimeindicator ? css + '-disabled': ''": function (obj) { with (obj) { return mintimeindicator ? css + '-disabled': ''; } }, "mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')": function (obj) { with (obj) { return mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'); } }, "hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))": function (obj) { with (obj) { return hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')); } }, "string('stop')": function (obj) { with (obj) { return string('stop'); } }, "skipvisible": function (obj) { with (obj) { return skipvisible; } }, "skip()": function (obj) { with (obj) { return skip(); } }, "hover(string('skip-tooltip'))": function (obj) { with (obj) { return hover(string('skip-tooltip')); } }, "string('skip')": function (obj) { with (obj) { return string('skip'); } }, "uploadcovershotvisible": function (obj) { with (obj) { return uploadcovershotvisible; } }, "hover(string('upload-covershot-tooltip'))": function (obj) { with (obj) { return hover(string('upload-covershot-tooltip')); } }, "uploadCovershot(domEvent)": function (obj) { with (obj) { return uploadCovershot(domEvent); } }, "covershot_accept_string": function (obj) { with (obj) { return covershot_accept_string; } }, "string('upload-covershot')": function (obj) { with (obj) { return string('upload-covershot'); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "left()": function (obj) { with (obj) { return left(); } }, "images": function (obj) { with (obj) { return images; } }, "select(image)": function (obj) { with (obj) { return select(image); } }, "{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}": function (obj) { with (obj) { return {left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}; } }, "right()": function (obj) { with (obj) { return right(); } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "actions": function (obj) { with (obj) { return actions; } }, "click_action(action)": function (obj) { with (obj) { return click_action(action); } }, "action.index": function (obj) { with (obj) { return action.index; } }, "action.select && action.capture": function (obj) { with (obj) { return action.select && action.capture; } }, "select_file_action(action, domEvent)": function (obj) { with (obj) { return select_file_action(action, domEvent); } }, "action.accept": function (obj) { with (obj) { return action.accept; } }, "action.select && !action.capture": function (obj) { with (obj) { return action.select && !action.capture; } }, "action.label": function (obj) { with (obj) { return action.label; } }, "action.icon": function (obj) { with (obj) { return action.icon; } }/**/ });
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "click()": function (obj) { with (obj) { return click(); } }, "shortMessage ? 'short-message' : 'long-message'": function (obj) { with (obj) { return shortMessage ? 'short-message' : 'long-message'; } }, "message || \"\"": function (obj) { with (obj) { return message || ""; } }, "links && links.length > 0": function (obj) { with (obj) { return links && links.length > 0; } }, "links": function (obj) { with (obj) { return links; } }, "linkClick(link)": function (obj) { with (obj) { return linkClick(link); } }, "link.title": function (obj) { with (obj) { return link.title; } }/**/ });
    return {
        "elevate": {
            css: "ba-videorecorder-theme-elevate",
            cssmessage: "ba-videorecorder",
            cssloader: "ba-videorecorder",
            tmpltopmessage: "<div class=\"{{css}}-topmessage-container\">\n    <div data-selector=\"recorder-topmessage-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",
            tmplcontrolbar: "<div class=\"{{css}}-dashboard\">\n\n\t<!-- Sidebar Settings -->\n\t<div class=\"{{css}}-settings-left-sidebar\">\n\n\t\t<div class=\"{{css}}-controlbar-left-section\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t<!-- Popup Settings Selections, initially hidden, appear when click button for settings -->\n\t\t\t<div data-selector=\"recorder-settings\" class=\"{{css}}-settings {{css}}-settings-button-container\">\n\n\t\t\t\t<div class=\"{{css}}-circle-button\" ba-show=\"{{settingsvisible}}\">\n\n\t\t\t\t\t<div class=\"{{css}}-bubble-info\" ba-show=\"{{settingsopen}}\" >\n\t\t\t\t\t\t<ul data-selector=\"camera-settings\" ba-repeat=\"{{camera :: cameras}}\">\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<input tabindex=\"0\"\n\t\t\t\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t\t\t   type='radio' name='camera' value=\"{{selectedcamera == camera.id}}\"\n\t\t\t\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t<label tabindex=\"0\"\n\t\t\t\t\t\t\t\t\t   ba-hotkey:space^enter=\"{{selectCamera(camera.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t\t\t   onclick=\"{{selectCamera(camera.id)}}\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t\t ba-hotkey:space^enter=\"{{settingsopen=!settingsopen}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t data-selector=\"record-button-icon-cog\"\n\t\t\t\t\t\t class=\"{{css}}-button-inner {{css}}-button-circle-{{settingsopen ? 'selected' : 'unselected' }}\"\n\t\t\t\t\t\t onclick=\"{{settingsopen=!settingsopen}}\"\n\t\t\t\t\t\t onmouseenter=\"{{hover(string('settings'))}}\"\n\t\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<i class=\"{{css}}-icon-cog\"></i>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\n\n                <div class=\"{{css}}-circle-button\" ba-show=\"{{!noaudio && !allowscreen}}\">\n\n                    <div class=\"{{css}}-bubble-info\" ba-show=\"{{settingsvisible && settingsopen && audio }}\">\n                        <ul data-selector=\"microphone-settings\" ba-repeat=\"{{microphone :: microphones}}\" ba-show=\"{{audio}}\">\n                            <li tabindex=\"0\"\n\t\t\t\t\t\t\t\tba-hotkey:space^enter=\"{{selectMicrophone(microphone.id)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t\t\t\tonclick=\"{{selectMicrophone(microphone.id)}}\"\n\t\t\t\t\t\t\t>\n                                <input type='radio' name='microphone' value=\"{{selectedmicrophone == microphone.id}}\" />\n                                <span></span>\n                                <label>\n                                    {{microphone.label}}\n                                </label>\n                            </li>\n                        </ul>\n                    </div>\n\n                    <div data-selector=\"record-button-icon-mic\" class=\"{{css}}-button-inner\"\n                         onmouseenter=\"{{hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))}}\"\n                         onmouseleave=\"{{unhover()}}\">\n                        <i class=\"{{css}}-icon-mic {{css}}-icon-state-{{microphonehealthy ? 'good' : 'bad' }}\"></i>\n                    </div>\n                </div>\n\n                <div class=\"{{css}}-circle-button\" ba-show=\"{{!novideo && !allowscreen}}\">\n                    <div data-selector=\"record-button-icon-videocam\" class=\"{{css}}-button-inner\"\n                         onmouseenter=\"{{hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))}}\"\n                         onmouseleave=\"{{unhover()}}\">\n                        <i class=\"{{css}}-icon-videocam {{css}}-icon-state-{{ camerahealthy ? 'good' : 'bad' }}\"></i>\n                    </div>\n                </div>\n\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<div class=\"{{css}}-controlbar-middle-section\">\n\n\t\t<div class=\"{{css}}-timer-container\" ba-show=\"{{stopvisible}}\">\n\t\t\t<div class=\"{{css}}-label-container\" ba-show=\"{{controlbarlabel}}\">\n\t\t\t\t<div data-selector=\"record-label-block\" class=\"{{css}}-label {{css}}-button-primary\">\n\t\t\t\t\t{{controlbarlabel}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<!-- Control bar, footer part which holds all buttons -->\n\t<div data-selector=\"controlbar\" class=\"{{css}}-controlbar\">\n\n\t\t<div class=\"{{css}}-controlbar-center-section\">\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{rerecordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"rerecord-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{rerecord()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('rerecord-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('rerecord')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-button-container\" ba-show=\"{{cancelvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{cancel()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"cancel-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{cancel()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('cancel-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('cancel')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"{{css}}-primary-button-container\" ba-show=\"{{recordvisible}}\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{record()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"record-primary-button\" class=\"{{css}}-button-primary\"\n\t\t\t\t\t onclick=\"{{record()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(string('record-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('record')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"{{css}}-stop-container\" ba-show=\"{{stopvisible}}\">\n\n\t\t\t<div class=\"{{css}}-stop-button-container\">\n\t\t\t\t<div tabindex=\"0\"\n\t\t\t\t\t ba-hotkey:space^enter=\"{{stop()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t\t data-selector=\"stop-primary-button\" class=\"{{css}}-button-primary {{mintimeindicator ? css + '-disabled': ''}}\"\n\t\t\t\t\t title=\"{{mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')}}\"\n\t\t\t\t\t onclick=\"{{stop()}}\"\n\t\t\t\t\t onmouseenter=\"{{hover(mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))}}\"\n\t\t\t\t\t onmouseleave=\"{{unhover()}}\"\n\t\t\t\t>\n\t\t\t\t\t{{string('stop')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n        <div class=\"{{css}}-centerbutton-container\" ba-show=\"{{skipvisible}}\">\n            <div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{skip()}}\" onmouseout=\"this.blur()\"\n\t\t\t\t data-selector=\"skip-primary-button\" class=\"{{css}}-button-primary\"\n                 onclick=\"{{skip()}}\"\n                 onmouseenter=\"{{hover(string('skip-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\"\n\t\t\t>\n                {{string('skip')}}\n            </div>\n        </div>\n\n\n        <div class=\"{{css}}-rightbutton-container\" ba-if=\"{{uploadcovershotvisible}}\">\n            <div data-selector=\"covershot-primary-button\" class=\"{{css}}-button-primary\"\n                 onmouseenter=\"{{hover(string('upload-covershot-tooltip'))}}\"\n                 onmouseleave=\"{{unhover()}}\">\n                <input type=\"file\"\n                       class=\"{{css}}-chooser-file\"\n                       style=\"height:100px\"\n                       onchange=\"{{uploadCovershot(domEvent)}}\"\n                       accept=\"{{covershot_accept_string}}\" />\n                <span>\n                    {{string('upload-covershot')}}\n                </span>\n            </div>\n        </div>\n\n\t</div>\n\n</div>\n",
            tmplimagegallery: "<div data-selector=\"image-gallery\" class=\"{{css}}-image-gallery-container\">\n\n\t<div data-selector=\"slider-left-button\" class=\"{{css}}-imagegallery-leftbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^left=\"{{left()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-left-inner-button\" class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{left()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-left-open\"></i>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"images-imagegallery-container\" ba-repeat=\"{{image::images}}\" class=\"{{css}}-imagegallery-container\" data-gallery-container>\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter=\"{{select(image)}}\" onmouseout=\"this.blur()\"\n\t\t\t class=\"{{css}}-imagegallery-image\"\n\t\t\t ba-styles=\"{{{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}}}\"\n\t\t\t onclick=\"{{select(image)}}\"\n\t\t>\n\t\t</div>\n\t</div>\n\n\t<div data-selector=\"slider-right-button\" class=\"{{css}}-imagegallery-rightbutton\">\n\t\t<div tabindex=\"0\"\n\t\t\t ba-hotkey:space^enter^right=\"{{right()}}\" onmouseout=\"this.blur()\"\n\t\t\t data-selector=\"slider-right-inner-button\" class=\"{{css}}-imagegallery-button-inner\"\n\t\t\t onclick=\"{{right()}}\"\n\t\t>\n\t\t\t<i class=\"{{css}}-icon-right-open\"></i>\n\t\t</div>\n\t</div>\n\n</div>\n",
            tmplchooser: "<div class=\"{{css}}-chooser-container\">\n\n\t<div class=\"{{css}}-chooser-button-container\">\n\n\t\t<div ba-repeat=\"{{action :: actions}}\">\n\t\t\t<div tabindex=\"0\"\n\t\t\t\t ba-hotkey:space^enter=\"{{click_action(action)}}\" onmouseout=\"this.blur()\"\n\t\t\t\t class=\"{{css}}-chooser-button-{{action.index}}\" ba-click=\"{{click_action(action)}}\"\n\t\t\t>\n\t\t\t\t<input ba-if=\"{{action.select && action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if=\"{{action.select && !action.capture}}\"\n\t\t\t\t\t   type=\"file\"\n\t\t\t\t\t   class=\"{{css}}-chooser-file\"\n\t\t\t\t\t   onchange=\"{{select_file_action(action, domEvent)}}\"\n\t\t\t\t\t   accept=\"{{action.accept}}\"\n\t\t\t\t/>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t\t<i class=\"{{css}}-icon-{{action.icon}}\" ba-if=\"{{action.icon}}\"></i>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>",
            tmplmessage: "<div data-selector=\"recorder-message-container\" class=\"{{css}}-message-container\" ba-click=\"{{click()}}\">\n    <div class=\"{{css}}-top-inner-message-container {{css}}-{{shortMessage ? 'short-message' : 'long-message'}}\">\n        <div class=\"{{css}}-first-inner-message-container\">\n            <div class=\"{{css}}-second-inner-message-container\">\n                <div class=\"{{css}}-third-inner-message-container\">\n                    <div class=\"{{css}}-fourth-inner-message-container\">\n                        <div data-selector=\"recorder-message-block\" class='{{css}}-message-message'>\n                            <p>\n                                {{message || \"\"}}\n                            </p>\n                            <ul ba-if=\"{{links && links.length > 0}}\" ba-repeat=\"{{link :: links}}\">\n                                <li>\n                                    <a href=\"javascript:;\" ba-click=\"{{linkClick(link)}}\">\n                                        {{link.title}}\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"
        }
    };
});

Scoped.extend("module:Assets.imageviewerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''": function (obj) { with (obj) { return activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''; } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-image')": function (obj) { with (obj) { return string('submit-image'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-image')": function (obj) { with (obj) { return string('rerecord-image'); } }, "title": function (obj) { with (obj) { return title; } }, "toggle_fullscreen()": function (obj) { with (obj) { return toggle_fullscreen(); } }, "fullscreen": function (obj) { with (obj) { return fullscreen; } }, "fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')": function (obj) { with (obj) { return fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image'); } }, "fullscreened ? 'small' : 'full'": function (obj) { with (obj) { return fullscreened ? 'small' : 'full'; } }/**/ });
    return {
        "elevate": {
            css: "ba-imageviewer-elevate-theme",
            csstheme: "ba-imageviewer-elevate-theme",
            tmplcontrolbar: "\n<div class=\"{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''}}\">\n\n    <div class=\"{{css}}-bottom-block\">\n\n        <div class=\"{{css}}-left-block\">\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"submit-image-button\" class=\"{{css}}-leftbutton-container\"\n                 ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    {{string('submit-image')}}\n                </div>\n            </div>\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-icon-ccw\" class=\"{{css}}-leftbutton-container\"\n                 ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-image')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-ccw\"></i>\n                </div>\n            </div>\n\n        </div>\n\n        <div class=\"{{css}}-center-block\">\n            <div data-selector=\"image-title-block\" class=\"{{css}}-image-title-block\" ba-if=\"{{title}}\">\n                <p class=\"{{css}}-image-title\">\n                    {{title}}\n                </p>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-right-block\">\n\n            <div tabindex=\"8\" data-selector=\"button-icon-resize-full\"\n                 ba-hotkey:space^enter=\"{{toggle_fullscreen()}}\" onmouseout=\"this.blur()\"\n                 class=\"{{css}}-button-container\"\n                 ba-if=\"{{fullscreen}}\" ba-click=\"{{toggle_fullscreen()}}\" title=\"{{ fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image') }}\"\n            >\n                <div class=\"{{css}}-button-inner {{css}}-full-screen-btn-inner\">\n                    <i class=\"{{css}}-icon-resize-{{fullscreened ? 'small' : 'full'}}\"></i>\n                </div>\n            </div>\n\n        </div>\n\n    </div>\n</div>\n",
            cssloader: ie8 ? "ba-imageviewer" : "",
            cssmessage: "ba-imageviewer"
        }
    };
});

Scoped.extend("module:Assets.audioplayerthemes", ["browser:Info","dynamics:Parser"], function (Info, Parser) {
    var ie8 = Info.isInternetExplorer() && Info.internetExplorerVersion() <= 8;
    Parser.registerFunctions({ /**/"css": function (obj) { with (obj) { return css; } }, "string('elapsed-time')": function (obj) { with (obj) { return string('elapsed-time'); } }, "formatTime(position)": function (obj) { with (obj) { return formatTime(position); } }, "string('total-time')": function (obj) { with (obj) { return string('total-time'); } }, "formatTime(duration || position)": function (obj) { with (obj) { return formatTime(duration || position); } }, "disableseeking ? css + '-disabled' : ''": function (obj) { with (obj) { return disableseeking ? css + '-disabled' : ''; } }, "seek(position + skipseconds)": function (obj) { with (obj) { return seek(position + skipseconds); } }, "seek(position - skipseconds)": function (obj) { with (obj) { return seek(position - skipseconds); } }, "startUpdatePosition(domEvent)": function (obj) { with (obj) { return startUpdatePosition(domEvent); } }, "stopUpdatePosition(domEvent)": function (obj) { with (obj) { return stopUpdatePosition(domEvent); } }, "progressUpdatePosition(domEvent)": function (obj) { with (obj) { return progressUpdatePosition(domEvent); } }, "{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? cached / duration * 100 : 0) + '%'}; } }, "{width: Math.round(duration ? position / duration * 100 : 0) + '%'}": function (obj) { with (obj) { return {width: Math.round(duration ? position / duration * 100 : 0) + '%'}; } }, "string('audio-progress')": function (obj) { with (obj) { return string('audio-progress'); } }, "submit()": function (obj) { with (obj) { return submit(); } }, "submittable": function (obj) { with (obj) { return submittable; } }, "string('submit-audio')": function (obj) { with (obj) { return string('submit-audio'); } }, "rerecord()": function (obj) { with (obj) { return rerecord(); } }, "rerecordable": function (obj) { with (obj) { return rerecordable; } }, "string('rerecord-audio')": function (obj) { with (obj) { return string('rerecord-audio'); } }, "play()": function (obj) { with (obj) { return play(); } }, "tab_index_move(domEvent, null, 'button-icon-pause')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-pause'); } }, "!playing": function (obj) { with (obj) { return !playing; } }, "string('play-audio')": function (obj) { with (obj) { return string('play-audio'); } }, "pause()": function (obj) { with (obj) { return pause(); } }, "tab_index_move(domEvent, null, 'button-icon-play')": function (obj) { with (obj) { return tab_index_move(domEvent, null, 'button-icon-play'); } }, "disablepause ? css + '-disabled' : ''": function (obj) { with (obj) { return disablepause ? css + '-disabled' : ''; } }, "playing": function (obj) { with (obj) { return playing; } }, "disablepause ? string('pause-audio-disabled') : string('pause-audio')": function (obj) { with (obj) { return disablepause ? string('pause-audio-disabled') : string('pause-audio'); } }, "toggle_volume()": function (obj) { with (obj) { return toggle_volume(); } }, "string(volume > 0 ? 'volume-mute' : 'volume-unmute')": function (obj) { with (obj) { return string(volume > 0 ? 'volume-mute' : 'volume-unmute'); } }, "css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))": function (obj) { with (obj) { return css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')); } }, "set_volume(volume + 0.1)": function (obj) { with (obj) { return set_volume(volume + 0.1); } }, "set_volume(volume - 0.1)": function (obj) { with (obj) { return set_volume(volume - 0.1); } }, "startUpdateVolume(domEvent)": function (obj) { with (obj) { return startUpdateVolume(domEvent); } }, "stopUpdateVolume(domEvent)": function (obj) { with (obj) { return stopUpdateVolume(domEvent); } }, "progressUpdateVolume(domEvent)": function (obj) { with (obj) { return progressUpdateVolume(domEvent); } }, "{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}": function (obj) { with (obj) { return {width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}; } }, "string('volume-button')": function (obj) { with (obj) { return string('volume-button'); } }, "title": function (obj) { with (obj) { return title; } }/**/ });
    return {
        "elevate": {
            css: "ba-audioplayer-elevate-theme",
            csstheme: "ba-audioplayer-elevate-theme",
            tmplcontrolbar: "\n<div class=\"{{css}}-dashboard \">\n\n    <div class=\"{{css}}-top-block\">\n\n        <div class=\"{{css}}-top-left-block\">\n            <div class=\"{{css}}-time-container {{css}}-left-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n            </div>\n        </div>\n\n        <div class=\"{{css}}-top-right-block\">\n\n            <div class=\"{{css}}-time-container {{css}}-right-time-container\">\n                <div class=\"{{css}}-time-value\" title=\"{{string('total-time')}}\">{{formatTime(duration || position)}}</div>\n            </div>\n\n        </div>\n\n        <div class=\"{{css}}-progressbar {{disableseeking ? css + '-disabled' : ''}}\">\n            <div tabindex=\"2\"\n                 ba-hotkey:right=\"{{seek(position + skipseconds)}}\"\n                 ba-hotkey:left=\"{{seek(position - skipseconds)}}\"\n                 onmouseout=\"this.blur()\"\n                 data-selector=\"progress-bar-inner\" class=\"{{css}}-progressbar-inner\"\n                 onmousedown=\"{{startUpdatePosition(domEvent)}}\"\n                 onmouseup=\"{{stopUpdatePosition(domEvent)}}\"\n                 onmouseleave=\"{{stopUpdatePosition(domEvent)}}\"\n                 onmousemove=\"{{progressUpdatePosition(domEvent)}}\"\n            >\n\n                <div class=\"{{css}}-progressbar-cache\" ba-styles=\"{{{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}}}\"></div>\n                <div class=\"{{css}}-progressbar-position\" ba-styles=\"{{{width: Math.round(duration ? position / duration * 100 : 0) + '%'}}}\" title=\"{{string('audio-progress')}}\">\n                    <div class=\"{{css}}-progressbar-button-description\" style=\"display: none\">\n                        <div class=\"{{css}}-time-container\">\n                            <div class=\"{{css}}-time-value\" title=\"{{string('elapsed-time')}}\">{{formatTime(position)}}</div>\n                        </div>\n                    </div>\n                    <div class=\"{{css}}-progressbar-button\"></div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n\n    <div class=\"{{css}}-bottom-block\">\n\n        <div class=\"{{css}}-left-block\">\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{submit()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"submit-audio-button\" class=\"{{css}}-leftbutton-container\"\n                 ba-if=\"{{submittable}}\"  ba-click=\"{{submit()}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    {{string('submit-audio')}}\n                </div>\n            </div>\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{rerecord()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-icon-ccw\" class=\"{{css}}-leftbutton-container\"\n                 ba-if=\"{{rerecordable}}\" ba-click=\"{{rerecord()}}\" title=\"{{string('rerecord-audio')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-ccw\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{play()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-pause')}}\"\n                 data-selector=\"button-icon-play\" class=\"{{css}}-button-container\"\n                 ba-if=\"{{!playing}}\" ba-click=\"{{play()}}\" title=\"{{string('play-audio')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-play\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"0\" ba-hotkey:space^enter=\"{{pause()}}\" onmouseout=\"this.blur()\"\n                 onkeydown=\"{{tab_index_move(domEvent, null, 'button-icon-play')}}\"\n                 data-selector=\"button-icon-pause\" class=\"{{css}}-button-container {{disablepause ? css + '-disabled' : ''}}\"\n                 ba-if=\"{{playing}}\" ba-click=\"{{pause()}}\" title=\"{{disablepause ? string('pause-audio-disabled') : string('pause-audio')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css}}-icon-pause\"></i>\n                </div>\n            </div>\n\n            <div tabindex=\"3\" ba-hotkey:space^enter=\"{{toggle_volume()}}\" onmouseout=\"this.blur()\"\n                 data-selector=\"button-icon-volume\" class=\"{{css}}-button-container\"\n                 ba-click=\"{{toggle_volume()}}\" title=\"{{string(volume > 0 ? 'volume-mute' : 'volume-unmute')}}\"\n            >\n                <div class=\"{{css}}-button-inner\">\n                    <i class=\"{{css + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off')) }}\"></i>\n                </div>\n            </div>\n\n            <div class=\"{{css}}-volumebar\">\n                <div tabindex=\"4\"\n                     ba-hotkey:right=\"{{set_volume(volume + 0.1)}}\"\n                     ba-hotkey:left=\"{{set_volume(volume - 0.1)}}\"\n                     onmouseout=\"this.blur()\"\n                     data-selector=\"button-volume-bar\" class=\"{{css}}-volumebar-inner\"\n                     onmousedown=\"{{startUpdateVolume(domEvent)}}\"\n                     onmouseup=\"{{stopUpdateVolume(domEvent)}}\"\n                     onmouseleave=\"{{stopUpdateVolume(domEvent)}}\"\n                     onmousemove=\"{{progressUpdateVolume(domEvent)}}\"\n                >\n                    <div class=\"{{css}}-volumebar-position\" ba-styles=\"{{{width: Math.ceil(1+Math.min(99, Math.round(volume * 100))) + '%'}}}\" title=\"{{string('volume-button')}}\"></div>\n                </div>\n            </div>\n\n        </div>\n\n        <div class=\"{{css}}-center-block\">\n            <div data-selector=\"audio-title-block\" class=\"{{css}}-audio-title-block\" ba-if=\"{{title}}\">\n                <p class=\"{{css}}-audio-title\">\n                    {{title}}\n                </p>\n            </div>\n        </div>\n\n    </div>\n</div>\n",
            cssloader: ie8 ? "ba-audioplayer" : "",
            cssmessage: "ba-audioplayer",
            cssplaybutton: ie8 ? "ba-audioplayer" : ""
        }
    };
});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('browser', 'root:BetaJS.Browser');
Scoped.binding('base', 'root:BetaJS');
Scoped.binding('module', 'global:ZiggeoApi.V2');
Scoped.binding('private', 'root:ZiggeoApi.V2');
Scoped.binding('media', 'root:BetaJS.Media');
Scoped.binding('mediacomponents', 'root:BetaJS.MediaComponents');
Scoped.binding('dynamics', 'root:BetaJS.Dynamics');
Scoped.binding('flash', 'root:BetaJS.Flash');
Scoped.define("module:", function (){return{guid:"6c65838a-53fd-4fd1-8d48-e571a0500135"}});

Scoped.define("private:Core", function (){return{servers:{local:{whitedomains:["*"],"server.api.server.public.domain":"localhost:91","server.api.server.public.protocol":"http","assets.api.server.public.domain":"localhost:92","assets.api.server.public.protocol":"http","assets-cdn.api.server.public.domain":"localhost:92","assets-cdn.api.server.public.protocol":"http","embed.api.server.public.domain":"localhost:93","embed.api.server.public.protocol":"http","analytics.api.server.public.domain":"localhost:1197","analytics.api.server.public.protocol":"http","embed-cdn.api.server.public.domain":"localhost:93","embed-cdn.api.server.public.protocol":"http","webserver.public.domain":"localhost:98","webserver.public.protocol":"http","hosted.pages.server.public.domain":"localhost:99","hosted.pages.server.public.protocol":"http","wowza.api.record.rtmp.protocol":"rtmp","wowza.api.record.rtmp.domain":"localhost","wowza.api.record.rtmp.path":"record/_definst_","wowza.api.record.webrtc.wssurl":"wss://localhost:4444/webrtc-session.json","wowza.api.record.webrtc.app":"webrtcziggeo",prefix:"",location:"Home",regions:{other:{prefix:"r1",location:"Somewhere","server.api.server.public.domain":"localhost:191","embed.api.server.public.domain":"localhost:193","analytics.api.server.public.domain":"localhost:2197","embed-cdn.api.server.public.domain":"localhost:193","webserver.public.domain":"localhost:198","hosted.pages.server.public.domain":"localhost:199"}},tags:{local:!0,development:!0}},production:{whitedomains:["*.ziggeo.com","ziggeo.com","localhost"],"server.api.server.public.domain":"srvapi.ziggeo.com","server.api.server.public.protocol":"https","assets.api.server.public.domain":"assets.ziggeo.com","assets.api.server.public.protocol":"https","assets-cdn.api.server.public.domain":"assets-cdn.ziggeo.com","assets-cdn.api.server.public.protocol":"https","embed.api.server.public.domain":"embed.ziggeo.com","embed.api.server.public.protocol":"https","analytics.api.server.public.domain":"api-us-east-1.ziggeo.com","analytics.api.server.public.protocol":"https","embed-cdn.api.server.public.domain":"embed-cdn.ziggeo.com","embed-cdn.api.server.public.protocol":"https","webserver.public.domain":"ziggeo.com","webserver.public.protocol":"https","hosted.pages.server.public.domain":"ziggeo.io","hosted.pages.server.public.protocol":"https","wowza.api.record.rtmp.protocol":"rtmps","wowza.api.record.rtmp.domain":"wowza.ziggeo.com","wowza.api.record.rtmp.path":"record/_definst_","wowza.api.record.webrtc.wssurl":"wss://wowza.ziggeo.com:443/webrtc-session.json","wowza.api.record.webrtc.app":"webrtcziggeo",prefix:"",location:"U.S. (US Law)",regions:{"eu-west-1":{prefix:"r1",location:"Ireland (European Law)","server.api.server.public.domain":"srvapi-eu-west-1.ziggeo.com","embed.api.server.public.domain":"embed-eu-west-1.ziggeo.com","analytics.api.server.public.domain":"api-eu-west-1.ziggeo.com","embed-cdn.api.server.public.domain":"embed-cdn-eu-west-1.ziggeo.com","webserver.public.domain":"eu-west-1.ziggeo.com","hosted.pages.server.public.domain":"eu-west-1.ziggeo.io","wowza.api.record.rtmp.domain":"wowza-eu-west-1.ziggeo.com","wowza.api.record.webrtc.wssurl":"wss://wowza-eu-west-1.ziggeo.com:443/webrtc-session.json"}},tags:{production:!0}},development:{whitedomains:["*.ziggeo.com","ziggeo.com","localhost"],"server.api.server.public.domain":"srvapi-dev.ziggeo.com","server.api.server.public.protocol":"https","assets.api.server.public.domain":"assets-dev.ziggeo.com","assets.api.server.public.protocol":"https","assets-cdn.api.server.public.domain":"assets-dev.ziggeo.com","assets-cdn.api.server.public.protocol":"https","embed.api.server.public.domain":"embed-dev.ziggeo.com","embed.api.server.public.protocol":"https","analytics.api.server.public.domain":"api-us-east-1-dev.ziggeo.com","analytics.api.server.public.protocol":"https","embed-cdn.api.server.public.domain":"embed-cdn.ziggeo.com","embed-cdn.api.server.public.protocol":"https","webserver.public.domain":"www-dev.ziggeo.com","webserver.public.protocol":"https","hosted.pages.server.public.domain":"dev.ziggeo.io","hosted.pages.server.public.protocol":"https","wowza.api.record.rtmp.protocol":"rtmps","wowza.api.record.rtmp.domain":"wowza-dev.ziggeo.com","wowza.api.record.rtmp.path":"record/_definst_","wowza.api.record.webrtc.wssurl":"wss://wowza-dev.ziggeo.com:443/webrtc-session.json","wowza.api.record.webrtc.app":"webrtcziggeo",prefix:"",location:"U.S. (US Law)",regions:{"eu-west-1":{prefix:"r1",location:"Ireland (European Law)","server.api.server.public.domain":"srvapi-dev-eu-west-1.ziggeo.com","embed.api.server.public.domain":"embed-dev-eu-west-1.ziggeo.com","analytics.api.server.public.domain":"api-eu-west-1.ziggeo.com","embed-cdn.api.server.public.domain":"embed-cdn-eu-west-1.ziggeo.com","webserver.public.domain":"dev-eu-west-1.ziggeo.com","hosted.pages.server.public.domain":"dev-eu-west-1.ziggeo.io","wowza.api.record.rtmp.domain":"wowza-dev-eu-west-1.ziggeo.com","wowza.api.record.webrtc.wssurl":"wss://wowza-dev-eu-west-1.ziggeo.com:443/webrtc-session.json"}},tags:{development:!0}}},models:{session_cookie_prefix:"i07af2jp98rvoctt26y5egy3"},revision:{version:1,revision:32,latest:!0,prerelease:!1}}});

Scoped.define("private:Application.Connect", ["base:Class","base:Ajax.AjaxWrapper"], ["browser:Ajax.IframePostmessageAjax","browser:Ajax.JsonpScriptAjax","browser:Ajax.XDomainRequestAjax","browser:Ajax.XmlHttpRequestAjax"], function (a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c){a.constructor.call(this),this.application=c,this.ajax=new b({sendContentType:!1,contentType:"urlencoded",wrapStatus:!0,wrapStatusParam:"_wrapstatus",noCache:!0,noCacheParam:"_nocache"})},destroy:function(){this.ajax.destroy(),a.destroy.call(this)},rawRequest:function(a,b){return this.ajax.execute({method:b.method,data:b.data,uri:a,resilience:b.resilience,sendContentType:b.sendContentType})},request:function(a,b){return this.rawRequest(this.application.urls.apiResourceUrl(a,b),b)}}})});

Scoped.define("private:Application.Data", ["base:Properties.Properties","base:Objs","browser:Cookies","private:Core","browser:Upload.FileUploader","dynamics:Parser"], ["browser:Upload.ChunkedFileUploader"], function (a,b,c,d,e,f,g){return a.extend({scoped:g},function(a){return{constructor:function(b,e){if(a.constructor.call(this),e=e||{},this.set("token",e.token),!this.get("token"))throw"You need to specify an application token when creating an application";this.set("webrtc_streaming","boolean"==typeof e.webrtc_streaming&&e.webrtc_streaming),this.set("webrtc_streaming_if_necessary","boolean"==typeof e.webrtc_streaming_if_necessary&&e.webrtc_streaming_if_necessary),this.set("webrtc_on_mobile","boolean"==typeof e.webrtc_on_mobile&&e.webrtc_on_mobile),this.set("cdn","boolean"!=typeof e.cdn||e.cdn),this.set("resumable",!1),this.set("auth","boolean"==typeof e.auth&&e.auth),this.set("analytics","boolean"!=typeof e.analytics||e.analytics),this.set("google_analytics","boolean"==typeof e.google_analytics&&e.google_analytics),this.set("google_analytics_track","undefined"!=typeof e.google_analytics_track?e.google_analytics_track:["init_application","embedding_loaded","record_start","record_end","rerecord_confirm","upload_start"]),this.compute("cookie_key",function(){return d.models.session_cookie_prefix+this.get("token")},["token"]),this.set("cookie_value",this.get("auth")?c.get(this.get("cookie_key")):""),this.on("change:cookie_value",function(a){this.get("auth")&&c.set(this.get("cookie_key"),a)},this),this.set("testing_application",!1),this.set("debug","debug"in e&&void 0!==e.debug?e.debug:d.revision.prerelease),this.set("chrome_extension_id",e.chrome_extension_id),this.set("opera_extension_id",e.opera_extension_id),this.set("chrome_extension_install_link",e.chrome_extension_install_link),this.set("opera_extension_install_link",e.opera_extension_install_link),e.disable_secure_templates&&(f.secureMode=!1)},getUploaderConfig:function(a,c,d){var e={url:a,serverSupportPostMessage:!0,resilience:5,serverSupportsChunked:this.get("resumable"),identifierParameter:"resumableIdentifier",chunks:{chunkNumberParameter:"resumableChunkNumber"},assembly:{fileNameParameter:"resumableFilename",totalSizeParameter:"resumableTotalSize",chunkNumberParameter:"resumableChunkNumber",fileTypeParameter:"resumableType"}};return c&&(e.source=c),b.extend(e,d)},getUploader:function(a,b,c){return e.create(this.getUploaderConfig(a,b,c))}}})});

Scoped.define("private:Application.Debugger", ["base:Class","base:Timers.Timer","browser:Events"], function (a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d){a.constructor.call(this),this.application=d,this.__events=this.auto_destroy(new c),this.__events.on(window,"error",function(a){this.__logError({message:a.message,source:a.filename,lineno:a.lineno,colno:a.colno,time:a.timeStamp})},this),this.__queue=[],this.__quota=25,this.__timer=this.auto_destroy(new b({context:this,fire:this.__pushErrors,delay:5e3}))},__logError:function(a){this.__queue.length>=this.__quota||this.__queue.push(a)},__pushErrors:function(){if(0!==this.__queue.length){var a=this.__queue;this.__queue=[],this.__quota-=a.length,this.application.connect.request("/debugger",{data:{events:JSON.stringify(a)},method:"POST"})}}}})});

Scoped.define("module:Device", ["base:Events.Events","base:Functions","base:Async","base:Promise","media:Recorder.WebRTCVideoRecorderWrapper","media:Recorder.FlashVideoRecorderWrapper","media:WebRTC.Support","media:Flash.Support","browser:Info","private:Core"], function (a,b,c,d,e,f,g,h,i,j){var k=function(a,b){try{return a()}catch(c){return b||!1}},l=new a,m=function(){return{location:document.location.href,userAgent:navigator.userAgent,flash:i.formatFlash(),device:i.formatDevice(),os:i.formatOS(),browser:i.formatBrowser(),version:i.formatBrowserVersion(),revision:j.revision}},n={info:k(m,{}),on:b.as_method(l.on,l),webrtc:k(function(){return e.supported({})}),flash:k(function(){return f.supported({})}),cameras:null,microphones:null,camera_count:null,microphone_count:null},o=function(a){n.devices=a,n.cameras=a.video,n.microphones=a.audio,n.camera_count=a.videoCount,n.microphone_count=a.audioCount,l.persistentTrigger("device_info",n.cameras,n.microphones,n.camera_count,n.microphone_count),l.persistentTrigger(n.camera_count>0?"has_camera":"no_camera"),l.persistentTrigger(n.microphone_count>0?"has_microphone":"no_microphone")},p=function(){n.devices=null,l.persistentTrigger("device_error")};return n.media=function(){if("devices"in n)return n.devices?d.value(n.devices):d.error("failed");var a=d.create();try{g.enumerateMediaSources().success(function(b){a.asyncSuccess(b),o(b)}).error(function(){try{h.enumerateMediaSources().success(function(b){a.asyncSuccess(b),o(b)}).error(function(){a.asyncError("failed"),p()})}catch(b){a.asyncError("failed"),p()}})}catch(b){try{h.enumerateMediaSources().success(function(b){a.asyncSuccess(b),o(b)}).error(function(){a.asyncError("failed"),p()})}catch(b){a.asyncError("failed"),p()}}return a},n});

Scoped.define("module:Locale", ["base:Classes.LocaleAggregator","base:Classes.LocaleTable","browser:Info","mediacomponents:Assets"], function (a,b,c,d){var e=new a,f=new b;return e.register(f),e.register(d.strings),e.setWeakLocale(c.language()),{setLocale:function(a){e.setLocale(a)},mainLocale:f,mediaLocale:d.strings}});

Scoped.define("private:Logger", [], function (){return{__console:function(a,b){try{console&&console[a]&&console[a].apply(console,b)}catch(c){}return this},warn:function(){return this.__console("warn",arguments)},log:function(){return this.__console("log",arguments)}}});

Scoped.define("private:Environment", ["private:Logger","private:Core","browser:Info","browser:Loader","base:Objs","base:Types","base:Net.Uri"], function (a,b,c,d,e,f,g){b.revision.prerelease&&a.warn("You are currently using a prerelease version of the Ziggeo JS SDK. We suggest using the stable revision for production use, and prereleases for staging environments and tests only.");var h=!!Scoped.getGlobal("ZiggeoLocal")||!!Scoped.getGlobal("ZiggeoWeb")&&location.hostname.indexOf("ziggeo.com")===-1,i=!1;if(!h)try{i=location.protocol.indexOf("https")!=-1||0===location.protocol.indexOf("file")||c.isCordova()}catch(j){}try{0!==location.protocol.indexOf("file")||c.isCordova()||a.warn("In order to use Ziggeo's recording technology, this page needs to be served via https (for WebRTC) and at least via http (for Flash). The file:// protocol is not supported. For more details contact us at support@ziggeo.com")}catch(j){}try{0===location.protocol.indexOf("https")?window.location!=window.parent.location&&0===document.referrer.indexOf("https")&&a.warn("Accessing the camera and the microphone on insecure origins (HTTP) is deprecated, and future browser versions will stop to support insecure origins. We highly recommend upgrading to SSL (HTTPS). For more details contact us at support@ziggeo.com"):0===location.protocol.indexOf("http")&&a.warn("Accessing the camera and the microphone on insecure origins (HTTP) is deprecated, and future browser versions will stop to support insecure origins. We highly recommend upgrading to SSL (HTTPS). For more details contact us at support@ziggeo.com")}catch(j){}var k=!h,l=h||!!Scoped.getGlobal("ZiggeoDev")||!!Scoped.getGlobal("ZiggeoWeb")&&k&&location.hostname.indexOf("dev")!==-1,m=!l,n=h?"local":m?"production":"development",o=e.clone(b.servers[n],1),p=function(a){var b=e.clone(o,-1);return e.iter(o.regions,function(c){0===a.indexOf(c.prefix)&&(b=e.extend(b,c))}),b},q={};if(m&&(q.cdn=o["assets-cdn.api.server.public.domain"]),q.normal=o["assets.api.server.public.domain"],h)try{window.location.hostname&&/^\d+\.\d+\.\d+\.\d+$/.test(window.location.hostname)&&(o=e.map(o,function(a){return f.is_string(a)?a.replace("localhost",window.location.hostname):a}),q.local=o["assets.api.server.public.domain"])}catch(j){}var r=o["assets.api.server.public.domain"],s=!1,t="/v"+b.revision.version+"-r"+b.revision.revision+"/",u=i?"https":"http",v=null;m&&(r=o["assets-cdn.api.server.public.domain"],s=!0);for(var w in q)try{var x=q[w],y=d.findScript(x);if(y&&y.src.indexOf("ziggeo.js")!==-1){s="cdn"===w;var z=g.parse(y.src);u=i?"https":z.protocol,r=z.host,z.port&&(r+=":"+z.port),t=z.directory;break}}catch(j){}v||(v=u+"://"+r+t);var A={isLocal:h,isServer:k,isDevelopment:l,isProduction:m,environment:n,serverEnvironments:b.servers,servers:o,serversByToken:p,assetsDomain:r,assetsCdn:s,assetsPath:t,assetsBase:v,sslRequired:i};return A});

Scoped.define("private:Application.Analytics", ["base:Class","base:Events.EventsMixin","base:Objs","base:Time","base:Timers.Timer","browser:Info","private:Core","private:Environment","private:Logger"], function (a,b,c,d,e,f,g,h,i,j){var k=d.now();return a.extend({scoped:j},[b,function(a){return{constructor:function(b){a.constructor.call(this),this.application=b,this.__google_analytics_events={},b.data.get("google_analytics")&&(this.__google_analytics_events=c.objectify(b.data.get("google_analytics_track"))),this.__queue=[],this.__trackFailed=0,this.__trackSuccess=0,this.application.data.get("analytics")&&(this.__timer=this.auto_destroy(new e({context:this,fire:this.__pushEvents,delay:5e3})))},_generateEvent:function(a,b,c,e,h,i){return i=i||d.now(),c=c||{},e=e||{},h=h||{},{tokens:{application_token:this.application.data.get("token"),video_token:c.video_token,stream_token:c.stream_token},client:{type:"web",version:"v"+g.revision.version+"-"+g.revision.revision,revision:g.revision.revision,sdk_version:a},environment:{location:document.location.href,time:i-k},device:{navigator_appname:navigator.appName,navigator_appcodename:navigator.appCodeName,navigator_appversion:navigator.appVersion,navigator_cookieenabled:navigator.cookieEnabled,navigator_language:navigator.language||navigator.userLanguage||"",navigator_platform:navigator.platform,navigator_useragent:navigator.userAgent,navigator_window_chrome:"chrome"in window,navigator_window_opera:"opera"in window,flash_installed:f.flash().installed(),flash_version_major:f.flash().installed()?f.flash().version().major:0,flash_version_minor:f.flash().installed()?f.flash().version().minor:0},event:{time:i,type:b,media_time:e.media_time||null,embed_type:e.embed_type||null,data_size:e.data_size||null,bandwidth:e.bandwidth||null},media:{duration:h.duration||null,width:h.width||null,height:h.height||null,tags:h.tags?h.tags.join(","):null,creation_type:h.creation_type||null,hd:h.width&&h.height&&h.width*h.height>=921600}}},track:function(a,b,c,d,e,f){try{var g=this._generateEvent(a,b,c,d,e,f);this.application.data.get("analytics")&&this.__queue.push(g),this.__google_analytics_events[b]&&ga("send","event","Ziggeo",b,"Ziggeo Campaign",d.media_time||e.duration||d.data_size||void 0),this.trigger("track",g)}catch(h){}},userTrack:function(a){this.track("2",a)},__pushEvents:function(){if(this.application.data.get("analytics")&&0!==this.__queue.length&&!(this.__trackFailed>10&&this.__trackSuccess/this.__trackFailed<.5)){var a=this.__queue;this.__queue=[],this.application.connect.rawRequest(this.application.urls.analyticsUrl(),{data:{events:JSON.stringify(a)},method:"POST",sendContentType:!0}).error(function(){this.__trackFailed++,this.__queue=a.concat(this.__queue)},this).success(function(){this.__trackSuccess++},this)}}}}])});

Scoped.define("private:Application.Urls", ["base:Class","base:Objs","base:Sort","base:Types","base:Comparators","base:Net.Uri","base:Async","browser:Info","media:Flash.Support","media:WebRTC.RecorderWrapper","private:Environment"], function (a,b,c,d,e,f,g,h,i,j,k,l){return a.extend({scoped:l},function(a){return{constructor:function(b){a.constructor.call(this),this.application=b,this.__servers=k.serversByToken(this.application.data.get("token")),this.__rtmpConnectivityResults={}},httpApiBaseUrl:function(){return(k.sslRequired?"https":"http")+"://"+this.__servers["embed.api.server.public.domain"]},analyticsApiBaseUrl:function(){return(k.isLocal?"http":"https")+"://"+this.__servers["analytics.api.server.public.domain"]},httpStreamingBaseUrl:function(){return(k.sslRequired?"https":"http")+"://"+this.__servers[this.application.data.get("cdn")?"embed-cdn.api.server.public.domain":"embed.api.server.public.domain"]},rtmpRecordingUrls:function(){var a=[];return a.push("rtmp://"+this.__servers["wowza.api.record.rtmp.domain"]+"/"+this.__servers["wowza.api.record.rtmp.path"]),k.isLocal?(a.push("rtmp://"+this.__servers["wowza.api.record.rtmp.domain"]+":1936/"+this.__servers["wowza.api.record.rtmp.path"]),a.push("rtmpt://"+this.__servers["wowza.api.record.rtmp.domain"]+":1936/"+this.__servers["wowza.api.record.rtmp.path"])):(a.push("rtmp://"+this.__servers["wowza.api.record.rtmp.domain"]+":80/"+this.__servers["wowza.api.record.rtmp.path"]),a.push("rtmps://"+this.__servers["wowza.api.record.rtmp.domain"]+":443/"+this.__servers["wowza.api.record.rtmp.path"]),a.push("rtmpt://"+this.__servers["wowza.api.record.rtmp.domain"]+":80/"+this.__servers["wowza.api.record.rtmp.path"])),a.push("rtmpt://"+this.__servers["wowza.api.record.rtmp.domain"]+"/"+this.__servers["wowza.api.record.rtmp.path"]),a.filter(function(a){return this.__rtmpConnectivityResults[a]>0},this).concat(a.filter(function(a){return!this.__rtmpConnectivityResults[a]},this)).concat(a.filter(function(a){return this.__rtmpConnectivityResults[a]<0},this))},registerRtmpConnectivityResult:function(a,b){this.__rtmpConnectivityResults[a]=b},rtmpRecordingUrl:function(){var a=this.rtmpRecordingUrls();return a[0]},webrtcStreamingApp:function(a){return this.__servers["wowza.api.record.webrtc.app"]+(a||"")},wssUrl:function(){return this.__servers["wowza.api.record.webrtc.wssurl"]},httpApiAppUrl:function(){return this.httpApiBaseUrl()+"/v1/applications/"+this.application.data.get("token")},analyticsUrl:function(){return this.analyticsApiBaseUrl()+"/embed/v1/applications/"+this.application.data.get("token")+"/scitylana/kcart"},apiResourceUrl:function(a,c){return this.resourceUrl(this.httpApiAppUrl(),a,b.extend({auth:!0},c))},httpStreamingAppUrl:function(){return this.httpStreamingBaseUrl()+"/v1/applications/"+this.application.data.get("token")},streamingResourceUrl:function(a,b){return this.resourceUrl(this.httpStreamingAppUrl(),a,b)},urlParams:function(a){a=a||{};var d=b.extend({},b.filter(a.params,function(a,b){return null!==a&&""!==a}));return a.auth&&this.application.data.get("auth")&&(d=b.extend(d,b.filter(a.auth,function(a,b){return null!==a&&""!==a})),d[this.application.data.get("cookie_key")]=this.application.data.get("cookie_value")),c.sort_object(d,e.byValue)},hostedBaseUrl:function(){return(k.sslRequired?"https":"http")+"://"+this.__servers["hosted.pages.server.public.domain"]},hostedUrl:function(a){return this.hostedBaseUrl()+a},resourceUrl:function(a,b,c){return f.appendUriParams(a+(b&&0!==b.indexOf("/")?"/":"")+b,this.urlParams(c))}}})});

Scoped.define("module:Config", ["private:Environment","base:Properties.Properties","base:Functions","flash:"], function (a,b,c,d){var e=new b,f=function(a,b,c){c(b),e.set(a,b),e.on("change:"+a,function(a){c(a)})};return f("flash",a.assetsBase+"ziggeo.swf",function(a){d.options=d.options||{},d.options.flashFile=a}),{set:c.as_method(e.set,e),get:c.as_method(e.get,e)}});

Scoped.define("module:Ads", ["mediacomponents:Ads.AdSenseVideoAdProvider","mediacomponents:Ads.VastVideoAdProvider"], function (a,b){return{AdSenseVideoAdProvider:a,VastVideoAdProvider:b}});

Scoped.define("module:Supplementary", ["base:Async"], function (a){return{eventInvokeCallback:function(b,c,d){try{b.apply(c,d)}catch(e){a.eventually(function(){throw e})}}}});

Scoped.define("module:PlayerStates.PosterError", ["mediacomponents:VideoPlayer.Dynamics.PlayerStates.State"], function (a,b){return a.extend({scoped:b},{dynamics:["loader"],_fail:function(){return 4===this.dyn.get("video_data").state?void this.next("VideoProcessing"):(this.dyn.set("loader_active",!1),this.dyn.set("message_active",!0),this.dyn.set("message",this.dyn.string("video-access-error")),void this.listenOn(this.dyn,"message:click",function(){this.next("LoadPlayer")},this))},_started:function(){this.dyn.get("video_status")===!0&&this._fail(),this.listenOn(this.dyn,"change:video_status",function(){this.dyn.get("video_status")===!0&&this._fail()})}})});

Scoped.define("module:PlayerStates.VideoProcessing", ["mediacomponents:VideoPlayer.Dynamics.PlayerStates.State","base:Time","base:Timers.Timer"], function (a,b,c,d){return a.extend({scoped:d},function(a){return{dynamics:["loader","message"],_started:function(){this.dyn.set("message",this.dyn.string("video-processing")),this.__video=this.dyn.get("video"),this.dyn.application.videos.watch(this.__video,{auth:this.dyn.get("auth"),maxage:2500},this.dyn.__videoUpdate,this.dyn),this.dyn.set("start-processing-time",b.now()),this.dyn._track("processing_start"),this.auto_destroy(new c({delay:100,context:this,fire:function(){var a=1e3;this.dyn.get("duration")&&this.dyn.get("duration")/60*1e3>1e3&&(a=this.dyn.get("duration")/60*1e3);var c=(b.now()-this.dyn.get("start-processing-time"))/a,d=1-1/(1+Math.sqrt(Math.sqrt(c)));this.dyn.trigger("processing",d),this.dyn.parent()&&this.dyn.parent().trigger("processing",d)}}))},_end:function(){this.dyn.application.videos.unwatch(this.__video,this),this.dyn.set("end-processing-time",b.now()),this.dyn._track("processing_end",{media_time:this.dyn.get("end-processing-time")-this.dyn.get("start-processing-time")}),this.dyn.trigger("processed"),this.dyn.parent()&&this.dyn.parent().trigger("processed"),a._end.call(this)}}})});

Scoped.define("module:PlayerStates.PlayVideo", ["mediacomponents:VideoPlayer.Dynamics.PlayerStates.PlayVideo"], function (a,b){return a.extend({scoped:b},function(a){return{_started:function(){a._started.call(this),this.dyn.application&&this.dyn.application.videos._playback(this.dyn.get("video"),null,this.dyn.get("auth")),this.dyn._track("play_start")}}})});

Scoped.define("module:RecorderStates.Recording", ["mediacomponents:VideoRecorder.Dynamics.RecorderStates.Recording"], function (a,b){return a.extend({scoped:b},function(a){return{_started:function(){a._started.call(this),this.dyn._track("record_start")},_hasStopped:function(){a._hasStopped.call(this),this.dyn._track("record_end",{media_time:this.dyn.get("duration")})}}})});

Scoped.define("module:RecorderStates.Chooser", ["mediacomponents:VideoRecorder.Dynamics.RecorderStates.Chooser"], function (a,b){return a.extend({scoped:b},function(a){return{_uploadFile:function(b){a._uploadFile.call(this,b),this.dyn._track("upload_start",{data_size:b.size})}}})});

Scoped.define("module:RecorderStates.CovershotSelection", ["mediacomponents:VideoRecorder.Dynamics.RecorderStates.CovershotSelection"], function (a,b){return a.extend({scoped:b},function(a){return{_nextUploading:function(b){this.dyn._track(b?"cover_skip":"cover_select"),a._nextUploading.call(this,b)}}})});

Scoped.define("module:RecorderStates.Uploading", ["mediacomponents:VideoRecorder.Dynamics.RecorderStates.Uploading","base:Time"], function (a,b,c){return a.extend({scoped:c},function(a){return{_started:function(){a._started.call(this),this.dyn.__had_processed=!1,this.dyn._track("uploading_start",{data_size:this.dyn._dataUploader.totalBytes()})},_finished:function(){a._finished.call(this),this.dyn._track("uploading_end",{media_time:this.dyn.get("end-upload-time")-this.dyn.get("start-upload-time"),data_size:this.dyn._dataUploader.totalBytes(),bandwidth:this.dyn._dataUploader.totalBytes()/(this.dyn.get("end-upload-time")-this.dyn.get("start-upload-time"))}),this.dyn._track("upstream_bandwidth",{media_time:this.dyn.get("end-upload-time")-this.dyn.get("start-upload-time"),data_size:this.dyn._dataUploader.totalBytes(),bandwidth:this.dyn._dataUploader.totalBytes()/(this.dyn.get("end-upload-time")-this.dyn.get("start-upload-time"))}),this.dyn.setProp("playerattrs.forcerefresh",b.now())}}})});

Scoped.define("private:Application.VideosApiMixin", function (){return{index:function(a,b,c){return this.application.connect.request("/videos/",{method:"GET",auth:b,resilience:c,data:a})},destroy:function(a,b,c){return this.application.connect.request("/videos/"+a,{method:"DELETE",auth:b,resilience:c})},create:function(a,b,c){return this.application.connect.request("/videos",{method:"POST",auth:b,resilience:c,data:a})},update:function(a,b,c,d){return this.application.connect.request("/videos/"+a,{method:"POST",auth:c,resilience:d,data:b})},_playback:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/playback",{method:"POST",auth:c,resilience:d,data:b})},get:function(a,b,c){return this.application.connect.request("/videos/"+a,{method:"GET",auth:b,resilience:c})}}});

Scoped.define("private:Application.Videos", ["base:Class","base:Promise","base:Objs","base:Time","base:Async","base:Net.HttpHeader","base:Ids","base:Comparators","private:Application.VideosApiMixin"], function (a,b,c,d,e,f,g,h,i,j){return a.extend({scoped:j},[i,function(a){return{constructor:function(b){a.constructor.call(this),this.application=b,this.__cache={}},imageUrl:function(a,b){b=b||{};var d="videos/"+a+"/image";return this.application.urls.streamingResourceUrl(d,{auth:b.auth,params:c.extend({refresh:this.refreshToken(a)},b.params)})},publicVideoUrl:function(a){return this.application.urls.hostedUrl("/v/"+a)},videoUrl:function(a,b){b=b||{};var d="videos/"+a+"/"+(b.download?"download_video.mp4":"video.mp4");return this.application.urls.streamingResourceUrl(d,{auth:b.auth,params:c.extend({refresh:this.refreshToken(a)},b.params)})},refreshToken:function(a){try{var b=this.cache(a,{weak:!0}).value();if(!b||b.submission_date===b.resubmission_date)return null;var c=d.now()/1e3-b.resubmission_date;return c>86400?null:b.resubmission_date}catch(e){return null}},__cacheGet:function(a){return this.__cache[a]||(this.__cache[a]={ready:!1,data:null,error:null,last_update:null,auth:null,next_update:null,next_update_timer:null,updating:!1,promises:[],watchers:{}}),this.__cache[a]},__cacheUpdate:function(a,b){var f=this.__cacheGet(a);if(!(f.updating||f.next_update&&f.next_update<=b)){f.next_update&&(e.clearEventually(f.next_update_timer),f.next_update=null);var g=d.now();if(g<b)return f.next_update=b,void(f.next_update_timer=e.eventually(function(){this.__cacheUpdate(a)},this,b-g));f.updating=!0,this.get(a,f.auth).callback(function(b,g){f.ready=!0,f.updating=!1;var i=d.now(),j=f.last_update?i-f.last_update:null;f.last_update=i,f.next_update=null;var k=f.data,l=b;f.data=g,f.error=b,e.clearEventually(f.next_update_timer),c.iter(f.promises,function(a){a.asyncCallback(b,g)},this),(b&&!b.equals(l)||!h.deepEqual(g,k,10))&&c.iter(f.watchers,function(a){a.callback.call(a.context,b,g)},this),null===j?c.iter(f.watchers,function(a){a.weak||(j=null===j?a.initialage:Math.min(a.initialage,j))},this):j*=2,null!==j&&(c.iter(f.watchers,function(a){!a.weak&&a.maxage&&(j=Math.min(j,a.maxage))},this),this.__cacheUpdate(a,i+j))},this)}},cacheInvalidate:function(a){this.__cacheGet(a).ready=!1},cache:function(a,d){var e=this.__cacheGet(a);if(d=c.extend({auth:null,weak:!1,force:!1,age:null},d),d.weak&&!e.ready)return b.error(!0);if(e.ready&&!d.force&&(!d.age||now-e.last_update<d.age))return e.data?b.value(e.data):b.error(e.error);d.auth&&(e.auth=d.auth);var f=b.create();return e.promises.push(f),this.__cacheUpdate(a),f},watch:function(a,b,e,f){var h=this.__cacheGet(a);b=c.extend({auth:null,weak:!1,maxage:null,initialage:1e3},b),b.auth&&(h.auth=b.auth),h.watchers[g.objectId(f)]={context:f,callback:e,weak:b.weak,maxage:b.maxage,age:b.initialage},b.weak||this.__cacheUpdate(a,b.initialage+d.now())},unwatch:function(a,b){var c=this.__cacheGet(a);delete c.watchers[g.objectId(b)]},createByUpload:function(a){return this.create(c.extend(c.clone(a.data,1),{create_stream:!0}),a.auth).mapSuccess(function(c){var d=b.create(),e=this.application.streams.dataUploader(c.video.token,c.stream.token,{auth:a.auth,video_data:a.video_data,audio_data:a.audio_data,image_data:a.image_data});return a.progress&&e.on("progress",a.progress,a.context),e.on("error",function(a){d.asyncError(a)},this),e.on("success",function(){this.application.streams._recorder_submit(c.video.token,c.stream.token,null,a.auth,50).forwardCallback(d)},this),e.upload(),d},this)}}}])});

Scoped.define("private:Application.StreamsApiMixin", function (){return{index:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/streams/",{method:"GET",auth:c,resilience:d,data:b})},destroy:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/streams/"+b,{method:"DELETE",auth:c,resilience:d})},create:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/streams",{method:"POST",auth:c,resilience:d,data:b})},accept:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/streams/"+b+"/accept",{method:"POST",auth:c,resilience:d})},_image_attach:function(a,b,c,d,e){return this.application.connect.request("/videos/"+a+"/streams/"+b+"/imageattach",{method:"POST",auth:d,resilience:e,data:c})},_audio_attach:function(a,b,c,d,e){return this.application.connect.request("/videos/"+a+"/streams/"+b+"/audioattach",{method:"POST",auth:d,resilience:e,data:c})},_recorder_submit:function(a,b,c,d,e){return this.application.connect.request("/videos/"+a+"/streams/"+b+"/recordersubmit",{method:"POST",auth:d,resilience:e,data:c})},_uploader_state:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/streams/"+b+"/uploaderstate",{method:"GET",auth:c,resilience:d})},_subtitle_attach:function(a,b,c,d){return this.application.connect.request("/videos/"+a+"/streams/"+b+"/subtitleattach",{method:"POST",auth:c,resilience:d})}}});

Scoped.define("private:Application.Streams", ["base:Class","base:Objs","private:Application.StreamsApiMixin","browser:Upload.MultiUploader"], function (a,b,c,d,e){return a.extend({scoped:e},[c,function(a){return{constructor:function(b){a.constructor.call(this),this.application=b},imageUrl:function(a,b,c){c=c||{};var d="videos/"+a+"/streams/"+b+"/image";return this.application.urls.streamingResourceUrl(d,{auth:c.auth,params:c.params})},videoUrl:function(a,b,c){c=c||{};var d="videos/"+a+"/streams/"+b+"/"+(c.download?"download_video.mp4":"video.mp4");return this.application.urls.streamingResourceUrl(d,{auth:c.auth,params:c.params})},videoAttachUrl:function(a,b,c){return this.application.urls.apiResourceUrl("/videos/"+a+"/streams/"+b+"/videoattach",{auth:c})},videoAttachUploaderConfig:function(a,b,c,d){return this.application.data.getUploaderConfig(this.videoAttachUrl(a,b,c),d)},videoAttachUploader:function(a,b,c,d){return this.application.data.getUploader(this.videoAttachUrl(a,b,c),d)},imageAttachUrl:function(a,b,c){return this.application.urls.apiResourceUrl("/videos/"+a+"/streams/"+b+"/imageattach",{auth:c})},imageAttachUploaderConfig:function(a,b,c,d){return this.application.data.getUploaderConfig(this.imageAttachUrl(a,b,c),d,{nonessential:!1})},imageAttachUploader:function(a,b,c,d){return this.application.data.getUploader(this.imageAttachUrl(a,b,c),d,{essential:!1})},audioAttachUrl:function(a,b,c){return this.application.urls.apiResourceUrl("/videos/"+a+"/streams/"+b+"/audioattach",{auth:c})},subtitleAttachUrl:function(a,b,c){return this.application.urls.apiResourceUrl("/videos/"+a+"/streams/"+b+"/subtitleattach",{auth:c})},audioAttachUploaderConfig:function(a,b,c,d){return this.application.data.getUploaderConfig(this.audioAttachUrl(a,b,c),d)},subtitleAttachUploaderUrl:function(a,b,c){return this.subtitleAttachUrl(a,b,c)},audioAttachUploader:function(a,b,c,d){return this.application.data.getUploader(this.audioAttachUrl(a,b,c),d)},rtmpStreamName:function(a,b,c){return this.application.urls.resourceUrl("applications/"+this.application.data.get("token"),"/videos/"+a+"/streams/"+b+"/video.mp4",{auth:c})},webrtcStreamName:function(a,b,c){return"applications___"+this.application.data.get("token")+"___videos___"+a+"___streams___"+b+"___video"},dataUploader:function(a,b,c){var e=new d;return c.video_data&&e.addUploader(this.videoAttachUploader(a,b,c.auth,c.video_data)),c.audio_data&&e.addUploader(this.audioAttachUploader(a,b,c.auth,c.audio_data)),c.image_data&&e.addUploader(this.imageAttachUploader(a,b,c.auth,c.image_data)),e}}}])});

Scoped.define("module:Application", ["base:Class","base:Objs","base:Events.EventsMixin","base:Events.Events","base:Async","browser:Dom","module:Locale","private:Application.Data","private:Application.Urls","private:Application.Connect","private:Application.Videos","private:Application.Streams","private:Application.Analytics","private:Application.Debugger","module:Supplementary"], function (a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){return g.mainLocale.register({error_503:"We are maintaining our service. Videos will be back soon.",error_404:"We cannot recognize your api key. Please make sure to specify it in your website's header.",error_401:"You are not allowed to access the application from this site.",error_412:"You need to confirm / upgrade your account.",error_unknown:"An unknown error occurred. Our team has been notified and will resolve the issue."},"application"),a.extend({scoped:p},[c,function(a){return{constructor:function(b){a.constructor.call(this),this.data=this.auto_destroy(new h(this,b)),this.data.get("debug")&&(this.debug=this.auto_destroy(new n(this))),this.urls=this.auto_destroy(new i(this)),this.connect=this.auto_destroy(new j(this)),this.videos=this.auto_destroy(new k(this)),this.streams=this.auto_destroy(new l(this)),this.analytics=this.auto_destroy(new m(this)),this.embed_events=this.auto_destroy(new d),this.embed_events._invokeCallback=o.eventInvokeCallback,this._invokeCallback=o.eventInvokeCallback,this.cls.register(this),this.__init()},destroy:function(){this.cls.unregister(this),a.destroy.call(this)},__init:function(){this.connect.request("session",{method:"POST",params:{noauth:!this.data.get("auth")}}).success(function(a){this.data.set("cookie_changed",a.token!==this.data.get("cookie_value")),this.data.set("cookie_value",a.token),this.data.set("testing_application",a.testing_application),this.data.set("ready",!0),this.analytics.track("2","init_application",{}),f.ready(function(){e.eventually(function(){this.persistentTrigger("ready")},this)},this)},this).error(function(a){this.data.set("error",a.status_code());var b=g.mainLocale.get("error_"+a.status_code(),"application");this.data.set("error_message",b||g.mainLocale.get("error_unknown","application")),this.persistentTrigger("error",a.status_code(),this.data.get("error_message"))},this)}}}],{__default:null,__instances:{},__deferred:0,events:new d,setDefault:function(a){this.__default=a,this.events.trigger("set-default",a)},getDefault:function(){return this.__default},getByToken:function(a){return this.__instances[a]},instanceByToken:function(a,c){return this.getByToken(a)||new this(b.extend({token:a},c))},register:function(a){var b=a.data.get("token");if(b in this.__instances)throw"Application Instance already existing for this application token.";this.__instances[b]=a,this.__default||this.setDefault(a)},unregister:function(a){var b=a.data.get("token");this.__instances[b]===a&&delete this.__instances[b],this.getDefault()===a&&this.setDefault(null)},isDeferred:function(){return this.__deferred>0},defer:function(){this.__deferred++},undefer:function(){this.__deferred--,0===this.__deferred&&this.events.trigger("undefer")},onUndefer:function(a,b){this.isDeferred()?this.events.once("undefer",a,b):a.call(b||this)}})});

Scoped.define("private:Dynamics", ["dynamics:DomObserver","dynamics:Parser","dynamics:Registries","base:Async","browser:Dom","module:Application"], function (a,b,c,d,e,f){b.secureMode=!0,c.prefixes.ziggeo=!0;var g=new a({allowed_dynamics:["ziggeoplayer","ziggeorecorder"],enabled:!1});return e.ready(function(){d.eventually(function(){f.onUndefer(function(){g.enable()})})}),{domObserver:g}});

Scoped.define("module:Player", ["mediacomponents:VideoPlayer.Dynamics.Player","private:Logger","module:Application","base:Types","module:PlayerStates","base:Net.HttpHeader","module:Locale","module:Supplementary","base:Objs","base:Time","base:Promise","base:TimeFormat"], function (a,b,c,d,e,f,g,h,i,k,l,m,n){return a.extend({scoped:n},function(a){return{attrs:{"stream-width":null,"stream-height":null,"effect-profile":null,"client-auth":null,"server-auth":null,"intermediate-token":null,video:null,stream:null,application:null,forcerefresh:!1,pauseonplay:!1,"audio-transcription-as-subtitles":!1
},types:{playlist:"array",pauseonplay:"bool","lazy-application":"bool","audio-transcription-as-subtitles":"bool"},create:function(){return this._invokeCallback=h.eventInvokeCallback,this.get("source")||this.get("sources").length>0?a.create.call(this):(this.set("ready",!1),this.__playlist=this.get("playlist"),this.set("playlist",null),this.get("effect-profile")&&d.is_array(this.get("effect-profile"))&&this.set("effect-profile",this.get("effect-profile")[0]),a.create.call(this),this.set("auth",{client_auth:this.get("client-auth"),server_auth:this.get("server-auth"),intermediate_token:this.get("intermediate-token")}),this.set("application_status",null),void this.set("video_status",null))},_notifications:{_activate:"_createWithApplication"},_obtainApplication:function(){this.get("application")&&(this.application=d.is_string(this.get("application"))?c.instanceByToken(this.get("application")):this.get("application")),this.application=this.application||c.getDefault()},_deferActivate:function(){return this._obtainApplication(),!(this.application||!this.get("lazy-application"))&&(c.events.once("set-default",function(a){this.application=a,this.activate()},this),!0)},_createWithApplication:function(){if(this._obtainApplication(),!this.application)return void b.warn("No application (token) defined. We need an application (token) to include an embedding.");if(!this.application.data.get("auth")&&(this.get("client-auth")||this.get("server-auth")))return void b.warn("You are specifying auth tokens on your embedding yet your application is initialized with auth = false.");if(this.application.embed_events.delegateEvents(null,this,null,[this]),this.__playlist){this.set("playlist",this.__playlist.map(function(a){return this.__sourceByVideo(a)},this));var a=this.get("playlist")[0];this.set("poster",a.poster),this.set("source",a.source),this.set("video",a.token),this.on("playlist-next",function(a){this.set("video",a.token)},this)}this.application.on("ready",function(){this.set("application_status",!0),this.get("playlist")?this.set("ready",!0):(this.get("source")||this.__setVideoSources(),this.set("ready",!0)),this._track("embedding_loaded")},this).on("error",function(a,b){this.set("application_status",!1),this.state().next("FatalError",{message:b})},this),this.get("pauseonplay")&&this.application.embed_events.on("playing",function(a){a!==this&&this.get("playing")&&this.execute("pause")},this)},destroy:function(){this.application.embed_events.off(null,null,this),a.destroy.call(this)},events:{"change:video":function(){this.set("stream",null),this.__setVideoSources()},paused:function(){this._track("play_pause",{media_time:this.get("position")})},playing:function(){this._track("play_playing",{media_time:this.get("position")})},ended:function(){this._track("play_end",{media_time:this.get("duration")})},seek:function(a){this._track("play_seek",{media_time:a})}},__setVideoSources:function(){this.get("video")&&this.get("application_status")&&(this.set("sharevideourl",this.application.videos.publicVideoUrl(this.get("video")).replace("http://","https://")),this.get("stream")||this.set("refresh_token",this.application.videos.refreshToken(this.get("video"))),this.__setSources(),this.application.videos.cache(this.get("video"),{auth:this.get("auth")}).callback(this.__videoUpdate,this),this.get("ready")&&this.reattachVideo())},__sourceByVideo:function(a,b){var c=this.get("video_data"),d=i.filter(c&&c.streams?c.streams:[],function(a){return!(a.token!==c.original_stream.token&&a.parent_stream!==c.original_stream.token||5!==a.state||3!==a.streamable||this.get("effect-profile")&&a.effect_profile!==this.get("effect-profile"))},this);if(this.get("playlist")&&(d=[],b=null),b||this.get("stream-width")||this.get("stream-height")||d.length<2){var e=b?this.application.streams:this.application.videos,f=[a];return b&&f.push(b),f.push({auth:this.get("auth"),params:{stream_width:this.get("stream-width"),stream_height:this.get("stream-height"),effect_profile:this.get("effect-profile"),force_refresh:this.get("forcerefresh")}}),{poster:e.imageUrl.apply(e,f),source:e.videoUrl.apply(e,f),token:a}}var g=[],h=[],j={effect_profile:this.get("effect-profile"),force_refresh:this.get("forcerefresh"),auth:this.get("auth")};i.iter(d,function(b){g.push({src:this.application.streams.videoUrl(a,b.token,j),poster:this.application.streams.imageUrl(a,b.token,j),token:b.token}),h.push({width:b.video_width,height:b.video_height,filter:{token:b.token}})},this);var k=h[0];return{poster:null,source:null,sources:g,streams:h,currentstream:k,token:a}},__setSources:function(){this.set("uploadoptions",{textTracks:this.application.streams.subtitleAttachUploaderUrl(this.get("video"),this.get("stream")||this.properties().getProp("video_data.original_stream.token"),this.get("auth"))}),this.setAll(this.__sourceByVideo(this.get("video"),this.get("stream")))},__audioTranscriptionToVTT:function(a,b,c){c=c||5;for(var d=a.length,e=0,f=["WEBVTT"];e<d;){var g=b[e].start,h=b[e].end,i=[a[e]];for(e++,j=c-1;j>0&&e<d;)h=b[e].end,i.push(a[e]),e++,j--;f.push(""),f.push(m.format("HH:MM:ss.l",g)+" --> "+m.format("HH:MM:ss.l",h)),f.push(i.join(" "))}return f.join("\n")},__videoUpdate:function(a,b){if(!this.destroyed())if(a)this.set("video_status",!1),a.status_code()===f.HTTP_STATUS_NOT_FOUND?this.state().next("FatalError",{message:this.string("video-not-found")}):a.status_code()===f.HTTP_STATUS_FORBIDDEN?this.state().next("FatalError",{message:this.string("video-access-forbidden")}):this.state().next("FatalError",{message:this.string("video-unknown-error")});else{this.set("video_data",b);var c=[];try{var d=b.default_stream.audio_transcription||b.original_stream.audio_transcription;d&&this.get("audio-transcription-as-subtitles")&&c.push({lang:"en",kind:"subtitles",label:"Transcription",content:this.__audioTranscriptionToVTT(d.words,d.times)});var e=b.default_stream.subtitles||b.original_stream.subtitles;e&&i.iter(e,function(a,b){c.push({lang:b,kind:"subtitles",label:a.label,content:a.data})})}catch(g){}if(this.set("tracktags",c),this.get("title")||this.set("title",b.title),this.set("totalduration",b.duration),b.approved===!1&&!this.get("intermediate-token"))return void this.state().next("FatalError",{message:b.moderation_reason||this.string("video-rejected")});if(b.state<4)return void this.state().next("FatalError",{message:this.string("video-unknown-error")});if(this.set("video_status",!0),4===b.state)return void("VideoProcessing"!==this.state().state_name()&&this.state().next("VideoProcessing"));if(this.get("effect-profile")){var h=!1;if(i.iter(b.streams,function(a){a.effect_profile===this.get("effect-profile")&&a.state>4&&(h=!0)},this),!h)return void("VideoProcessing"!==this.state().state_name()&&this.state().next("VideoProcessing"));if("VideoProcessing"===this.state().state_name())return this.set("forcerefresh",k.now()),this.__setSources(),void this.state().next("LoadPlayer")}if("VideoProcessing"===this.state().state_name())return this.set("refresh_token",this.application.videos.refreshToken(this.get("video"))),this.set("forcerefresh",k.now()),this.__setSources(),void this.state().next("LoadPlayer");if(!this.get("stream")&&!this.get("refresh_token")&&this.application.videos.refreshToken(this.get("video")))return this.set("refresh_token",this.application.videos.refreshToken(this.get("video"))),this.__setSources(),void this.state().next("LoadPlayer");this.__setSources()}},_track:function(a,b,c){if(this.application){var d=k.now(),e=l.create();e.success(function(){this.application.analytics.track("2",a,{video_token:this.get("video_data").token,stream_token:this.get("stream")?this.get("stream"):void 0},i.extend({embed_type:"player"},b),i.extend({duration:this.get("video_data").duration||this.get("duration"),width:this.get("stream")?this.get("stream").width:this.videoWidth(),height:this.get("stream")?this.get("stream").height:this.videoHeight(),tags:this.get("video_data").tags},c),d)},this),this.get("video_data")?e.asyncSuccess():this.once("change:video_data",function(){e.asyncSuccess()},this)}}}},function(a){return{playerStates:function(){return a.playerStates.call(this).concat([e])}}}).register("ba-ziggeoplayer").register("ziggeoplayer").attachStringTable(g.mainLocale).addStrings({"video-not-found":"We could not find the specified video file.","video-access-forbidden":"You are not permitted to access this video file.","video-unknown-error":"We cannot access this video at the moment. Please try again later.","video-rejected":"The video has been rejected.","video-processing":"The video is processing - stay tuned.","video-access-error":"The video is currently under moderation. You may click to retry."})});

Scoped.define("module:PopupPlayer", ["module:Player","mediacomponents:PopupHelper"], function (a,b,c){return a.extend({scoped:c},b.mixin)});

Scoped.define("module:Recorder", ["mediacomponents:VideoRecorder.Dynamics.Recorder","module:Application","module:Device","private:Logger","private:Environment","module:RecorderStates","base:Types","base:Time","base:Strings","module:Locale","module:Supplementary","base:Objs","base:Promise","base:Async","browser:Events","browser:Info"], function (Recorder,Application,Device,Logger,Environment,RecorderStates,Types,Time,Strings,Locale,Supplementary,Objs,Promise,Async,DomEvents,Info,scoped){return Recorder.extend({scoped:scoped},function(a){return{template:a.template.replace('"overlay">','"overlay"><a class="ziggeo-v2-testing" ba-if="{{testing}}" href="https://ziggeo.com/pricing" target="_blank"></a>'),attrs:{dynvideoplayer:"ziggeoplayer","effect-profile":null,"preview-effect-profile":null,"video-profile":null,"meta-profile":null,"client-auth":null,"server-auth":null,"intermediate-token":null,application:null,video:null,description:null,title:null,tags:null,"custom-data":null,key:null,"auto-crop":null,"auto-pad":null,"expiration-days":null,"force-overwrite":null,"recover-streams":null,"input-bind":null,"form-accept":null,playermodeifexists:!1,rerecordableifexists:!1,chrome_extension_id:null,opera_extension_id:null,chrome_extension_install_link:null,opera_extension_install_link:null},types:{tags:"array","custom-data":"object","auto-crop":"bool","auto-pad":"bool","expiration-days":"int","delete-old-streams":"bool","force-overwrite":"bool","recover-streams":"bool","effect-profile":"array","lazy-application":"bool",playermodeifexists:"bool",rerecordableifexists:"bool"},events:{rerecord:function(){this.__inputBindElement&&(this.__inputBindElement.value=""),this.get("form-accept")&&this._formAcceptEvents.on(document.querySelector(this.get("form-accept")),"submit",function(a){a.preventDefault()})},processed:function(){this.__had_processed=!0}},create:function(){this._invokeCallback=Supplementary.eventInvokeCallback,this.set("ready",!1),this.set("rtmpstreamtype",Environment.isLocal?"flv":"mp4"),a.create.call(this),this.get("video")&&!this.get("key")&&Strings.starts_with(this.get("video"),"_")&&this.set("key",Strings.strip_start(this.get("video"),"_")),this.get("simulate")&&this.set("localplayback",!0),Types.is_string(this.get("effect-profile"))&&this.set("effect-profile",Types.parseArray(this.get("effect-profile"))),this.set("auth",{client_auth:this.get("client-auth"),server_auth:this.get("server-auth"),intermediate_token:this.get("intermediate-token")}),this.set("application_status",null),this.__hadInitialVideo=!!this.get("video"),this.get("video")||(this.set("playermodeifexists",!1),this.set("rerecordableifexists",!1),this.get("form-accept")&&(this._formAcceptEvents=this.auto_destroy(new DomEvents),this._formAcceptEvents.on(document.querySelector(this.get("form-accept")),"submit",function(a){a.preventDefault()}))),this.on("rerecord",function(){this._track("rerecord_confirm")},this),this.__had_processed=!1},_notifications:{_activate:"_createWithApplication"},_obtainApplication:function(){this.get("application")&&(this.application=Types.is_string(this.get("application"))?Application.instanceByToken(this.get("application")):this.get("application")),this.application=this.application||Application.getDefault()},_deferActivate:function(){if(this._obtainApplication(),(this.application||!this.get("lazy-application"))&&!this.get("playermodeifexists")&&!this.get("rerecordableifexists"))return!1;var a=Promise.create();return this.application?a.asyncSuccess(!0):Application.events.once("set-default",function(b){this.application=b,a.asyncSuccess(!0)},this),(this.get("playermodeifexists")||this.get("rerecordableifexists"))&&(a=a.mapSuccess(function(){return this.application.videos.get(this.get("video"),{auth:this.get("auth")}).success(function(a){a&&(this.get("playermodeifexists")&&this.set("recordermode",!1),this.get("rerecordableifexists")||this.set("rerecordable",!1))},this)},this)),a.success(this.activate,this),!0},_createWithApplication:function(){return this._obtainApplication(),this.application?this.application.data.get("auth")||!this.get("client-auth")&&!this.get("server-auth")?(this.get("chrome_extension_id")&&!this.get("chrome_extension_install_link")&&this.set("chrome_extension_install_link","https://chrome.google.com/webstore/detail/"+this.get("chrome_extension_id")),this.set("screen",{chromeExtensionId:this.get("chrome_extension_id")||this.application.data.get("chrome_extension_id"),operaExtensionId:this.get("opera_extension_id")||this.application.data.get("opera_extension_id"),chromeExtensionInstallLink:this.get("chrome_extension_install_link")||this.application.data.get("chrome_extension_install_link"),operaExtensionInstallLink:this.get("opera_extension_install_link")||this.application.data.get("opera_extension_install_link")}),this.application.embed_events.delegateEvents(null,this,null,[this]),this.application.on("ready",function(){this.set("application_status",!0),this.set("ready",!0),this.set("testing",this.application.data.get("testing_application"))},this).on("error",function(a,b){this.set("application_status",!1),this.state().next("FatalError",{message:b})},this),this.set("playerattrs",{application:this.application,"effect-profile":this.get("preview-effect-profile"),"client-auth":this.get("client-auth"),"server-auth":this.get("server-auth"),"intermediate-token":this.get("intermediate-token"),video:this.get("video"),"force-refresh":Time.now()}),this._track("embedding_loaded"),this.on("attached",function(){this.recorder.isFlash()&&this.recorder.on("endpoint_connectivity",function(a,b){this.application.urls.registerRtmpConnectivityResult(a.serverUrl,b)},this)},this),this._updateUrls(),this.set("webrtcstreaming",this.application.data.get("webrtc_streaming")),this.set("webrtcstreamingifnecessary",this.application.data.get("webrtc_streaming_if_necessary")),void this.set("webrtconmobile",this.application.data.get("webrtc_on_mobile"))):void Logger.warn("You are specifying auth tokens on your embedding yet your application is initialized with auth = false."):void Logger.warn("No application (token) defined. We need an application (token) to include an embedding.")},_track:function(a,b,c){this.application.analytics.track("2",a,{video_token:this.get("video"),stream_token:this.get("stream")},Objs.extend({embed_type:this.__hadInitialVideo?"rerecorder":"recorder"},b),Objs.extend({creation_type:this.get("creation-type"),duration:this.get("duration"),width:this.get("recordingwidth"),height:this.get("recordingheight"),tags:this.get("tags")},c))},functions:{reset:function(){this.get("video")&&!this.__hadInitialVideo&&this.set("video",null),this.__had_processed=!1,a.functions.reset.call(this)},ready_to_play:function(){this.__had_processed||(this.trigger("processing",1),this.trigger("processed")),a.functions.ready_to_play.call(this)}},_updateUrls:function(){this.set("playerattrs.video",this.get("video"));var a=this.application.streams.rtmpStreamName(this.get("video"),this.get("stream"),this.get("auth"));this.set("uploadoptions",{rtmp:this.application.urls.rtmpRecordingUrls().map(function(b){return{serverUrl:b,streamName:a}}),webrtcStreaming:{wssUrl:this.application.data.get("webrtc_streaming")?this.application.urls.wssUrl():void 0,streamInfo:this.application.data.get("webrtc_streaming")?{applicationName:this.application.urls.webrtcStreamingApp(Info.isFirefox()?"udp":""),streamName:this.application.streams.webrtcStreamName(this.get("video"),this.get("stream"),this.get("auth"))}:void 0,delay:4750,stopDelay:2750},image:this.application.streams.imageAttachUploaderConfig(this.get("video"),this.get("stream"),this.get("auth")),video:Objs.extend({resilienceCheck:function(a){return!a||!a.duration}},this.application.streams.videoAttachUploaderConfig(this.get("video"),this.get("stream"),this.get("auth"))),audio:this.application.streams.audioAttachUploaderConfig(this.get("video"),this.get("stream"),this.get("auth")),textTracks:this.application.streams.subtitleAttachUploaderUrl(this.get("video"),this.get("stream"),this.get("auth"))})},_readDeviceOrientation:function(){var a=window.orientation+90;return a||void 0},__createParams:function(){var a={};try{var b=this.activeElement().cloneNode();b.innerHTML="",a=b.outerHTML}catch(c){}return{description:this.get("description"),title:this.get("title"),tags:this.get("tags")?this.get("tags").join(","):void 0,data:this.get("custom-data")?JSON.stringify(this.get("custom-data")):void 0,key:this.get("key"),auto_crop:this.get("auto-crop"),auto_pad:this.get("auto-pad"),only_audio:this.get("onlyaudio"),expiration_days:this.get("expiration-days"),delete_old_streams:this.get("delete-old-streams"),effect_profile:this.get("effect-profile")?this.get("effect-profile").join(","):void 0,force_overwrite:this.get("force-overwrite"),video_profile:this.get("video-profile"),meta_profile:this.get("meta-profile"),enforce_duration:this.get("enforce-duration"),recover_streams:this.get("recover-streams"),max_duration:this.get("timelimit"),user_language:navigator.language||navigator.userLanguage,video_file_name:this._videoFileName,device_info:Objs.extend({api_version:2,embed_code:a},Device.info)}},__recordingTypeParams:function(){return this.isFlash()?{flash_recording:!0}:this.recorder?{webrtc_recording:!0,create_stream:!0,webrtc_streaming:this.application.data.get("webrtc_streaming")}:{create_stream:!0}},_prepareRecording:function(){return this._requiresDeviceOrientation=Info.isMobile()&&Info.isiOS()&&void 0!==window.orientation&&this.recorder,this.get("video")?this.application.streams.create(this.get("video"),this.__recordingTypeParams(),this.get("auth")).mapSuccess(function(a){this.set("stream",a.token),this.set("stream_data",a),this._updateUrls()},this):this.application.videos.create(Objs.extend(this.__createParams(),this.__recordingTypeParams()),this.get("auth")).mapSuccess(function(a){this.set("video",a.video.token),this.set("video_data",a.video),this.set("stream",a.stream.token),this.set("stream_data",a.stream),this._updateUrls()},this)},_verifyRecording:function(){var a=Promise.create();return Async.eventually(function(){if(this.get("video")){var b=this.get("simulate")?Promise.value(!0):this.application.streams._recorder_submit(this.get("video"),this.get("stream"),{rotation:this._requiresDeviceOrientation?this._readDeviceOrientation():void 0},this.get("auth"),50);b.success(function(){this.__inputBindElement&&(this.__inputBindElement.value=this.get("video")),this.get("form-accept")&&this._formAcceptEvents.off(document.querySelector(this.get("form-accept")),"submit"),this.application.videos.cacheInvalidate(this.get("video"))},this).forwardCallback(a)}},this,2500),a},_afterActivate:function(b){a._afterActivate.apply(this,arguments),this.get("input-bind")&&(this.__inputBindElement=document.getElementsByName(this.get("input-bind"))[0],this.__inputBindElement||(this.__inputBindElement=document.createElement("input"),this.__inputBindElement.type="hidden",this.__inputBindElement.id=this.get("input-bind"),this.__inputBindElement.name=this.get("input-bind"),b.parentElement.appendChild(this.__inputBindElement)),this.get("video")&&(this.__inputBindElement.value=this.get("video")))}}},function(a){return{recorderStates:function(){return a.recorderStates.call(this).concat([RecorderStates])}}}).register("ba-ziggeorecorder").register("ziggeorecorder").registerFunctions({testing:function(obj){with(obj)return testing}}).attachStringTable(Locale.mainLocale).addStrings({})});

Scoped.define("module:PopupRecorder", ["module:Recorder","mediacomponents:PopupHelper"], function (a,b,c){return a.extend({scoped:c},b.mixin)});


}).call(Scoped);
(function () {
var Scoped = this.subScope();
Scoped.binding('module', 'global:ZiggeoApi.V2');
Scoped.extend("module:", function () {
	return {};
});

Scoped.extend("module:Locale", ["module:Locale"], function (Locale) {
    var languages = {"language:ar":{"application.error_503":"&#x646;&#x62D;&#x646; &#x641;&#x64A; &#x642;&#x64A;&#x62F; &#x62A;&#x637;&#x648;&#x64A;&#x631; &#x62E;&#x62F;&#x645;&#x62A;&#x646;&#x627;. &#x633;&#x62A;&#x639;&#x648;&#x62F; &#x645;&#x642;&#x627;&#x637;&#x639; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x642;&#x631;&#x64A;&#x628;&#x627;.","application.error_404":"&#x644;&#x627; &#x64A;&#x645;&#x643;&#x646;&#x646;&#x627; &#x627;&#x644;&#x62A;&#x639;&#x631;&#x641; &#x639;&#x644;&#x649; &#x645;&#x641;&#x62A;&#x627;&#x62D; &#x648;&#x627;&#x62C;&#x647;&#x629; &#x628;&#x631;&#x645;&#x62C;&#x629; &#x627;&#x644;&#x62A;&#x637;&#x628;&#x64A;&#x642;&#x627;&#x62A;. &#x627;&#x644;&#x631;&#x62C;&#x627;&#x621; &#x627;&#x644;&#x62A;&#x623;&#x643;&#x62F; &#x645;&#x646; &#x62A;&#x62D;&#x62F;&#x64A;&#x62F;&#x647; &#x641;&#x64A; &#x639;&#x646;&#x648;&#x627;&#x646; &#x645;&#x648;&#x642;&#x639;&#x643; &#x627;&#x644;&#x625;&#x644;&#x643;&#x62A;&#x631;&#x648;&#x646;&#x64A;.","application.error_401":"&#x644;&#x627; &#x64A;&#x633;&#x645;&#x62D; &#x644;&#x643; &#x628;&#x627;&#x644;&#x648;&#x635;&#x648;&#x644; &#x625;&#x644;&#x649; &#x627;&#x644;&#x62A;&#x637;&#x628;&#x64A;&#x642; &#x645;&#x646; &#x647;&#x630;&#x627; &#x627;&#x644;&#x645;&#x648;&#x642;&#x639;.","application.error_412":"&#x62A;&#x62D;&#x62A;&#x627;&#x62C; &#x625;&#x644;&#x649; &#x62A;&#x623;&#x643;&#x64A;&#x62F; / &#x62A;&#x631;&#x642;&#x64A;&#x629; &#x62D;&#x633;&#x627;&#x628;&#x643;.","application.error_unknown":"&#x62D;&#x62F;&#x62B; &#x62E;&#x637;&#x623; &#x63A;&#x64A;&#x631; &#x645;&#x639;&#x631;&#x648;&#x641;. &#x62A;&#x645; &#x625;&#x639;&#x644;&#x627;&#x645; &#x641;&#x631;&#x64A;&#x642;&#x646;&#x627; &#x648;&#x633;&#x64A;&#x62D;&#x644; &#x627;&#x644;&#x645;&#x634;&#x643;&#x644;&#x629;.","ziggeoplayer.video-not-found":"&#x62A;&#x639;&#x630;&#x631; &#x627;&#x644;&#x639;&#x62B;&#x648;&#x631; &#x639;&#x644;&#x649; &#x645;&#x644;&#x641; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x627;&#x644;&#x645;&#x62D;&#x62F;&#x62F;.","ziggeoplayer.video-access-forbidden":"&#x644;&#x627; &#x64A;&#x633;&#x645;&#x62D; &#x644;&#x643; &#x628;&#x627;&#x644;&#x62F;&#x62E;&#x648;&#x644; &#x625;&#x644;&#x649; &#x645;&#x644;&#x641; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x647;&#x630;&#x627;.","ziggeoplayer.video-unknown-error":"&#x644;&#x627; &#x64A;&#x645;&#x643;&#x646;&#x646;&#x627; &#x627;&#x644;&#x648;&#x635;&#x648;&#x644; &#x625;&#x644;&#x649; &#x647;&#x630;&#x627; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x641;&#x64A; &#x627;&#x644;&#x648;&#x642;&#x62A; &#x627;&#x644;&#x62D;&#x627;&#x644;&#x64A;. &#x627;&#x644;&#x631;&#x62C;&#x627;&#x621; &#x645;&#x639;&#x627;&#x648;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629; &#x641;&#x64A; &#x648;&#x642;&#x62A; &#x644;&#x627;&#x62D;&#x642;.","ziggeoplayer.video-rejected":"&#x62A;&#x645; &#x631;&#x641;&#x636; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648;.","ziggeoplayer.video-processing":"&#x64A;&#x62A;&#x645; &#x645;&#x639;&#x627;&#x644;&#x62C;&#x629; &#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; - &#x627;&#x644;&#x631;&#x62C;&#x627;&#x621; &#x627;&#x644;&#x627;&#x646;&#x62A;&#x638;&#x627;&#x631;.","ziggeoplayer.video-access-error":"&#x627;&#x644;&#x641;&#x64A;&#x62F;&#x64A;&#x648; &#x642;&#x64A;&#x62F; &#x627;&#x644;&#x645;&#x631;&#x627;&#x62C;&#x639;&#x629; &#x62D;&#x627;&#x644;&#x64A;&#x627;. &#x64A;&#x645;&#x643;&#x646;&#x643; &#x627;&#x644;&#x646;&#x642;&#x631; &#x644;&#x625;&#x639;&#x627;&#x62F;&#x629; &#x627;&#x644;&#x645;&#x62D;&#x627;&#x648;&#x644;&#x629;."},"language:az":{"application.error_503":"Hal haz&#x131;rda texniki xidm&#x259;t g&#xF6;st&#x259;ririk. Video tezlikl&#x259; geri qaytar&#x131;lacaq.","application.error_404":"Sizin AP&#x130; a&#xE7;ar&#x131; m&#xFC;&#x259;yy&#x259;n ed&#x259; bilm&#x259;dik. Z&#x259;hm&#x259;t olmasa a&#xE7;ar&#x131; veb s&#x259;hif&#x259;nin ba&#x15F;l&#x131;q hiss&#x259;sind&#x259; qeyd edin.","application.error_401":"Sizin t&#x259;tbiq&#x259; bu veb s&#x259;hif&#x259;d&#x259;n daxil olman&#x131;za icaz&#x259; yoxdur.","application.error_412":"Siz&#x259; hesab&#x131;n&#x131;z&#x131; t&#x259;sdiq etm&#x259;k / y&#xFC;ks&#x259;ltm&#x259;k g&#x259;r&#x259;kdir.","application.error_unknown":"Bilinm&#x259;y&#x259;n s&#x259;hv ba&#x15F; verdi. Bizim komandaya x&#x259;b&#x259;r verildi v&#x259; m&#x259;s&#x259;l&#x259;ni h&#x259;ll etm&#x259;y&#x259; &#xE7;al&#x131;&#x15F;&#x131;r&#x131;q.","ziggeoplayer.video-not-found":"Sor&#x11F;u edilmi&#x15F; video fayl&#x131;n&#x131; tapa bilm&#x259;dik.","ziggeoplayer.video-access-forbidden":"Sizin bu video fayla daxil olmaq &#xFC;&#xE7;&#xFC;n icaz&#x259;niz yoxdur.","ziggeoplayer.video-unknown-error":"Biz hal-haz&#x131;rda bu video fayla daxil ola bilm&#x259;dik. Z&#x259;hm&#x259;t olmasa bir az sonra yenid&#x259;n c&#x259;hd edin.","ziggeoplayer.video-rejected":"Video r&#x259;dd edildi.","ziggeoplayer.video-processing":"Video emal olunur - biraz g&#xF6;zl&#x259;yin.","ziggeoplayer.video-access-error":"Video hal haz&#x131;rda emal olunur. Yenid&#x259;n yoxlamaq &#xFC;&#xE7;&#xFC;n basa bil&#x259;rsiz."},"language:bg":{"application.error_503":"&#x41D;&#x438;&#x435; &#x43F;&#x43E;&#x434;&#x434;&#x44A;&#x440;&#x436;&#x430;&#x43C;&#x435; &#x43D;&#x430;&#x448;&#x430;&#x442;&#x430; &#x443;&#x441;&#x43B;&#x443;&#x433;&#x430;. &#x412;&#x438;&#x434;&#x435;&#x43E; &#x449;&#x435; &#x441;&#x435; &#x432;&#x44A;&#x440;&#x43D;&#x435; &#x441;&#x43A;&#x43E;&#x440;&#x43E;.","application.error_404":"&#x41D;&#x438;&#x435; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x440;&#x430;&#x437;&#x43F;&#x43E;&#x437;&#x43D;&#x430;&#x435; &#x432;&#x430;&#x448;&#x438;&#x44F; &#x43A;&#x43B;&#x44E;&#x447; API. &#x41C;&#x43E;&#x43B;&#x44F;, &#x43D;&#x435; &#x437;&#x430;&#x431;&#x440;&#x430;&#x432;&#x44F;&#x439;&#x442;&#x435; &#x434;&#x430; &#x433;&#x43E; &#x43F;&#x43E;&#x441;&#x43E;&#x447;&#x438;&#x442;&#x435; &#x432; &#x437;&#x430;&#x433;&#x43B;&#x430;&#x432;&#x43A;&#x430;&#x442;&#x430; &#x43D;&#x430; &#x443;&#x435;&#x431;&#x441;&#x430;&#x439;&#x442;&#x430; &#x441;&#x438;.","application.error_401":"&#x41D;&#x435; &#x435; &#x440;&#x430;&#x437;&#x440;&#x435;&#x448;&#x435;&#x43D;&#x43E; &#x437;&#x430; &#x434;&#x43E;&#x441;&#x442;&#x44A;&#x43F; &#x434;&#x43E; &#x43F;&#x440;&#x438;&#x43B;&#x43E;&#x436;&#x435;&#x43D;&#x438;&#x435;&#x442;&#x43E; &#x43E;&#x442; &#x442;&#x43E;&#x437;&#x438; &#x441;&#x430;&#x439;&#x442;.","application.error_412":"&#x422;&#x440;&#x44F;&#x431;&#x432;&#x430; &#x434;&#x430; &#x43F;&#x43E;&#x442;&#x432;&#x44A;&#x440;&#x434;&#x438;&#x442;&#x435; / &#x44A;&#x43F;&#x433;&#x440;&#x435;&#x439;&#x434; &#x432;&#x430;&#x448;&#x438;&#x44F; &#x430;&#x43A;&#x430;&#x443;&#x43D;&#x442;.","application.error_unknown":"&#x412;&#x44A;&#x437;&#x43D;&#x438;&#x43A;&#x43D;&#x430; &#x43D;&#x435;&#x438;&#x437;&#x432;&#x435;&#x441;&#x442;&#x43D;&#x430; &#x433;&#x440;&#x435;&#x448;&#x43A;&#x430;. &#x41D;&#x430;&#x448;&#x438;&#x44F;&#x442; &#x435;&#x43A;&#x438;&#x43F; &#x435; &#x431;&#x438;&#x43B; &#x443;&#x432;&#x435;&#x434;&#x43E;&#x43C;&#x435;&#x43D; &#x438; &#x449;&#x435; &#x440;&#x435;&#x448;&#x438; &#x43F;&#x440;&#x43E;&#x431;&#x43B;&#x435;&#x43C;&#x430;.","ziggeoplayer.video-not-found":"&#x41D;&#x438;&#x435; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435; &#x434;&#x430; &#x43D;&#x430;&#x43C;&#x435;&#x440;&#x438; &#x434;&#x430;&#x434;&#x435;&#x43D; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x439;&#x43B;.","ziggeoplayer.video-access-forbidden":"&#x41D;&#x44F;&#x43C;&#x430;&#x442;&#x435; &#x43F;&#x440;&#x430;&#x432;&#x43E; &#x43D;&#x430; &#x434;&#x43E;&#x441;&#x442;&#x44A;&#x43F; &#x434;&#x43E; &#x442;&#x430;&#x437;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x439;&#x43B;.","ziggeoplayer.video-unknown-error":"&#x41D;&#x438;&#x435; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x43C; &#x434;&#x430; &#x43F;&#x43E;&#x43B;&#x443;&#x447;&#x438;&#x442;&#x435; &#x434;&#x43E;&#x441;&#x442;&#x44A;&#x43F; &#x434;&#x43E; &#x442;&#x43E;&#x437;&#x438; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x43A;&#x43B;&#x438;&#x43F; &#x432; &#x43C;&#x43E;&#x43C;&#x435;&#x43D;&#x442;&#x430;. &#x41C;&#x43E;&#x43B;&#x44F;, &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x439;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E; &#x43F;&#x43E;-&#x43A;&#x44A;&#x441;&#x43D;&#x43E;.","ziggeoplayer.video-rejected":"&#x412;&#x438;&#x434;&#x435;&#x43E;&#x442;&#x43E; &#x435; &#x431;&#x438;&#x43B;&#x43E; &#x43E;&#x442;&#x445;&#x432;&#x44A;&#x440;&#x43B;&#x435;&#x43D;&#x43E;.","ziggeoplayer.video-processing":"&#x412;&#x438;&#x434;&#x435;&#x43E;&#x442;&#x43E; &#x435; &#x43E;&#x431;&#x440;&#x430;&#x431;&#x43E;&#x442;&#x43A;&#x430; - &#x43E;&#x441;&#x442;&#x430;&#x43D;&#x435;&#x442;&#x435; &#x43D;&#x430; &#x43B;&#x438;&#x43D;&#x438;&#x44F;.","ziggeoplayer.video-access-error":"&#x412;&#x438;&#x434;&#x435;&#x43E;&#x442;&#x43E; &#x435; &#x432; &#x43F;&#x440;&#x43E;&#x446;&#x435;&#x441; &#x43D;&#x430; &#x443;&#x43C;&#x435;&#x440;&#x435;&#x43D;&#x43E;&#x441;&#x442;. &#x41C;&#x43E;&#x436;&#x435;&#x442;&#x435; &#x434;&#x430; &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435;, &#x437;&#x430; &#x434;&#x430; &#x43E;&#x43F;&#x438;&#x442;&#x430;&#x442;&#x435; &#x43E;&#x442;&#x43D;&#x43E;&#x432;&#x43E;."},"language:cat":{"application.error_503":"Estem mantenint el nostre servei. V&#xED;deos estaran de tornada aviat.","application.error_404":"No podem recon&#xE8;ixer la clau d&#x27;API. Si us plau assegureu-vos d&#x27;especificar que a la cap&#xE7;alera de la seva p&#xE0;gina web.","application.error_401":"No se li permet accedir a l&#x27;aplicaci&#xF3; des d&#x27;aquest lloc.","application.error_412":"Cal confirmar / actualitzar el seu compte.","application.error_unknown":"S&#x27;ha produ&#xEF;t un error desconegut. El nostre equip ha estat notificat i resoldr&#xE0; el problema.","ziggeoplayer.video-not-found":"No hem trobat el fitxer de v&#xED;deo especificat.","ziggeoplayer.video-access-forbidden":"No se li permet accedir a aquest arxiu de v&#xED;deo.","ziggeoplayer.video-unknown-error":"No podem accedir a aquest v&#xED;deo en el moment. Siusplau, intenta-ho m&#xE9;s tard.","ziggeoplayer.video-rejected":"El v&#xED;deo ha estat rebutjat.","ziggeoplayer.video-processing":"El v&#xED;deo est&#xE0; processant - estigueu atents.","ziggeoplayer.video-access-error":"El v&#xED;deo est&#xE0; actualment a la moderaci&#xF3;. Podeu fer clic per tornar a intentar-ho."},"language:da":{"application.error_503":"Vi fastholder vores service. Videoer er snart tilbage.","application.error_404":"Vi kan ikke genkende din API n&#xF8;gle. S&#xF8;rg for at angive det i din hjemmeside overskrift.","application.error_401":"Du har ikke tilladelse til at f&#xE5; adgang til programmet fra dette site.","application.error_412":"Du skal bekr&#xE6;fte / opgradere din konto.","application.error_unknown":"En ukendt fejl opstod. Vores hold er blevet anmeldt og vil l&#xF8;se problemet.","ziggeoplayer.video-not-found":"Vi kunne ikke finde den angivne videofil.","ziggeoplayer.video-access-forbidden":"Det er ikke tilladt at f&#xE5; adgang til denne video-fil.","ziggeoplayer.video-unknown-error":"Vi kan ikke f&#xE5; adgang til denne video i &#xF8;jeblikket. Pr&#xF8;v igen senere.","ziggeoplayer.video-rejected":"Videoen er blevet afvist.","ziggeoplayer.video-processing":"Videoen behandles - Stay tuned.","ziggeoplayer.video-access-error":"Videoen er i &#xF8;jeblikket under moderation. Du kan klikke for at pr&#xF8;ve igen."},"language:de":{"application.error_503":"Das System wird gerade gewartet. Die Videofunktion ist in K&#xFC;rze wieder aktiv.","application.error_404":"Der API Schl&#xFC;ssel wurde nicht gefunden. Bitte &#xFC;berpr&#xFC;fen.","application.error_401":"Der Zugriff auf die Applikation wurde verweigert.","application.error_412":"Ihr Account muss best&#xE4;tigt bzw. f&#xFC;r weitere Videos freigeschaltet werden.","application.error_unknown":"Ein unbekannter Fehler ist aufgetreten. Unser Team wurde dar&#xFC;ber informiert und wird das Problem l&#xF6;sen.","ziggeoplayer.video-not-found":"Das angegebene Video konnte nicht gefunden werden.","ziggeoplayer.video-access-forbidden":"Der Zugriff auf das angegebene Video wurde verweigert.","ziggeoplayer.video-unknown-error":"Auf das angegebene Video kann zur Zeit nicht zugegriffen werden. Bitte zu einem sp&#xE4;teren Zeitpunkt erneut versuchen.","ziggeoplayer.video-rejected":"Das Video wurde nicht freigegeben.","ziggeoplayer.video-processing":"Das Video wird gerade verarbeitet, bitte kurz warten.","ziggeoplayer.video-access-error":"Das Video wird gerade moderiert, bitte etwas sp&#xE4;ter erneut versuchen."},"language:es":{"application.error_503":"Nuestro servicio se encuentra en mantenimiento. Los v&#xED;deos estar&#xE1;n de vuelta pronto.","application.error_404":"No podemos reconocer la clave de la API. Por favor aseg&#xFA;rese de especificarla en la cabecera de su p&#xE1;gina web.","application.error_401":"No tiene permitido acceder a la aplicaci&#xF3;n desde este sitio.","application.error_412":"Es necesario confirmar / actualizar su cuenta.","application.error_unknown":"Ocurri&#xF3; un error desconocido. Nuestro equipo ha sido notificado y resolver&#xE1; el problema.","ziggeoplayer.video-not-found":"No hemos podido encontrar el archivo de v&#xED;deo especificado.","ziggeoplayer.video-access-forbidden":"No se le permite acceder a este archivo de v&#xED;deo.","ziggeoplayer.video-unknown-error":"No podemos acceder a este v&#xED;deo por el momento. Por favor, int&#xE9;ntelo de nuevo m&#xE1;s tarde.","ziggeoplayer.video-rejected":"El v&#xED;deo ha sido rechazado.","ziggeoplayer.video-processing":"El v&#xED;deo est&#xE1; siendo procesado - estad atentos.","ziggeoplayer.video-access-error":"El v&#xED;deo est&#xE1; actualmente en moderaci&#xF3;n. Puede hacer clic para volver a intentarlo."},"language:fi":{"application.error_503":"Pid&#xE4;mme palvelumme. Videoita pian takaisin.","application.error_404":"Emme voi tunnista api avain. Muista m&#xE4;&#xE4;ritt&#xE4;&#xE4; sen sivuston otsikon.","application.error_401":"Sinulla ei ole oikeutta k&#xE4;ytt&#xE4;&#xE4; sovelluksen t&#xE4;st&#xE4; sivustosta.","application.error_412":"Sinun t&#xE4;ytyy vahvistaa / p&#xE4;ivitt&#xE4;&#xE4; tilin.","application.error_unknown":"Tuntematon virhe. Tiimimme on tehty ilmoitus ja ratkaisee ongelman.","ziggeoplayer.video-not-found":"Emme l&#xF6;yt&#xE4;neet m&#xE4;&#xE4;ritetyn videotiedoston.","ziggeoplayer.video-access-forbidden":"Sinulla ei ole oikeutta k&#xE4;ytt&#xE4;&#xE4; t&#xE4;t&#xE4; videotiedoston.","ziggeoplayer.video-unknown-error":"Emme voi k&#xE4;ytt&#xE4;&#xE4; t&#xE4;t&#xE4; videota t&#xE4;ll&#xE4; hetkell&#xE4;. Yrit&#xE4; uudelleen my&#xF6;hemmin.","ziggeoplayer.video-rejected":"Video on hyl&#xE4;tty.","ziggeoplayer.video-processing":"Videota k&#xE4;sitell&#xE4;&#xE4;n - pysy kuulolla.","ziggeoplayer.video-access-error":"Video on parhaillaan maltillisesti. Voit yrit&#xE4; uudelleen klikkaamalla."},"language:fr":{"application.error_503":"Notre service est en maintenance ou service en maintenance. Les vid&#xE9;os seront bient&#xF4;t de retours.","application.error_404":"Nous ne pouvons lire ou reconnaitre votre cl&#xE9; API. Assurez vous qu&#x2019;elle soit connect&#xE9;e avec l&#x2019;ent&#xEA;te du site web.","application.error_401":"Vous n&#x2019;&#xEA;tes pas autoris&#xE9; &#xE0; acc&#xE9;der &#xE0; l&#x2019;application depuis ce site.","application.error_412":"Vous devez confirmer/ veuillez mettre &#xE0; jour votre compte.","application.error_unknown":"Une erreur s&#x2019;est produite, notre &#xE9;quipe a &#xE9;t&#xE9; pr&#xE9;venue et interviendra dans les meilleurs d&#xE9;lais.","ziggeoplayer.video-not-found":"Nous ne pouvons trouver votre fichier vid&#xE9;o.","ziggeoplayer.video-access-forbidden":"Vous n&#x2019;&#xEA;tes pas autoris&#xE9; &#xE0; accede &#xE0; ce fichier vid&#xE9;o.","ziggeoplayer.video-unknown-error":"Nous ne pouvons pas acc&#xE9;der &#xE0; cette vid&#xE9;o pour le moment - R&#xE9;essayez plus tard.","ziggeoplayer.video-rejected":"La vid&#xE9;o a &#xE9;t&#xE9; rejet&#xE9;e.","ziggeoplayer.video-processing":"La vid&#xE9;o est en cours de traitement - restez &#xE0; l&#x27;&#xE9;coute.","ziggeoplayer.video-access-error":"La vid&#xE9;o est en cours de mod&#xE9;ration. Vous pouvez cliquer pour r&#xE9;essayer."},"language:hi":{"application.error_503":"&#x939;&#x92E; &#x905;&#x92A;&#x928;&#x940; &#x938;&#x947;&#x935;&#x93E; &#x915;&#x94B; &#x92C;&#x928;&#x93E;&#x90F; &#x930;&#x916;&#x924;&#x947; &#x939;&#x948;&#x902; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x91C;&#x932;&#x94D;&#x926; &#x939;&#x940; &#x935;&#x93E;&#x92A;&#x938; &#x906; &#x91C;&#x93E;&#x90F;&#x902;&#x917;&#x947;","application.error_404":"&#x939;&#x92E; &#x906;&#x92A;&#x915;&#x940; &#x90F;&#x92A;&#x940;&#x906;&#x908; &#x915;&#x941;&#x902;&#x91C;&#x940; &#x915;&#x94B; &#x928;&#x939;&#x940;&#x902; &#x92A;&#x939;&#x91A;&#x93E;&#x928; &#x938;&#x915;&#x924;&#x947; &#x915;&#x943;&#x92A;&#x92F;&#x93E; &#x907;&#x938;&#x947; &#x905;&#x92A;&#x928;&#x940; &#x935;&#x947;&#x92C;&#x938;&#x93E;&#x907;&#x91F; &#x915;&#x947; &#x939;&#x947;&#x921;&#x930; &#x92E;&#x947;&#x902; &#x928;&#x93F;&#x930;&#x94D;&#x926;&#x93F;&#x937;&#x94D;&#x91F; &#x915;&#x930;&#x928;&#x93E; &#x938;&#x941;&#x928;&#x93F;&#x936;&#x94D;&#x91A;&#x93F;&#x924; &#x915;&#x930;&#x947;&#x902;","application.error_401":"&#x906;&#x92A;&#x915;&#x94B; &#x907;&#x938; &#x938;&#x93E;&#x907;&#x91F; &#x938;&#x947; &#x906;&#x935;&#x947;&#x926;&#x928; &#x924;&#x915; &#x92A;&#x939;&#x941;&#x902;&#x91A;&#x928;&#x947; &#x915;&#x940; &#x905;&#x928;&#x941;&#x92E;&#x924;&#x93F; &#x928;&#x939;&#x940;&#x902; &#x939;&#x948;&#x964;","application.error_412":"&#x906;&#x92A;&#x915;&#x94B; &#x905;&#x92A;&#x928;&#x947; &#x916;&#x93E;&#x924;&#x947; &#x915;&#x940; &#x92A;&#x941;&#x937;&#x94D;&#x91F;&#x93F; / &#x905;&#x92A;&#x917;&#x94D;&#x930;&#x947;&#x921; &#x915;&#x930;&#x928;&#x947; &#x915;&#x940; &#x906;&#x935;&#x936;&#x94D;&#x92F;&#x915;&#x924;&#x93E; &#x939;&#x948;&#x964;","application.error_unknown":"&#x90F;&#x915; &#x905;&#x91C;&#x94D;&#x91E;&#x93E;&#x924; &#x924;&#x94D;&#x930;&#x941;&#x91F;&#x93F; &#x939;&#x941;&#x908; &#x939;&#x92E;&#x93E;&#x930;&#x940; &#x91F;&#x940;&#x92E; &#x915;&#x94B; &#x938;&#x942;&#x91A;&#x93F;&#x924; &#x915;&#x93F;&#x92F;&#x93E; &#x917;&#x92F;&#x93E; &#x939;&#x948; &#x914;&#x930; &#x907;&#x938; &#x92E;&#x941;&#x926;&#x94D;&#x926;&#x947; &#x915;&#x94B; &#x939;&#x932; &#x915;&#x930;&#x947;&#x917;&#x93E;&#x964;","ziggeoplayer.video-not-found":"&#x939;&#x92E;&#x947;&#x902; &#x928;&#x93F;&#x930;&#x94D;&#x926;&#x93F;&#x937;&#x94D;&#x91F; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92B;&#x93C;&#x93E;&#x907;&#x932; &#x928;&#x939;&#x940;&#x902; &#x92E;&#x93F;&#x932;&#x940;&#x964;","ziggeoplayer.video-access-forbidden":"&#x906;&#x92A;&#x915;&#x94B; &#x907;&#x938; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92B;&#x93C;&#x93E;&#x907;&#x932; &#x915;&#x94B; &#x90F;&#x915;&#x94D;&#x938;&#x947;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x940; &#x905;&#x928;&#x941;&#x92E;&#x924;&#x93F; &#x928;&#x939;&#x940;&#x902; &#x939;&#x948;&#x964;","ziggeoplayer.video-unknown-error":"&#x939;&#x92E; &#x907;&#x938; &#x938;&#x92E;&#x92F; &#x907;&#x938; &#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x915;&#x94B; &#x90F;&#x915;&#x94D;&#x938;&#x947;&#x938; &#x928;&#x939;&#x940;&#x902; &#x915;&#x930; &#x938;&#x915;&#x924;&#x947;&#x964; &#x92C;&#x93E;&#x926; &#x92E;&#x947;&#x902; &#x92A;&#x941;&#x928;: &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x947;&#x902;&#x964;","ziggeoplayer.video-rejected":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x915;&#x94B; &#x905;&#x938;&#x94D;&#x935;&#x940;&#x915;&#x93E;&#x930; &#x915;&#x930; &#x926;&#x93F;&#x92F;&#x93E; &#x917;&#x92F;&#x93E; &#x939;&#x948;&#x964;","ziggeoplayer.video-processing":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x92A;&#x94D;&#x930;&#x94B;&#x938;&#x947;&#x938;&#x93F;&#x902;&#x917; &#x939;&#x948; - &#x926;&#x947;&#x916;&#x924;&#x947; &#x930;&#x939;&#x947;&#x902;","ziggeoplayer.video-access-error":"&#x935;&#x940;&#x921;&#x93F;&#x92F;&#x94B; &#x935;&#x930;&#x94D;&#x924;&#x92E;&#x93E;&#x928; &#x92E;&#x947;&#x902; &#x92E;&#x949;&#x921;&#x930;&#x947;&#x936;&#x928; &#x915;&#x947; &#x905;&#x902;&#x924;&#x930;&#x94D;&#x917;&#x924; &#x939;&#x948; &#x906;&#x92A; &#x92B;&#x93F;&#x930; &#x938;&#x947; &#x92A;&#x94D;&#x930;&#x92F;&#x93E;&#x938; &#x915;&#x930;&#x928;&#x947; &#x915;&#x947; &#x932;&#x93F;&#x90F; &#x915;&#x94D;&#x932;&#x93F;&#x915; &#x915;&#x930; &#x938;&#x915;&#x924;&#x947; &#x939;&#x948;&#x902;&#x964;"},"language:hr":{"application.error_503":"Dr&#x17E;imo na&#x161;e usluge. Video &#x107;e se uskoro vratiti.","application.error_404":"Ne mo&#x17E;emo prepoznati svoj API klju&#x10D;. Obavezno nazna&#x10D;iti to u va&#x161;e web stranice napada&#x10D;a.","application.error_401":"Ne mogu pristupiti aplikacija s ove stranice.","application.error_412":"Morate potvrditi / nadograditi svoj ra&#x10D;un.","application.error_unknown":"Do&#x161;lo je do nepoznate pogre&#x161;ke. Na&#x161; tim je obavije&#x161;ten i da &#x107;e rije&#x161;iti problem.","ziggeoplayer.video-not-found":"Nismo mogli prona&#x107;i navedenu datoteku videozapisa.","ziggeoplayer.video-access-forbidden":"Ne smiju pristupiti ovom video datoteku.","ziggeoplayer.video-unknown-error":"Ne mogu pristupiti ovaj video u tom trenutku. Molimo poku&#x161;ajte ponovo kasnije.","ziggeoplayer.video-rejected":"Video je odbijen.","ziggeoplayer.video-processing":"Video obra&#x111;uje - Stay tuned.","ziggeoplayer.video-access-error":"Spot je trenutno u umjerenim koli&#x10D;inama. Mo&#x17E;ete kliknuti na ponovni poku&#x161;aj."},"language:hu":{"application.error_503":"Mi fenntart&#xE1;sa a szolg&#xE1;ltat&#xE1;st. Vide&#xF3; hamarosan visszat&#xE9;r.","application.error_404":"Nem lehet felismerni az API-kulcsot. K&#xE9;rj&#xFC;k, hogy adja meg a webhely fejl&#xE9;c&#xE9;ben.","application.error_401":"&#xD6;n nem jogosult hozz&#xE1;f&#xE9;rni az alkalmaz&#xE1;s ezen az oldalon.","application.error_412":"Meg kell er&#x151;s&#xED;tenie / friss&#xED;tse a sz&#xE1;mla.","application.error_unknown":"Ismeretlen hiba t&#xF6;rt&#xE9;nt. Csapatunk m&#xE1;r bejelentett, &#xE9;s megoldja a probl&#xE9;m&#xE1;t.","ziggeoplayer.video-not-found":"Nem tal&#xE1;ltunk a megadott vide&#xF3; f&#xE1;jlt.","ziggeoplayer.video-access-forbidden":"&#xD6;n nem jogosult hozz&#xE1;f&#xE9;rni a vide&#xF3; f&#xE1;jlt.","ziggeoplayer.video-unknown-error":"Nem tudjuk el&#xE9;rni ezt a vide&#xF3;t a pillanatban. K&#xE9;rlek, pr&#xF3;b&#xE1;ld &#xFA;jra k&#xE9;s&#x151;bb.","ziggeoplayer.video-rejected":"A vide&#xF3; elutas&#xED;t&#xE1;sra ker&#xFC;lt.","ziggeoplayer.video-processing":"A vide&#xF3; feldolgoz&#xE1;s - a h&#xED;rad&#xE1;sokat.","ziggeoplayer.video-access-error":"A vide&#xF3; jelenleg a moder&#xE1;l&#xE1;s. Lehet kattint&#xE1;ssal &#xFA;jra."},"language:id":{"application.error_503":"Kami menjaga layanan kami. Video akan segera kembali.","application.error_404":"Kami tidak dapat mengenali kunci api Anda. Pastikan untuk menentukannya di header situs web Anda.","application.error_401":"Anda tidak diizinkan mengakses aplikasi dari situs ini.","application.error_412":"Anda perlu mengkonfirmasi / meningkatkan akun Anda.","application.error_unknown":"Terjadi kesalahan yang tidak diketahui. Tim kami telah diberi tahu dan akan menyelesaikan masalah ini.","ziggeoplayer.video-not-found":"Kami tidak dapat menemukan file video yang ditentukan.","ziggeoplayer.video-access-forbidden":"Anda tidak diizinkan mengakses file video ini.","ziggeoplayer.video-unknown-error":"Saat ini kami tidak dapat mengakses video ini. Silakan coba lagi nanti.","ziggeoplayer.video-rejected":"Video telah ditolak","ziggeoplayer.video-processing":"Video sedang diproses - nantikan.","ziggeoplayer.video-access-error":"Video saat ini sedang dalam moderasi. Anda bisa mengklik untuk mencoba lagi."},"language:it":{"application.error_503":"Stiamo mantenendo il nostro servizio. Video torneranno presto.","application.error_404":"Non possiamo riconoscere la chiave API. Assicurati di specificare che nell&#x27;intestazione del tuo sito web.","application.error_401":"Non &#xE8; consentito di accedere all&#x27;applicazione da questo sito.","application.error_412":"&#xC8; necessario confermare / aggiornare il tuo account.","application.error_unknown":"Un errore sconosciuto si &#xE8; verificato. La nostra squadra &#xE8; stata notifica e dovr&#xE0; risolvere il problema.","ziggeoplayer.video-not-found":"Non siamo riusciti a trovare il file video specificato.","ziggeoplayer.video-access-forbidden":"Non &#xE8; consentito per accedere a questo file video.","ziggeoplayer.video-unknown-error":"Non possiamo accedere a questo video in questo momento. Per favore riprova pi&#xF9; tardi.","ziggeoplayer.video-rejected":"Il video &#xE8; stato rifiutato.","ziggeoplayer.video-processing":"Il video &#xE8; in fase di elaborazione - rimanete sintonizzati.","ziggeoplayer.video-access-error":"Il video &#xE8; attualmente in fase di moderazione. &#xC8; possibile fare clic per riprovare."},"language:nl":{"application.error_503":"Wij handhaven onze service. Video&#x27;s zullen snel terug zijn.","application.error_404":"We kunnen niet herkent uw API-sleutel. Zorg ervoor om het te specificeren in de header van uw website.","application.error_401":"Het is niet toegestaan &#x200B;&#x200B;om de toepassing van deze site.","application.error_412":"Je nodig hebt om te bevestigen / uw account upgraden.","application.error_unknown":"Er is een onbekende fout opgetreden. Ons team is aangemeld en zal het probleem op te lossen.","ziggeoplayer.video-not-found":"We konden het opgegeven video-bestand niet vinden.","ziggeoplayer.video-access-forbidden":"U bent niet toegestaan &#x200B;&#x200B;om toegang tot dit videobestand.","ziggeoplayer.video-unknown-error":"We hebben geen toegang tot deze video op dit moment. Probeer het later opnieuw.","ziggeoplayer.video-rejected":"De video is geweigerd.","ziggeoplayer.video-processing":"De video wordt verwerkt - stay tuned.","ziggeoplayer.video-access-error":"De video is momenteel in matiging. U kunt klikken om opnieuw te proberen."},"language:no":{"application.error_503":"Vi opprettholder v&#xE5;r tjeneste. Videoer vil v&#xE6;re tilbake snart.","application.error_404":"Vi kan ikke gjenkjenne din API-n&#xF8;kkel. Vennligst s&#xF8;rg for &#xE5; spesifisere det i nettstedets spissen.","application.error_401":"Du har ikke lov til &#xE5; f&#xE5; tilgang til programmet fra denne siden.","application.error_412":"Du m&#xE5; bekrefte / oppgradere kontoen din.","application.error_unknown":"En ukjent feil oppstod. V&#xE5;rt team har blitt informert og l&#xF8;se problemet.","ziggeoplayer.video-not-found":"Vi kunne ikke finne den angitte videofilen.","ziggeoplayer.video-access-forbidden":"Du har ikke tillatelse til &#xE5; f&#xE5; tilgang til denne videofilen.","ziggeoplayer.video-unknown-error":"Vi har ikke tilgang til denne videoen i &#xF8;yeblikket. Pr&#xF8;v igjen senere.","ziggeoplayer.video-rejected":"Videoen har blitt avvist.","ziggeoplayer.video-processing":"Videoen behandler - f&#xF8;lg med.","ziggeoplayer.video-access-error":"Videoen er under moderering. Du kan klikke for &#xE5; pr&#xF8;ve igjen."},"language:pl":{"application.error_503":"Podtrzymujemy nasz&#x105; us&#x142;ug&#x119;. Filmy b&#x119;d&#x105; wkr&#xF3;tce.","application.error_404":"Nie mo&#x17C;emy rozpozna&#x107; sw&#xF3;j klucz API. Pami&#x119;taj, aby poda&#x107; go w nag&#x142;&#xF3;wku witryny.","application.error_401":"Nie masz uprawnie&#x144;, aby uzyska&#x107; dost&#x119;p do aplikacji z tej strony.","application.error_412":"Musisz potwierdzi&#x107; / upgrade konta.","application.error_unknown":"Wyst&#x105;pi&#x142; nieznany b&#x142;&#x105;d. Nasz zesp&#xF3;&#x142; zosta&#x142; powiadomiony i b&#x119;dzie rozwi&#x105;za&#x107; problem.","ziggeoplayer.video-not-found":"Nie mo&#x17C;na znale&#x17A;&#x107; okre&#x15B;lonego pliku wideo.","ziggeoplayer.video-access-forbidden":"Nie masz wystarczaj&#x105;cych uprawnie&#x144;, aby uzyska&#x107; dost&#x119;p do tego pliku wideo.","ziggeoplayer.video-unknown-error":"Nie mo&#x17C;emy uzyska&#x107; dost&#x119;p do tego filmu w tym momencie. Spr&#xF3;buj ponownie p&#xF3;&#x17A;niej.","ziggeoplayer.video-rejected":"Film zosta&#x142; odrzucony.","ziggeoplayer.video-processing":"Film jest przetwarzanie - stay tuned.","ziggeoplayer.video-access-error":"Film jest obecnie w umiarkowanych ilo&#x15B;ciach. Mo&#x17C;na klikn&#x105;&#x107;, aby ponowi&#x107; pr&#xF3;b&#x119;."},"language:pt-br":{"application.error_503":"Estamos mantendo o nosso servi&#xE7;o. V&#xED;deos estar&#xE1; de volta em breve.","application.error_404":"N&#xF3;s n&#xE3;o podemos reconhecer a sua chave de API. Por favor, certifique-se de especific&#xE1;-lo no cabe&#xE7;alho do seu site.","application.error_401":"Voc&#xEA; n&#xE3;o tem permiss&#xE3;o para acessar o aplicativo a partir deste site.","application.error_412":"Voc&#xEA; precisa confirmar / actualizar a sua conta.","application.error_unknown":"Ocorreu um erro desconhecido. Nossa equipe foi notificado e resolver o problema.","ziggeoplayer.video-not-found":"N&#xE3;o foi poss&#xED;vel encontrar o arquivo de v&#xED;deo especificado.","ziggeoplayer.video-access-forbidden":"Voc&#xEA; n&#xE3;o tem permiss&#xE3;o para acessar esse arquivo de v&#xED;deo.","ziggeoplayer.video-unknown-error":"N&#xE3;o podemos acessar este v&#xED;deo no momento. Por favor, tente novamente mais tarde.","ziggeoplayer.video-rejected":"O v&#xED;deo foi rejeitada.","ziggeoplayer.video-processing":"O v&#xED;deo est&#xE1; processando - fique atento.","ziggeoplayer.video-access-error":"O v&#xED;deo est&#xE1; em modera&#xE7;&#xE3;o. Voc&#xEA; pode clicar para tentar novamente."},"language:pt":{"application.error_503":"O nosso servi&#xE7;o est&#xE1; em manuten&#xE7;&#xE3;o. Os v&#xED;deos voltar&#xE3;o em breve.","application.error_404":"N&#xE3;o reconhecemos a sua chave api. Certifique-se de especific&#xE1;-la no seu cabe&#xE7;alho do site.","application.error_401":"N&#xE3;o tem permiss&#xF5;es para aceder a esta aplica&#xE7;&#xE3;o.","application.error_412":"Tem de confirmar / atualizar a sua conta.","application.error_unknown":"Ocorreu um erro desconhecido. A nossa equipa foi notificada e ir&#xE1; resolver o problema.","ziggeoplayer.video-not-found":"N&#xE3;o foi poss&#xED;vel encontrar o v&#xED;deo especificado.","ziggeoplayer.video-access-forbidden":"N&#xE3;o tem permiss&#xF5;es para aceder a este v&#xED;deo.","ziggeoplayer.video-unknown-error":"N&#xE3;o conseguimos aceder a este v&#xED;deo neste momento. Por favor, tente de novo mais tarde.","ziggeoplayer.video-rejected":"O v&#xED;deo foi rejeitado.","ziggeoplayer.video-processing":"O v&#xED;deo est&#xE1; em processamento - fique atento.","ziggeoplayer.video-access-error":"O v&#xED;deo est&#xE1; atualmente sob modera&#xE7;&#xE3;o. Pode clicar para tentar novamente."},"language:ro":{"application.error_503":"Ne men&#x21B;inem serviciul nostru. Videoclipurile vor reveni &#xEE;n cur&#xE2;nd.","application.error_404":"Noi nu putem recunoaste cheia API-ului. Asigura&#x21B;i-v&#x103; c&#x103; specifica&#x21B;i acest lucru &#xEE;n antetul site-ului.","application.error_401":"Nu ave&#x21B;i permisiunea de a accesa aplica&#x21B;ia de pe acest site.","application.error_412":"Trebuie s&#x103; confirma&#x21B;i / actualiza&#x21B;i contul.","application.error_unknown":"A ap&#x103;rut o eroare necunoscut&#x103;. Echipa noastr&#x103; a fost notificat&#x103; &#x219;i va rezolva problema.","ziggeoplayer.video-not-found":"Nu am putut g&#x103;si fi&#x219;ierul video specificat.","ziggeoplayer.video-access-forbidden":"Nu ave&#x21B;i permisiunea de a accesa acest fi&#x219;ier video.","ziggeoplayer.video-unknown-error":"Noi nu putem avea acces la acest video la acest moment. V&#x103; rug&#x103;m s&#x103; &#xEE;ncerca&#x21B;i din nou mai t&#xE2;rziu.","ziggeoplayer.video-rejected":"Videoclipul a fost respins.","ziggeoplayer.video-processing":"Videoclipul este de prelucrare - urm&#x103;ri&#x21B;i.","ziggeoplayer.video-access-error":"Video este &#xEE;n prezent &#xEE;n curs de moderare. Ave&#x21B;i dreptul s&#x103; face&#x21B;i clic pentru a &#xEE;ncerca din nou."},"language:ru":{"application.error_503":"&#x41C;&#x44B; &#x43D;&#x430; &#x442;&#x435;&#x445;&#x43D;&#x438;&#x447;&#x435;&#x441;&#x43A;&#x43E;&#x43C; &#x43E;&#x431;&#x441;&#x43B;&#x443;&#x436;&#x438;&#x432;&#x430;&#x43D;&#x438;&#x438;. &#x412;&#x438;&#x434;&#x435;&#x43E; &#x441;&#x43A;&#x43E;&#x440;&#x43E; &#x432;&#x435;&#x440;&#x43D;&#x443;&#x442;&#x441;&#x44F;.","application.error_404":"&#x41C;&#x44B; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x43C; &#x440;&#x430;&#x441;&#x43F;&#x43E;&#x437;&#x43D;&#x430;&#x442;&#x44C; &#x432;&#x430;&#x448; &#x43A;&#x43B;&#x44E;&#x447; api. &#x41D;&#x435; &#x437;&#x430;&#x431;&#x443;&#x434;&#x44C;&#x442;&#x435; &#x443;&#x43A;&#x430;&#x437;&#x430;&#x442;&#x44C; &#x435;&#x433;&#x43E; &#x432; &#x437;&#x430;&#x433;&#x43E;&#x43B;&#x43E;&#x432;&#x43A;&#x435; &#x441;&#x432;&#x43E;&#x435;&#x433;&#x43E; &#x432;&#x435;&#x431;-&#x441;&#x430;&#x439;&#x442;&#x430;.","application.error_401":"&#x423; &#x432;&#x430;&#x441; &#x43D;&#x435;&#x442; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;&#x430; &#x43A; &#x43F;&#x440;&#x438;&#x43B;&#x43E;&#x436;&#x435;&#x43D;&#x438;&#x44E; &#x441; &#x44D;&#x442;&#x43E;&#x433;&#x43E; &#x441;&#x430;&#x439;&#x442;&#x430;.","application.error_412":"&#x412;&#x430;&#x43C; &#x43D;&#x435;&#x43E;&#x431;&#x445;&#x43E;&#x434;&#x438;&#x43C;&#x43E; &#x43F;&#x43E;&#x434;&#x442;&#x432;&#x435;&#x440;&#x434;&#x438;&#x442;&#x44C; / &#x43E;&#x431;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x44C; &#x441;&#x432;&#x43E;&#x44E; &#x443;&#x447;&#x435;&#x442;&#x43D;&#x443;&#x44E; &#x437;&#x430;&#x43F;&#x438;&#x441;&#x44C;.","application.error_unknown":"&#x41F;&#x440;&#x43E;&#x438;&#x437;&#x43E;&#x448;&#x43B;&#x430; &#x43D;&#x435;&#x438;&#x437;&#x432;&#x435;&#x441;&#x442;&#x43D;&#x430;&#x44F; &#x43E;&#x448;&#x438;&#x431;&#x43A;&#x430;. &#x41D;&#x430;&#x448;&#x430; &#x43A;&#x43E;&#x43C;&#x430;&#x43D;&#x434;&#x430; &#x43F;&#x43E;&#x43B;&#x443;&#x447;&#x438;&#x43B;&#x430; &#x443;&#x432;&#x435;&#x434;&#x43E;&#x43C;&#x43B;&#x435;&#x43D;&#x438;&#x435; &#x438; &#x43C;&#x44B; &#x440;&#x435;&#x448;&#x438;&#x43C; &#x43F;&#x440;&#x43E;&#x431;&#x43B;&#x435;&#x43C;&#x443;.","ziggeoplayer.video-not-found":"&#x41D;&#x435; &#x443;&#x434;&#x430;&#x43B;&#x43E;&#x441;&#x44C; &#x43D;&#x430;&#x439;&#x442;&#x438; &#x443;&#x43A;&#x430;&#x437;&#x430;&#x43D;&#x43D;&#x44B;&#x439; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x444;&#x430;&#x439;&#x43B;.","ziggeoplayer.video-access-forbidden":"&#x412;&#x430;&#x43C; &#x43D;&#x435; &#x440;&#x430;&#x437;&#x440;&#x435;&#x448;&#x435;&#x43D; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F; &#x43A; &#x44D;&#x442;&#x43E;&#x43C;&#x443; &#x432;&#x438;&#x434;&#x435;&#x43E;&#x444;&#x430;&#x439;&#x43B;&#x443;.","ziggeoplayer.video-unknown-error":"&#x412; &#x43D;&#x430;&#x441;&#x442;&#x43E;&#x44F;&#x449;&#x435;&#x435; &#x432;&#x440;&#x435;&#x43C;&#x44F; &#x443; &#x43D;&#x430;&#x441; &#x43D;&#x435;&#x442; &#x434;&#x43E;&#x441;&#x442;&#x443;&#x43F;&#x430; &#x43A; &#x44D;&#x442;&#x43E;&#x43C;&#x443; &#x432;&#x438;&#x434;&#x435;&#x43E;. &#x41F;&#x43E;&#x436;&#x430;&#x43B;&#x443;&#x439;&#x441;&#x442;&#x430;, &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x435; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443; &#x43F;&#x43E;&#x437;&#x436;&#x435;.","ziggeoplayer.video-rejected":"&#x412;&#x438;&#x434;&#x435;&#x43E; &#x43E;&#x442;&#x43A;&#x43B;&#x43E;&#x43D;&#x435;&#x43D;&#x43E;.","ziggeoplayer.video-processing":"&#x412;&#x438;&#x434;&#x435;&#x43E; &#x43E;&#x431;&#x440;&#x430;&#x431;&#x430;&#x442;&#x44B;&#x432;&#x430;&#x435;&#x442;&#x441;&#x44F; - &#x441;&#x43B;&#x435;&#x434;&#x438;&#x442;&#x435; &#x437;&#x430; &#x43E;&#x431;&#x43D;&#x43E;&#x432;&#x43B;&#x435;&#x43D;&#x438;&#x44F;&#x43C;&#x438;.","ziggeoplayer.video-access-error":"&#x412; &#x43D;&#x430;&#x441;&#x442;&#x43E;&#x44F;&#x449;&#x435;&#x435; &#x432;&#x440;&#x435;&#x43C;&#x44F; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x43D;&#x430; &#x43C;&#x43E;&#x434;&#x435;&#x440;&#x430;&#x446;&#x438;&#x438;. &#x41D;&#x430;&#x436;&#x43C;&#x438;&#x442;&#x435;, &#x447;&#x442;&#x43E;&#x431;&#x44B; &#x43F;&#x43E;&#x432;&#x442;&#x43E;&#x440;&#x438;&#x442;&#x44C; &#x43F;&#x43E;&#x43F;&#x44B;&#x442;&#x43A;&#x443;."},"language:sk":{"application.error_503":"T&#xFA;to slu&#x17E;bu pr&#xE1;ve vylep&#x161;ujeme. Mo&#x17E;nos&#x165; nahrania video&#x17E;ivotopisu bude dostupn&#xE1; u&#x17E; onedlho. T&#xFA;to slu&#x17E;bu pr&#xE1;ve vylep&#x161;ujeme. Mo&#x17E;nos&#x165; nahrania video&#x17E;ivotopisu bude op&#xE4;tovne spusten&#xE1; u&#x17E; onedlho.","application.error_404":"Nedar&#xED; sa n&#xE1;m rozpozna&#x165; V&#xE1;&#x161; API k&#x13E;&#xFA;&#x10D;. Uistite sa, pros&#xED;m, &#x10D;i ho m&#xE1;te v hlavi&#x10D;ke V&#xE1;&#x161;ho webu.","application.error_401":"Nem&#xE1;te pr&#xED;stup k aplik&#xE1;cii na tejto str&#xE1;nke.","application.error_412":"Mus&#xED;te potvrdi&#x165; / aktualizova&#x165; svoj &#xFA;&#x10D;et.","application.error_unknown":"Vyskytla sa nezn&#xE1;ma chyba. N&#xE1;&#x161; t&#xED;m bol upozornen&#xFD; a bude tento probl&#xE9;m rie&#x161;i&#x165;.","ziggeoplayer.video-not-found":"Nepodarilo sa n&#xE1;m n&#xE1;js&#x165; zadan&#xFD; video s&#xFA;bor.","ziggeoplayer.video-access-forbidden":"K tomuto video s&#xFA;boru nem&#xE1;te povolen&#xFD; pr&#xED;stup.","ziggeoplayer.video-unknown-error":"K tomuto videu nem&#xE1;me moment&#xE1;lne pr&#xED;stup. Sk&#xFA;ste nesk&#xF4;r pros&#xED;m.","ziggeoplayer.video-rejected":"Video bolo zamietnut&#xE9;.","ziggeoplayer.video-processing":"Video sa spracov&#xE1;va.","ziggeoplayer.video-access-error":"Video je moment&#xE1;lne pou&#x17E;&#xED;van&#xE9;. Kliknut&#xED;m sk&#xFA;ste znova."},"language:sr":{"application.error_503":"&#x41C;&#x438; &#x441;&#x43C;&#x43E; &#x43E;&#x434;&#x440;&#x436;&#x430;&#x432;&#x430;&#x45A;&#x435; &#x43D;&#x430;&#x448;&#x435; &#x443;&#x441;&#x43B;&#x443;&#x433;&#x435;. &#x412;&#x438;&#x434;&#x435;&#x43E; &#x45B;&#x435; &#x441;&#x435; &#x432;&#x440;&#x430;&#x442;&#x438;&#x442;&#x438; &#x443;&#x441;&#x43A;&#x43E;&#x440;&#x43E;.","application.error_404":"&#x41D;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x43C;&#x43E; &#x43F;&#x440;&#x435;&#x43F;&#x43E;&#x437;&#x43D;&#x430;&#x442;&#x438; &#x43A;&#x459;&#x443;&#x447; &#x410;&#x41F;&#x418;-&#x458;&#x430;. &#x423;&#x432;&#x435;&#x440;&#x438;&#x442;&#x435; &#x441;&#x435; &#x434;&#x430; &#x458;&#x435; &#x43D;&#x430;&#x432;&#x435;&#x434;&#x435;&#x442;&#x435; &#x443; &#x437;&#x430;&#x433;&#x43B;&#x430;&#x432;&#x459;&#x443; &#x432;&#x430;&#x448;&#x435;&#x433; &#x432;&#x435;&#x431;-&#x441;&#x430;&#x458;&#x442;&#x430;.","application.error_401":"&#x41D;&#x438;&#x441;&#x442;&#x435; &#x434;&#x43E;&#x437;&#x432;&#x43E;&#x459;&#x435;&#x43D; &#x43F;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43F; &#x430;&#x43F;&#x43B;&#x438;&#x43A;&#x430;&#x446;&#x438;&#x458;&#x443; &#x441;&#x430; &#x43E;&#x432;&#x43E;&#x433; &#x441;&#x430;&#x458;&#x442;&#x430;.","application.error_412":"&#x41F;&#x43E;&#x442;&#x440;&#x435;&#x431;&#x43D;&#x43E; &#x458;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x442;&#x432;&#x440;&#x434;&#x438;&#x442;&#x435; / &#x43D;&#x430;&#x434;&#x43E;&#x433;&#x440;&#x430;&#x434;&#x438;&#x442;&#x435; &#x43D;&#x430;&#x43B;&#x43E;&#x433;.","application.error_unknown":"&#x41D;&#x435;&#x43F;&#x43E;&#x437;&#x43D;&#x430;&#x442;&#x435; &#x433;&#x440;&#x435;&#x448;&#x43A;&#x435;. &#x41D;&#x430;&#x448; &#x442;&#x438;&#x43C; &#x458;&#x435; &#x43E;&#x431;&#x430;&#x432;&#x435;&#x448;&#x442;&#x435;&#x43D; &#x438; &#x434;&#x430; &#x45B;&#x435; &#x440;&#x435;&#x448;&#x438;&#x442;&#x438; &#x43F;&#x440;&#x43E;&#x431;&#x43B;&#x435;&#x43C;.","ziggeoplayer.video-not-found":"&#x41D;&#x438;&#x441;&#x43C;&#x43E; &#x43C;&#x43E;&#x433;&#x43B;&#x438; &#x43D;&#x430;&#x45B;&#x438; &#x43D;&#x430;&#x432;&#x435;&#x434;&#x435;&#x43D;&#x443; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x458;&#x43B;.","ziggeoplayer.video-access-forbidden":"&#x41D;&#x438;&#x458;&#x435; &#x432;&#x430;&#x43C; &#x434;&#x43E;&#x437;&#x432;&#x43E;&#x459;&#x435;&#x43D;&#x43E; &#x434;&#x430; &#x43F;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43F;&#x435; &#x43E;&#x432;&#x43E;&#x43C; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x444;&#x430;&#x458;&#x43B;.","ziggeoplayer.video-unknown-error":"&#x41C;&#x438; &#x43D;&#x435; &#x43C;&#x43E;&#x436;&#x435;&#x43C;&#x43E; &#x434;&#x430; &#x43F;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43F;&#x438;&#x442;&#x435; &#x43E;&#x432;&#x43E;&#x43C; &#x432;&#x438;&#x434;&#x435;&#x43E; &#x443; &#x43E;&#x432;&#x43E;&#x43C; &#x442;&#x440;&#x435;&#x43D;&#x443;&#x442;&#x43A;&#x443;. &#x41F;&#x43E;&#x43A;&#x443;&#x448;&#x430;&#x458;&#x442;&#x435; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x43E; &#x43A;&#x430;&#x441;&#x43D;&#x438;&#x458;&#x435;.","ziggeoplayer.video-rejected":"&#x412;&#x438;&#x434;&#x435;&#x43E; &#x458;&#x435; &#x43E;&#x434;&#x431;&#x438;&#x458;&#x435;&#x43D;.","ziggeoplayer.video-processing":"&#x412;&#x438;&#x434;&#x435;&#x43E; &#x43E;&#x431;&#x440;&#x430;&#x452;&#x443;&#x458;&#x435; - &#x441;&#x442;&#x430;&#x438; &#x442;&#x443;&#x43D;&#x435;&#x434;.","ziggeoplayer.video-access-error":"&#x412;&#x438;&#x434;&#x435;&#x43E; &#x458;&#x435; &#x442;&#x440;&#x435;&#x43D;&#x443;&#x442;&#x43D;&#x43E; &#x443; &#x444;&#x430;&#x437;&#x438; &#x443;&#x43C;&#x435;&#x440;&#x435;&#x43D;&#x43E;&#x441;&#x442;&#x438;. &#x41C;&#x43E;&#x436;&#x435;&#x442;&#x435; &#x434;&#x430; &#x43A;&#x43B;&#x438;&#x43A;&#x43D;&#x435;&#x442;&#x435; &#x434;&#x430; &#x43F;&#x43E;&#x43D;&#x43E;&#x432;&#x438;&#x442;&#x435;."},"language:sv":{"application.error_503":"Vi beh&#xE5;ller v&#xE5;r service. Videoklipp kommer att vara tillbaka snart.","application.error_404":"Vi kan inte k&#xE4;nna igen din API-nyckel. Var noga med att ange det i webbplatsens sidhuvud.","application.error_401":"Det &#xE4;r inte till&#xE5;tet att f&#xE5; tillg&#xE5;ng till programmet fr&#xE5;n denna sida.","application.error_412":"Du m&#xE5;ste bekr&#xE4;fta / uppgradera ditt konto.","application.error_unknown":"Ett ok&#xE4;nt fel uppstod. V&#xE5;rt team har anm&#xE4;lts och kommer att l&#xF6;sa problemet.","ziggeoplayer.video-not-found":"Vi kunde inte hitta den angivna videofilen.","ziggeoplayer.video-access-forbidden":"Det &#xE4;r inte till&#xE5;tet att f&#xE5; tillg&#xE5;ng till den h&#xE4;r videofil.","ziggeoplayer.video-unknown-error":"Vi kan inte f&#xE5; tillg&#xE5;ng till den h&#xE4;r videon just nu. F&#xF6;rs&#xF6;k igen senare.","ziggeoplayer.video-rejected":"Videon har avvisats.","ziggeoplayer.video-processing":"Videon bearbetar - h&#xE5;ll &#xF6;gonen &#xF6;ppna.","ziggeoplayer.video-access-error":"Videon &#xE4;r f&#xF6;r n&#xE4;rvarande under m&#xE5;tta. Du kan klicka f&#xF6;r att f&#xF6;rs&#xF6;ka igen."},"language:tl":{"application.error_503":"Kami ay pinapanatili ang aming serbisyo. Video ay maaaring bumalik sa lalong madaling panahon.","application.error_404":"Hindi namin maaaring makilala ang iyong api key. Mangyaring siguraduhin na tukuyin ito sa header ng iyong website.","application.error_401":"Hindi ka pinapayagang i-access ang application mula sa site na ito.","application.error_412":"Kailangan mong kumpirmahin / i-upgrade ang iyong account.","application.error_unknown":"Isang hindi alam na error ang naganap. Ang aming koponan ay aabisuhan at kukumpirmahin malutas ang isyu.","ziggeoplayer.video-not-found":"Hindi kami makahanap ng ang tinukoy na file na video.","ziggeoplayer.video-access-forbidden":"Ikaw ay hindi pinapayagan na ma-access ang video file.","ziggeoplayer.video-unknown-error":"Hindi namin ma-access ang video na ito sa sandaling ito. Subukang muli mamaya.","ziggeoplayer.video-rejected":"Ang video na ito ay tinanggihan.","ziggeoplayer.video-processing":"Ang video ay pinoproseso - manatiling nakatutok.","ziggeoplayer.video-access-error":"Ang video na ito ay kasalukuyang sumasailalim sa pagmo-moderate. Maaari mong i-click upang subukang muli."},"language:tr":{"application.error_503":"Biz hizmetimizi s&#xFC;rd&#xFC;rmekteyiz. Videolar geri yak&#x131;nda olacak.","application.error_404":"Biz API anahtar&#x131;n&#x131; tan&#x131;yamaz. Web sitenizin ba&#x15F;l&#x131;&#x11F;&#x131;nda bunu belirtmek i&#xE7;in emin olun.","application.error_401":"Bu siteden uygulamaya eri&#x15F;mek i&#xE7;in izin verilmez.","application.error_412":"Sen / onaylamak hesab&#x131;n&#x131;z&#x131; y&#xFC;kseltmeniz gerekir.","application.error_unknown":"Bilinmeyen bir hata olu&#x15F;tu. Ekibimiz tebli&#x11F; edilmi&#x15F; ve sorunu &#xE7;&#xF6;zecektir.","ziggeoplayer.video-not-found":"Biz Belirtilen video dosyas&#x131;n&#x131; bulamad&#x131;.","ziggeoplayer.video-access-forbidden":"Bu g&#xF6;r&#xFC;nt&#xFC;l&#xFC; dosyaya eri&#x15F;mek i&#xE7;in izin verilmez.","ziggeoplayer.video-unknown-error":"Biz &#x15F;u anda bu videoyu eri&#x15F;emiyor. L&#xFC;tfen daha sonra tekrar deneyiniz.","ziggeoplayer.video-rejected":"Video reddedildi.","ziggeoplayer.video-processing":"Video i&#x15F;leme - bizi izlemeye devam edin.","ziggeoplayer.video-access-error":"Video &#x131;l&#x131;ml&#x131;l&#x131;k a&#x15F;amas&#x131;ndad&#x131;r. Tekrar denemek i&#xE7;in t&#x131;klayabilirsiniz."},"language:zh-cn":{"application.error_503":"&#x670D;&#x52A1;&#x5668;&#x6B63;&#x5728;&#x7EF4;&#x62A4;&#x4E2D;&#xFF0C;&#x7A0D;&#x540E;&#x5C31;&#x4F1A;&#x6062;&#x590D;&#x3002;","application.error_404":"&#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x9A8C;&#x8BC1;&#x60A8;&#x7684;&#x5E94;&#x7528;&#x91D1;&#x94A5;&#xFF0C;&#x8BF7;&#x786E;&#x5B9A;&#x60A8;&#x6709;&#x5728;&#x7F51;&#x7AD9;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x4E2D;&#x6B63;&#x786E;&#x6307;&#x5B9A;&#x4E86;&#x91D1;&#x94A5;&#x3002;","application.error_401":"&#x672A;&#x7ECF;&#x6388;&#x6743;&#x7684;&#x5E94;&#x7528;&#xFF0C;&#x8BF7;&#x786E;&#x8BA4;&#x3002;","application.error_412":"&#x60A8;&#x5FC5;&#x987B;&#x786E;&#x8BA4;/&#x66F4;&#x65B0;&#x60A8;&#x7684;&#x5E10;&#x6237;&#x3002;","application.error_unknown":"&#x53D1;&#x751F;&#x4E86;&#x672A;&#x77E5;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x5DF2;&#x901A;&#x77E5;&#x5DE5;&#x4F5C;&#x56E2;&#x961F;&#x6765;&#x6392;&#x9664;&#x6B64;&#x95EE;&#x9898;&#x3002;","ziggeoplayer.video-not-found":"&#x65E0;&#x6CD5;&#x627E;&#x5230;&#x8BE5;&#x5F71;&#x7247;&#x3002;","ziggeoplayer.video-access-forbidden":"&#x672A;&#x6388;&#x6743;&#x5B58;&#x53D6;&#x6B64;&#x5F71;&#x7247;&#x3002;","ziggeoplayer.video-unknown-error":"&#x6682;&#x65F6;&#x65E0;&#x6CD5;&#x5B58;&#x53D6;&#x6B64;&#x5F71;&#x7247;&#xFF0C;&#x8BF7;&#x7A0D;&#x540E;&#x518D;&#x8BD5;&#x3002;","ziggeoplayer.video-rejected":"&#x62D2;&#x7EDD;&#x5B58;&#x53D6;&#x5F71;&#x7247;&#x3002;","ziggeoplayer.video-processing":"&#x5F71;&#x7247;&#x5904;&#x7406;&#x4E2D;&#xFF0C;&#x8BF7;&#x7A0D;&#x5019;&#x3002;","ziggeoplayer.video-access-error":"&#x5F71;&#x7247;&#x6B63;&#x5728;&#x8F6C;&#x6863;&#x4E2D;&#xFF0C;&#x8BF7;&#x7A0D;&#x540E;&#x518D;&#x8BD5;&#x3002;"},"language:zh-tw":{"application.error_503":"&#x4F3A;&#x670D;&#x5668;&#x6B63;&#x5728;&#x7DAD;&#x8B77;&#x4E2D;&#xFF0C;&#x670D;&#x52D9;&#x7A0D;&#x5F8C;&#x5C31;&#x6703;&#x6062;&#x5FA9;&#x3002;","application.error_404":"&#x6211;&#x5011;&#x7121;&#x6CD5;&#x9A57;&#x8B49;&#x60A8;&#x7684; API &#x91D1;&#x9470;&#xFF0C;&#x8ACB;&#x78BA;&#x5B9A;&#x60A8;&#x6709;&#x5728;&#x7DB2;&#x7AD9;&#x914D;&#x7F6E;&#x53C3;&#x6578;&#x4E2D;&#x6B63;&#x78BA;&#x6307;&#x5B9A;&#x4E86;&#x91D1;&#x9470;&#x3002;","application.error_401":"&#x672A;&#x7D93;&#x6388;&#x6B0A;&#x7684;&#x61C9;&#x7528;&#xFF0C;&#x8ACB;&#x78BA;&#x8A8D;&#x3002;","application.error_412":"&#x60A8;&#x5FC5;&#x9808;&#x78BA;&#x8A8D;/&#x66F4;&#x65B0;&#x60A8;&#x7684;&#x5E33;&#x865F;&#x3002;","application.error_unknown":"&#x767C;&#x751F;&#x4E86;&#x672A;&#x77E5;&#x7684;&#x932F;&#x8AA4;&#xFF0C;&#x5DF2;&#x901A;&#x77E5;&#x5DE5;&#x4F5C;&#x5718;&#x968A;&#x4F86;&#x6392;&#x9664;&#x6B64;&#x554F;&#x984C;&#x3002;","ziggeoplayer.video-not-found":"&#x7121;&#x6CD5;&#x627E;&#x5230;&#x8A72;&#x5F71;&#x7247;&#x3002;","ziggeoplayer.video-access-forbidden":"&#x672A;&#x6388;&#x6B0A;&#x5B58;&#x53D6;&#x6B64;&#x5F71;&#x7247;&#x3002;","ziggeoplayer.video-unknown-error":"&#x66AB;&#x6642;&#x7121;&#x6CD5;&#x5B58;&#x53D6;&#x6B64;&#x5F71;&#x7247;&#xFF0C;&#x8ACB;&#x7A0D;&#x5F8C;&#x518D;&#x8A66;&#x3002;","ziggeoplayer.video-rejected":"&#x62D2;&#x7D55;&#x5B58;&#x53D6;&#x5F71;&#x7247;&#x3002;","ziggeoplayer.video-processing":"&#x5F71;&#x7247;&#x8655;&#x7406;&#x4E2D;&#xFF0C;&#x8ACB;&#x7A0D;&#x5019;&#x3002;","ziggeoplayer.video-access-error":"&#x5F71;&#x7247;&#x6B63;&#x5728;&#x8F49;&#x6A94;&#x4E2D;&#xFF0C;&#x8ACB;&#x7A0D;&#x5F8C;&#x518D;&#x8A66;&#x3002;"}};
    for (var language in languages)
        Locale.mainLocale.register(languages[language], [language]);
    return {};
});


}).call(Scoped);
Scoped.detach(true);

if (oldScoped)
	oldScoped.attach();	

}).call(this);